[{"title":"Goå¹¶å‘ç¼–ç¨‹åŸºç¡€æ¦‚å¿µ","date":"2020-10-09T02:17:07.000Z","path":"2020/10/09/Go-Concurrent/","text":"åç¨‹æœºåˆ¶Thread vs. Groutine åˆ›å»ºæ—¶é»˜è®¤çš„stackçš„å¤§å° Groutineçš„Stackåˆå§‹åŒ–å¤§å°ä¸º2K å’ŒKSEï¼ˆKernel Space Entityï¼‰çš„å¯¹åº”å…³ç³» Java Thread æ˜¯ 1 : 1 çº¿ç¨‹ä¹‹é—´å‘ç”Ÿcontextåˆ‡æ¢çš„æ—¶å€™å›ç›´æ¥é€ æˆå†…æ ¸å¯¹è±¡çš„åˆ‡æ¢ï¼Œé€ æˆå¾ˆå¤§çš„æ¶ˆè€— Groutine æ˜¯ M:N åç¨‹åŸç†å›¾ ç»“æ„Processorä¸ºGoè¯­è¨€å®ç°çš„åç¨‹å¤„ç†å™¨ï¼ŒProcessoråœ¨ä¸åŒçš„ç³»ç»Ÿçº¿ç¨‹é‡Œï¼Œæ¯ä¸ªProcessoræœ‰ä¸€ä¸ªå‡†å¤‡è¿è¡Œçš„åç¨‹é˜Ÿåˆ—ï¼Œæœ‰ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„åç¨‹ã€‚ å¹¶å‘æ€§èƒ½ GOè¿è¡Œçš„æ—¶å€™ä¼šæœ‰ä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹è¿›è¡Œè®¡æ•°ï¼Œè®°å½•æ¯ä¸ªProcessorçš„å®Œæˆåç¨‹çš„æ•°é‡ã€‚å½“ä¸€æ®µæ—¶é—´å®Œæˆçš„æ•°é‡æ²¡æœ‰å˜åŒ–çš„æ—¶å€™ï¼Œå°±ä¼šåœ¨è¯¥Processorçš„åç¨‹ä»»åŠ¡æ ˆä¸­æ’å…¥ä¸€ä¸ªç‰¹æ®Šçš„æ ‡è®°ï¼Œå½“åç¨‹è¿è¡Œéå†…è”å‡½æ•°æ—¶å°±ä¼šé‡åˆ°æ­¤æ ‡è®°ï¼Œå°±ä¼šå°†è‡ªå·±ä¸­æ–­ä¸‹æ¥ç„¶åæ’åœ¨ç­‰å¾…é˜Ÿåˆ—çš„é˜Ÿå°¾ï¼Œåˆ‡æ¢æˆåˆ«çš„åç¨‹ç»§ç»­è¿è¡Œã€‚ åç¨‹è¢«ä¸­æ–­çš„æ—¶å€™ï¼ŒProcessorä¼šæŠŠè‡ªå·±ç§»åˆ°å¦ä¸€ä¸ªå¯ä½¿ç”¨çš„ç³»ç»Ÿçº¿ç¨‹ä¸­ï¼Œç»§ç»­æ‰§è¡Œæ‰€æŒ‚é˜Ÿåˆ—é‡Œçš„å…¶ä»–åç¨‹ã€‚å½“è¢«ä¸­æ–­çš„åç¨‹è¢«å”¤é†’æ—¶ï¼Œå®ƒä¼šè¢«åŠ åœ¨å…¶ä¸­æŸä¸€ä¸ªProcessorçš„ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼Œæˆ–è€…å…¨å±€ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚å…¶åœ¨å¯„å­˜å™¨ä¸­çš„çŠ¶æ€ä¼šè¢«ä¿å­˜åˆ°åç¨‹å¯¹è±¡ä¸­ï¼Œåœ¨ä¸‹ä¸€æ¬¡è·å–æ‰§è¡Œæœºä¼šçš„æ—¶å€™ï¼Œä¼šå†å°†çŠ¶æ€ä¿å­˜åˆ°å¯„å­˜å™¨ä¸­ã€‚ ä½¿ç”¨12345678910111213141516func TestGroutine(t *testing.T) &#123; for i := 0; i &lt; 10; i++ &#123; go func(i int) &#123; //è¿™é‡Œçš„iåœ¨æ¯ä¸ªåç¨‹ä¸­çš„åœ°å€æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¼šè¿›è¡Œå€¼å¤åˆ¶ fmt.Println(i) &#125;(i) /* go func() &#123; //è¿™æ ·å†™å°±ä¼šå­˜åœ¨å†…å­˜å…±äº«ï¼Œä¼šå­˜åœ¨ç«æ€ fmt.Println(i) &#125;() */ &#125; time.Sleep(time.Millisecond * 50)&#125; æ§åˆ¶å¹¶å‘å…±äº«å†…å­˜å¹¶å‘æœºåˆ¶ä½¿ç”¨é” Mutex ä¿è¯çº¿ç¨‹è¯»å†™å®‰å…¨12345678910111213141516func TestCounterThreadSafe(t *testing.T) &#123; var mut sync.Mutex counter := 0 for i := 0; i &lt; 5000; i++ &#123; go func() &#123; defer func() &#123; mut.Unlock() &#125;() mut.Lock() counter++ &#125;() &#125; time.Sleep(1 * time.Second) t.Logf(\"counter = %d\", counter)&#125; WaitGroup å¯ä»¥è¿›è¡ŒåŒæ­¥æ“ä½œ123456789101112131415161718func TestCounterWaitGroup(t *testing.T) &#123; var mut sync.Mutex var wg sync.WaitGroup counter := 0 for i := 0; i &lt; 5000; i++ &#123; wg.Add(1) go func() &#123; defer func() &#123; mut.Unlock() &#125;() mut.Lock() counter++ wg.Done() &#125;() &#125; wg.Wait() t.Logf(\"counter = %d\", counter)&#125; CSPå¹¶å‘æœºåˆ¶ä¾èµ–äºä¸€ä¸ªé€šé“æ¥å®Œæˆä¸¤ä¸ªé€šè®¯å®ä½“ä¹‹é—´çš„åè°ƒ Channelå…¸å‹çš„Channelæœºåˆ¶ï¼Œ é€šè®¯ä¸¤æ–¹éƒ½éœ€è¦åœ¨ï¼Œä¼ é€’å’Œæ¥å—æ¶ˆæ¯éƒ½éœ€è¦ Buffer Channel å‘é€è€…å’Œæ¥å—è€…æ¾è€¦åˆã€‚channelä¼šæœ‰ä¸€ä¸ªå®¹é‡ï¼Œåœ¨æ²¡æœ‰æ»¡çš„æƒ…å†µä¸‹éƒ½å¯ä»¥å‘æ¶ˆæ¯ 123456789101112131415161718192021222324func service() string &#123; time.Sleep(time.Millisecond * 500) return \"Done\"&#125;func AsyncService() chan string &#123; retCh := make(chan string) //è®¾ç½®äº†å®¹é‡ä¹‹åï¼Œå°±æ˜¯buffer channelï¼Œ ä¸ä¼šé˜»å¡å½“å‰çš„åç¨‹ // retCh := make(chan string, 1) go func() &#123; ret := service() fmt.Println(\"returned result\") retCh &lt;- ret fmt.Println(\"service exited\") &#125;() return retCh&#125;func TestAsyncService(t *testing.T) &#123; retCh := AsyncService() otherTask() fmt.Println(&lt;-retCh)&#125; channelçš„å…³é—­ å‘å…³é—­çš„channelå‘é€æ•°æ®ï¼Œä¼šå¯¼è‡´panic v , ok &lt;- ch; ok ä¸º boolå€¼ï¼Œtrue è¡¨ç¤ºæ­£å¸¸æ¥æ”¶ï¼Œfalseè¡¨ç¤ºé€šé“å…³é—­ æ‰€æœ‰çš„channel æ¥å—è€…éƒ½ä¼šåœ¨channelå…³é—­æ—¶ï¼Œç«‹åˆ»ä»é˜»å¡ç­‰å¾…ä¸­è¿”å›ä¸”ä¸Šè¿°okå€¼ä¸ºfalseï¼Œæ•°æ®ä¼šè¿”å›é€šé“å¯¹åº”ç±»å‹å€¼çš„é›¶å€¼ã€‚ è¿™ä¸ªå¹¿æ’­æœºåˆ¶å¸¸è¢«åˆ©ç”¨ï¼Œè¿›è¡Œå‘å¤šä¸ªè®¢é˜…è€…åŒæ—¶å‘é€ä¿¡å·ã€‚å¦‚ï¼šé€€å‡ºä¿¡å· 123456789101112131415161718192021222324252627282930313233343536func dataProducer(ch chan int, wg *sync.WaitGroup) &#123; go func() &#123; for i := 0; i &lt; 10; i++ &#123; ch &lt;- i &#125; //å¯ä»¥åŒæ—¶è·Ÿå¾ˆå¤šè®¢é˜…è€…å‘é€ç‰¹æ®Šçš„é€šçŸ¥ close(ch) ch &lt;- 11 wg.Done() &#125;()&#125;func dataReceiver(ch chan int, wg *sync.WaitGroup) &#123; go func() &#123; for &#123; if data, ok := &lt;-ch; ok &#123; fmt.Println(data) &#125; else &#123; break &#125; &#125; wg.Done() &#125;()&#125;func TestCloseChannel(t *testing.T) &#123; var wg sync.WaitGroup ch := make(chan int) wg.Add(1) dataProducer(ch, &amp;wg) wg.Add(1) dataReceiver(ch, &amp;wg) wg.Add(1) dataReceiver(ch, &amp;wg) wg.Wait()&#125; å¤šè·¯é€‰æ‹©å’Œè¶…æ—¶æ§åˆ¶ 12345678func TestSelect(t *testing.T) &#123; select &#123; case ret := &lt;-AsyncService(): t.Log(ret) case &lt;-time.After(time.Millisecond * 100): t.Error(\"time out\") &#125;&#125; 100æ¯«ç§’çš„æ—¶å€™åˆ°äº†ä¹‹åï¼ŒAsyncService() è¿˜æ²¡æœ‰è¿”å›å°±ä¼šè¿›å…¥è¶…æ—¶çš„é”™è¯¯ä¿¡æ¯æ‰“å° ä»»åŠ¡å–æ¶ˆ123456789101112131415161718192021222324252627282930func isCancelled(cancelChan chan struct&#123;&#125;) bool &#123; select &#123; case &lt;-cancelChan: return true default: return false &#125;&#125;//ä½¿ç”¨closeå¹¿æ’­æœºåˆ¶è¿›è¡Œæ‰¹é‡å–æ¶ˆä»»åŠ¡func cancel_2(cancelChan chan struct&#123;&#125;) &#123; close(cancelChan)&#125;func TestCancel(t *testing.T) &#123; cancelChan := make(chan struct&#123;&#125;, 0) for i := 0; i &lt; 5; i++ &#123; go func(i int, cancelCh chan struct&#123;&#125;) &#123; for &#123; if isCancelled(cancelCh) &#123; break &#125; time.Sleep(time.Millisecond * 5) &#125; fmt.Println(i, \"Cancelled\") &#125;(i, cancelChan) &#125; cancel_2(cancelChan) time.Sleep(time.Millisecond * 1)&#125; Context ä¸Šä¸‹æ–‡å–æ¶ˆä»»åŠ¡ æ ¹Contextï¼š é€šè¿‡ context.Background()åˆ›å»º å­Contextï¼š context.WithCancel(parentContext)åˆ›å»º ctx, cancel := context.WithCancel(context.Background()) å½“å‰Contextè¢«å–æ¶ˆæ—¶ï¼ŒåŸºäºä»–çš„å­context éƒ½ä¼šè¢«å–æ¶ˆ æ¥æ”¶æ¶ˆæ¯é€šçŸ¥&lt;-ctx.Done() 1234567891011121314151617181920212223242526func isCancelled(ctx context.Context) bool &#123; select &#123; case &lt;-ctx.Done(): return true default: return false &#125;&#125;func TestCancel(t *testing.T) &#123; ctx, cancel := context.WithCancel(context.Background()) for i := 0; i &lt; 5; i++ &#123; go func(i int, ctx context.Context) &#123; for &#123; if isCancelled(ctx) &#123; break &#125; time.Sleep(time.Millisecond * 5) &#125; fmt.Println(i, \"Cancelled\") &#125;(i, ctx) &#125; cancel() time.Sleep(time.Millisecond * 1)&#125;","tags":[{"name":"Go","slug":"Go","permalink":"http://www.yangjie.hu//tags/Go/"}]},{"title":"SwiftUI æ•°æ®æµ","date":"2020-10-09T02:14:39.000Z","path":"2020/10/09/SwiftUI-DataFlow/","text":"â€œçº¯å‡½æ•°æŒ‡çš„æ˜¯ï¼Œè¿”å›å€¼åªç”±è°ƒç”¨æ—¶çš„å‚æ•°å†³å®šï¼Œè€Œä¸ä¾èµ–äºä»»ä½•ç³»ç»ŸçŠ¶æ€ï¼Œä¹Ÿä¸æ”¹å˜å…¶ä½œç”¨åŸŸä¹‹å¤–çš„å˜é‡çŠ¶æ€çš„å‡½æ•°â€ æ‘˜å½•æ¥è‡ª: ç‹ å·. â€œSwiftUI å’Œ Combine ç¼–ç¨‹ã€‚â€ Apple Books. ä½¿ç”¨çº¯å‡½æ•°çš„æ–¹å¼å¯ä»¥å’ŒSwiftUIé…åˆå¾—å¤©ä¸€æ— ç¼ï¼ŒSwiftUIå¼ºè°ƒsingle source of truth, ä¸€ä¸ªç¨³å®šå¯æµ‹è¯•çš„modelæ˜¯appçŠ¶æ€æ¸…æ™°çš„æœ€é‡è¦çš„ä¿è¯ï¼Œä¹Ÿæ˜¯SwiftUIä¸­ä¼ é€’çŠ¶æ€æ—¶é¦–å…ˆéœ€è¦è€ƒè™‘çš„æ–¹å‘ã€‚ å‰ç«¯æµè¡Œçš„æ¡†æ¶Redux ä¸ºä»£è¡¨çš„çŠ¶æ€ç®¡ç†å’Œç»„ä»¶é€šè®¯æ¶æ„æ€æƒ³å’Œæ­¥éª¤ï¼š &gt; å°† app å½“ä½œä¸€ä¸ªçŠ¶æ€æœºï¼ŒçŠ¶æ€å†³å®šç”¨æˆ·ç•Œé¢ã€‚ è¿™äº›çŠ¶æ€éƒ½ä¿å­˜åœ¨ä¸€ä¸ª Store å¯¹è±¡ä¸­ï¼Œè¢«ç§°ä¸º Stateã€‚ View ä¸èƒ½ç›´æ¥æ“ä½œ Stateï¼Œè€Œåªèƒ½é€šè¿‡å‘é€ Action çš„æ–¹å¼ï¼Œé—´æ¥æ”¹å˜å­˜å‚¨åœ¨ Store ä¸­çš„ Stateã€‚ Reducer æ¥å—åŸæœ‰çš„ State å’Œå‘é€è¿‡æ¥çš„ Actionï¼Œç”Ÿæˆæ–°çš„ Stateã€‚ ç”¨æ–°çš„ State æ›¿æ¢ Store ä¸­åŸæœ‰çš„çŠ¶æ€ï¼Œå¹¶ç”¨æ–°çŠ¶æ€æ¥é©±åŠ¨æ›´æ–°ç•Œé¢ã€‚ åœ¨å°å‹çš„é¡¹ç›®é‡Œé¢ä¸ä¸€å®šéœ€è¦å¼•å…¥Reduxè¿™æ ·çš„æ¶æ„ï¼Œè¿™æ ·åè€Œä¼šå¢åŠ å¤æ‚æ€§ã€‚ â€œ@ â€ å±æ€§åŒ…è£…åœ¨Swift ä¸­ @ å±æ€§çš„ç‰¹æ€§ç§°ä¸º å±æ€§åŒ…è£…ï¼Œ propertyWrapper @State@State ä¿®é¥°çš„å€¼ï¼Œåœ¨SwiftUIå†…éƒ¨ä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸ºä¸€å¯¹ setter å’Œ getterï¼Œ å¯¹è¿™ä¸ªå±æ€§è¿›è¡Œèµ‹å€¼çš„æ“ä½œå°†ä¼šè§¦å‘Viewçš„åˆ·æ–°ï¼Œå®ƒçš„bodyä¼šè¢«å†æ¬¡è°ƒç”¨ï¼Œä½å±‚æ¸²æŸ“å¼•æ“ä¼šæ‰¾å‡ºç•Œé¢ä¸Šè¢«æ”¹å˜çš„éƒ¨åˆ†ï¼Œæ ¹æ®æ–°çš„å±æ€§å€¼è®¡ç®—å‡ºæ–°çš„View å¹¶è¿›è¡Œåˆ·æ–°ã€‚ @Binding@State å±æ€§å€¼ä»…åªèƒ½åœ¨å±æ€§æœ¬èº«è¢«è®¾ç½®æ—¶ä¼šè§¦å‘UIåˆ·æ–°ï¼Œè¿™ä¸ªç‰¹æ€§è®©å®ƒéå¸¸é€‚åˆç”¨æ¥å£°æ˜ä¸€ä¸ªå€¼ç±»å‹çš„å€¼ï¼šå› ä¸ºå¯¹å€¼ç±»å‹çš„å±æ€§çš„å˜æ›´ï¼Œä¹Ÿä¼šè§¦å‘æ•´ä¸ªå€¼çš„é‡æ–°è®¾ç½®ï¼Œè¿›è€Œåˆ·æ–° UIã€‚ ä¸è¿‡ï¼Œåœ¨æŠŠè¿™æ ·çš„å€¼åœ¨ä¸åŒå¯¹è±¡é—´ä¼ é€’æ—¶ï¼ŒçŠ¶æ€å€¼å°†ä¼šéµå®ˆå€¼è¯­ä¹‰å‘ç”Ÿå¤åˆ¶ã€‚å¦‚æ­¤å„ä¸ªå±‚çº§çš„çš„Stateå±æ€§éƒ½ä¸ç›¸åŒï¼Œå¯¹Stateå±æ€§çš„å˜æ›´å°±åªèƒ½ä½œç”¨åœ¨åŒå±‚çº§ä¸­ï¼Œå¯¹é¡¶å±‚çš„UIå°±æ²¡æœ‰åŠæ³•åšå‡ºæ›´æ–°ã€‚ @Binding å°±æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ â€œ@Binding ä¹Ÿæ˜¯å¯¹å±æ€§çš„ä¿®é¥°ï¼Œå®ƒåšçš„äº‹æƒ…æ˜¯å°†å€¼è¯­ä¹‰çš„å±æ€§â€œè½¬æ¢â€ä¸ºå¼•ç”¨è¯­ä¹‰ã€‚å¯¹è¢«å£°æ˜ä¸º @Binding çš„å±æ€§è¿›è¡Œèµ‹å€¼ï¼Œæ”¹å˜çš„å°†ä¸æ˜¯å±æ€§æœ¬èº«ï¼Œè€Œæ˜¯å®ƒçš„å¼•ç”¨ï¼Œè¿™ä¸ªæ”¹å˜å°†è¢«å‘å¤–ä¼ é€’ã€‚â€ æ‘˜å½•æ¥è‡ª: ç‹ å·. â€œSwiftUI å’Œ Combine ç¼–ç¨‹ã€‚â€ Apple Books. åœ¨ Swift 5.1 ä¸­ï¼Œå¯¹ä¸€ä¸ªç”± @ ç¬¦å·ä¿®é¥°çš„å±æ€§ï¼Œåœ¨å®ƒå‰é¢ä½¿ç”¨ $ æ‰€å–å¾—çš„å€¼ï¼Œè¢«ç§°ä¸ºæŠ•å½±å±æ€§ (projection property)ã€‚æœ‰äº› @ å±æ€§ï¼Œæ¯”å¦‚ @State å’Œ @Bindingï¼Œå®ƒä»¬çš„æŠ•å½±å±æ€§å°±æ˜¯è‡ªèº«æ‰€å¯¹åº”å€¼çš„ Binding ç±»å‹ã€‚ 1CalculatorButtonRow(row: row, brain: self.$brain) $brain çš„å†™æ³•å°† brain ä» State è½¬æ¢æˆäº†å¼•ç”¨è¯­ä¹‰çš„ Binding çŠ¶æ€ä¼ é€’é€‰æ‹© è¿™ä¸ªçŠ¶æ€æ˜¯å±äºå•ä¸ª View åŠå…¶å­å±‚çº§ï¼Œè¿˜æ˜¯éœ€è¦åœ¨å¹³è¡Œçš„éƒ¨ä»¶ä¹‹é—´ä¼ é€’å’Œä½¿ç”¨ï¼Ÿ@State å¯ä»¥ä¾é  SwiftUI æ¡†æ¶å®Œæˆ View çš„è‡ªåŠ¨è®¢é˜…å’Œåˆ·æ–°ï¼Œä½†è¿™æ˜¯æœ‰æ¡ä»¶çš„ï¼šå¯¹äº @State ä¿®é¥°çš„å±æ€§çš„è®¿é—®ï¼Œåªèƒ½å‘ç”Ÿåœ¨ body æˆ–è€… body æ‰€è°ƒç”¨çš„æ–¹æ³•ä¸­ã€‚ä½ ä¸èƒ½åœ¨å¤–éƒ¨æ”¹å˜ @State çš„å€¼ï¼Œå®ƒçš„æ‰€æœ‰ç›¸å…³æ“ä½œå’ŒçŠ¶æ€æ”¹å˜éƒ½åº”è¯¥æ˜¯å’Œå½“å‰ View æŒ‚é’©çš„ã€‚å¦‚æœä½ éœ€è¦åœ¨å¤šä¸ª View ä¸­å…±äº«æ•°æ®ï¼Œ@State å¯èƒ½ä¸æ˜¯å¾ˆå¥½çš„é€‰æ‹©ï¼›å¦‚æœè¿˜éœ€è¦åœ¨ View å¤–éƒ¨æ“ä½œæ•°æ®ï¼Œé‚£ä¹ˆ @State ç”šè‡³å°±ä¸æ˜¯å¯é€‰é¡¹äº†ã€‚ çŠ¶æ€å¯¹åº”çš„æ•°æ®ç»“æ„æ˜¯å¦è¶³å¤Ÿç®€å•ï¼Ÿå¯¹äºåƒæ˜¯å•ä¸ªçš„ Bool æˆ–è€… Stringï¼Œ@State å¯ä»¥è¿…é€Ÿå¯¹åº”ã€‚å«æœ‰å°‘æ•°å‡ ä¸ªæˆå‘˜å˜é‡çš„å€¼ç±»å‹ï¼Œä¹Ÿè®¸ä½¿ç”¨ @State ä¹Ÿè¿˜ä¸é”™ã€‚ä½†æ˜¯å¯¹äºæ›´å¤æ‚çš„æƒ…å†µï¼Œä¾‹å¦‚å«æœ‰å¾ˆå¤šå±æ€§å’Œæ–¹æ³•çš„ç±»å‹ï¼Œå¯èƒ½å…¶ä¸­åªæœ‰å¾ˆå°‘å‡ ä¸ªå±æ€§éœ€è¦è§¦å‘ UI æ›´æ–°ï¼Œä¹Ÿå¯èƒ½å„ä¸ªå±æ€§ä¹‹é—´å½¼æ­¤æœ‰å…³è”ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥é€‰æ‹©å¼•ç”¨ç±»å‹å’Œæ›´çµæ´»çš„å¯è‡ªå®šä¹‰æ–¹å¼ã€‚ ObservableObject å’Œ @ObjectBindingObservableObject åè®®è¦æ±‚å®ç°ç±»å‹æ˜¯classï¼Œ å®ƒåªæœ‰ä¸€ä¸ªéœ€è¦å®ç°çš„å±æ€§ï¼šobjectWillChange, åœ¨æ•°æ®å°†è¦å‘ç”Ÿæ”¹å˜æ—¶ï¼Œè¿™ä¸ªå±æ€§ç”¨æ¥å‘å¤–è¿›è¡Œâ€œå¹¿æ’­â€ï¼Œå®ƒçš„è®¢é˜…è€…ï¼ˆä¸€èˆ¬æ˜¯Viewç›¸å…³çš„é€»è¾‘ï¼‰æ”¶åˆ°é€šçŸ¥åï¼Œå¯¹Viewè¿›è¡Œåˆ·æ–°ã€‚ åˆ›å»ºå¥½ObservableObjectååœ¨Viewä¸­ä½¿ç”¨çš„æ—¶å€™éœ€è¦å°†å®ƒå£°æ˜ä¸º@ObservedObjectï¼Œå®ƒä¹Ÿæ˜¯ä¸€ä¸ªå±ç›¸åŒ…è£…ï¼Œè´Ÿè´£é€šè¿‡è®¢é˜… objectWillChange å°†å…·ä½“ç®¡ç†æ•°æ®çš„ ObservableObject å’Œ å½“å‰çš„Viewå…³è”èµ·æ¥ã€‚ ğŸŒ°123456class CalculatorModel: ObservableObject &#123; let objectWillChange = PassthroughSubject&lt;Void, Never&gt;() var brain: CalculatorBrain = .left(\"0\") &#123; willSet &#123; objectWillChange.send() &#125; &#125;&#125; @Publishedå½“ObservableObjectä¸­å­˜åœ¨å¤§é‡éœ€è¦æ‰‹åŠ¨è°ƒç”¨objectWillChange.send(),ä½¿ç”¨@Published ,ç¼–è¯‘å™¨å°†ä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨å®Œæˆè¿™ä»¶äº‹æƒ…ã€‚ 123class CalculatorModel: ObservableObject &#123; @Published var brain: CalculatorBrain = .left(\"0\")&#125; @EnvironmentObject â€œåœ¨ SwiftUI ä¸­ï¼ŒView æä¾›äº† environmentObject(_:) æ–¹æ³•ï¼Œæ¥æŠŠæŸä¸ª ObservableObject çš„å€¼æ³¨å…¥åˆ°å½“å‰ View å±‚çº§åŠå…¶å­å±‚çº§ä¸­å»ã€‚åœ¨è¿™ä¸ª View çš„å­å±‚çº§ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ @EnvironmentObject æ¥ç›´æ¥è·å–è¿™ä¸ªç»‘å®šçš„ç¯å¢ƒå€¼ã€‚â€ æ‘˜å½•æ¥è‡ª: ç‹ å·. â€œSwiftUI å’Œ Combine ç¼–ç¨‹ã€‚â€ Apple Books. åœ¨SceneDelegate.swiftæ–‡ä»¶ä¸­åˆ›å»ºContentViewçš„åœ°æ–¹ï¼Œé€šè¿‡environmentObjectæŠŠé€šç”¨çš„ Model æ·»åŠ ä¸Šå»ï¼š 123window.rootViewController = UIHostingController( rootView: ContentView().environmentObject(CalculatorModel())) ä¸ºäº†è®© ContentView çš„é¢„è§ˆä¹Ÿèƒ½ä¿æŒå·¥ä½œï¼Œä½ è¿˜éœ€è¦ä¸ºåœ¨ContentView_Previews ä¸­ä¹Ÿç”¨åŒæ ·çš„æ–¹å¼æ·»åŠ ä¸Š environmentObjectï¼š 12345struct ContentView_Previews: PreviewProvider &#123; static var previews: some View &#123; ContentView().environmentObject(CalculatorModel()) &#125;&#125; å°ç»“ â€œ@State å’Œ @Binding æä¾› View å†…éƒ¨çš„çŠ¶æ€å­˜å‚¨ï¼Œå®ƒä»¬åº”è¯¥æ˜¯è¢«æ ‡è®°ä¸º private çš„ç®€å•å€¼ç±»å‹ï¼Œä»…åœ¨å†…éƒ¨ä½¿ç”¨ã€‚ObservableObject å’Œ @ObservedObject åˆ™é’ˆå¯¹è·¨è¶Š View å±‚çº§çš„çŠ¶æ€å…±äº«ï¼Œå®ƒå¯ä»¥å¤„ç†æ›´å¤æ‚çš„æ•°æ®ç±»å‹ï¼Œå…¶å¼•ç”¨ç±»å‹çš„ç‰¹ç‚¹ï¼Œä¹Ÿè®©æˆ‘ä»¬éœ€è¦åœ¨æ•°æ®å˜åŒ–æ—¶é€šè¿‡æŸç§æ‰‹æ®µå‘å¤–å‘é€é€šçŸ¥ (æ¯”å¦‚æ‰‹åŠ¨è°ƒç”¨ objectWillChange.send() æˆ–è€…ä½¿ç”¨ @Published)ï¼Œæ¥è§¦å‘ç•Œé¢åˆ·æ–°ã€‚å¯¹äºâ€œè·³è·ƒå¼â€è·¨è¶Šå¤šä¸ª View å±‚çº§çš„çŠ¶æ€ï¼Œ@EnvironmentObject èƒ½è®©æˆ‘ä»¬æ›´æ–¹ä¾¿åœ°ä½¿ç”¨ ObservableObjectï¼Œä»¥è¾¾åˆ°ç®€åŒ–ä»£ç çš„ç›®çš„ã€‚â€ æ‘˜å½•æ¥è‡ª: ç‹ å·. â€œSwiftUI å’Œ Combine ç¼–ç¨‹ã€‚â€ Apple Books. Referenceæ–‡ç« ä»£ç ä»¥åŠçŸ¥è¯†æ¢³ç†æ¥è‡ªäºå–µç¥çš„ã€ŠSwiftUI å’Œ Combine ç¼–ç¨‹ã€‹ï¼Œæ„Ÿå…´è¶£å¯ä»¥åœ¨objc.ioä¸Šè´­ä¹°é£Ÿç”¨ã€‚","tags":[{"name":"SwiftUI","slug":"SwiftUI","permalink":"http://www.yangjie.hu//tags/SwiftUI/"}]},{"title":"é™ä½åœˆå¤æ‚åº¦çš„æ–¹æ³•","date":"2020-03-31T16:06:30.000Z","path":"2020/04/01/Reduce-Cyclomatic-Complexity/","text":"é‡æ–°ç»„ç»‡ä½ çš„å‡½æ•°æŠ€å·§1 æç‚¼å‡½æ•°æœ‰ä¸€æ®µä»£ç å¯ä»¥è¢«ç»„ç»‡åœ¨ä¸€èµ·å¹¶ç‹¬ç«‹å‡ºæ¥: 123456789101112void Example(int val)&#123; if( val &gt; MAX_VAL) &#123; val = MAX_VAL; &#125; for( int i = 0; i &lt; val; i++) &#123; doSomething(i); &#125;&#125; å°†è¿™æ®µä»£ç æ”¾è¿›ä¸€ä¸ªç‹¬ç«‹å‡½æ•°ä¸­ï¼Œå¹¶è®©å‡½æ•°åç§°è§£é‡Šè¯¥å‡½æ•°çš„ç”¨é€”: 12345678910111213141516171819202122232425262728293031323334353637383940414243int getValidVal(int val)&#123; if( val &gt; MAX_VAL) &#123; return MAX_VAL; &#125; return val;&#125;void doSomethings(int val)&#123; for( int i = 0; i &lt; val; i++) &#123; doSomething(i); &#125;&#125;void Example(int val)&#123; doSomethings(getValidVal(val));&#125;``` æœ€åè¿˜è¦é‡æ–°å®¡è§†å‡½æ•°å†…å®¹æ˜¯å¦åœ¨ç»Ÿä¸€å±‚æ¬¡ä¸Šã€‚### æŠ€å·§2 æ›¿æ¢ç®—æ³•æŠŠæŸä¸ªç®—æ³•æ›¿æ¢ä¸ºå¦ä¸€ä¸ªæ›´æ¸…æ™°çš„ç®—æ³•ï¼š``` cstring foundPerson(const vector&lt;string&gt;&amp; peoples)&#123; for (auto&amp; people : peoples) &#123; if (people == \"Don\")&#123; return \"Don\"; &#125; if (people == \"John\")&#123; return \"John\"; &#125; if (people == \"Kent\")&#123; return \"Kent\"; &#125; &#125; return \"\";&#125; å°†å‡½æ•°å®ç°æ›¿æ¢ä¸ºå¦ä¸€ä¸ªç®—æ³•: 12345678910111213string foundPerson(const vector&lt;string&gt;&amp; people)&#123; std::map&lt;string,string&gt;candidates&#123; &#123; \"Don\", \"Don\"&#125;, &#123; \"John\", \"John\"&#125;, &#123; \"Kent\", \"Kent\"&#125;, &#125;; for (auto&amp; people : peoples) &#123; auto&amp; it = candidates.find(people); if(it != candidates.end()) return it-&gt;second; &#125;&#125; æ‰€è°“çš„è¡¨é©±åŠ¨ã€‚ ç®€åŒ–æ¡ä»¶è¡¨è¾¾å¼æŠ€å·§3 é€†å‘è¡¨è¾¾åœ¨ä»£ç ä¸­å¯èƒ½å­˜åœ¨æ¡ä»¶è¡¨è¾¾å¦‚ä¸‹ï¼š 12345678910111213141516if ((condition1() &amp;&amp; condition2()) || !condition1())&#123; return true;&#125;else&#123; return false;&#125;åº”ç”¨é€†å‘è¡¨è¾¾è°ƒæ¢è¡¨è¾¾é¡ºåºåæ•ˆæœå¦‚ä¸‹ï¼šif(condition1() &amp;&amp; !condition2())&#123; return false;&#125;return true; æŠ€å·§4 åˆ†è§£æ¡ä»¶åœ¨ä»£ç ä¸­å­˜åœ¨å¤æ‚çš„æ¡ä»¶è¡¨è¾¾ï¼š 12345678910if(date.before (SUMMER_START) || date.after(SUMMER_END)) charge = quantity * _winterRate + _winterServiceCharge;else charge = quantity * _summerRate;ä»ifã€thenã€elseä¸‰ä¸ªæ®µè½ä¸­åˆ†åˆ«æç‚¼å‡ºç‹¬ç«‹å‡½æ•°ï¼šif(notSummer(date)) charge = winterCharge(quantity);else charge = summerCharge (quantity); æŠ€å·§5 åˆå¹¶æ¡ä»¶ä¸€ç³»åˆ—æ¡ä»¶åˆ¤æ–­ï¼Œéƒ½å¾—åˆ°ç›¸åŒç»“æœ: 1234567891011121314151617181920212223242526272829303132333435double disabilityAmount() &#123; if (_seniority &lt; 2) return 0; if (_monthsDisabled &gt; 12) return 0; if (_isPartTime) return 0; // compute the disability amount ......å°†è¿™äº›åˆ¤æ–­åˆå¹¶ä¸ºä¸€ä¸ªæ¡ä»¶å¼ï¼Œå¹¶å°†è¿™ä¸ªæ¡ä»¶å¼æç‚¼æˆä¸ºä¸€ä¸ªç‹¬ç«‹å‡½æ•°:double disabilityAmount() &#123; if (isNotEligableForDisability()) return 0; // compute the disability amount ......``` ### æŠ€å·§6 ç§»é™¤æ§åˆ¶æ ‡è®°åœ¨ä»£ç é€»è¾‘ä¸­ï¼Œæœ‰æ—¶å€™ä¼šä½¿ç”¨boolç±»å‹ä½œä¸ºé€»è¾‘æ§åˆ¶æ ‡è®°ï¼š``` cvoid checkSecurity(vector&lt;string&gt;&amp; peoples) &#123; bool found = false; for (auto&amp; people : peoples) &#123; if (! found) &#123; if (people == \"Don\")&#123; sendAlert(); found = true; &#125; if (people == \"John\")&#123; sendAlert(); found = true; &#125; &#125; &#125;&#125; ä½¿ç”¨breakå’Œreturnå–ä»£æ§åˆ¶æ ‡è®°ï¼š 12345678910void checkSecurity(vector&lt;string&gt;&amp; peoples) &#123; for (auto&amp; people : peoples) &#123; if (people == \"Don\" || people == \"John\") &#123; sendAlert(); break; &#125; &#125;&#125; æŠ€å·§7 ä»¥å¤šæ€å–ä»£æ¡ä»¶å¼æ¡ä»¶å¼æ ¹æ®å¯¹è±¡ç±»å‹çš„ä¸åŒè€Œé€‰æ‹©ä¸åŒçš„è¡Œä¸ºï¼š 123456789101112double getSpeed() &#123; switch (_type) &#123; case EUROPEAN: return getBaseSpeed(); case AFRICAN: return getBaseSpeed() - getLoadFactor() *_numberOfCoconuts; case NORWEGIAN_BLUE: return (_isNailed) ? 0 : getBaseSpeed(_voltage); &#125; throw new RuntimeException (\"Should be unreachable\");&#125; å°†æ•´ä¸ªæ¡ä»¶å¼çš„æ¯ä¸ªåˆ†æ”¯æ”¾è¿›ä¸€ä¸ªå­ç±»çš„é‡è½½æ–¹æ³•ä¸­ï¼Œç„¶åå°†åŸå§‹å‡½æ•°å£°æ˜ä¸ºæŠ½è±¡æ–¹æ³•ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243class Bird&#123;public: virtual double getSpeed() = 0; protected: double getBaseSpeed();&#125;class EuropeanBird&#123;public: double getSpeed() &#123; return getBaseSpeed(); &#125;&#125;class AfricanBird&#123;public: double getSpeed() &#123; return getBaseSpeed() - getLoadFactor() *_numberOfCoconuts; &#125; private: double getLoadFactor(); double _numberOfCoconuts;&#125;class NorwegianBlueBird&#123;public: double getSpeed() &#123; return (_isNailed) ? 0 : getBaseSpeed(_voltage); &#125;; private: bool _isNailed;&#125; ç®€åŒ–å‡½æ•°è°ƒç”¨æŠ€å·§8 è¯»å†™åˆ†ç¦»æŸä¸ªå‡½æ•°æ—¢è¿”å›å¯¹è±¡çŠ¶æ€å€¼ï¼Œåˆä¿®æ”¹å¯¹è±¡çŠ¶æ€: 1234567891011class Customer&#123;int getTotalOutstandingAndSetReadyForSummaries(int number);&#125;å»ºç«‹ä¸¤ä¸ªä¸åŒçš„å‡½æ•°ï¼Œå…¶ä¸­ä¸€ä¸ªè´Ÿè´£æŸ¥è¯¢ï¼Œå¦ä¸€ä¸ªè´Ÿè´£ä¿®æ”¹:class Customer&#123; int getTotalOutstanding(); void SetReadyForSummaries(int number);&#125; æŠ€å·§9 å‚æ•°åŒ–æ–¹æ³•è‹¥å¹²å‡½æ•°åšäº†ç±»ä¼¼çš„å·¥ä½œï¼Œä½†åœ¨å‡½æ•°æœ¬ä½“ä¸­å´ åŒ…å«äº†ä¸åŒçš„å€¼: 12345678910111213Dollars baseCharge() &#123; double result = Math.min(lastUsage(),100) * 0.03; if (lastUsage() &gt; 100) &#123; result += (Math.min (lastUsage(),200) - 100) * 0.05; &#125; if (lastUsage() &gt; 200) &#123; result += (lastUsage() - 200) * 0.07; &#125; return new Dollars (result);&#125; å»ºç«‹å•ä¸€å‡½æ•°ï¼Œä»¥å‚æ•°è¡¨è¾¾é‚£äº›ä¸åŒçš„å€¼ï¼š 123456789101112131415Dollars baseCharge() &#123; double result = usageInRange(0, 100) * 0.03; result += usageInRange (100,200) * 0.05; result += usageInRange (200, Integer.MAX_VALUE) * 0.07; return new Dollars (result);&#125;int usageInRange(int start, int end) &#123; if (lastUsage() &gt; start) return Math.min(lastUsage(),end) -start; return 0;&#125; æŠ€å·§10 ä»¥æ˜ç¡®å‡½æ•°å–ä»£å‚æ•°å‡½æ•°å®ç°å®Œå…¨å–å†³äºå‚æ•°å€¼è€Œé‡‡å–ä¸åŒååº”ï¼š 123456789101112131415161718void setValue (string name, int value) &#123; if (name == \"height\") _height = value; else if (name == \"width\") _width = value; Assert.shouldNeverReachHere();&#125;é’ˆå¯¹è¯¥å‚æ•°çš„æ¯ä¸€ä¸ªå¯èƒ½å€¼ï¼Œå»ºç«‹ä¸€ä¸ªç‹¬ç«‹å‡½æ•°ï¼švoid setHeight(int arg) &#123; _height = arg;&#125;void setWidth (int arg) &#123; _width = arg;&#125; Referenceï¼š è¯¦è§£åœˆå¤æ‚åº¦","tags":[{"name":"ç¼–è¯‘åŸç†","slug":"ç¼–è¯‘åŸç†","permalink":"http://www.yangjie.hu//tags/ç¼–è¯‘åŸç†/"}]},{"title":"Clang æ’ä»¶è®¡ç®—åœˆå¤æ‚åº¦","date":"2020-03-31T16:02:12.000Z","path":"2020/04/01/clang-Cyclomatic-complexity/","text":"åœˆå¤æ‚åº¦ åœˆå¤æ‚åº¦ï¼ˆCyclomatic complexityï¼Œç®€å†™CCï¼‰ä¹Ÿç§°ä¸ºæ¡ä»¶å¤æ‚åº¦ï¼Œæ˜¯ä¸€ç§ä»£ç å¤æ‚åº¦çš„è¡¡é‡æ ‡å‡†ã€‚ç”±æ‰˜é©¬æ–¯Â·JÂ·éº¦å‡¯å¸ƒï¼ˆThomas J. McCabe, Sr.ï¼‰äº1976å¹´æå‡ºï¼Œç”¨æ¥è¡¨ç¤ºç¨‹åºçš„å¤æ‚åº¦ï¼Œå…¶ç¬¦å·ä¸ºVGæˆ–æ˜¯Mã€‚å®ƒå¯ä»¥ç”¨æ¥è¡¡é‡ä¸€ä¸ªæ¨¡å—åˆ¤å®šç»“æ„çš„å¤æ‚ç¨‹åº¦ï¼Œæ•°é‡ä¸Šè¡¨ç°ä¸ºç‹¬ç«‹ç°è¡Œè·¯å¾„æ¡æ•°ï¼Œä¹Ÿå¯ç†è§£ä¸ºè¦†ç›–æ‰€æœ‰çš„å¯èƒ½æƒ…å†µæœ€å°‘ä½¿ç”¨çš„æµ‹è¯•ç”¨ä¾‹æ•°ã€‚åœˆå¤æ‚åº¦å¤§è¯´æ˜ç¨‹åºä»£ç çš„åˆ¤æ–­é€»è¾‘å¤æ‚ï¼Œå¯èƒ½è´¨é‡ä½ä¸”éš¾äºæµ‹è¯•å’Œ ç»´æŠ¤ã€‚ç¨‹åºçš„å¯èƒ½é”™è¯¯å’Œé«˜çš„åœˆå¤æ‚åº¦æœ‰ç€å¾ˆå¤§å…³ç³»ã€‚ é€šä¿—å¾—è®²åœˆå¤æ‚åº¦å°±æ˜¯ç¡®å®šæŸä¸€æ–¹æ³•åˆ°è¾¾100%çš„è¦†ç›–ç‡å°†éœ€è¦å¤šå°‘æ¡æµ‹è¯•ç”¨ä¾‹ References: McCabe (December 1976). â€œA Complexity Measureâ€.IEEE Transactions on Software Engineering: 308â€“320http://www.literateprogramming.com/mccabe.pdf åœˆå¤æ‚åº¦ç®—æ³•ç‚¹è¾¹è®¡ç®—æ³•è®¡ç®—å…¬å¼ V(G) = e â€“ n + 2 * p eï¼šæ§åˆ¶æµå›¾ä¸­è¾¹çš„æ•°é‡ï¼ˆå¯¹åº”ä»£ç ä¸­é¡ºåºç»“æ„çš„éƒ¨åˆ†ï¼‰nï¼šä»£è¡¨åœ¨æ§åˆ¶æµå›¾ä¸­çš„åˆ¤å®šèŠ‚ç‚¹æ•°é‡ï¼ŒåŒ…æ‹¬èµ·ç‚¹å’Œç»ˆç‚¹ï¼ˆå¯¹åº”ä»£ç ä¸­çš„åˆ†æ”¯è¯­å¥ï¼‰psï¼šæ‰€æœ‰ç»ˆç‚¹åªè®¡ç®—ä¸€æ¬¡ï¼Œå³ä½¿æœ‰å¤šä¸ª return æˆ–è€… throw pï¼šç‹¬ç«‹ç»„ä»¶çš„ä¸ªæ•° èŠ‚ç‚¹è®¡ç®—æ³•åœˆå¤æ‚åº¦å®é™…ä¸Šå°±æ˜¯ç­‰äºåˆ¤å®šèŠ‚ç‚¹çš„æ•°é‡å†åŠ ä¸Š1ï¼Œä¹Ÿå³æ§åˆ¶æµå›¾çš„åŒºåŸŸæ•°ï¼Œå¯¹åº”çš„è®¡ç®—å…¬å¼ä¸ºï¼š V (G) = P + 1 å…¶ä¸­Pä¸ºåˆ¤å®šèŠ‚ç‚¹æ•°ï¼Œåˆ¤å®šèŠ‚ç‚¹ä¸¾ä¾‹ï¼š ifè¯­å¥ whileè¯­å¥ forè¯­å¥ caseè¯­å¥ catchè¯­å¥ andå’Œorå¸ƒå°”æ“ä½œ ?:ä¸‰å…ƒè¿ç®—ç¬¦ å¸¸è§è¯­å¥çš„æ§åˆ¶æµï¼š 1ã€æ‰€æœ‰ç»ˆç‚¹åªè®¡ç®—ä¸€æ¬¡ï¼Œå³ä¾¿æœ‰å¤šä¸ªreturnæˆ–è€…throwï¼›2ã€èŠ‚ç‚¹å¯¹åº”ä»£ç ä¸­çš„åˆ†æ”¯è¯­å¥ ä½¿ç”¨Clangæ’ä»¶ä»£ç å®ç°è‡ªåŠ¨æ£€æµ‹çš„è¯ï¼Œæˆ‘ä»¬ä½¿ç”¨èŠ‚ç‚¹è®¡ç®—æ³• å°ç»“å¦‚é«˜å¤æ‚åº¦çš„ä»£ç æ˜¯å¦å¯ç»´æŠ¤æ€§å·® åœˆå¤æ‚åº¦é«˜çš„æƒ…å†µä¹Ÿå¹¶ä¸æ˜¯éœ€è¦é‡æ„ å¦‚å¤æ‚åº¦ç›¸åŒçš„ä»£ç æ˜¯å¦æ˜¯ä¸€è‡´çš„ åœˆå¤æ‚åº¦ç›¸åŒçš„æƒ…å†µä»£ç å¥åº·çŠ¶å†µä¹Ÿä¸åŒ åœˆå¤æ‚åº¦è¿˜éœ€è¦å…·ä½“æƒ…å†µå…·ä½“åˆ†æï¼Œå…¶åªèƒ½ä½œä¸ºé‡æ„çš„ä¸€ä¸ªåº¦é‡æŒ‡æ ‡ï¼Œä½œä¸ºå†³ç­–çš„ä¸€ä¸ªå‚è€ƒä¾æ®ã€‚ é™ä½åœˆå¤æ‚åº¦ä¸åœ¨æœ¬æ–‡è®¨è®ºèŒƒå›´ï¼Œå¯ä»¥ç‚¹å‡» é™ä½åœˆå¤æ‚åº¦æ–¹æ³• é“¾æ¥æŸ¥çœ‹ Clang æ’ä»¶é€»è¾‘Clangå‘½ä»¤é›† clangåˆ†æAST ä½¿ç”¨å‘½ä»¤ï¼šclang -Xclang -ast-dump -fsyntax-only xxx.m ï¼Œå³å¯åˆ†æxxx.m çš„ AST 1clang -Xclang -ast-dump -fsyntax-only jake.m clang-queryä½œä¸ºclangçš„ä¸€ä¸ªå·¥å…·ï¼Œå¯äº¤äº’å¼æ£€éªŒMatcheræ­£ç¡®æ€§å’Œæœ‰æ•ˆæ€§ï¼Œå¯æ¢ç´¢ASTçš„ç»“æ„å’Œå…³ç³»ã€‚ 1~/clang-llvm/build/bin/clang-query jake.m Clang åœˆå¤æ‚åº¦ç®—æ³•å®ç°æ–‡ä¸­çš„ä¸¤ç§åœˆå¤æ‚åº¦è®¡ç®—æ–¹æ³•ï¼Œç‚¹è¾¹è®¡ç®—å¯¹äººæ›´åŠ ç›´è§‚ï¼Œä¸è¿‡åœ¨ä»£ç ä¸­å®ç°ï¼Œç”¨èŠ‚ç‚¹è®¡ç®—æ³•å¯¹è®¡ç®—æœºè€Œè¨€æ‰æ˜¯æ›´ç›´è§‚çš„æ–¹æ³•ã€‚ 1V (G) = P + 1 åªéœ€è¦ç»Ÿè®¡ä¸€ä¸ªæ¨¡å—ï¼ˆå‡½æ•°ï¼‰ä¸­æ‰€æœ‰På‡ºç°çš„æ¬¡æ•°ï¼Œå…·ä½“åœ¨Clangä¸­å¯ä»¥é‡è½½RecursiveASTVisitor ç±»ï¼ˆæ­¤ç±»ç”¨äºæœç´¢æ•´ä¸ªASTï¼Œå¹¶è®¿é—®æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼‰ï¼Œç„¶åé‡è½½é‡Œé¢çš„è¿™äº›æ–¹æ³• 12345678910bool VisitIfStmt(clang::IfStmt *stmt);bool VisitForStmt(clang::ForStmt *stmt);bool VisitObjCForCollectionStmt(clang::ObjCForCollectionStmt *stmt);bool VisitWhileStmt(clang::WhileStmt *stmt);bool VisitDoStmt(clang::DoStmt *stmt);bool VisitCaseStmt(clang::CaseStmt *stmt);bool VisitObjCAtCatchStmt(clang::ObjCAtCatchStmt *stmt);bool VisitCXXCatchStmt(clang::CXXCatchStmt *stmt);bool VisitConditionalOperator(clang::ConditionalOperator *op);bool VisitBinaryOperator(clang::BinaryOperator *op); åœ¨é‡è½½çš„æ–¹æ³•å†…å¯¹æ­¤æ¨¡å—ä¸­èŠ‚ç‚¹Pçš„æ¬¡æ•°è¿›è¡Œä¸€æ¬¡ç´¯åŠ å¹¶è¿”å›trueï¼Œå¦‚: 1234bool VisitIfStmt(clang::IfStmt *stmt) &#123; _count++; return true;&#125; éå†ä¸€æ¬¡æ¨¡å—è¯­æ³•æ ‘ä¹‹åè·å¾—æ­¤æ¨¡å—çš„åœˆå¤æ‚åº¦å€¼ï¼Œå†åœ¨å¦ä¸€ä¸ªRecursiveASTVisitorç±»ä¸­è¿›è¡Œåˆ¤æ–­ï¼Œä¸€èˆ¬åœˆå¤æ‚åº¦ä¸è¦è¶…è¿‡10ï¼Œä»¥ä¸‹è§„èŒƒæ¥è‡ªç½‘ç»œä»…åšå‚è€ƒ åœˆå¤æ‚åº¦ ä»£ç çŠ¶å†µ å¯æµ‹æ€§ ç»´æŠ¤æˆæœ¬ 1-10 æ¸…æ™°ã€ç»“æ„åŒ– é«˜ ä½ 10-20 å¤æ‚ ä¸­ ä¸­ 20-30 éå¸¸å¤æ‚ ä½ é«˜ 30 ä¸å¯è¯» ä¸å¯æµ‹ éå¸¸é«˜ åœ¨æ¨¡å—ç¼–è¯‘å®Œæˆåï¼Œå°†ä¼šåœ¨æ¨¡å—çš„ç»“å°¾è¿›è¡Œæç¤ºï¼Œç±»ä¼¼å½¢å¼å¦‚ä¸‹ï¼š æ€è€ƒå¦‚ä¸‹æ˜¯ä¸€ä¸ªåœˆå¤æ‚åº¦å¤§äº10çš„ASTè¯­æ³•æ ‘ç¤ºä¾‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071CompoundStmt 0x7ff7f2898788|-CallExpr 0x7ff7f289af60 &apos;void&apos;| |-ImplicitCastExpr 0x7ff7f289af48 &apos;void (*)(id, ...)&apos; &lt;FunctionToPointerDecay&gt;| | `-DeclRefExpr 0x7ff7f289ae60 &apos;void (id, ...)&apos; Function 0x7ff7f2055540 &apos;NSLog&apos; &apos;void (id, ...)&apos;| `-ImplicitCastExpr 0x7ff7f289af88 &apos;id&apos;:&apos;id&apos; &lt;BitCast&gt;| `-ObjCStringLiteral 0x7ff7f289aed0 &apos;NSString *&apos;| `-StringLiteral 0x7ff7f289aeb8 &apos;char [1]&apos; lvalue &quot;&quot;|-DeclStmt 0x7ff7f289b040| `-VarDecl 0x7ff7f289afb8 used num &apos;int&apos; cinit| `-IntegerLiteral 0x7ff7f289b020 &apos;int&apos; 0|-IfStmt 0x7ff7f289b238 has_else| |-BinaryOperator 0x7ff7f289b0c8 &apos;int&apos; &apos;==&apos;| | |-ImplicitCastExpr 0x7ff7f289b0b0 &apos;int&apos; &lt;LValueToRValue&gt;| | | `-DeclRefExpr 0x7ff7f289b058 &apos;int&apos; lvalue Var 0x7ff7f289afb8 &apos;num&apos; &apos;int&apos;| | `-IntegerLiteral 0x7ff7f289b090 &apos;int&apos; 0| |-CompoundStmt 0x7ff7f289b1d8| | `-IfStmt 0x7ff7f289b1c0| | |-BinaryOperator 0x7ff7f289b158 &apos;int&apos; &apos;==&apos;| | | |-ImplicitCastExpr 0x7ff7f289b140 &apos;int&apos; &lt;LValueToRValue&gt;| | | | `-DeclRefExpr 0x7ff7f289b0e8 &apos;int&apos; lvalue Var 0x7ff7f289afb8 &apos;num&apos; &apos;int&apos;| | | `-UnaryOperator 0x7ff7f289b128 &apos;int&apos; prefix &apos;-&apos;| | | `-IntegerLiteral 0x7ff7f289b108 &apos;int&apos; 1| | `-CompoundStmt 0x7ff7f289b1a8| | `-ReturnStmt 0x7ff7f289b198| | `-IntegerLiteral 0x7ff7f289b178 &apos;int&apos; 0| `-CompoundStmt 0x7ff7f289b220| `-ReturnStmt 0x7ff7f289b210| `-IntegerLiteral 0x7ff7f289b1f0 &apos;int&apos; 0|-DeclStmt 0x7ff7f289b300| `-VarDecl 0x7ff7f289b278 used index &apos;int&apos; cinit| `-IntegerLiteral 0x7ff7f289b2e0 &apos;int&apos; 0|-SwitchStmt 0x7ff7f289b368| |-ImplicitCastExpr 0x7ff7f289b350 &apos;int&apos; &lt;LValueToRValue&gt;| | `-DeclRefExpr 0x7ff7f289b318 &apos;int&apos; lvalue Var 0x7ff7f289b278 &apos;index&apos; &apos;int&apos;| `-CompoundStmt 0x7ff7f2898700| |-CaseStmt 0x7ff7f289b3c0| | |-ConstantExpr 0x7ff7f289b3a8 &apos;int&apos;| | | `-IntegerLiteral 0x7ff7f289b388 &apos;int&apos; 1| | `-BreakStmt 0x7ff7f289b3e8| |-CaseStmt 0x7ff7f2898438| | |-ConstantExpr 0x7ff7f2898420 &apos;int&apos;| | | `-IntegerLiteral 0x7ff7f2898400 &apos;int&apos; 2| | `-BreakStmt 0x7ff7f2898460| |-CaseStmt 0x7ff7f28984a0| | |-ConstantExpr 0x7ff7f2898488 &apos;int&apos;| | | `-IntegerLiteral 0x7ff7f2898468 &apos;int&apos; 3| | `-BreakStmt 0x7ff7f28984c8| |-CaseStmt 0x7ff7f2898508| | |-ConstantExpr 0x7ff7f28984f0 &apos;int&apos;| | | `-IntegerLiteral 0x7ff7f28984d0 &apos;int&apos; 4| | `-BreakStmt 0x7ff7f2898530| |-CaseStmt 0x7ff7f2898570| | |-ConstantExpr 0x7ff7f2898558 &apos;int&apos;| | | `-IntegerLiteral 0x7ff7f2898538 &apos;int&apos; 5| | `-BreakStmt 0x7ff7f2898598| |-CaseStmt 0x7ff7f28985d8| | |-ConstantExpr 0x7ff7f28985c0 &apos;int&apos;| | | `-IntegerLiteral 0x7ff7f28985a0 &apos;int&apos; 6| | `-BreakStmt 0x7ff7f2898600| |-CaseStmt 0x7ff7f2898640| | |-ConstantExpr 0x7ff7f2898628 &apos;int&apos;| | | `-IntegerLiteral 0x7ff7f2898608 &apos;int&apos; 7| | `-BreakStmt 0x7ff7f2898668| |-CaseStmt 0x7ff7f28986a8| | |-ConstantExpr 0x7ff7f2898690 &apos;int&apos;| | | `-IntegerLiteral 0x7ff7f2898670 &apos;int&apos; 8| | `-BreakStmt 0x7ff7f28986d0| `-DefaultStmt 0x7ff7f28986e0| `-BreakStmt 0x7ff7f28986d8`-ReturnStmt 0x7ff7f2898778 `-IntegerLiteral 0x7ff7f2898758 &apos;int&apos; 0 å…¶æºç ä¸ºï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142- (int)func &#123; NSLog(@\"\"); int num = 0; if (num == 0) &#123; if (num == -1) &#123; return 0; &#125; &#125; else &#123; return 0; &#125; int index = 0; switch (index) &#123; case 1: break; case 2: break; case 3: break; case 4: break; case 5: break; case 6: break; case 7: break; case 8: break; default: break; &#125; return 0;&#125; é«˜å¤æ‚åº¦çš„ä»£ç æ˜¯å¦å¯ç»´æŠ¤æ€§å·® Reference Clang å®˜æ–¹æ–‡æ¡£ è¯¦è§£åœˆå¤æ‚åº¦ ç¾å›¢-ä»£ç è´¨é‡ç®¡æ§ â€“ å¤æ‚åº¦æ£€æµ‹ OCLint Docs https://blog.csdn.net/vincentiss/article/details/54617915 åŸºäºclangæ’ä»¶çš„ä¸€ç§iOSåŒ…å¤§å°ç˜¦èº«æ–¹æ¡ˆ LLVM å®˜æ–¹ ExternalClangExamples ASTMatcheråˆ†æå‡½æ•°è°ƒç”¨é“¾","tags":[{"name":"ç¼–è¯‘åŸç†","slug":"ç¼–è¯‘åŸç†","permalink":"http://www.yangjie.hu//tags/ç¼–è¯‘åŸç†/"}]},{"title":"Clang æºç å¼€å‘ç¯å¢ƒçš„æ­å»º","date":"2020-03-31T15:57:39.000Z","path":"2020/03/31/clang-build/","text":"è·Ÿéš æ•™ç¨‹ æ­å»º ä½¿ç”¨ä¸‹é¢å‘½ä»¤ä¸‹è½½æºç æ­å»ºç¯å¢ƒï¼š 1234git clone -b release_90 git@github.com:llvm-mirror/llvm.git llvmgit clone -b release_90 git@github.com:llvm-mirror/clang.git llvm/tools/clanggit clone -b release_90 git@github.com:llvm-mirror/clang-tools-extra.git llvm/tools/clang/tools/extragit clone -b release_90 git@github.com:llvm-mirror/compiler-rt.git llvm/projects/compiler-rt ä¸‹è½½å®Œæˆä¹‹åï¼Œè¿›è¡Œç¼–è¯‘ï¼ˆéœ€è¦å°†è¿‘1å°æ—¶æ—¶é—´ï¼‰ç¼–è¯‘å®Œæˆä¹‹åç£ç›˜ç©ºé—´å ç”¨å¤§æ¦‚ 37G åˆ›å»ºæ’ä»¶## è¯¦ç»†åˆ›å»ºæµç¨‹å‚è€ƒ LLVM &amp; Clang å…¥é—¨ é‡Œé¢è®²å¾—éå¸¸è¯¦ç»†ï¼Œä¸å†è¿›è¡Œcopyèµ˜è¿°ã€‚ å¦‚æœå‡ºç°é”™è¯¯ï¼š 1Unknown CMake command &quot;add_llvm_loadable_module&quot;. ä½¿ç”¨ add_llvm_library ä»£æ›¿ add_llvm_loadable_module çš„ä½¿ç”¨ ä¾‹å¦‚ä¸€ä¸ªCMakeLists.txtæ–‡ä»¶çš„å†…å®¹ä¸ºï¼š 12345678910add_llvm_library(xxPlugin MODULE xxPlugin.cpp PLUGIN_TOOL clang)if(LLVM_ENABLE_PLUGINS AND (WIN32 OR CYGWIN)) target_link_libraries(xxPlugin PRIVATE clangAST clangBasic clangFrontend LLVMSupport )endif() å…³äºadd_llvm_loadable_module ä¿®æ”¹æ–‡æ¡£ è¿”å›åˆ°llvm_buildç›®å½•ï¼Œä¹Ÿå°±æ˜¯LLVMå·¥ç¨‹çš„ç›®å½•ï¼Œä½¿ç”¨ CMake è¿›è¡Œå†æ¬¡æ„å»º 1cmake -G Xcode ../llvm -DCMAKE_BUILD_TYPE:STRING=MinSizeRel åœ¨Productsç›®å½•ä¸‹å°±èƒ½çœ‹åˆ°dylibåŠ¨æ€åº“æ–‡ä»¶ é›†æˆåˆ° Xcode å·¥ç¨‹ åœ¨å·¥ç¨‹çš„ build settingsä¸­æœç´¢ Other C Flags æ·»åŠ å¦‚ä¸‹å‚æ•° 1-Xclang -load -Xclang (.dylib)åŠ¨æ€åº“è·¯å¾„ -Xclang -add-plugin -Xclang æ’ä»¶åå­—ï¼ˆnamespace çš„åå­—ï¼Œåå­—ä¸å¯¹åˆ™æ— æ³•ä½¿ç”¨æ’ä»¶ï¼‰ ä¾‹å¦‚ï¼š 1-Xclang -load -Xclang $&#123;PROJECT_DIR&#125;/cctest/CCDetector.dylib -Xclang -add-plugin -Xclang CCDetector åœ¨Build Settingsæ ç›®ä¸­æ–°å¢ä¸¤é¡¹ç”¨æˆ·å®šä¹‰çš„è®¾ç½® åˆ†åˆ«æ˜¯CCå’ŒCXXã€‚ CCå¯¹åº”çš„æ˜¯è‡ªå·±ç¼–è¯‘çš„clangçš„ç»å¯¹è·¯å¾„ï¼ŒCXXå¯¹åº”çš„æ˜¯è‡ªå·±ç¼–è¯‘çš„clang++çš„ç»å¯¹è·¯å¾„ã€‚ åœ¨Build Settingsæ ç›®ä¸­æœç´¢indexï¼Œå°†Enable Index-Wihle-Building Functionalityçš„Defaultæ”¹ä¸ºNOã€‚ å‚è€ƒLLVM &amp; Clang å…¥é—¨ Clang ä¹‹æ—…â€“ä½¿ç”¨ Xcode å¼€å‘ Clang æ’ä»¶","tags":[{"name":"ç¼–è¯‘åŸç†","slug":"ç¼–è¯‘åŸç†","permalink":"http://www.yangjie.hu//tags/ç¼–è¯‘åŸç†/"}]},{"title":"Shell è„šæœ¬æ›´æ–°å…¬ç½‘ IP åˆ° Dynu DDNS æœåŠ¡","date":"2019-07-17T02:19:44.000Z","path":"2019/07/17/manual-update-ip-for-dynu-ddns/","text":"dynuæ›´æ–°ipçš„æœåŠ¡å°½ç„¶è¢«Qäº†, ä½¿ç”¨ä»£ç†è¿›è¡Œæ›´æ–°ipï¼Œä½†æ›´æ–°çš„æ˜¯ä»£ç†æœåŠ¡å™¨çš„ipåœ°å€ã€‚ åŸºäºä»¥ä¸Šçš„çŸ›ç›¾ç‚¹ï¼Œæˆ‘æƒ³åˆ°çš„è§£å†³æ€è·¯æ˜¯ï¼š ä¸ä½¿ç”¨ä»£ç†è·å–çœŸå®çš„å…¬ç½‘IPå¹¶ä¿å­˜åˆ°å˜é‡ è®¾ç½®ä»£ç† å°†çœŸå®IPå˜é‡æ‰‹åŠ¨æ›´æ–°åˆ°dynuæœåŠ¡ å®šæ—¶æ‰§è¡Œæ­¤è„šæœ¬ å‰3æ­¥å…·ä½“å®ç°å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738#!/bin/bashecho $SHELL#éªŒè¯æ‹¿åˆ°çš„çœŸå®IPæ˜¯å¦åˆæ³•function isValideIP() &#123; regex=\"\\b(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[1-9])\\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[1-9])\\b\" ckStep2=`echo $1 | egrep $regex | wc -l` if [ $ckStep2 -eq 0 ] then echo 0 else echo 1 fi&#125;#ç”¨äºè·å–çœŸå®IPçš„æœåŠ¡ï¼Œç”±äºæ˜¯äº›ä¸‰æ–¹çš„æœåŠ¡ï¼Œæ·»åŠ å¤šä¸ªé¿å…å…¶ä¸­æŸä¸ªå¤±æ•ˆpaths=(\"whatismyip.akamai.com\" \"ifconfig.me\" \"icanhazip.com\" \"ident.me\" \"ipecho.net/plain\" \"myip.dnsomatic.com\")count=$&#123;#paths[*]&#125; index=0while [ $index -lt $count ];do unset all_proxy ip=`curl --connect-timeout 5 -m 5 $&#123;paths[$index]&#125;` echo \"using $&#123;paths[$index]&#125;\" res=$(isValideIP $ip) if [ $res -eq 1 ]; then echo \"ipaddr: $ip\" time=$(date \"+%Y-%m-%d %H:%M:%S\") echo $time export all_proxy=socks5://127.0.0.1:1086 echo `curl \"https://api.dynu.com/nice/update?username=yourusername&amp;password=yourpwd&amp;hostname=your_domain&amp;myip=$ip\"` let index=count else echo \"fail\" let index+=1 fidone æ³¨æ„æ‰§è¡Œ shell è„šæœ¬ç”¨çš„ zsh è¿˜æ˜¯ bashï¼Œå› ä¸ºè¦æ¶‰åŠåˆ°è®¾ç½®åˆ°ä»£ç†å’Œå–æ¶ˆä»£ç†ã€‚ ç¬¬4æ­¥å¯ä»¥ä½¿ç”¨ cron å‘½ä»¤æˆ–è€…æ˜¯ mac çš„ launchctl æ¥åˆ›å»ºå®šæ—¶æ“ä½œä»»åŠ¡ï¼Œä¸åœ¨æœ¬æ–‡ä¸­ä»‹ç»ã€‚ Macä¸­ä½¿ç”¨ launchctl çš„æµç¨‹å¯ä»¥æŸ¥çœ‹ Mac åˆ›å»ºå®šæ—¶ä»»åŠ¡","tags":[{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","permalink":"http://www.yangjie.hu//tags/ç½‘ç»œ/"}]},{"title":"Mac åˆ›å»ºå®šæ—¶ä»»åŠ¡(Launchctl)","date":"2019-07-16T01:22:04.000Z","path":"2019/07/16/launchctl-in-mac/","text":"ç›®å½•ä»‹ç» ~/Library/LaunchAgents ç”±ç”¨æˆ·è‡ªå·±å®šä¹‰çš„ä»»åŠ¡é¡¹ /Library/LaunchAgents ç”±ç®¡ç†å‘˜ä¸ºç”¨æˆ·å®šä¹‰çš„ä»»åŠ¡é¡¹ /Library/LaunchDaemons ç”±ç®¡ç†å‘˜å®šä¹‰çš„å®ˆæŠ¤è¿›ç¨‹ä»»åŠ¡é¡¹ /System/Library/LaunchAgents ç”±Mac OS Xä¸ºç”¨æˆ·å®šä¹‰çš„ä»»åŠ¡é¡¹è¯´æ˜:Agentsæ–‡ä»¶å¤¹ä¸‹çš„plistæ˜¯éœ€è¦ç”¨æˆ·ç™»å½•åï¼Œæ‰ä¼šåŠ è½½çš„ï¼Œè€ŒDaemonsæ–‡ä»¶å¤¹ä¸‹å¾—plistæ˜¯åªè¦å¼€æœºï¼Œå¯ä»¥ä¸ç”¨ç™»å½•å°±ä¼šè¢«åŠ è½½ ä»»åŠ¡æ“ä½œä¿®æ”¹plistæ–‡ä»¶ä¹‹åéœ€è¦é‡æ–°åŠ è½½plistæ–‡ä»¶ï¼Œå†è¿›è¡Œå¯åŠ¨ä»»åŠ¡ã€‚ 123456789101112#åŠ è½½plistä»»åŠ¡launchctl load /Library/LaunchDaemons/ioser.store.update.ip.plist---launchctl load -w **.pist #è®¾ç½®å¼€æœºå¯åŠ¨å¹¶ç«‹å³å¯åŠ¨æ”¹æœåŠ¡launchctl load **.pist #è®¾ç½®å¼€æœºå¯åŠ¨ä½†ä¸ç«‹å³å¯åŠ¨æœåŠ¡ #å¯åŠ¨plistä»»åŠ¡launchctl start ioser.store.update.ip#å¸è½½plistä»»åŠ¡launchctl unload /Library/LaunchDaemons/ioser.store.update.ip.plist Referenceç¾é¤æé†’","tags":[{"name":"æŠ€æœ¯æ‚è°ˆ","slug":"æŠ€æœ¯æ‚è°ˆ","permalink":"http://www.yangjie.hu//tags/æŠ€æœ¯æ‚è°ˆ/"}]},{"title":"å¤–ç½‘è®¿é—®å±€åŸŸç½‘Jenkins","date":"2019-06-26T13:14:19.000Z","path":"2019/06/26/build-jenkins-for-internet/","text":"åˆšåœ¨å®¶é‡Œçš„æœºå™¨æ­å»ºäº†Jenkins ï¼Œæƒ³è¦åœ¨å¤–é¢ä½¿ç”¨çš„æ—¶å€™éœ€è¦å€ŸåŠ©è¿œç¨‹æ¡Œé¢ (æˆ‘ä½¿ç”¨TeamViewer) è½¯ä»¶ç™»å½•åˆ°æœºå™¨ï¼Œæ‰èƒ½è¿›è¡Œæ“ä½œã€‚è™½ç„¶éº»çƒ¦ç‚¹ä½†ä¹Ÿè¿˜æ˜¯èƒ½å¤Ÿè¿›è¡Œæ“ä½œã€‚ ç›´åˆ°æœ‰ä¸€æ¬¡ï¼Œéœ€è¦ç”¨åˆ°Jenkinsçš„æ—¶å€™ï¼Œä½¿ç”¨ TeamViewer è¿›è¡Œç™»å½•å®¶é‡Œä¸»æœºçš„æ—¶å€™ç«Ÿç„¶å¡ä¸»äº†ï¼Œæ²¡æ³•ç™»å½•è¿›å…¥è¿œç¨‹ä¸»æœºã€‚ PS TeamViewer å…è´¹ä¹Ÿè¿˜ç®—ç¨³å®šï¼Œä½†æ˜¯ä¹Ÿæ€»æœ‰å‡ºbugçš„æ—¶å€™ã€‚ æˆ‘éœ€è¦æ›´åŠ ç¨³å®šçš„æœåŠ¡â€¦ ä¹‹å‰å¬æœ‹å‹è¯´è‡ªå·±æ­å»ºäº†ä¸€ä¸ª DDNS é€šè¿‡åŸŸåè®¿é—®å±€åŸŸç½‘ç”µè„‘ï¼Œ å¯ä»¥è¿›è¡Œ ssh ç™»å½•ã€‚ å¾ˆé…·æ–¹ä¾¿ï¼ŒåŠ¨æ€DNSè§£æåŠ ä¸Šç«¯å£è½¬å‘å°±å¯ä»¥å®ç°å•¦ã€‚ é‚£æˆ‘å°±å¯ä»¥è€ƒè™‘ç›´æ¥è®¿é—®å®¶é‡Œæœºå™¨çš„ Jenkins åœ°å€äº†ã€‚æ€è·¯å¾ˆç®€å• æœ¬æ–‡é‡ç‚¹ã€è¦è€ƒã€‘ï¼š æ‰¾ä¸ªåŸŸåæœåŠ¡å•†æä¸ªåŠ¨æ€åŸŸåè§£ææœåŠ¡ï¼Œè§£æåˆ° Jenkins æœºå™¨IP åœ¨è·¯ç”±å™¨å°† Jenkins ç«¯å£è¿›è¡Œè½¬å‘ è®¿é—®åŸŸå+ç«¯å£å°±å¯ä»¥è®¿é—® Jenkinsäº†ï¼ æ²¡æƒ³åˆ°å…·ä½“å®ç°èµ·æ¥çœŸçš„æ˜¯ï¼Œæ¢ç´¢æ–°å¤§é™†ä¸€æ ·â€¦ é‡åˆ°æ–°å¥‡çš„äº‹ä¸€ä»¶åŠ ä¸€ä»¶ï¼Œè®°å½•ä¸‹ã€‚ DDNSæœåŠ¡å•†æˆ‘æ‰¾å‡ ä¸ªæœåŠ¡ï¼Œæœ€åç¡®è®¤äº†è¿™å‡ ä¸ªï¼š namecheap (è¿™ä¸ªæ˜¯æœ‹å‹æ¨èçš„) no-ip dynu ä»¥ä¸Š3ä¸ªéƒ½å¯ä»¥æä¾›å…è´¹çš„DDNSæœåŠ¡ã€‚ no-ipæˆ‘ç°åœ¨æˆåŠŸåœ¨ä½¿ç”¨çš„æ˜¯ no-ip ï¼Œè§£æå¾ˆå¿«, ä½¿ç”¨no-ipæä¾›çš„ä¸‰çº§åŸŸå xxx.ddns.net è¿›è¡Œè§£æã€‚ç¼ºç‚¹æ˜¯éœ€è¦ä¸€ä¸ªæœˆæ—¶é—´æ¿€æ´»ä¸€æ¬¡ï¼Œ ä¸èƒ½ç»‘å®šè‡ªå·±çš„åŸŸåã€‚ æœåŠ¡ä¸éœ€è¦ç§‘å­¦ä¸Šç½‘ä¹Ÿå¯ä»¥æ­£å¸¸æ›´æ–°è§£æçš„ipã€‚ namecheapè²Œä¼¼åªæœ‰è‡ªå®šä¹‰åŸŸåï¼ˆ not sure ï¼‰ï¼Œåœ¨åŸŸåæä¾›å•†è®¾ç½®è‡ªå®šä¹‰DNSåï¼Œç­‰äº†ä¸¤å¤©ï¼Œå§‹ç»ˆæ²¡æ³•è§£ææˆåŠŸã€‚ dynuå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰åŸŸåï¼Œé¡µé¢è¿˜æœ‰ä¸­æ–‡æ”¯æŒã€‚ä½†æ˜¯ç¬¬ä¸€æ¬¡æ›´æ–°ipæˆåŠŸä¹‹åï¼Œå¾ˆå¿«å†æ¬¡æ›´æ–°æ—¶å°±å¤±è´¥äº†ï¼Œæ€»æç¤ºè¶…æ—¶ã€‚ åŸå› ï¼š dynuæ›´æ–°ipçš„æœåŠ¡å°½ç„¶è¢«Qäº†ã€‚ å› ä¸ºæ˜¯å›½å¤–çš„æœåŠ¡æˆ‘å°è¯•ä½¿ç”¨ä»£ç†è¿›è¡Œæ›´æ–°ipï¼Œç»“æœæ›´æ–°æ˜¯æˆåŠŸäº†åªæ˜¯æ›´æ–°æˆäº†æˆ‘ä»£ç†æœåŠ¡å™¨çš„ipåœ°å€ã€‚ç°åœ¨è¿˜æ²¡è§£.. è§£å·²ç»å‡ºæ¥äº†ï¼šè§Shell è„šæœ¬æ›´æ–°å…¬ç½‘ IP åˆ° dynu DDNS æœåŠ¡ æˆ‘ç°åœ¨åœ¨macç«¯ä¸Šä½¿ç”¨çš„å®¢æˆ·ç«¯ä¸º dDns Broker æ”¯æŒå¤§éƒ¨åˆ†æœåŠ¡å•† ç«¯å£è½¬å‘éƒ½çŸ¥é“å›½å†…å»ºç«™åŸŸåæ˜¯è¦è¿›è¡Œå¤‡æ¡ˆçš„å§ï¼Œæ—¢ç„¶æœ‰è¿™æ ·çš„è¦æ±‚å°±å¿…å®šè·Ÿéšç€é™åˆ¶ã€‚443, 8080, 80, 22 ç­‰å¸¸ç”¨ç«¯å£éƒ½æ˜¯é»˜è®¤è¢«ç¦ç”¨çš„ã€‚ è¿™é‡Œæ³¨æ„ä¸€ä¸ªsmbæœåŠ¡çš„ç«¯å£ï¼Œå±€åŸŸç½‘è®¿é—®å’Œå¤–ç½‘è®¿é—®çš„ç«¯å£å¹¶ä¸æ˜¯åŒä¸€ä¸ªã€‚ ç«¯å£ æ„ä¹‰ 139 Microsoft SMB åŸŸæœåŠ¡å™¨ netbios-ssn å±€åŸŸç½‘ç«¯å£ 445 Microsoft SMB åŸŸæœåŠ¡å™¨ microsoft-ds å¹¿åŸŸç½‘ç«¯å£ æˆ‘æ­å»ºæˆåŠŸçš„æ—¶å€™ï¼ŒJenkins å½“æ—¶çš„ç«¯å£æ˜¯8080, è½¬å‘8080ç«¯å£å®Œæˆå1ä¸ªå°æ—¶å·¦å³æ—¶é—´å†…æ˜¯å¯ä»¥æ­£å¸¸è®¿é—®çš„ï¼Œä¹‹åå°±ä¸è¡Œäº†ã€‚ ç°å­˜é—®é¢˜ï¼šæˆ‘ä½¿ç”¨äº†åŸŸå æ˜¾æ€§è½¬å€ å®Œæˆäº†è‡ªå®šä¹‰åŸŸåè®¿é—®ï¼Œåªæ˜¯è®¿é—®åå˜å›äº†no-ipçš„åŸŸåã€‚ ä½¿ç”¨éšæ€§è½¬å€ï¼Œä¼šé€ æˆæ— æ³•è§£æçš„é—®é¢˜ã€‚ æˆæœå®Œæˆäº†å¯¹å®¶é‡Œæœºå™¨ Jenkins çš„è®¿é—®ï¼Œ è¿œç¨‹æ§åˆ¶ï¼ˆ Mac åº”ç”¨ Screen Shareing ï¼‰è®¿é—®ï¼Œsshç™»å½• ç­‰ ReferenceApple è½¯ä»¶äº§å“ä½¿ç”¨çš„ TCP å’Œ UDP ç«¯å£","tags":[{"name":"æŠ€æœ¯æ‚è°ˆ","slug":"æŠ€æœ¯æ‚è°ˆ","permalink":"http://www.yangjie.hu//tags/æŠ€æœ¯æ‚è°ˆ/"}]},{"title":"Git ä»“åº“æ–‡ä»¶è¿‡å¤§æ— æ³•ä¸Šä¼ ","date":"2019-04-15T11:33:58.000Z","path":"2019/04/15/git-lfs/","text":"Gitä»“åº“é»˜è®¤æ˜¯æœ‰100Mæ–‡ä»¶å¤§å°çš„é™åˆ¶ï¼Œæ¯”å¦‚æˆ‘è¿™ä¸ªé¡¹ç›®ä¸­çš„Python.frameworkæ–‡ä»¶å¤§å°è¶…è¿‡äº†100M,å°±ä¸èƒ½ä¸Šä¼ åˆ°GitHubäº†ï¼ˆè¿™ä¸ªé™åˆ¶å…¶å®å¯ä»¥å–æ¶ˆï¼‰ã€‚ 1234remote: error: GH001: Large files detected. You may want to try Git Large File Storage - https://git-lfs.github.com.remote: error: Trace: 44bd870a4d27f7109aee59495836e701remote: error: See http://git.io/iEPt8g for more information.remote: error: File ThirdLibs/Python/Python.framework/Versions/3.4/Python is 132.98 MB; this exceeds GitHub's file size limit of 100.00 MB ä½†æ›´ä¸¥é‡çš„äº‹æ˜¯ è®¾è®¡å›¾ï¼Œè§†é¢‘ç­‰å¤§æ–‡ä»¶åœ¨é¡¹ç›®ä¸­å­˜åœ¨å¤šäº†ï¼Œé¡¹ç›®ä¼šå˜å¾—ååˆ†è‡ƒè‚¿ï¼Œå¯¹æ—¥å¸¸å¼€å‘çš„åˆ†æ”¯åˆ‡æ¢ï¼Œæ–‡ä»¶æ›¿æ¢é€ æˆäº†å¾ˆå¤šè´Ÿæ‹…ã€‚å¦‚ä½•è§£å†³ï¼Ÿè§ä¸Šæ–¹ä»£ç å—ä¸­Gitçš„é”™è¯¯æç¤ºï¼Œç»™äº†è§£å†³æ–¹æ¡ˆ: LFS è§£å†³æ–¹æ¡ˆåœ¨ https://git-lfs.github.com ä½¿ç”¨ Large File Storage Git LFSï¼ˆLarge File Storage, å¤§æ–‡ä»¶å­˜å‚¨ï¼‰æ˜¯å¯ä»¥æŠŠéŸ³ä¹ã€å›¾ç‰‡ã€è§†é¢‘ç­‰æŒ‡å®šçš„ä»»æ„æ–‡ä»¶å­˜åœ¨ Git ä»“åº“ä¹‹å¤–ï¼Œè€Œåœ¨ Git ä»“åº“ä¸­ç”¨ä¸€ä¸ªå ç”¨ç©ºé—´ 1KB ä¸åˆ°çš„æ–‡æœ¬æŒ‡é’ˆæ¥ä»£æ›¿çš„å°å·¥å…·ã€‚é€šè¿‡æŠŠå¤§æ–‡ä»¶å­˜å‚¨åœ¨ Git ä»“åº“ä¹‹å¤–ï¼Œå¯ä»¥å‡å° Git ä»“åº“æœ¬èº«çš„ä½“ç§¯ï¼Œä½¿å…‹éš† Git ä»“åº“çš„é€Ÿåº¦åŠ å¿«ï¼Œä¹Ÿä½¿å¾— Git ä¸ä¼šå› ä¸ºä»“åº“ä¸­å……æ»¡å¤§æ–‡ä»¶è€ŒæŸå¤±æ€§èƒ½ã€‚ ä½¿ç”¨æ–¹æ³•ä½¿ç”¨ git lfs track è¿½è¸ªéœ€è¦ä½¿ç”¨ Git LFS ç®¡ç†çš„æ–‡ä»¶ã€‚å¦‚ï¼š 1git lfs track \"*.psd\" ä¹Ÿå¯ä»¥æ‰‹åŠ¨ç¼–è¾‘ Git ä»“åº“æ ¹ç›®å½•ä¸‹çš„ .gitattributes æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š 1*.psd filter=lfs diff=lfs merge=lfs -text ä¿®æ”¹å®Œæˆ .gitattributes æ–‡ä»¶ä¹‹åå°†å…¶æ·»åŠ åˆ°Gitç®¡ç†ä¸­ã€‚ æ¥ä¸‹æ¥çš„æ­¥éª¤ æˆ‘è¸©äº†å¾ˆä¹…çš„å‘ï¼ï¼â˜¹ï¸ çœ‹äº†å¾ˆå¤šçš„ä½¿ç”¨æ•™ç¨‹éƒ½æ˜¯è¯´æ­¤æ—¶å†å°†å·²ç»æ·»åŠ åˆ°Gitä¸­ï¼Œè¿›è¡ŒPushæ“ä½œå°±å¯ä»¥å®ŒæˆLFSçš„å·¥ä½œï¼Œå¤§æ–‡ä»¶å°±å¯ä»¥ä¸Šä¼ äº†ã€‚ è€Œæˆ‘ä½¿ç”¨çš„å®é™…æƒ…å†µå´ä¸æ˜¯è¿™æ ·ï¼Œæ€ä¹ˆä¸Šä¼ éƒ½è¿˜æ˜¯å‡ºç°äº†ä¸æ–‡ç« å¼€å¤´ä¸€æ ·çš„æç¤ºã€‚ ç»è¿‡æˆ‘çš„å°è¯•ï¼Œå‘ç°å¿…é¡»è¦éµå¾ªä»¥ä¸‹çš„æ“ä½œæµç¨‹æ‰å¯ä»¥æ­£å¸¸åœ°ä½¿ç”¨LFSï¼š å‡†å¤‡çŠ¶æ€: å¤§æ–‡ä»¶å°šæœªæ·»åŠ åˆ°ä»“åº“ä¸­ æ·»åŠ  .gitattributes æ–‡ä»¶ç¼–å†™å†…å®¹ æ·»åŠ  .gitattributes æ–‡ä»¶åˆ°Gitä»“åº“ç®¡ç† æ¨é€æœ¬åœ°ä»“åº“åˆ°è¿œç¨‹åœ°å€ æ·»åŠ å¤§æ–‡ä»¶åˆ°ä»“åº“ä¸­ commitæ·»åŠ æ“ä½œï¼Œ Pushåˆ°è¿œç¨‹ä»“åº“ PS : å…³äºcloneå¸¦LFSæ–‡ä»¶çš„ä»“åº“ç›®å‰æœ€æ–°ç‰ˆæœ¬çš„ git clone å·²ç»èƒ½å¤Ÿæä¾›ä¸ git lfs clone ä¸€è‡´çš„æ€§èƒ½ï¼Œå› æ­¤è‡ª Git LFS 2.3.0 ç‰ˆæœ¬èµ·ï¼Œgit lfs clone å·²ä¸å†æ¨èä½¿ç”¨ã€‚ åœ¨æˆ‘çœŸå®ä½¿ç”¨çš„æ—¶å€™ï¼Œæˆ‘éœ€è¦åœ¨ä»“åº“ä¸­åˆå§‹åŒ– lfs ä¹‹åå† ä½¿ç”¨ git lfs clone æˆ–è€…æ˜¯ git lfs pull æ‰èƒ½æ­£ç¡®æ‹‰ä¸‹ä»£ç ã€‚ ä¸€äº›è¿›é˜¶çš„ä½¿ç”¨ä¾‹å¦‚ï¼š åªè·å–ä»“åº“æœ¬èº«ï¼Œä¸è·å–LFSå¯¹è±¡ ä»…è·å–æŒ‡å®šç›®å½•ä¸‹çš„LFSå¯¹è±¡â€¦ ç‚¹å‡» Reference ä¸­çš„è¿æ¥æŸ¥çœ‹ ReferenceGit LFS æ“ä½œæŒ‡å—","tags":[{"name":"æŠ€æœ¯æ‚è°ˆ","slug":"æŠ€æœ¯æ‚è°ˆ","permalink":"http://www.yangjie.hu//tags/æŠ€æœ¯æ‚è°ˆ/"}]},{"title":"ä¸å¸¸ç”¨ä½†å®ç”¨çš„Gitæ“ä½œ","date":"2019-04-15T07:55:11.000Z","path":"2019/04/15/Not-common-but-useful-git-command/","text":"â€œä¸å¸¸ç”¨åªæ˜¯å¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œä¸å–œå‹¿å–·~â€é‚£ä¹ˆæˆ‘å…ˆåˆ—ä¸€ä¸‹è¦è®²åˆ°çš„gitå‘½ä»¤å§ 1234git rebasegit rebase --ontogit reset --softgit pick Git rebaseä¸­æ–‡å« â€œå˜åŸºâ€ï¼ˆä»sourcetreeä¸Šçš„ç¿»è¯‘å¾—æ¥ï¼‰ï¼Œå•ä»åå­—ç†è§£èµ·æ¥ä¹ŸæŒºå½¢è±¡çš„ï¼Œå°±æ˜¯å°†å½“å‰çš„åŸºç¡€ç»™ä¿®æ”¹æ‰ï¼Œç§»èŠ±æ¥æœ¨ä¹‹ç±»çš„æ„æ€å§ğŸ˜‚ rebase å®ç°çš„æœ€ç»ˆæ•ˆæœæ˜¯è·Ÿ merge ç›¸åŒâ€”â€”â€”â€”å°†ä¸¤ä¸ªåˆ†æ”¯çš„ä¿®æ”¹åˆå¹¶ã€‚ä½†ç•¥æœ‰ä¸åŒï¼Œæ¯”å¦‚åœ¨æ–°çš„åˆ†æ”¯ä¸­åšäº† C5 C6 çš„ä¸¤æ¬¡ä¿®æ”¹æäº¤ï¼Œç°åœ¨è¦å°†è¿™ä¸¤ä¸ªä¿®æ”¹åˆåˆ°åŸåˆ†æ”¯ä¸Šã€‚ ä»ä¸‹é¢ä¸¤å¼ å›¾æ¥çœ‹ rebase å’Œ merge çš„åŒºåˆ«å§ï¼š merge rebase rebaseæ“ä½œä¹‹åå°†åŸæœ‰æ–°åˆ†æ”¯ä¸Šçš„ C5 C6 æäº¤æ¸…é™¤ï¼ˆC5 C6å¹¶ä¸ä¼šé©¬ä¸Šå°±è¢«ä¸¢å¼ƒï¼Œå¦‚æœè¿è¡Œåƒåœ¾æ”¶é›†å‘½ä»¤pruning garbage collection, è¿™äº›è¢«ä¸¢å¼ƒçš„æäº¤å°±ä¼šåˆ é™¤ï¼‰ï¼Œæœ€ååªå‰©ä¸‹äº†åŸåˆ†æ”¯ã€‚è¿™æ ·çš„åšæ³•å¯ä»¥ç®€åŒ–åˆ†æ”¯æ ‘ã€‚ å¦‚ä½•ä½¿ç”¨çŸ¥é“ä»€ä¹ˆåŒºåˆ«ä¹‹åï¼Œæˆ‘ä»¬äº†è§£ä¸‹å¦‚ä½•ä½¿ç”¨ï¼š 123#å½“å‰å¤„äº develop åˆ†æ”¯$ git checkout mywork$ git rebase develop rebaseçš„è¿‡ç¨‹å’Œå¯èƒ½ä¼šå‡ºç°å†²çªï¼Œrebaseä¼šæš‚åœè¿™æ—¶å€™éœ€è¦è§£å†³å†²çªï¼Œå®Œæˆä¹‹åï¼Œä½¿ç”¨ git add æ›´æ–°è¿™äº›å†…å®¹çš„ç´¢å¼• æ­¤æ—¶ä¸éœ€è¦è¿›è¡Œcommit åªéœ€è¦æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œrebaseå°±ä¼šç»§ç»­å®Œæˆæ“ä½œã€‚ 1$ git rebase --continue åœ¨ä»»ä½•æ—¶å€™ï¼Œä½ å¯ä»¥ç”¨â€“abortå‚æ•°æ¥ç»ˆæ­¢rebaseçš„è¡ŒåŠ¨ï¼Œå¹¶ä¸”â€myworkâ€ åˆ†æ”¯ä¼šå›åˆ°rebaseå¼€å§‹å‰çš„çŠ¶æ€ã€‚ 1$ git rebase --abort Referencegit rebase ä½¿ç”¨è¯¦è§£git ä¸­æ–‡è®²è§£Gitåˆ é™¤commitæäº¤çš„logè®°å½•","tags":[]},{"title":"Swift Codableä½“éªŒ","date":"2019-03-21T07:38:38.000Z","path":"2019/03/21/Swift-Codable/","text":"â€œHey broï¼Jsonæ•°æ®è½¬æ¨¡å‹ï¼Œç”¨å•¥ï¼Ÿâ€â€œemmmâ€¦ æœ€å¸¸ç”¨çš„ MJExtension , YYModelå‘—â€â€œWhat about struct Type Model in Swift?â€â€œé¢ï¼ŒOCé‡Œéƒ½æ˜¯ä¾èµ–Runtimeçš„è½¬çš„ï¼Œè¿™å€¼ç±»å‹â€¦â€â€œSwift è‡ªå¸¦çš„Codable. Take a lookâ€ Swift ç”±äºç±»å‹å®‰å…¨çš„ç‰¹æ€§ï¼Œå¯¹äºåƒ JSON è¿™ç±»å¼±ç±»å‹çš„æ•°æ®å¤„ç†ä¸€ç›´æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤´ç–¼çš„é—®é¢˜ï¼ŒObjectMapper SwiftyJSON å’Œ HandyJSON éƒ½åšäº†è¿™æ ·çš„åŠªåŠ›ï¼Œä½†éƒ½è¿˜æ˜¯æœ‰æ‰€ç¼ºé™·ã€‚ æ‰€ä»¥ Codable åè®®çš„æ¨å‡ºï¼Œæ‹¯æ•‘äº†è¿™æ ·çš„å±€é¢ï¼Œä¹Ÿä¼šå¯¹è¿™äº›ä¸‰æ–¹åº“æä¾›äº†äº›æ–°çš„æ€è·¯å§ï¼Œæ¯•ç«Ÿæ˜¯è‹¹æœè‡ªå·±é€ çš„ï¼Œæ‹¥æœ‰ä»åº•å±‚æ”¹åŠ¨çš„æƒé™ã€‚ Codable å…¶å®æ˜¯ä¸€ä¸ªç»„åˆåè®®ï¼Œç”± Decodable å’Œ Encodable ä¸¤ä¸ªåè®®ç»„æˆï¼š 123456789101112/// A type that can convert itself into and out of an external representation.public typealias Codable = Decodable &amp; Encodable/// A type that can encode itself to an external representation.public protocol Encodable &#123; public func encode(to encoder: Encoder) throws&#125;/// A type that can decode itself from an external representation.public protocol Decodable &#123; public init(from decoder: Decoder) throws&#125; Encodable å’Œ Decodable åˆ†åˆ«å®šä¹‰äº† encode(to:) å’Œ init(from:) ä¸¤ä¸ªåè®®å‡½æ•°ï¼Œåˆ†åˆ«ç”¨æ¥å®ç°æ•°æ®æ¨¡å‹çš„å½’æ¡£å’Œå¤–éƒ¨æ•°æ®çš„è§£æå’Œå®ä¾‹åŒ–ã€‚ ç°åœ¨æˆ‘ä»¬ç”¨codableæ¥è§£å†³å·¥ä½œé‡å¸¸é‡åˆ°çš„æƒ…å†µ å¤„ç†æœåŠ¡ç«¯è¿”å›å­—æ®µå’Œæœ¬åœ°å­—æ®µåç§°ä¸ä¸€è‡´æƒ…å†µå°±ä¸¾ä¸€ä¸ªå°†æœåŠ¡ç«¯ä¸‹åˆ’çº¿å‘½åçš„å­—æ®µèµ‹å€¼ç»™å®¢æˆ·ç«¯é©¼å³°å‘½åçš„å­—æ®µçš„ä¾‹å­ã€‚ OCä¸­çš„å®ç°(ä½¿ç”¨MJExtension)ï¼š 123456789@interface JakeyObj : NSObject@property (nonatomic, copy) NSString *countNum;@end@implementation JakeyObj+ (NSDictionary *)mj_replacedKeyFromPropertyName &#123; return @&#123;@\"countNum\" : @\"count_num\"&#125;;&#125;@end ä½¿ç”¨Swiftçš„Codableæ¥å®ç°ï¼Œå¾—å…ˆäº†è§£ä¸‹Codableçš„å†…éƒ¨å®ç°åŸç†ã€‚ å…³äºCodableå†…éƒ¨çš„å…·ä½“å®ç° æ‘˜è‡ªå‚è€ƒ[1]ï¼š é€šè¿‡ç ”ç©¶åº•å±‚çš„ C++ æºä»£ç å¯ä»¥å‘ç°ï¼ŒCodable é€šè¿‡å·§ï¼ˆkaiï¼‰å¦™ï¼ˆguÃ ï¼‰çš„æ–¹å¼ï¼Œåœ¨ç¼–è¯‘ä»£ç æ—¶æ ¹æ®ç±»å‹çš„å±æ€§ï¼Œè‡ªåŠ¨ç”Ÿæˆäº†ä¸€ä¸ª CodingKeys çš„æšä¸¾ç±»å‹å®šä¹‰ï¼Œè¿™æ˜¯ä¸€ä¸ªä»¥ String ç±»å‹ä½œä¸ºåŸå§‹å€¼çš„æšä¸¾ç±»å‹ï¼Œå¯¹åº”æ¯ä¸€ä¸ªå±æ€§çš„åç§°ã€‚ç„¶åå†ç»™æ¯ä¸€ä¸ªå£°æ˜å®ç° Codable åè®®çš„ç±»å‹è‡ªåŠ¨ç”Ÿæˆ init(from:) å’Œ encode(to:) ä¸¤ä¸ªå‡½æ•°çš„å…·ä½“å®ç°ï¼Œæœ€ç»ˆå®Œæˆäº†æ•´ä¸ªåè®®çš„å®ç°ã€‚ äº†è§£Codableçš„å†…éƒ¨å®ç°ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å®ç°CodingKeysçš„ç±»å‹å®šä¹‰ï¼Œ å¹¶ä¸”ç»™å±æ€§æŒ‡å®šä¸åŒçš„åŸå§‹å€¼ï¼Œå®ç°è‡ªå®šä¹‰å­—æ®µçš„è§£æï¼Œè¿™æ ·ç¼–è¯‘å™¨ä¸ä¼šç»™æˆ‘ä»¬é‡æ–°ç”Ÿæˆä¸€ä¸ªé»˜è®¤çš„CodingKeys 123456789struct JakeyObj: Codable &#123; var name: String var countNum: Int enum CodingKeys: String, CodingKey &#123; case name case countNum = \"count_num\" &#125;&#125; éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå³ä½¿å±æ€§åç§°ä¸ JSON ä¸­çš„å­—æ®µåç§°ä¸€è‡´ï¼Œå¦‚æœè‡ªå®šä¹‰äº† CodingKeysï¼Œè¿™äº›å±æ€§ä¹Ÿæ˜¯æ— æ³•çœç•¥çš„ã€å¯é€‰å€¼ç±»å‹å±æ€§å¯ä»¥çœç•¥ã€‘ï¼Œå¦åˆ™ä¼šå¾—åˆ°ä¸€ä¸ª Type â€˜JakeyObjâ€™ does not conform to protocol â€˜Codableâ€™ çš„ç¼–è¯‘é”™è¯¯ï¼Œè¿™ä¸€ç‚¹è¿˜æ˜¯æœ‰ç‚¹å‘çš„ã€‚ Swift 4.1ä¸­å¯¹æ­¤è¿›è¡Œäº†æ”¹è¿›ï¼Œåªéœ€è¦å¯¹JSONDecoderå¯¹è±¡è¿›è¡Œè®¾ç½®æŒ‡å®škeyDecodingStrategyå±æ€§ 1234let jsonData = Data(jsonString.utf8)let decoder = JSONDecoder()decoder.keyDecodingStrategy = .convertFromSnakeCase å¤„ç†æœåŠ¡ç«¯å­—æ®µè¿”å›ä¸ºç©ºã€ä¸è¿”å›å­—æ®µæƒ…å†µå°†å­—æ®µå¯¹åº”çš„å±æ€§æ ‡è®°ä¸ºå¯é€‰å€¼ç±»å‹å³å¯ã€‚ 123struct JakeyObj: Codable &#123; var name: String?&#125; å¦‚æœå®šä¹‰éå¯é€‰ç±»å‹ï¼ŒæœåŠ¡ç«¯æ²¡æœ‰ç»™å€¼çš„è¯ä¼šCrashå“¦ã€‚è¿™æ ·çš„è¯ï¼Œæ¨¡å‹ä¸æ˜¯éƒ½å¾—ä½¿ç”¨å¯é€‰ç±»å‹æ‰åˆç†äº†ï¼Œå–å€¼çš„æ—¶å€™ä¼šæœ‰ç‚¹éº»çƒ¦ Dateç±»å‹çš„è½¬æ¢å½“ç„¶æ—¶é—´çš„å¤„ç†å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²æ¥æ”¶ä¸‹æ¥ä¹‹ååœ¨ä½¿ç”¨å‰è¿›è¡Œå¤„ç†ï¼Œä½†è¿™éš¾å…ä¼šé‡å¤æ‰§è¡Œå¢åŠ äº†CPUçš„é¢å¤–è´Ÿæ‹…ã€‚ çœ‹çœ‹å¦‚ä½•åœ¨æ¨¡å‹ä¸­ä¸€æ¬¡æ€§å¤„ç†å®Œæˆå§ JSONDecoderæä¾›äº†ä¸€ä¸ªæšä¸¾ç±»å‹æ¥å¤„ç†æ—¥æœŸæ ¼å¼ 1234567891011121314151617181920public enum DateDecodingStrategy &#123; /// Defer to `Date` for decoding. This is the default strategy. case deferredToDate /// Decode the `Date` as a UNIX timestamp from a JSON number. case secondsSince1970 /// Decode the `Date` as UNIX millisecond timestamp from a JSON number. case millisecondsSince1970 /// Decode the `Date` as an ISO-8601-formatted string (in RFC 3339 format). case iso8601 /// Decode the `Date` as a string parsed by the given formatter. case formatted(DateFormatter) /// Decode the `Date` as a custom value decoded by the given closure. case custom((Decoder) throws -&gt; Date)&#125; æ³¨é‡Šå†™å¾—å¾ˆæ¸…æ¥šï¼Œæ¯ä¸ªç±»å‹çš„ç”¨é€”ï¼Œæˆ‘ä»¬æ¥å°è¯•ä¸‹æœ€åä¸¤ä¸ª.formatted(DateFormatter)å’Œ.custom((Decoder) throws -&gt; Date)çš„ä½¿ç”¨ã€‚ 12345let decoder = JSONDecoder()let formatter = DateFormatter()formatter.dateFormat = \"yyyy-MM-dd HH:mm:ss\"formatter.timeZone = TimeZone(abbreviation: \"UTC\")decoder.dateDecodingStrategy = .formatted(formatter) ä½¿ç”¨.formatted(DateFormatter)å·²ç»èƒ½æ»¡è¶³åŸºæœ¬ä¸Šçš„éœ€æ±‚çš„ï¼Œç‰¹æ®Šçš„å®ç°å°±å¯ä»¥æŒ‡å®šå¦‚ä½•è§£æã€‚ ä¾‹å­ï¼š 123456789101112131415161718let decoder = JSONDecoder()decoder.dateDecodingStrategy = .custom(&#123; (decoder) -&gt; Date in let container = try decoder.singleValueContainer() if let str = try? container.decode(String.self) &#123; // å¦‚æœ‰å¿…è¦,è¿™é‡Œè¿˜å¯ä»¥åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºæ—¶é—´æˆ³,æœ€ç»ˆè½¬æ¢æˆDate let formatter = DateFormatter() formatter.dateFormat = \"yyyy-MM-dd HH:mm:ss\" formatter.timeZone = TimeZone(abbreviation: \"UTC\") if let date = formatter.date(from: str) &#123; return date &#125; &#125; if let double = try? container.decode(Double.self) &#123; // å¯æ ¹æ®æœåŠ¡å™¨è¿”å›çš„æ—¶é—´æˆ³æ˜¯ç›¸å¯¹äº1970.1.1 00:00:00è¿˜æ˜¯2001.1.1 00:00:00è¿›è¡Œç›¸åº”çš„è½¬æ¢ return Date(timeIntervalSinceReferenceDate: double) &#125; throw DecodingError.dataCorruptedError(in: container, debugDescription: \"Cannot decode date.\")&#125;) æ›´å¤šå¯¹äºDateDecodingStrategyçš„ä¼˜åŒ–ä½¿ç”¨è§å‚è€ƒ[4] å‚è€ƒ[1]. Swift 4 è¸©å‘ä¹‹ Codable åè®®[2]. è°ˆè°ˆMVXä¸­çš„Model[3]. Swift é¡¹ç›®ä¸­æ¶‰åŠåˆ° JSONDecoderâ€¦[4]. Swift4ä¹‹Codableåè®®","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"},{"name":"Swift","slug":"Swift","permalink":"http://www.yangjie.hu//tags/Swift/"}]},{"title":"iOSå¼€å±å¹¿å‘Šæ–¹æ¡ˆ ï¼ˆIdea vs Realityï¼‰","date":"2019-03-15T11:04:51.000Z","path":"2019/03/15/iOS-new-launch-shceme/","text":"å¼€å±å¹¿å‘Š emmmâ€¦ æ˜¯ä¸ªè€ç”Ÿå¸¸è°ˆçš„åŠŸèƒ½éœ€æ±‚äº†ã€‚è„‘å­é‡Œå°è±¡å°±æ˜¯ä¸ªå¾ˆç®€å•çš„éœ€æ±‚ï¼ŒYYäº†ä¸€ä¸‹å®ç°çš„æ–¹å¼ï¼Œæˆ‘æƒ³åˆ°çš„æ–¹æ¡ˆå¤§æ¦‚æ˜¯ï¼š åœ¨ didFinishLaunchingWithOptions æ–¹æ³•ä¸­åˆ‡æ¢windowçš„rootViewControllerä¸ºå¯åŠ¨å¹¿å‘Šé¡µé¢ï¼Œå€’è®¡æ—¶å®Œæˆä¹‹åå†åˆ‡ä¸ºæ­£å¸¸çš„ rootViewControllerï¼Œå…¶ä¸­å†æ³¨æ„ä¸‹å¤„ç†å›¾ç‰‡ç¼“å­˜çš„å­˜å‚¨å’Œè¯»å–çš„æ“ä½œã€‚ è‡³äºå±•ç¤ºæ•ˆæœï¼ŒåŠ ç‚¹åŠ¨æ•ˆçš„äº‹æƒ…è€Œå·²å•¦ã€‚ä¿®æ”¹rootViewControlleræ•ˆæœä¸å¥½çš„è¯ï¼Œæƒ³åŠæ³•åœ¨windowä¸ŠåŠ ä¸€ä¸ªviewå±•ç¤ºå’¯ï¼Œå†ä¸è¡Œä½¿ç”¨ä¸€ä¸ªæ–°çš„windowå’¯ ç»ˆäºåœ¨é¡¹ç›®çš„è¿™ä¸€æ¬¡éœ€æ±‚ä¸­è¦æ·»åŠ å¯åŠ¨å¹¿å‘Šï¼Œæˆ‘å¯ä»¥å®ç°è„‘å­é‡ŒYYçš„åŠŸèƒ½äº†ã€‚è¿™é‡Œå…ˆåˆ—ä¸€ä¸‹éœ€æ±‚æ–¹ç»™çš„è¯¦ç»†éœ€æ±‚ï¼š å¯åŠ¨å¹¿å‘Šåªéœ€è¦åœ¨Appå¯åŠ¨çš„æ—¶å€™å±•ç¤ºï¼Œå€’è®¡æ—¶3ç§’ Appæ”¯æŒè¯»å–ç¼“å­˜å±•ç¤ºå¯åŠ¨å¹¿å‘Šã€å¼‚æ­¥æ›´æ–°å¹¿å‘Š æ§åˆ¶Appæ˜¯å¦å¼ºåˆ¶å±•ç¤ºæ­¤æ¬¡è¿”å›çš„å¯åŠ¨å¹¿å‘Š ç‚¹å‡»å¹¿å‘Šè·³è½¬åˆ°æ´»åŠ¨è½åœ°é¡µï¼Œè½åœ°é¡µè¿”å›åˆ°Appé¦–é¡µ ä½œä¸ºå¤„å¥³åº§çš„æˆ‘ï¼Œé’ˆå¯¹ç»†èŠ‚ç§è‡ªå®šäº†äº›é¢å¤–çš„éœ€æ±‚ï¼š a. å¼€å±å¹¿å‘Šä¸Šä¸å±•ç¤ºçŠ¶æ€æ b. å¹¿å‘Šå±•ç¤ºå®Œæˆä¹‹åè·³è½¬åˆ°é¦–é¡µä¸é‚£ä¹ˆçªå…€(é¦–é¡µéœ€è¦å·²ç»åŠ è½½å®Œæˆ) æ–¹æ¡ˆå®ç°å‡è®¾å¦‚ä¸‹æ˜¯æœåŠ¡ç«¯è¿”å›çš„å¼€å±å¹¿å‘Šæ§åˆ¶æ¥å£ã€‚ 123456789101112&#123; \"code\": 200, \"msg\": \"SUCCESS\", \"data\": &#123; \"hasAd\": true, \"id\": 231, \"imgUrl\": \"http://jakey.test.png\", \"jumpType\": \"url\", \"jumpValue\": \"https://www.baidu.com/\", \"showMoment\": 0 &#125;&#125; æˆ‘åˆ›å»ºäº†ä¸€ä¸ªLaunchAdManagerå¾ˆå¿«å®ç°äº†åˆ‡æ¢rootViewControllerçš„æ–¹æ¡ˆï¼Œé€šè¿‡SDWebImageä¸‹è½½ç¼“å­˜å›¾ç‰‡ï¼Œä½¿ç”¨æœåŠ¡ç«¯çš„å”¯ä¸€å­—æ®µidå½“åškeyç¼“å­˜åˆ°å†…å­˜å’Œç£ç›˜ï¼Œä¸è¯¦ç»†æè¿°æ–¹æ¡ˆï¼Œå…·ä½“æµç¨‹è§æˆ‘çš„æ—¶åºå›¾ï¼Œå¦‚ä¸‹å›¾ï¼š æœ€åçš„æ•ˆæœéå¸¸åœ°ç”Ÿç¡¬ï¼Œä¸¤ä¸ªrootViewControllerä¹‹é—´çš„åˆ‡æ¢å°±åƒæ˜¯åœ¨æ‰“æ¶â€¦ å¯»æ‰¾æ–°æ–¹æ¡ˆæ—¢ç„¶è¿™æ ·åªèƒ½å¾€ åœ¨é¦–é¡µæ‰€åœ¨çš„windowä¸Šæ·»åŠ æ–°çš„view çš„æ–¹æ¡ˆä¸Šè¿›è¡Œé äº†ã€‚ æ–¹æ¡ˆçš„å¯¹æ¯”ä¼˜åŠ£å¯ä»¥åœ¨ å‚è€ƒåˆ—è¡¨ä¸­æŸ¥çœ‹[2] æˆ‘æƒ³åˆ°é¦–é¡µä¼šæœ‰ä¸€ä¸ªåŠ è½½æ•°æ®çš„è¿‡ç¨‹ï¼Œéœ€è¦æ§åˆ¶viewåœ¨windowä¸Šå±•ç¤ºä¼šä¸ä¼šè·Ÿå…¶ä»–çš„é«˜ä¼˜å…ˆçº§çš„å¼¹çª—å†²çªã€‚ä»¥åŠè¿™æ ·ä¼šä¸ä¼šå¯¹ä¸šåŠ¡ä¼šæœ‰æ‰€å½±å“ã€‚ è¿˜æ˜¯åƒé”®ç›˜ä¸€æ ·é€šè¿‡ä¸€ä¸ªæ–°çš„windowå¯¹è±¡å±•ç¤ºå‡ºæˆ‘ä»¬çš„å¯åŠ¨å¹¿å‘Šå°±ä¸ä¼šå¯¹åŸæœ‰ä¸šåŠ¡æœ‰ä»€ä¹ˆå½±å“ã€‚ å› ä¸ºå¯åŠ¨é¡µæ˜¯å¦å±•ç¤ºéœ€è¦è¯·æ±‚æ¥å£ï¼Œå±•ç¤ºè¯»å–åœ¨çº¿å›¾ç‰‡æˆ–æ˜¯ç¼“å­˜å›¾ç‰‡ä¹Ÿä¼šéœ€è¦ä¸€ç‚¹æ—¶é—´ã€‚å¦å¤–è¿˜éœ€è¦æœ‰ä¸€ç‚¹è€ƒè™‘çš„æ˜¯ï¼ŒåŸæœ¬ä¸šåŠ¡çš„é¦–é¡µéœ€è¦åœ¨ä»€ä¹ˆæ—¶æœºè¿›è¡Œå±•ç¤ºã€‚å¦‚æœå¤ªæ—©ï¼ŒAppå¯åŠ¨ä¼šå…ˆè¿›å…¥ä¸šåŠ¡é¦–é¡µï¼Œå†å‡ºç°å¼€å±å¹¿å‘Šã€‚å¦‚æœå¤ªæ™šï¼Œå¼€å±å¹¿å‘Šå®Œæˆä¹‹åè¿˜æ²¡æœ‰åŠ è½½å®Œé¦–é¡µçš„æ•°æ®ï¼Œåˆè¾¾ä¸åˆ°æˆ‘å®šçš„éœ€æ±‚ b ã€‚æ‰€ä»¥æˆ‘è®¾è®¡äº†å¦‚ä¸‹æ¥å£ï¼š 12345678/** æ£€æŸ¥æ˜¯å¦éœ€è¦å±•ç¤ºå¹¿å‘Š @param completeHandler åˆ¤æ–­æ¥å£è¯·æ±‚å®Œæˆ @param finishedAction å€’è®¡æ—¶å®Œæˆ */- (void)checkIfNeedLaunchAdLoadComplete:(void(^)())completeHandler countFinished:(void(^)(BOOL isSkiped))finishedAction; åœ¨å¼€å±å¹¿å‘Šæ¥å£è¯·æ±‚å®Œæˆä¹‹åå°±è¿›è¡ŒåŠ è½½é¦–é¡µï¼Œæ­¤æ—¶æ–°çš„windowä¹Ÿå·²ç»è¢«åŠ è½½å‡ºæ¥äº†ï¼Œå°±ä¸ä¼šå‡ºç°å‰åä¸è¡”æ¥çš„æƒ…å†µã€‚ ç®€å•åˆ—ä¸€ä¸‹å…³é”®ä»£ç  1234567UIWindow *adWindow = [[UIWindow alloc] initWithFrame:[UIScreen mainScreen].bounds];THKLaunchClearViewController *vc = [[THKLaunchClearViewController alloc] init];adWindow.rootViewController = vc;adWindow.windowLevel = UIWindowLevelStatusBar + 1;adWindow.hidden = NO;adWindow.alpha = 1;[adWindow addSubview:rootVC.view]; å…³äº UIWindow æœ‰åªè¦åˆ›å»ºäº†ï¼Œå®ƒçš„hiddenå±æ€§é»˜è®¤å°±æ˜¯YESã€‚åœ¨makeKeyAndVisibleæ–¹æ³•çš„æ³¨é‡Šä¸­æœ‰è¿™ä¹ˆå†™ï¼š Shows the window and makes it the key window. This is a convenience method to show the current window and position it in front of all other windows at the same level or lower. If you only want to show the window, change its hidden property to NO. æˆ‘ä»¬åªæ˜¯å±•ç¤ºè¿™ä¸ªæ–°çš„windowï¼Œä¸æ˜¯å°†å…¶æ›¿æ¢ä¸ºkeywindow, é‚£ä¹ˆåªéœ€è¦å°†å…¶hiddençš„å±æ€§ç½®ä¸ºNOã€‚ åœ¨å±•ç¤ºå®Œæˆä¹‹åï¼Œè®°å¾—å°†æ–°åˆ›å»ºçš„windowå¯¹è±¡ä¸Šçš„æ‰€æœ‰è§†å›¾å’Œå…¶æœ¬èº«è¿›è¡Œé”€æ¯ã€‚ æƒ³è¦ç›´æ¥ä½¿ç”¨ç°æˆçš„å¼€å±å¹¿å‘Šç»„ä»¶ï¼Ÿæ¨èä½¿ç”¨æ–‡ç« åº•éƒ¨å‚è€ƒé“¾æ¥ä¸­çš„ [1] ä¸‰æ–¹åº“ï¼Œçœ‹äº†å…¶å®ç°çš„æºç ï¼Œè™½ç„¶å†™å¾—æ¯”è¾ƒé‡ç¨æ˜¾å•°å—¦ï¼Œä½†åŠŸèƒ½å…¨ã€æ•ˆæœä¸é”™ï¼Œå…¶staræ•°ç»å¾—èµ·å®æˆ˜è€ƒéªŒäº†ã€‚ åœ¨æºç ä¸­çœ‹åˆ°äº†ä¸€ç§æ— ç—›æ¥å…¥çš„å®ç°æ–¹å¼ï¼Œå…ˆè§£é‡Šä¸‹æ— ç—›æ˜¯ä»€ä¹ˆæ¦‚å¿µï¼šä½¿ç”¨ä¸‰æ–¹åº“ä¸éœ€è¦é¢å¤–å†™ä»»ä½•ä»£ç ï¼Œåªè¦å°†åº“æ–‡ä»¶æ‹–å…¥å·¥ç¨‹å°±å®ŒæˆåŠŸèƒ½çš„å®ç°ã€‚ å…·ä½“å®ç°çš„ä»£ç å¦‚ä¸‹ï¼Œé€šè¿‡é‡å†™ç±»çš„loadæ–¹æ³•ï¼Œå› ä¸ºç±»çš„loadæ–¹æ³•å¿…å®šä¼šæ‰§è¡Œï¼Œæ‰€ä»¥å¯ä»¥ç¡®ä¿é‡Œé¢çš„ä»£ç æ‰§è¡Œã€‚ 123456789101112131415161718192021222324+(void)load&#123; [self shareManager];&#125;+(XHLaunchAdManager *)shareManager&#123; static XHLaunchAdManager *instance = nil; static dispatch_once_t oneToken; dispatch_once(&amp;oneToken,^&#123; instance = [[XHLaunchAdManager alloc] init]; &#125;); return instance;&#125;- (instancetype)init&#123; self = [super init]; if (self) &#123; //åœ¨UIApplicationDidFinishLaunchingæ—¶åˆå§‹åŒ–å¼€å±å¹¿å‘Š,åšåˆ°å¯¹ä¸šåŠ¡å±‚æ— å¹²æ‰°,å½“ç„¶ä½ ä¹Ÿå¯ä»¥ç›´æ¥åœ¨AppDelegate didFinishLaunchingWithOptionsæ–¹æ³•ä¸­åˆå§‹åŒ– [[NSNotificationCenter defaultCenter] addObserverForName:UIApplicationDidFinishLaunchingNotification object:nil queue:nil usingBlock:^(NSNotification * _Nonnull note) &#123; //åˆå§‹åŒ–å¼€å±å¹¿å‘Š [self setupXHLaunchAd]; &#125;]; &#125; return self;&#125; å‚è€ƒ[1].XHLaunchAd GitHub[2]. iOSå¼€å±å¹¿å‘Š&amp;å¼¹çª—æµ®å±‚è§£å†³æ–¹æ¡ˆ","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"iOS/MacOSå†…å­˜çš„æµ‹é‡","date":"2018-12-03T03:56:33.000Z","path":"2018/12/03/memory-measure/","text":"iOSè®¾å¤‡çš„å†…å­˜å¤§å°ï¼š Xcodeè®¡é‡è¡¨ å‘½ä»¤è¡Œå·¥å…·topå‘½ä»¤123456789101112131415161718Processes: 411 total, 5 running, 406 sleeping, 2126 threads 15:12:53Load Avg: 3.24, 3.04, 3.10 CPU usage: 18.22% user, 6.71% sys, 75.5% idleSharedLibs: 277M resident, 70M data, 137M linkedit.MemRegions: 83990 total, 7653M resident, 245M private, 2352M shared.PhysMem: 15G used (2366M wired), 1377M unused.VM: 2387G vsize, 1297M framework vsize, 0(0) swapins, 0(0) swapouts.Networks: packets: 249379/143M in, 128089/35M out.Disks: 553235/5857M read, 1249971/16G written.PID COMMAND %CPU TIME #TH #WQ #PORT MEM PURG CMPR PGRP PPID STATE637 webstorm 2.0 02:49.89 60 3 354 665M 64K 0B 637 1 sleeping5033 lldb-rpc-ser 0.0 00:10.29 8 1 69 625M 0B 0B 5033 1228 sleeping0 kernel_task 6.7 06:49.77 140/8 0 0 600M- 0B 0B 0 0 running228 WindowServer 10.9 04:13.65 10/1 3 4431+ 464M- 17M- 0B 228 1 running1228 Xcode 1.6 01:52.85 20 9 890 319M+ 9204K- 0B 1228 1 sleeping1257 XCBBuildServ 0.0 01:17.54 3 3 44 308M 0B 0B 1257 1228 sleeping574 Paste 94.6 22:28.97 8 4 347+ 303M- 103M+ 0B 574 1 sleeping2434 WeChat 2.1 00:48.94 21 8 727 252M- 21M 0B 2434 1 sleepin æ’åºtopå‘½ä»¤ç•Œé¢ä¸‹(Linux): p é”® - æŒ‰ cpu ä½¿ç”¨ç‡æ’åºm é”® - æŒ‰å†…å­˜ä½¿ç”¨é‡æ’åº åœ¨Macä¸‹ï¼Œå…ˆè¾“å…¥ oï¼Œç„¶åè¾“å…¥ cpu åˆ™æŒ‰ cpu ä½¿ç”¨é‡æ’åºï¼Œè¾“å…¥ rsize åˆ™æŒ‰å†…å­˜ä½¿ç”¨é‡æ’åºã€‚ æŸ¥çœ‹ç‰©ç†å†…å­˜åœ¨ç³»ç»Ÿçº§åˆ«ä¸Šå®é™…å ç”¨æƒ…å†µï¼š PhysMem 12âœ ~ top -l 1 | head -n 10 | grep PhysMemPhysMem: 13G used (2309M wired), 2908M unused. vm_statå‘½ä»¤ä½¿ç”¨Pythonè„šæœ¬è¿›è¡Œè§£æå’ŒåŒ…è£…ï¼Œè¾“å‡ºç»“æœï¼š 12345Wired Memory: 2483 MBActive Memory: 6814 MBInactive Memory: 5648 MBFree Memory: 271 MBReal Mem Total (ps): 15974.336 MB wired, active, inactive, freeåˆ†åˆ«æ˜¯ä»€ä¹ˆæ„ä¹‰ï¼š ç®€å•çš„è¯´ï¼ŒMac OS Xçš„[å†…å­˜]ä½¿ç”¨æƒ…å†µåˆ†ä¸ºï¼šwired, active, inactive å’Œ free å››ç§ã€‚ wiredæ˜¯ç³»ç»Ÿæ ¸å¿ƒå ç”¨çš„ï¼Œæ°¸è¿œä¸ä¼šä»ç³»ç»Ÿç‰©ç†[å†…å­˜]ç§é©±é™¤ã€‚activeè¡¨ç¤ºè¿™äº›[å†…å­˜]æ•°æ®æ­£åœ¨ä½¿ç”¨ä¸­ï¼Œæˆ–è€…åˆšè¢«ä½¿ç”¨è¿‡ã€‚inactiveè¡¨ç¤ºè¿™äº›[å†…å­˜]ä¸­çš„æ•°æ®æ˜¯æœ‰æ•ˆçš„ï¼Œä½†æ˜¯æœ€è¿‘æ²¡æœ‰è¢«ä½¿ç”¨ã€‚free, è¡¨ç¤ºè¿™äº›[å†…å­˜]ä¸­çš„æ•°æ®æ˜¯æ— æ•ˆçš„ï¼Œè¿™äº›ç©ºé—´å¯ä»¥éšæ—¶è¢«ç¨‹åºä½¿ç”¨ã€‚ å½“freeçš„[å†…å­˜]ä½äºæŸä¸ªå€¼ï¼ˆè¿™ä¸ªå€¼æ˜¯ç”±ä½ çš„ç‰©ç†[å†…å­˜]å¤§å°å†³å®šçš„ï¼‰ï¼Œç³»ç»Ÿåˆ™ä¼šæŒ‰ç…§ä»¥ä¸‹é¡ºåºä½¿ç”¨inactiveçš„èµ„æºã€‚é¦–å…ˆ å¦‚æœinactiveçš„æ•°æ®æœ€è¿‘è¢«è°ƒç”¨äº†ï¼Œç³»ç»Ÿä¼šæŠŠå®ƒä»¬çš„çŠ¶æ€æ”¹å˜æˆactive,å¹¶æ¥åœ¨åŸæœ‰active[å†…å­˜]é€»è¾‘åœ°å€çš„åé¢, å¦‚æœinactiveçš„ [å†…å­˜]æ•°æ®æœ€è¿‘æ²¡æœ‰è¢«ä½¿ç”¨è¿‡ï¼Œä½†æ˜¯æ›¾ç»è¢«æ›´æ”¹è¿‡è€Œè¿˜æ²¡æœ‰åœ¨ç¡¬ç›˜çš„ç›¸åº”è™šæ‹Ÿ[å†…å­˜]ä¸­åšä¿®æ”¹ï¼Œç³»ç»Ÿä¼šå¯¹ç›¸åº”ç¡¬ç›˜çš„è™šæ‹Ÿ[å†…å­˜]åšä¿®æ”¹ï¼Œå¹¶æŠŠè¿™éƒ¨åˆ†ç‰©ç†[å†…å­˜]é‡Šæ”¾ä¸ºfreeä¾›ç¨‹åºä½¿ç”¨ã€‚å¦‚æœinactive[å†…å­˜]ä¸­å¾—æ•°æ®è¢«åœ¨æ˜ å°„åˆ°ç¡¬ç›˜åå†æ²¡æœ‰è¢«æ›´æ”¹è¿‡ï¼Œ åˆ™ç›´æ¥é‡Šæ”¾æˆfreeã€‚æœ€åå¦‚æœactiveçš„[å†…å­˜]ä¸€æ®µæ—¶é—´æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œä¼šè¢«æš‚æ—¶æ”¹å˜çŠ¶æ€ä¸ºinactiveã€‚ æ‰€ä»¥è¯´ï¼Œå¦‚æœä½ çš„ç³»ç»Ÿé‡Œæœ‰å°‘é‡çš„free memeoryå’Œå¤§é‡çš„inactiveçš„memeoryï¼Œè¯´æ˜ä½ çš„[å†…å­˜]æ˜¯å¤Ÿç”¨çš„ï¼Œç³»ç»Ÿè¿è¡Œåœ¨æœ€ä½³çŠ¶æ€ï¼Œåªè¦éœ€è¦,ç³»ç»Ÿå°±ä¼šä½¿ç”¨å®ƒä»¬ï¼Œä¸ç”¨æ‹…å¿ƒã€‚ è€Œåä¹‹å¦‚æœç³»ç»Ÿçš„free memoryå’Œinactive memoryéƒ½å¾ˆå°‘ï¼Œè€Œactive memory å¾ˆå¤šï¼Œè¯´æ˜ä½ çš„[å†…å­˜]ä¸å¤Ÿäº†ã€‚ å½“ç„¶ä¸€å¼€æœºï¼Œå¤§éƒ¨åˆ†[å†…å­˜]éƒ½æ˜¯free,è¿™æ—¶ç³»ç»Ÿåè€Œä¸åœ¨æœ€ä½³çŠ¶æ€ï¼Œå› ä¸ºå¾ˆå¤šæ•°æ®éƒ½éœ€è¦ä»ç¡¬ç›˜è°ƒç”¨ï¼Œé€Ÿåº¦åè€Œæ…¢äº†ã€‚ æ´»åŠ¨ç›‘è§†å™¨ReferenceMacä¸‹çš„topMACä¸Šå‘½ä»¤è¡ŒæŸ¥çœ‹ç³»ç»Ÿå†…å­˜ä½¿ç”¨é‡","tags":[]},{"title":"ä¸€é”®æ›¿æ¢åšå®¢æ‰€æœ‰å›¾ç‰‡åŸŸå","date":"2018-10-27T07:53:01.000Z","path":"2018/10/27/replace-img-host-name-by-python/","text":"é¦–å…ˆä»‹ç»ä¸‹æˆ‘çš„åšå®¢å†·è¯»ç©ºé—´ï¼Œæ˜¯ä¸€ä¸ªä½¿ç”¨hexoç”Ÿæˆçš„é™æ€åšå®¢ã€‚ åšå®¢ä¸­çš„å›¾åºŠä¸€ç›´ä½¿ç”¨çš„æ˜¯ä¸ƒç‰›äº‘çš„å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼Œæˆ‘çš„ä½¿ç”¨æ–¹å¼å¾ˆç®€å•åªæ˜¯å›¾ç‰‡ä¸Šä¼ å¥½ä¹‹åè·å¾—ä¸€ä¸ªä¸ƒç‰›å¯¹è±¡å­˜å‚¨ç©ºé—´çš„é»˜è®¤å¤–é“¾åœ°å€ï¼Œå°±æ”¾åˆ°åšå®¢ä¸­ä½¿ç”¨ã€‚å®Œå…¨æ²¡æœ‰ä»€ä¹ˆæŠ€æœ¯å«é‡ğŸ˜‚ é—®é¢˜çš„è¯ç”Ÿå‰æ®µæ—¶é—´è¢«å‘ŠçŸ¥ä¸ƒç‰›è¦å›æ”¶é»˜è®¤çš„æµ‹è¯•åŸŸåï¼Œè¿™å°±æ„å‘³ç€æ‰€æœ‰å†å²æ–‡ç« ä¸­çš„å›¾ç‰‡éƒ½è¦æŒ‚äº†ã€‚å¿…é¡»è¦ç»‘å®šè‡ªå·±çš„åŸŸååˆ°å¯¹è±¡å­˜å‚¨ç©ºé—´ï¼Œå¹¶æ›¿æ¢æ‰€æœ‰å†å²æ–‡ç« ä¸­å¯¹å›¾ç‰‡çš„å¼•ç”¨åœ°å€ã€‚ é—®é¢˜å°±è¿™ä¹ˆäº§ç”Ÿäº†ï¼Œåšå®¢æ–‡ç« æ•°é‡é‚£ä¹ˆå¤šï¼ˆå…¶å®æˆ‘å¹¶ä¸å¤šï¼Œå°±æ˜¯æ‡’ï¼‰ï¼Œæ‰‹åŠ¨åœ°å»æœç´¢æ›¿æ¢å¤šéº»çƒ¦ã€‚é¦–å…ˆæƒ³åˆ°çš„æ•‘æ˜Ÿæ˜¯mwebï¼Œè¿™ä¸ªå¼ºå¤§çš„åšå®¢ç¼–è¾‘å·¥å…·ï¼Œå®ƒçš„å¤–éƒ¨æ–‡æ¡£åŠŸèƒ½å¦‚æœèƒ½è¿›è¡Œå…¨å±€æœç´¢æ›¿æ¢è¿™ä¸ªäº‹æƒ…å°±ç®€å•äº†ã€‚ æœ‰æ—¶å€™äººå°±æ˜¯è¯¥ç£¨ç ºä¸€ä¸‹æ‰ä¸ä¼šé‚£ä¹ˆæ‡’æƒ°â€”â€”æœç´¢å’Œæ›¿æ¢åªèƒ½å•æ–‡ä»¶è¿›è¡Œæ“ä½œã€‚æˆ‘ä¹Ÿæ²¡æœ‰å†å»æ‰¾å…¶ä»–å·¥å…·å»å®ç°è¿™å·¥ä½œã€‚æ‰“ç®—è‡ªå·±å†™ä¸ªç®€å•è„šæœ¬ è§£å†³æ–¹æ¡ˆä½¿ç”¨è‹¹æœè‡ªå¸¦çš„Python2.7 ç¯å¢ƒæˆåŠŸè·‘é€šå®Œæˆä»»åŠ¡ã€‚ è„šæœ¬ä¸­åšçš„ä¸»è¦ä»»åŠ¡æœ‰ä¸‰ä¸ªï¼š è·å–æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å è¯»å–åšå®¢æ–‡ç« æ–‡ä»¶å†…å®¹ æ›¿æ¢æ–‡ç« å†…å®¹ä¸­æŒ‡å®šå­—ç¬¦ä¸² è„šæœ¬å†™å¾—å¾ˆç²—ç³™ï¼Œè¿˜æ˜¯ä¸è¦è„¸å¾—è´´ä¸Šæ¥äº†ã€‚ 123456789101112131415161718192021222324252627282930313233# -*- coding: utf-8 -*-import osold_str = '*******'new_str = '*******'dir_path = 'resource-path'def read_file(file_path, name): count = 0 file_data = '' with open(file_path, 'r') as f: for line in f: if old_str in line: line = line.replace(old_str,new_str) count += 1 file_data += line print('--------æ–‡ç« ï¼š' + name + '------ä¿®æ”¹åŸŸåæ•°é‡ï¼š' + str(count).encode('utf-8')) replace_content(file_path, file_data)def replace_content(file_path, file_data): with open(file_path, 'w') as f: f.write(file_data) def get_all_files(path): files = os.listdir(path) for file_name in files: if file_name[-2:] == 'md': read_file(os.path.join(path, file_name), file_name)if __name__ == '__main__': get_all_files(dir_path) æˆæœï¼š 1234567891011121314151617âœ blog python replace_hostname.py--------æ–‡ç« ï¼šApple-Debugging-å¼€å§‹ä½¿ç”¨LLDB.md------ä¿®æ”¹åŸŸåæ•°é‡ï¼š0--------æ–‡ç« ï¼šHiï¼CALayeræˆ‘ä»¬èŠèŠ.md------ä¿®æ”¹åŸŸåæ•°é‡ï¼š2--------æ–‡ç« ï¼šJSPatché‡ä¸ŠSwift.md------ä¿®æ”¹åŸŸåæ•°é‡ï¼š0--------æ–‡ç« ï¼šä¸€æ¬¡ç‰ˆæœ¬å‘å¸ƒçš„å¯ç¤º.md------ä¿®æ”¹åŸŸåæ•°é‡ï¼š3--------æ–‡ç« ï¼š1024.md------ä¿®æ”¹åŸŸåæ•°é‡ï¼š0--------æ–‡ç« ï¼šå°ç¨‹åºé€»è¾‘å±‚.md------ä¿®æ”¹åŸŸåæ•°é‡ï¼š1--------æ–‡ç« ï¼šæœºå™¨å­¦ä¹ -ç»Ÿè®¡åŸºç¡€-tæ£€éªŒï¼ˆ2ï¼‰.md------ä¿®æ”¹åŸŸåæ•°é‡ï¼š0--------æ–‡ç« ï¼šæœºå™¨å­¦ä¹ -ç»Ÿè®¡åŸºç¡€-å‡è®¾æ£€éªŒ.md------ä¿®æ”¹åŸŸåæ•°é‡ï¼š0--------æ–‡ç« ï¼šApple-debugging-ä½¿ç”¨LLDBæ›¿æ¢æ–¹æ³•ä¸ºè‡ªå®šä¹‰çš„block.md------ä¿®æ”¹åŸŸåæ•°é‡ï¼š0--------æ–‡ç« ï¼šObjective-C-isaæŒ‡é’ˆ.md------ä¿®æ”¹åŸŸåæ•°é‡ï¼š0--------æ–‡ç« ï¼šè‡ªå®šä¹‰NSURLProtocolå®ç°UIWebViewç¼“å­˜æœºåˆ¶.md------ä¿®æ”¹åŸŸåæ•°é‡ï¼š0--------æ–‡ç« ï¼šObjective-Cä¸­çš„è£…é¥°æ¨¡å¼.md------ä¿®æ”¹åŸŸåæ•°é‡ï¼š6--------æ–‡ç« ï¼šæœºå™¨å­¦ä¹ -ç»Ÿè®¡åŸºç¡€-å½’ä¸€åŒ–-æ­£æ€åˆ†å¸ƒ-æŠ½æ ·åˆ†å¸ƒ.md------ä¿®æ”¹åŸŸåæ•°é‡ï¼š1... æ›¿æ¢å®Œæˆåï¼Œå†å‘å¸ƒæ–‡ç« çº¿ä¸Šçš„å›¾å°±éƒ½ä¹–ä¹–å›æ¥äº†ã€‚ æ­¤æ–‡ç« æƒå½“ä¸ºç®€å•çš„è„šæœ¬å°è¯•åšä¸ªè®°å½•å§ğŸ˜‚","tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://www.yangjie.hu//tags/éšç¬”/"}]},{"title":"åœ¨iOSä¸­è¿è¡ŒPython","date":"2018-09-03T04:27:12.000Z","path":"2018/09/03/Run-Python-in-iOS/","text":"åœ¨iOSè®¾å¤‡ä¸­è¿è¡Œpythonè„šæœ¬ï¼Ÿé‚£ä¸å°±æ„å‘³ç€å¯ä»¥åœ¨æ‰‹æœºä¸Šè·‘çˆ¬è™«ï¼Œå¯ä»¥ä½¿ç”¨å„ç§ç‰›é€¼å“„å“„çš„pythonåº“äº†å—ã€‚ è¿™ä¸ªæ ‡é¢˜å¯¹æˆ‘å¾ˆæœ‰å¸å¼•åŠ›ï¼Œæ›¾ç»å°±æœ‰è§åˆ°è¿‡åœ¨iOSå¹³å°ä¸Šçš„pythonç¼–è¯‘å™¨(å¾ˆå¤šiOSä¸Špythonçš„IDEï¼Œå¦‚Python3IDE)ï¼Œå¯ä»¥æ‰§è¡Œè¾“å…¥çš„pythonè¯­å’Œæœ¬åœ°çš„pythonæ–‡ä»¶ã€‚ å½“ç„¶æˆ‘æƒ³è¦çš„ä¸æ˜¯åƒè¿™ç¯‡æ–‡ç« è¯´çš„ç”¨pythonç¼–å†™ä¸€æ•´ä¸ªiOSç¨‹åºï¼Œè€Œåªæ˜¯åœ¨iOSåº”ç”¨ä¸­åµŒå…¥pythonæ–‡ä»¶æ‰§è¡ŒéUIçš„é€»è¾‘ï¼Œä¹Ÿå°±æ˜¯è¯´åªéœ€è¦åœ¨é¡¹ç›®ä¸­åµŒå…¥ä¸€ä¸ªpythonçš„ç¼–è¯‘ç¯å¢ƒã€‚ é¢å¯¹å¸‚åœºä¸Šè¿™ä¹ˆå¤šçš„iOSç‰ˆpythonç¼–è¯‘å™¨ï¼Œé¦–å…ˆå¯ä»¥ç¡®å®šçš„æ˜¯ï¼Œé’ˆå¯¹iOSç«¯çš„pythonç¼–è¯‘åº“æ˜¯å­˜åœ¨çš„ã€‚æˆ‘å…³å¿ƒçš„é—®é¢˜æ˜¯ï¼Œèƒ½å¦æ”¯æŒpythoné¡¹ç›®åŒ–çš„ç¼–è¯‘ï¼Œèƒ½å¦å¯¼å…¥ä¸°å¯Œçš„ä¸‰æ–¹åº“ã€‚é‚£å°±åŠ¨æ‰‹ä¸€è¯•å’¯ å°ç›®æ ‡ä¸ƒç‰›çš„iOSå¹³å°SDKæœ‰è¿™æ ·ä¸€ä¸ªç‰¹ç‚¹ï¼Œä¸Šä¼ æ–‡ä»¶çš„æ—¶å€™éœ€è¦ç”Ÿæˆtokenï¼Œä½†æ˜¯ç”Ÿæˆtokençš„é€»è¾‘åœ¨å®¢æˆ·ç«¯çš„SDKä¸­ä¸å­˜åœ¨ï¼Œåªèƒ½é€šè¿‡è°ƒç”¨æœåŠ¡ç«¯çš„SDKæ‰èƒ½è·å¾—ã€‚äºæ˜¯æˆ‘ä»¬çš„å°ç›®æ ‡å°±è¯ç”Ÿäº†ï¼šåœ¨iOSç«¯ä¸Šè°ƒç”¨ä¸ƒç‰›pythonæœåŠ¡ç«¯SDKæ¥ç”Ÿæˆtokenç»™å®¢æˆ·ç«¯çš„ä¸ƒç‰›SDKä½¿ç”¨ã€‚ iOSçš„Pythonè§£é‡Šå™¨é’ˆå¯¹iOSã€MacOSå¹³å°ï¼Œpybeeå¼€æºäº†pythonæ”¯æŒåº“Python-Apple-supportï¼Œè¿™ä¸ªæ˜¯è€ç‰ˆæœ¬çš„åº“Python-iOS-support. å‡†å¤‡ç¼–è¯‘ç¯å¢ƒæˆ‘è¿™æ¬¡ä½¿ç”¨çš„æ˜¯è€åº“ä¸­çš„Python3.4.2-b5ç‰ˆæœ¬ï¼Œä¸‹è½½ä¸‹æ¥æœ‰ä¸¤ä¸ªframeworkï¼Œåˆ†åˆ«æ˜¯OpenSSLå’ŒPythonã€‚å°†è¿™ä¸ªä¸¤ä¸ªframeworkæ‹–å…¥é¡¹ç›®ä¸­ï¼Œæ·»åŠ å¿…è¦çš„libåº“å¦‚å›¾ï¼š åœ¨é¡¹ç›®ä¸­åˆ›å»ºPythonEnvironment.bundleå°†Python.frameworkä¸­çš„Resourcesæ–‡ä»¶å¤¹å†…å®¹å¤åˆ¶è¿›å»ï¼Œåœ¨åˆå§‹åŒ–Pythonç¯å¢ƒä¹‹å‰å°†bundleä¸­çš„æ–‡ä»¶å¤åˆ¶åˆ°æŒ‡å®šç›®å½•ä½œä¸ºHomeè·¯å¾„ è®¾ç½®Homeè·¯å¾„ã€åˆå§‹åŒ–è®¾ç½®ä¸Šé¢å‡†å¤‡homeè·¯å¾„ï¼Œå¹¶åˆå§‹åŒ–ç¼–è¯‘ç¯å¢ƒã€‚ 123456789const char * frameworkPath = [[NSString stringWithFormat:@\"%@/Resources\",[self p_pythonFrameworkPath]] UTF8String];wchar_t *pythonHome = _Py_char2wchar(frameworkPath, NULL);Py_SetPythonHome(pythonHome);Py_Initialize();PyEval_InitThreads();//åœ¨é‡Šæ”¾çš„æ—¶å€™è°ƒç”¨Py_Finalize(); æ‰§è¡ŒPythonä»£ç ã€æ–‡ä»¶ç¼–è¯‘ç¯å¢ƒè®¾ç½®å¥½ä¹‹åï¼Œä½¿ç”¨PyRun_SimpleString(python_code)ä¾¿å¯ä»¥ç®€å•æ‰§è¡ŒPythonä»£ç  1PyRun_SimpleString(\"print('hello world')\"); ä¾¿å¯ä»¥è¾“å‡ºhello world æ‰§è¡ŒPythonæ–‡ä»¶12345NSString *scriptPath = [[NSBundle mainBundle] pathForResource:@\"test\" ofType:@\"py\"]; FILE *mainFile = fopen([scriptPath UTF8String], \"r\"); PyRun_SimpleFile(mainFile, (char *)[[scriptPath lastPathComponent] UTF8String]); ä¸Šé¢æ˜¯æ‰§è¡Œmain bundleä¸­çš„Pythonæ–‡ä»¶æ–¹å¼ï¼Œè¿™ç§æ–¹å¼æš‚æ—¶æ²¡æœ‰æ‰¾åˆ°å¦‚ä½•è°ƒç”¨æ–‡ä»¶ä¸­çš„æŸå„ç±»å…·ä½“æ–¹æ³•å’Œä¼ å‚ã€‚ å¦å¤–ä¸€ç§æ–¹å¼å¯ä»¥åšåˆ°ä¸Šé¢æè¿°çš„éœ€æ±‚ï¼Œå°†åœ¨ä¸‹ä¸€èŠ‚ä¸­è¯´æ˜ å‡†å¤‡ä¸ƒç‰›Pythonåº“ä¸‹è½½å¥½çš„ä¸ƒç‰›SDKæ–‡ä»¶æºç è§£å‹ï¼Œåœ¨Xcodeä¸­åˆ›å»ºä¸€ä¸ªbundleåŠ å…¥é¡¹ç›®ä¸­ï¼Œbundleä¸­æ”¾ä¸ƒç‰›SDKçš„æ ¸å¿ƒæ–‡ä»¶ï¼Œå¦‚å›¾ï¼š åœ¨éœ€è¦ä½¿ç”¨ä¸ƒç‰›SDKä¹‹å‰ï¼Œå°†æ­¤bundleä¸­çš„æ–‡ä»¶æ‹·è´åˆ°Pythonè¿è¡Œç¯å¢ƒçš„homeç›®å½•ä¸‹ ç¼–å†™tokenç”ŸæˆPythonæ–‡ä»¶æŸ¥çœ‹ä¸ƒç‰›çš„æ–‡æ¡£äº†è§£åˆ°ç”Ÿæˆtokenéœ€è¦ç”¨åˆ°auth.pyè¿™ä¸ªæ–‡ä»¶ä¸­çš„Authç±»ï¼Œ æˆ‘ä»¬éœ€è¦æƒ³åŠæ³•åˆ›å»ºä¸€ä¸ªAuthå®ä¾‹å¹¶ä¼ å…¥éœ€è¦çš„å‚æ•°ï¼Œå†å°†ç”Ÿæˆçš„tokenå¯¼å‡ºæ¥ã€‚ é¦–å…ˆè‡ªå·±åˆ›å»ºä¸€ä¸ªiostoken.pyæ–‡ä»¶ï¼ŒPythonçš„æ–‡ä»¶åå’Œæ–¹æ³•åéœ€è¦å°å†™ï¼Œç±»åéœ€è¦å¤§å†™ã€‚åœ¨iostoken.pyä¸­åˆ›å»ºTokenForiOSç±» 12345678910111213141516171819import jsonfrom qiniu import Authclass TokenForiOS(object): def create_token(jsonParams): print(str(jsonParams)) values = json.loads(jsonParams) access_key = values.get('access_key') secret_key = values.get('secret_key') #è¦ä¸Šä¼ çš„ç©ºé—´ bucket_name = values.get('bucket_name') #ä¸Šä¼ åˆ°ä¸ƒç‰›åä¿å­˜çš„æ–‡ä»¶å file_name = values.get('file_name') #æ„å»ºé‰´æƒå¯¹è±¡ q = Auth(access_key, secret_key) #ç”Ÿæˆä¸Šä¼  Tokenï¼Œå¯ä»¥æŒ‡å®šè¿‡æœŸæ—¶é—´ç­‰ token = q.upload_token(bucket_name, file_name, 3600) return token ä¸Šé¢æ˜¯æˆ‘ä½¿ç”¨ä¸ƒç‰›SDKä¸­çš„Authç”Ÿæˆtokençš„ä»£ç ï¼Œç±»åä¸ºTokenForiOSæ–¹æ³•åä¸ºcreate_tokenï¼Œç°åœ¨éœ€è¦æ‰¾åˆ°åˆé€‚çš„åœ°æ–¹è°ƒç”¨ã€‚ ä¸è¿‡åœ¨æƒ³è¦ä½¿ç”¨TokenForiOSç±»ä¹‹å‰ï¼Œéœ€è¦å°†å…¶åŠ å…¥qiniuæ¨¡å—çš„åˆå§‹åŒ–__init__.pyä¸­ï¼š 1from .iostoken import TokenForiOS æ¥ä¸‹æ¥å°±å¯ä»¥æ„‰å¿«åœ°è°ƒç”¨äº† Python.frameworkä¸­æœ‰ä¸€å¥—å®å¯ä»¥å¯¼å…¥Pythonæ¨¡å—ï¼Œç”Ÿæˆå®ä¾‹ï¼Œä¼ å‚è°ƒç”¨æ–¹æ³•ï¼Œå…·ä½“ä½¿ç”¨ä¾‹å­è§ä¸‹ä»£ç å— 123456789101112131415161718192021222324PyObject *pModule = PyImport_ImportModule([@\"qiniu.iostoken\" UTF8String]);//å¯¼å…¥æ¨¡å— PyObject *pyClass = PyObject_GetAttrString(pModule, [@\"TokenForiOS\" UTF8String]);//è·å–ç±» PyObject *pyInstance = PyInstanceMethod_New(pyClass); //åˆ›å»ºå®ä¾‹ NSMutableDictionary *params = [NSMutableDictionary new];[params setObject:@\"123\" forKey:@\"access_key\"];[params setObject:@\"456\" forKey:@\"secret_key\"];[params setObject:@\"jake\" forKey:@\"bucket_name\"];[params setObject:@\"pic\" forKey:@\"file_name\"]; NSError *error = nil;NSData *jsonData = [NSJSONSerialization dataWithJSONObject:params options:NSJSONWritingPrettyPrinted error:&amp;error];NSString *paramterJsonString = [[NSString alloc] initWithData:jsonData encoding:NSUTF8StringEncoding]; PyObject *result = NULL;result = PyObject_CallMethod(pyInstance, [@\"create_token\" UTF8String], \"(s)\", [paramterJsonString UTF8String] );char * resultCString = NULL;PyArg_Parse(result, \"s\", &amp;resultCString); //å°†pythonç±»å‹çš„è¿”å›å€¼è½¬æ¢ä¸ºc NSLog(@\"%s\", resultCString); è‡³æ­¤ï¼Œæˆ‘çš„å°ç›®æ ‡å°±å®Œæˆå•¦ã€‚åé¢è¿˜æœ‰å¾ˆå¤šäº‹æƒ…å¯ä»¥åšï¼Œæ¯”å¦‚è·‘ä¸ªçˆ¬è™«è¯•è¯•ï¼Œæ¯•ç«Ÿè¿˜æ²¡æœ‰å°è¯•è¿‡ç½‘ç»œè¯·æ±‚ã€‚å½“ç„¶ä¹Ÿè¿˜æœ‰å¾ˆå¤šå‘è¦è¸©ã€‚ æ€»ç»“ä½¿ç”¨è¿‡ç¨‹ä¸­æœ‰ä¸‹é¢å‡ ç‚¹ä½“ä¼š Python-Apple-supportåº“çš„ç¼ºå°‘æ–‡æ¡£ æŸ¥çœ‹Pythonçš„c-apiåº“ï¼šhttps://docs.python.org/3.5/c-api/ ï¼Œåœ¨è®¾ç½®Homeç›®å½•å¯¼å…¥æ¨¡å—çš„è¿‡ç¨‹ä¸­è¸©äº†å¾ˆå¤šå‘ ç¼–è¯‘å™¨å¯¹Pythonè¯­æ³•æç¤ºå¹¶ä¸æ”¯æŒï¼Œéš¾ä»¥æ’æŸ¥å†™é”™çš„åœ°æ–¹ frameworkçš„ä½“ç§¯æ˜¯åœ¨è¿‡å¤§ï¼Œå¯¹é¡¹ç›®æ€»ä½“ç§¯å½±å“å¤§ PS:åœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­å‘ç°äº†PyObjcè¿™ä¸ªé¡¹ç›®ï¼Œèƒ½å¤Ÿä½¿ç”¨pythoné€šè¿‡bridgeè°ƒç”¨OCçš„æ–¹æ³•ä»è€Œä½¿ç”¨Cocoaæ¡†æ¶ï¼Œå®ç°ä½¿ç”¨pythonç¼–å†™Cocoa GUIåº”ç”¨ã€‚ PyObjC is a bridge between Python and Objective-C. It allows Python scripts to use and extend existing Objective-C class libraries; most importantly the Cocoa libraries by Apple. This document describes how to use Objective-C class libraries from Python scripts and how to interpret the documentation of those libraries from the point of view of a Python programmer. Referenceåœ¨iOS appä¸­è¿è¡ŒPythonæ–‡ä»¶ï¼ˆSwift+Objective C+Python) å¸¦Demo iOS å·¥ç¨‹ä¸­è°ƒç”¨Pythonæ–¹æ³•ï¼ˆå¸¦Demoï¼‰ Embedding Python in an iPhone app PyObjc","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"iOSå¤šçº¿ç¨‹å®‰å…¨---å±æ€§ç¯‡","date":"2018-08-25T01:33:02.000Z","path":"2018/08/25/multithreading-property/","text":"APPå†…æ¶‰åŠåˆ°å¤šçº¿ç¨‹çš„è®¾è®¡éš¾å…ä¼šå¢åŠ Debugçš„éš¾åº¦ã€‚ä½†å…¶å®å¤šçº¿ç¨‹å…±åŒè®¿é—®åŒä¸€ä¸ªå¯¹è±¡æˆ–æ˜¯ä¸€æ®µä»£ç ï¼Œåœ¨ç¼–ç¨‹è¿‡ç¨‹ä¸­ç»å¸¸ç”¨åˆ°ï¼Œè¿™å°±éœ€è¦è€ƒè™‘åˆ°å¤šçº¿ç¨‹å®‰å…¨ã€‚ Property1@property (nonatomic, strong) NSString *userName; ä¸Šé¢å®šä¹‰å±æ€§æ˜¯æˆ‘ä»¬å·¥ä½œä¸­å¸¸ç”¨çš„æ–¹å¼ï¼Œå°è±¡é‡Œåªæ˜¯nonatomicæ˜¯éåŸå­æ€§ï¼Œå¯ä»¥æé«˜æ€§èƒ½ã€‚è€Œatomicæ˜¯Propertyçš„åŸå­æ€§ä¿®é¥°ï¼Œå¼€å‘ä¸­ä¸€èˆ¬ä¸ä½¿ç”¨ï¼ŒåŸå› æ˜¯atomicåŸå­æ€§ä¿®é¥°åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æ²¡æœ‰è¿™æ ·çš„éœ€æ±‚ï¼Œå¹¶ä¸”é¢‘ç¹è°ƒç”¨ä¼šå½±å“æ€§èƒ½ï¼Œå¦å¤–atomicæ›´ä¸¥æ ¼åœ°è¯´å¹¶ä¸èƒ½ç»å¯¹ä¿è¯çº¿ç¨‹çš„å®‰å…¨ã€‚ Whyï¼Ÿ å…ˆäº†è§£atomicçš„å…·ä½“å®ç°ï¼š atomicçš„æœ¬è´¨å…¶å®æ˜¯å¯¹getterå’Œgetteræ–¹æ³•åŠ é”ï¼Œä½¿ç”¨çš„æ˜¯spinlock_tè‡ªæ—‹é”ã€‚ å…·ä½“çš„å®ç°åœ¨runtimeæºç ä¸­çš„objc-accessors.mmæ–‡ä»¶ getteræ–¹æ³•å®ç° 123456789101112131415161718id objc_getProperty(id self, SEL _cmd, ptrdiff_t offset, BOOL atomic) &#123; if (offset == 0) &#123; return object_getClass(self); &#125; // Retain release world id *slot = (id*) ((char*)self + offset); if (!atomic) return *slot; // Atomic retain release world spinlock_t&amp; slotlock = PropertyLocks[slot]; slotlock.lock(); id value = objc_retain(*slot); slotlock.unlock(); // for performance, we (safely) issue the autorelease OUTSIDE of the spinlock. return objc_autoreleaseReturnValue(value);&#125; setteræ–¹æ³•å®ç° 1234567891011121314151617181920212223242526272829303132static inline void reallySetProperty(id self, SEL _cmd, id newValue, ptrdiff_t offset, bool atomic, bool copy, bool mutableCopy)&#123; if (offset == 0) &#123; object_setClass(self, newValue); return; &#125; id oldValue; id *slot = (id*) ((char*)self + offset); if (copy) &#123; newValue = [newValue copyWithZone:nil]; &#125; else if (mutableCopy) &#123; newValue = [newValue mutableCopyWithZone:nil]; &#125; else &#123; if (*slot == newValue) return; newValue = objc_retain(newValue); &#125; if (!atomic) &#123; oldValue = *slot; *slot = newValue; &#125; else &#123; spinlock_t&amp; slotlock = PropertyLocks[slot]; slotlock.lock(); oldValue = *slot; *slot = newValue; slotlock.unlock(); &#125; objc_release(oldValue);&#125; å€¼ç±»å‹Propertyå…ˆä»¥BOOLå€¼ç±»å‹ä¸ºä¾‹ï¼Œå½“æˆ‘ä»¬æœ‰ä¸¤ä¸ªçº¿ç¨‹è®¿é—®å¦‚ä¸‹propertyçš„æ—¶å€™ï¼š 1234567@property (nonatomic, assgin) BOOL isDeleted;//thread 1bool isDeleted = self.isDeleted;//thread 2self.isDeleted = false; çº¿ç¨‹1å’Œçº¿ç¨‹2ï¼Œä¸€ä¸ªè¯»(load)ï¼Œä¸€ä¸ªå†™(store)ï¼Œå¯¹äºBOOL isDeletedçš„è®¿é—®å¯èƒ½æœ‰å…ˆåä¹‹åˆ†ï¼Œä½†ä¸€å®šæ˜¯ä¸²è¡Œæ’é˜Ÿçš„ã€‚è€Œä¸”ç”±äºBOOLå¤§å°åªæœ‰1ä¸ªå­—èŠ‚ï¼Œ64ä½ç³»ç»Ÿçš„åœ°å€æ€»çº¿å¯¹äºè¯»å†™æŒ‡ä»¤å¯ä»¥æ”¯æŒ8ä¸ªå­—èŠ‚çš„é•¿åº¦ï¼Œæ‰€ä»¥å¯¹äºBOOLçš„è¯»å’Œå†™æ“ä½œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºæ˜¯åŸå­çš„ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬å£°æ˜BOOLç±»å‹çš„propertyçš„æ—¶å€™ï¼Œä»åŸå­æ€§çš„è§’åº¦çœ‹ï¼Œä½¿ç”¨atomicå’Œnonatomicå¹¶æ²¡æœ‰å®é™…ä¸Šçš„åŒºåˆ«ï¼ˆå½“ç„¶å¦‚æœé‡è½½äº†getteræ–¹æ³•å°±å¦å½“åˆ«è®ºäº†ï¼‰ã€‚ å¦‚æœæ˜¯intç±»å‹å‘¢ï¼Ÿ 1234567@property (nonatomic, assgin) int count;//thread 1int curCount = self.count;//thread 2self.count = 1; åŒç†intç±»å‹é•¿åº¦ä¸º4å­—èŠ‚ï¼Œè¯»å’Œå†™éƒ½å¯ä»¥é€šè¿‡ä¸€ä¸ªæŒ‡ä»¤å®Œæˆï¼Œæ‰€ä»¥ç†è®ºä¸Šè¯»å’Œå†™æ“ä½œéƒ½æ˜¯åŸå­çš„ã€‚ä»è®¿é—®å†…å­˜çš„è§’åº¦çœ‹nonatomicå’Œatomicä¹Ÿå¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚å¤šçº¿ç¨‹è®¿é—®å†…å­˜ é‚£ä¹ˆè®¾ç½®atomicçš„ç”¨å¤„ï¼Ÿ è®¾ç½®atomicä¹‹åï¼Œé»˜è®¤ç”Ÿæˆçš„getterå’Œsetteræ–¹æ³•æ‰§è¡Œæ˜¯åŸå­çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬åœ¨çº¿ç¨‹1æ‰§è¡Œgetteræ–¹æ³•çš„æ—¶å€™ï¼ˆåˆ›å»ºè°ƒç”¨æ ˆï¼Œè¿”å›åœ°å€ï¼Œå‡ºæ ˆï¼‰ï¼Œçº¿ç¨‹Bå¦‚æœæƒ³æ‰§è¡Œsetteræ–¹æ³•ï¼Œå¿…é¡»å…ˆç­‰getteræ–¹æ³•å®Œæˆæ‰èƒ½æ‰§è¡Œã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨32ä½ç³»ç»Ÿé‡Œï¼Œå¦‚æœé€šè¿‡getterè¿”å›64ä½çš„doubleï¼Œåœ°å€æ€»çº¿å®½åº¦ä¸º32ä½ï¼Œä»å†…å­˜å½“ä¸­è¯»å–doubleçš„æ—¶å€™æ— æ³•é€šè¿‡åŸå­æ“ä½œå®Œæˆï¼Œå¦‚æœä¸é€šè¿‡atomicåŠ é”ï¼Œæœ‰å¯èƒ½ä¼šåœ¨è¯»å–çš„ä¸­é€”åœ¨å…¶ä»–çº¿ç¨‹å‘ç”Ÿsetteræ“ä½œï¼Œä»è€Œå‡ºç°å¼‚å¸¸å€¼ã€‚å¦‚æœå‡ºç°è¿™ç§å¼‚å¸¸å€¼ï¼Œå°±å‘ç”Ÿäº†å¤šçº¿ç¨‹ä¸å®‰å…¨ã€‚ ç„¶è€Œè®¾ç½®äº†atomicä¹Ÿä¸ä¸€å®šå®‰å…¨ 12345678910111213@property (atomic, assign) int intA;//thread Afor (int i = 0; i &lt; 10000; i ++) &#123; self.intA = self.intA + 1; NSLog(@\"Thread A: %d\\n\", self.intA);&#125;//thread Bfor (int i = 0; i &lt; 10000; i ++) &#123; self.intA = self.intA + 1; NSLog(@\"Thread B: %d\\n\", self.intA);&#125; å³ä½¿å°†intAå£°æ˜ä¸ºatomicï¼Œæœ€åçš„ç»“æœä¹Ÿä¸ä¸€å®šä¼šæ˜¯20000ã€‚åŸå› å°±æ˜¯å› ä¸ºself.intA = self.intA + 1;ä¸æ˜¯åŸå­æ“ä½œï¼Œè™½ç„¶intAçš„getterå’Œsetteræ˜¯åŸå­æ“ä½œï¼Œä½†å½“æˆ‘ä»¬ä½¿ç”¨intAçš„æ—¶å€™ï¼Œæ•´ä¸ªè¯­å¥å¹¶ä¸æ˜¯åŸå­çš„ï¼Œè¿™è¡Œèµ‹å€¼çš„ä»£ç è‡³å°‘åŒ…å«è¯»å–(load)ï¼Œ+1(add)ï¼Œèµ‹å€¼(store)ä¸‰æ­¥æ“ä½œï¼Œå½“å‰çº¿ç¨‹storeçš„æ—¶å€™å¯èƒ½å…¶ä»–çº¿ç¨‹å·²ç»æ‰§è¡Œäº†è‹¥å¹²æ¬¡storeäº†ï¼Œå¯¼è‡´æœ€åçš„å€¼å°äºé¢„æœŸå€¼ã€‚è¿™ç§åœºæ™¯æˆ‘ä»¬ä¹Ÿå¯ä»¥ç§°ä¹‹ä¸º å¤šçº¿ç¨‹ä¸å®‰å…¨ã€‚ æŒ‡é’ˆPropertyæŒ‡å‘çš„å†…å­˜åŒºåŸŸè¿™ä¸€ç±»å¤šçº¿ç¨‹çš„è®¿é—®åœºæ™¯æ˜¯æˆ‘ä»¬å¾ˆå®¹æ˜“å‡ºé”™çš„åœ°æ–¹ï¼Œå³ä½¿æˆ‘ä»¬å£°æ˜propertyä¸ºatomicï¼Œä¾ç„¶ä¼šå‡ºé”™ã€‚å› ä¸ºæˆ‘ä»¬è®¿é—®çš„ä¸æ˜¯propertyçš„æŒ‡é’ˆåŒºåŸŸï¼Œè€Œæ˜¯propertyæ‰€æŒ‡å‘çš„å†…å­˜åŒºåŸŸã€‚å¯ä»¥çœ‹å¦‚ä¸‹ä»£ç ï¼š 1234567891011121314151617181920@property (atomic, strong) NSString *stringA;//thread Afor (int i = 0; i &lt; 100000; i ++) &#123; if (i % 2 == 0) &#123; self.stringA = @\"a very long string\"; &#125; else &#123; self.stringA = @\"string\"; &#125; NSLog(@\"Thread A: %@\\n\", self.stringA);&#125;//thread Bfor (int i = 0; i &lt; 100000; i ++) &#123; if (self.stringA.length &gt;= 10) &#123; NSString* subStr = [self.stringA substringWithRange:NSMakeRange(0, 10)]; &#125; NSLog(@\"Thread B: %@\\n\", self.stringA);&#125; è™½ç„¶stringAæ˜¯atomicçš„propertyï¼Œè€Œä¸”åœ¨å–substringçš„æ—¶å€™åšäº†lengthåˆ¤æ–­ï¼Œçº¿ç¨‹Bè¿˜æ˜¯å¾ˆå®¹æ˜“crashï¼Œå› ä¸ºåœ¨å‰ä¸€åˆ»è¯»lengthçš„æ—¶å€™self.stringA = @&quot;a very long string&quot;;ï¼Œä¸‹ä¸€åˆ»å–substringçš„æ—¶å€™çº¿ç¨‹Aå·²ç»å°†self.stringA = @&quot;string&quot;;ï¼Œç«‹å³å‡ºç°out of boundsçš„Exceptionï¼Œcrashï¼Œâ€” å¤šçº¿ç¨‹ä¸å®‰å…¨ã€‚ ä¸ºä»€ä¹ˆå€¼ç±»å‹ä¸å¤ªéœ€è¦è€ƒè™‘çº¿ç¨‹é—®é¢˜ å€¼ç±»å‹çš„èµ‹å€¼éƒ½æ˜¯æ·±æ‹·è´ï¼Œæ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„å¯¹è±¡ã€‚ å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹å¹¶ä¸æ˜¯ç»å¯¹ç‹¬ç«‹çš„ å€¼ç±»å‹åµŒå¥—å€¼ç±»å‹ å€¼ç±»å‹åµŒå¥—å¼•ç”¨ç±»å‹ å¼•ç”¨ç±»å‹åµŒå¥—å¼•ç”¨ç±»å‹ å¼•ç”¨ç±»å‹åµŒå¥—å€¼ç±»å‹ å¤šçº¿ç¨‹å†…å­˜è®¿é—®å…ˆæ¥çœ‹ä¸‹å¤šçº¿ç¨‹æ˜¯å¦‚ä½•åŒæ—¶è®¿é—®å†…å­˜çš„ã€‚ä¸è€ƒè™‘CPU cacheå¯¹å˜é‡çš„ç¼“å­˜ï¼Œå†…å­˜è®¿é—®å¯ä»¥ç”¨ä¸‹å›¾è¡¨ç¤ºï¼š ä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªåœ°å€æ€»çº¿ï¼Œä¸€ä¸ªå†…å­˜ã€‚å³ä½¿æ˜¯åœ¨å¤šçº¿ç¨‹çš„ç¯å¢ƒä¸‹ï¼Œä¹Ÿä¸å¯èƒ½å­˜åœ¨ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®åŒä¸€å—å†…å­˜åŒºåŸŸçš„åœºæ™¯ï¼Œå†…å­˜çš„è®¿é—®ä¸€å®šæ˜¯é€šè¿‡ä¸€ä¸ªåœ°å€æ€»çº¿ä¸²è¡Œæ’é˜Ÿè®¿é—®çš„ï¼Œæ‰€ä»¥åœ¨ç»§ç»­åç»­ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¦æ˜ç¡®å‡ ä¸ªç»“è®ºï¼š ç»“è®ºä¸€ï¼šå†…å­˜çš„è®¿é—®æ—¶ä¸²è¡Œçš„ï¼Œå¹¶ä¸ä¼šå¯¼è‡´å†…å­˜æ•°æ®çš„é”™ä¹±æˆ–è€…åº”ç”¨çš„crashã€‚ ç»“è®ºäºŒï¼šå¦‚æœè¯»å†™ï¼ˆload or storeï¼‰çš„å†…å­˜é•¿åº¦å°äºç­‰äºåœ°å€æ€»çº¿çš„é•¿åº¦ï¼Œé‚£ä¹ˆè¯»å†™çš„æ“ä½œæ˜¯åŸå­çš„ï¼Œä¸€æ¬¡å®Œæˆã€‚æ¯”å¦‚boolï¼Œintï¼Œlongåœ¨64ä½ç³»ç»Ÿä¸‹çš„å•æ¬¡è¯»å†™éƒ½æ˜¯åŸå­æ“ä½œã€‚ å¯¹äºå¹³æ—¶ç¼–å†™åº”ç”¨å±‚å¤šçº¿ç¨‹å®‰å…¨ä»£ç ï¼Œå»ºè®®è¿˜æ˜¯å¤šä½¿ç”¨@synchronizedï¼ŒNSLockï¼Œæˆ–è€…dispatch_semaphore_tï¼Œå¤šçº¿ç¨‹å®‰å…¨æ¯”å¤šçº¿ç¨‹æ€§èƒ½æ›´é‡è¦ï¼Œåº”è¯¥åœ¨å‰è€…å¾—åˆ°å……åˆ†ä¿è¯ï¼ŒçŠ¹æœ‰ä½™åŠ›çš„æ—¶å€™å†å»è¿½æ±‚åè€…ã€‚ å‚è€ƒæ–‡ç« ï¼š iOSå¤šçº¿ç¨‹åˆ°åº•ä¸å®‰å…¨åœ¨å“ªé‡Œï¼Ÿ å…³äºsynchronized ç†è§£iOSä¸­çš„é” OCä¸­atomicå±æ€§å¦‚ä½•ä¿è¯çº¿ç¨‹å®‰å…¨ runtimeåº“","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"ç¨‹åºå‘˜çš„å¼‚æ¬¡å…ƒä¸–ç•Œ---ä¸ªäººåšå®¢","date":"2018-06-29T15:16:37.000Z","path":"2018/06/29/how-to-choose-blog/","text":"éƒ½è¯´ç¨‹åºå‘˜æ¯”è¾ƒé—·ï¼Œä½†è‹¥çœ‹äº†ç¨‹åºå‘˜çš„åšå®¢ï¼Œé‚£å¯èƒ½çœ‹æ³•å°±ä¸ä¸€æ ·äº†ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæœ¬æ–‡çš„æ ‡é¢˜å«å¼‚æ¬¡å…ƒä¸–ç•Œã€‚ åŒä¸€ä¸ªä¸–ç•Œçš„æˆ‘ä»¬å¿ƒä¸­é£˜è¡ç€ä¸åŒçš„å®‡å®™ ä¸ªäººåšå®¢ï¼Œæ˜¯å¤šæ ·åŒ–çš„å­˜åœ¨ã€‚æ¯ä¸ªäººå¯¹å®ƒèµ‹äºˆçš„ä½¿å‘½ä¼šä¸ä¸€æ ·ï¼Œå®ƒå¯¹äºä¸ªäººçš„æ„ä¹‰ä¹Ÿä¼šæœ‰å·®åˆ«ã€‚å¯¹ç¨‹åºå‘˜è¿™ä¸ªç¾¤ä½“è€Œè¨€ï¼Œåšå®¢æœ‰ç€ä¸€ç§åˆ«æ ·çš„äº²å’ŒåŠ›ã€‚äº’è”ç½‘æ˜¯å› åˆ†äº«è€Œç”Ÿï¼Œè€Œç¨‹åºå‘˜ä½œä¸ºäº’è”ç½‘ä¸­çš„åœŸè‘—æ°‘ï¼Œæ›´æ˜¯è´¡çŒ®æ¦œçš„ä¸­æµç ¥æŸ±ã€‚æ–°çš„çŸ¥è¯†å°†ä¸æ–­åœ°æ¶Œå…¥ï¼Œæå®¢ç²¾ç¥æ˜¯ä¸€å¤§åŠ¨åŠ›æ¥æºï¼Œåšå®¢(æ–‡å­—æè¿°)å¾€å¾€æ˜¯å…¶ä¼ æ’­çš„è½½ä½“ã€‚åœ¨è‡ªå·±çš„é¢†åœŸä¸Šè®²è¿°å±äºè‡ªå·±çš„è¯­è¨€ï¼Œè¿˜èƒ½æœ‰æ¯”è¿™æ›´æœ‰äº²å’ŒåŠ›çš„äº‹å—ï¼Ÿ å†™ä¸€ç¯‡åšæ–‡æ˜¯åœ¨è®²ä¸€ä¸ªæ•…äº‹ï¼Œä¸€ä¸ªå¥½çš„æ•…äº‹ä¸ä»…èƒ½è®²å‡ºçœŸç›¸ï¼Œå¹¶ä¸”èƒ½è®©åˆ«äººéƒ½åŸæ„ä¸”å¬å¾—æ‡‚ã€‚è®²æ•…äº‹çš„æ˜¯ä½œè€…ï¼Œæ–‡ç« ä¹Ÿå°±æ˜¯ä½œè€…å¿ƒä¸­å®‡å®™çš„ç¼©å½±ã€‚ å› æ­¤æƒ³è¦äº†è§£ä¸€ä¸ªäººçš„å†…å¿ƒå®‡å®™ï¼Œé‚£å°±å»çœ‹ä»–çš„åšå®¢ã€‚è¯´ä¸å®šé›„èµ³èµ³çš„å¤–è¡¨ä¸‹æ˜¯ä¸€é¢—å°‘å¥³å¿ƒã€‚ æ­£ç¯‡é€‰æ‹©ä»€ä¹ˆåšå®¢ç³»ç»Ÿï¼Ÿ ç°åœ¨ç®€å•å®ç”¨çš„åšå®¢ç³»ç»Ÿå¾ˆå¤šï¼Œä¹Ÿæœ‰äººå®Œå…¨è‡ªå·±å†™äº†ä¸€ä¸ªç³»ç»Ÿï¼Œè¿™ä¸ªå…¶å®è§ä»è§æ™ºã€‚æˆ‘æ¯”è¾ƒå–œæ¬¢çš„æ˜¯ç®€çº¦é£æ ¼ï¼Œä½†æ˜¯ä¸€å®šè¦æ”¯æŒMarkDownè¯­æ³•æ¥ç¼–è¾‘æ–‡ç« ã€‚å› ä¸ºä½œä¸ºå¤§éƒ¨åˆ†ä¸ºæŠ€æœ¯è¾“å‡ºçš„åœ°æ–¹ï¼Œéœ€è¦ç”¨æˆ·èƒ½æ¸…æ™°åœ°çœ‹æ¸…æ–‡ç« è¡¨è¾¾çš„æ€æƒ³å’Œé€»è¾‘ï¼Œè¿™å°±ä¸é€‚åˆæœ‰å¤ªå¤šå…¶ä»–çš„å¹²æ‰°ï¼Œè€ŒMarkDownå¯¹ç¨‹åºå‘˜å¾ˆå‹å¥½ï¼Œç®€å•ï¼Œä¸ç”¨å¤ªåœ¨æ„æ ·å¼ï¼Œå†™ä»£ç ç‰‡æ®µå’Œå…¬å¼éƒ½å¾ˆæ–¹ä¾¿ã€‚ å¹³å°åšå®¢ç³»ç»Ÿç®€ä¹¦ç®€å•ï¼Œæ³¨é‡å†…å®¹ã€‚æ”¯æŒMarkDownï¼Œå¯¹ç¨‹åºå‘˜æ¯”è¾ƒå‹å¥½ã€‚æœ‰æ¯”è¾ƒå¤šçš„æŠ€æœ¯åœˆï¼Œå­˜åœ¨ä¸€äº›æŠ€æœ¯å¤§ç‰›ã€‚ åšå®¢å›­ &amp; CSDNå›½å†…æ¯”è¾ƒè€ç‰Œçš„ä¸€äº›æŠ€æœ¯ç¤¾åŒº çŸ¥ä¹SegmentFaulté£æ ¼ç±»ä¼¼å›½å¤–çš„Stack Overflowï¼Œæœ€åƒæŠ€æœ¯çš„ç¤¾åŒºï¼Œä½†æ˜¯äººæ°”ä¸é«˜ã€‚ Medium ç‹¬ç«‹åšå®¢ç³»ç»ŸWordPresså¤§è€Œå…¨çš„åšå®¢ç³»ç»Ÿï¼Œå¾ˆå¤šç½‘ç«™éƒ½æ˜¯åŸºäºè¿™ä¸ªç³»ç»Ÿè¿›è¡Œå¼€å‘çš„ã€‚å®ƒæ‹¥æœ‰æ•°æ®é‡åºå¤§çš„æ’ä»¶æ¥æ”¯æŒå…¶å¼ºå¤§çš„åŠŸèƒ½ã€‚ç±»ä¼¼äºæ­£ç»Ÿå»ºç«™åšå®¢ç³»ç»Ÿçš„é£æ ¼ã€‚ OctoPressHexoæˆ‘çš„åšå®¢ä½¿ç”¨çš„å°±æ˜¯ Hexo GhostJekyll ç¼–è¾‘å·¥å…·å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚è™½ç„¶æˆ‘åªæ˜¯å†™å†™æ–‡å­—ï¼Œè´´è´´å›¾ç‰‡ï¼Œä½†å¦‚æœèƒ½æŠŠå†™ä½œä¹‹å¤–çš„äº‹æƒ…å°½å¯èƒ½åœ°ç®€åŒ–ï¼Œç²¾åŠ›éƒ½æ”¾åœ¨å†™ä½œä¸Šï¼Œé‚£ä¹Ÿä¸å¤±ä¸ºä¸€å¤§å¿«äº‹ã€‚ æˆ‘å†™æ–‡ç« ä½¿ç”¨çš„éƒ½æ˜¯MarkDownæ‰€ä»¥è¿™é‡Œæ¨èçš„éƒ½æ˜¯å¸¦MarkDownç¼–è¾‘åŠŸèƒ½çš„å·¥å…·ã€‚ æ¯ä¸ªå·¥å…·éƒ½å¸¦æœ‰ç”¨æ¥åˆ›é€ å®ƒçš„é‚£ç§ç²¾ç¥ã€‚â€”â€”æµ·æ£®å ¡ã€Šç‰©ç†å­¦ä¸å“²å­¦ã€‹ Mouè¿™ä¸ªæ˜¯æˆ‘ç¬¬ä¸€ä¸ªä½¿ç”¨çš„MarkDownç¼–è¾‘å™¨ï¼Œå°±å–œæ¬¢å®ƒçš„è½»ä¾¿ï¼Œå’Œæ¸…æ–°çš„é£æ ¼ï¼Œåˆèƒ½å¯¼å‡ºPDFï¼ŒHTMLä¹‹ç±»ã€‚å½“æ—¶æˆ‘ç”¨å®ƒå†™åšå®¢ï¼Œå†™å‘¨æŠ¥å¯¼å‡ºHTMLè´´åˆ°é‚®ä»¶ä¸Šï¼Œè®©é‚®ä»¶å˜å¾—è´¼æœ‰èŒƒã€‚ ä½†æ˜¯éšç€OSXå‡çº§ï¼ŒMouä¸å†æ”¯æŒOS X10.11ä»¥ä¸Šçš„ç³»ç»Ÿäº†ã€‚ä¸€åº¦éå¸¸åœ°ä¼¤å¿ƒï¼Œä½†æ˜¯ç³»ç»Ÿæ˜¯çˆ¸çˆ¸ï¼Œåªå¥½è¯´å†è§ã€‚ è½¯ä»¶å®˜ç½‘ï¼šhttp://25.io/mou/ç°åœ¨å¥½åƒåœ¨é¢„å‘1.0ç‰ˆæœ¬ï¼Œåº”è¯¥ä¼šæ”¯æŒåˆ°æœ€æ–°çš„MacOSäº†ã€‚åŠä»·é¢„å”®ä¸­ï¼Œ15åˆ€ã€‚-_- è´µè¿˜æ˜¯æŒºè´µçš„ (åæ¥çŸ¥é“Mouæ˜¯ä¸ªè·³ç¥¨ç‹ï¼ŒTwitterä¸Šæ˜¯15å¹´è¯´è¦å‘å¸ƒ1.0ç‰ˆæœ¬äº†) StackEditè¿™æ˜¯ä¸€ä¸ªå¼€æºçš„åœ¨çº¿markdownç¼–è¾‘å™¨ï¼Œåœ¨æˆ‘å‡çº§äº†ç³»ç»Ÿæ²¡å¾—ç”¨Mouåï¼Œæˆ‘ä¹Ÿç”¨è¿‡ä¸€æ®µæ—¶é—´ã€‚æ€»ä½“æ„Ÿè§‰å°±æ˜¯ï¼Œåœ¨çº¿çš„æ€»æ˜¯æ²¡æœ‰æœ¬åœ°çš„åº”ç”¨ä½“éªŒå¥½ã€‚é¢„å‘æ”¯æŒå€’æ˜¯æŒºå…¨çš„ï¼Œç”šè‡³å¯ä»¥å†™ UML å›¾è¡¨ã€‚æ”¯æŒä»æœ¬åœ°æ‰“å¼€ï¼Œåœ¨çº¿åŒæ­¥å­˜å‚¨æ”¯æŒDropBoxï¼Œ GoogleDrive è¦è‡ªå·±çš„æœåŠ¡å™¨ä¸Šæ­å»ºä¸€ä¸ªå…è´¹çš„ç¼–è¾‘å™¨å€’æ˜¯ä¸ªä¸é”™çš„é€‰æ‹© ç¼–è¾‘å™¨åœ°å€ï¼šhttps://stackedit.io/editor GitHubä»“åº“ï¼šhttps://github.com/benweet/stackedit MacDownMacDownå¾ˆé•¿çš„ä¸€æ®µæ—¶é—´éƒ½æ‰®æ¼”ç€æˆ‘çš„æ•‘ä¸–ä¸»ï¼Œåˆ°ç°åœ¨æˆ‘ä¹Ÿè¿˜æœ‰æ—¶å€™ä¼šç”¨åˆ°å®ƒã€‚MacDowné•¿å¾—å¯ä»¥è¯´è·ŸMouéå¸¸åƒäº†ï¼Œåªä¸è¿‡é•¿å¾—æ˜¯é»‘ç™½è„¸ ä»ä½œè€…çš„æè¿°æ¥çœ‹ï¼Œä»–æ˜¯Mouçš„é‡åº¦ç”¨æˆ·ï¼Œå› ä¸ºMouæ²¡æœ‰å†æ›´æ–°æ‰€ä»¥å†³å®šè‡ªå·±æ¥å†™ä¸€ä¸ªå¹¶åŒæ—¶è‡´æ•¬Mouã€‚åŒæ—¶å› ä¸ºå¼€æºä¹Ÿå‘å±•å¾—å¾ˆå¿«ã€‚ MacDown is an open source Markdown editor for OS X, released under the MIT License. The author stole the idea from Chen Luoâ€™s Mou so that people can make crappy clones. è½¯ä»¶å®˜ç½‘ï¼šhttp://macdown.uranusjr.com/GitHubä»“åº“ï¼šhttps://github.com/MacDownApp/macdown ç¢°æ’æ…¢æ…¢åœ°ï¼Œæˆ‘å¼€å§‹æƒ³ï¼Œæˆ‘å¹³æ—¶è®°å½•ç¬”è®°æ˜¯å¦èƒ½å¤Ÿè·Ÿæˆ‘çš„åšå®¢MarkDownå†™ä½œä¹ æƒ¯ç»“åˆèµ·æ¥ï¼Œä½†åˆä¸æƒ³è®©æ–‡ä»¶æ•£æ•£è½è½ã€‚æˆ‘å¼€å§‹å¾€ç»“æ„åŒ–ç®¡ç†æ–‡æ¡£çš„æ–¹é¢å»æ¢ç´¢ï¼ˆåæ¥æˆ‘æ‰å‘ç°æˆ‘æ˜¯åœ¨å¯»æ‰¾ ç¬”è®°è½¯ä»¶ å’Œ å†™ä½œè½¯ä»¶ çš„ç¢°æ’ï¼‰ã€‚åœ¨å†™åšå®¢ä¹‹å‰ï¼Œæˆ‘ä¹Ÿæœ‰è®°å½•ç¬”è®°çš„ä¹ æƒ¯ï¼Œç”¨çš„ä¸€ç›´æ˜¯å°è±¡ç¬”è®°ï¼Œé‡Œé¢è®°å½•äº†æˆ‘åˆšå­¦ä¹ iOSæ—¶çš„é£é£é›¨é›¨ã€‚ä½†åæ¥æ…¢æ…¢æ¼”å˜ä¸ºçœ‹åˆ°å¥½çš„æ–‡ç« ï¼Œæµè§ˆå™¨çš„å°è±¡ç¬”è®°æ’ä»¶Clipä¸€ä¸‹ï¼Œå¾®åšä¸Šçœ‹åˆ°å¥½æ–‡ï¼Œ@å°è±¡ç¬”è®°ï¼Œæ…¢æ…¢æˆ‘çš„å°è±¡ç¬”è®°æœ¬æˆäº†â€œå¥½ç‰©â€åƒåœ¾åœºã€‚å°è±¡ç¬”è®°è¿˜æœ‰å›½å†…çš„æœ‰é“äº‘ç¬”è®°ä¹‹ç±»æœ‰ä¸€ä¸ªå…±åŒç‰¹å¾ï¼šå®ƒä»¬ä¸å¸Œæœ›ç”¨æˆ·ç¦»å¼€å®ƒä»¬çš„ä½“ç³»ï¼Œæ‰€ä»¥ä¸å…è®¸å†…å®¹ä»å†…éƒ¨è„±ç¦»æ¡†æ¶ä¼ æ’­ã€‚ä»¥è‡³äºæˆ‘ä»¬ç¬”è®°çš„ä¼ æ’­åˆ†äº«ï¼Œåªèƒ½æ˜¯åœ¨ç¬”è®°æœ¬è½¯ä»¶å†…éƒ¨ï¼Œå¹¶ä¸”æ˜¯æ³¨å†Œç”¨æˆ·ä¹‹é—´ã€‚è€Œä¸”â€¦è¿˜ä¸æ”¯æŒMarkDownã€‚å› æ­¤æˆ‘æ‰“ç®—è·³å‡ºæ¥ï¼Œå°è¯•äº†ä¸€æ®µæ—¶é—´å¾®è½¯çš„OneNoteï¼Œæ–‡æ¡£ç®¡ç†çš„æ–¹å¼åˆ«å…·ä¸€æ ¼ï¼Œä½†è¿˜æ˜¯ä¼ ç»Ÿçš„ç¬”è®°è½¯ä»¶çš„æ¨¡å¼ã€‚ç›´åˆ°æœ‰ä¸€å¤©â€¦ ä¸€æ”¯ä¸ºæŠ€æœ¯è€Œç”Ÿçš„å¼“ç®­å°„å…¥æˆ‘çš„çœ¼å¸˜ Quiverslogå°±æ˜¯ï¼š The Programmerâ€™s NoteBookçœ‹æ¥æ˜¯ä¸»æ‰“ç¨‹åºå‘˜ç¾¤ä½“äº†ï¼Œæˆ‘è¿˜æ˜¯æŒºè®¤åŒçš„ã€‚ Quiverä¸Šæ‰‹è¿˜æ˜¯éå¸¸å®¹æ˜“ï¼Œç®€å•æ˜“æ‡‚ã€‚é™¤äº†MacDownä¸Šçš„åŠŸèƒ½ä¹‹å¤–å®ƒæ‹¥æœ‰çš„æœ€å¤§çš„å‡ ä¸ªç‰¹ç‚¹ï¼š æ–‡ç« ä»¥Cellä¸ºå•ä½ç»„è£…ï¼Œæ¯ä¸ªCellå¯ä»¥è®¾ç½®è‡ªå·±çš„ç¼–è¾‘æ¨¡å¼å¦‚ä¸‹å›¾:è¿˜ç‰¹åœ°è´´å¿ƒåœ°æ‹å‡ºäº†Code Cellï¼Œ è¿™ä¸ªä¸­Cellæ¨¡å¼æ˜¯è¿™ä¸ªåº”ç”¨çš„æ ¸å¿ƒã€‚ æ–‡ç« ä½¿ç”¨æœ¬åœ°çš„æ•°æ®åº“ï¼Œå¯¹æ–‡ç« è¿›è¡Œå½’æ¡£åˆ†ç±»ï¼Œå¯ä»¥å°†æ•°æ®åº“æ–‡ä»¶å¤‡ä»½ã€‚æˆ‘ä½¿ç”¨äº‘ç½‘ç›˜åŒæ­¥æœ¬åœ°çš„æ•°æ®åº“æ–‡ä»¶ï¼Œä¹Ÿç›¸å½“äºå°†æ–‡ç« å®æ—¶å¤‡ä»½äº‘ç«¯å§ã€‚ æœ‰æ¼”ç¤ºæ¨¡å¼å…¨å±å±•ç¤º è¿™ä¸ªæ˜¯æˆ‘ç°åœ¨è‡ªå·±é…ç½®çš„ä¸»é¢˜ï¼š é™¤äº†äº†Macç‰ˆæœ¬ï¼ŒQuiverè¿˜æœ‰iOSç‰ˆçš„ï¼ˆå…è´¹ï¼‰ï¼Œä½†æ˜¯åªæ˜¯æ”¯æŒä»DropBoxå’Œæ”¯æŒWebDAVçš„ç½‘ç›˜ä¸­è¯»å–å¤‡ä»½çš„Quiveræ•°æ®åº“è¿›è¡Œæµè§ˆæ–‡ç« ã€‚ è½¯ä»¶å®˜ç½‘ï¼šhttp://happenapps.com/ MWebåˆšå¼€å§‹æ¥è§¦è¿™ä¸ªæ˜¯å› ä¸ºå®ƒä¸Šäº†å°‘æ•°æ´¾çš„é¦–é¡µæ¨èï¼ŒåŒæ—¶ä¹Ÿåœ¨AppStoreçš„æ¨èæ¦œä¸Šçœ‹åˆ°äº†å®ƒã€‚äºæ˜¯å°±æ¥ä½“éªŒä¸‹å®ƒçš„è¿‡äººä¹‹å¤„ï¼Œä¸€ä¸Šæ‰‹å‘ç°MWebçš„åŠŸèƒ½è®¾è®¡å¾—..å¤ªå¤šäº†ï¼Œæ— ä»ä¸‹æ‰‹ã€‚è¿·èŒ«äº†ä¸€æ®µæ—¶é—´ä¹‹åï¼Œæˆ‘å¼€å§‹ç–¯ç‹‚åœ°çˆ±ä¸Šäº†å®ƒã€‚ç°åœ¨MWebæ˜¯æˆ‘æœ€å–œæ¬¢ä½¿ç”¨çš„å†™ä½œè½¯ä»¶ã€‚ MWebæœ€å¤§çš„ä¼˜åŠ¿æ˜¯å¯¹é™æ€åšå®¢çš„å†™ä½œæ”¯æŒå¾—éå¸¸åˆ°ä½ã€‚éšæ‰‹åˆ—å‡ ä¸ªæˆ‘æœ€å–œæ¬¢çš„åŠŸèƒ½ï¼š æ”¯æŒæ–‡æ¡£åº“(è‡ªå»ºæ•°æ®åº“) å’Œ å¤–éƒ¨æ–‡æ¡£æ¨¡å¼ï¼ˆåšå®¢ç³»ç»Ÿæ–‡æ¡£åº“ï¼‰ æ–‡æ¡£åº“å¯ä»¥ç”Ÿæˆé™æ€é¡µé¢ æˆ‘ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½å°†é™æ€é¡µé¢æ”¾åœ¨æœ¬åœ°çš„tomcatæœåŠ¡ä¸Šï¼Œç›¸å½“äºæœ‰äº†ä¸€ä¸ªæœ¬åœ°çš„ç¬”è®°å°åšå®¢ã€‚æ”¾åˆ°è‡ªå·±æœåŠ¡å™¨ä¸Šå°±å¯ä»¥å½“åšè‡ªå·±çš„åšå®¢å•¦ã€‚å…·ä½“ä½¿ç”¨å¯ä»¥å‚è€ƒæŠŠç”Ÿæˆçš„é™æ€ç½‘ç«™å‘å¸ƒåˆ°githubæˆ–FTP æ”¯æŒå›¾åºŠä¸€é”®ä¸Šä¼  æ”¯æŒä¸€é”®å‘å¸ƒé™æ€åšå®¢ï¼ˆæ”¯æŒè„šæœ¬å‘å¸ƒï¼‰ è¿™ç¯‡æ–‡ç« å°±æ˜¯ä½¿ç”¨MWebè¿›è¡Œç¼–è¾‘å‘å¸ƒçš„ MWebä¹Ÿæœ‰iOSç‰ˆæœ¬ï¼Œä¸“ä¸šç‰ˆï¿¥60ã€‚å¯ä»¥åœ¨iOSç‰ˆä¸Šè¿›è¡Œå†™ä½œï¼Œç”šè‡³å‘å¸ƒæ–‡ç« ã€‚ è½¯ä»¶å®˜ç½‘ï¼šhttps://zh.mweb.im/ ç°åœ¨MWeb 3åˆšå‘å¸ƒï¼Œè¿˜å¤„äºåŠä»·ï¿¥60é”€å”®ä¸­ æœ€åé™„ä¸Šä¸€ä¸ªè¡¨æ ¼å¯¹æ¯”ä¸‹ äº§å“å ä¼˜åŠ¿ åŠ£åŠ¿ ä»·æ ¼ Mou è½»ä¾¿æ¸…æ–° å¾ˆä¹…æ²¡è·Ÿæ–°ï¼Œæš‚ä¸æ”¯æŒMacOS 10.11ä»¥ä¸Š $15ï¼ˆåŠä»·é¢„å”®ï¼‰ StackEdit åœ¨çº¿ç¼–è¾‘éšæ—¶éšåœ° å“åº”ç•¥æ…¢ï¼Œå­˜å‚¨ä¸æ–¹ä¾¿ å…è´¹ MacDown è½»ä¾¿ é»‘ç™½è„¸ä¸å¥½çœ‹(å½“ç„¶ä¹Ÿæœ‰ä¸»é¢˜) å…è´¹ Quiver æ–‡ä»¶å½’æ¡£ ä¸­æ–‡æ£€ç´¢åŠŸèƒ½ç•¥ä¸è¶³ ï¿¥68 MWeb é™æ€åšå®¢å‘å¸ƒç¥å™¨ åœ¨æˆ‘çœ¼ä¸­ä¸å­˜åœ¨ ï¿¥60ï¼ˆåŠä»·ä¿ƒé”€ä¸­ï¼‰ å…¶ä»–çš„å†™ä½œè½¯ä»¶è¿˜æœ‰æ¥è§¦è¿‡Ulysses Bear ä¹Ÿæ˜¯ç”¨æˆ·é‡éå¸¸å¤šçš„ä¸¤æ¬¾åº”ç”¨ï¼Œç”±äºæˆ‘ä½¿ç”¨ä½“éªŒä¸å¤Ÿå¤šå°±ä¸è¿›è¡Œåˆ†æã€‚ä½†æ˜¯å¯ä»¥ç¡®å®šçš„æ˜¯æ­¤ä¸¤æ¬¾åº”ç”¨ä½“éªŒä¸Šä¹Ÿæ˜¯å±äºéå¸¸ä¼˜ç§€çš„ï¼Œåªæ˜¯æˆ‘å·²ç»å¿ƒæœ‰æ‰€å±ã€‚","tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://www.yangjie.hu//tags/éšç¬”/"}]},{"title":"Realm è´¨æ„Ÿè®°å½•","date":"2018-05-27T03:49:56.000Z","path":"2018/05/27/Realm-petting-feeling/","text":"å…ˆæ¥æ®µä»£ç æ¬£èµä¸‹ 1234567891011121314let myDog = Dog()myDog.name = \"Fido\"myDog.age = 1try! realm.write &#123; realm.add(myDog)&#125;let myPuppy = realm.objects(Dog.self).filter(\"age == 1\").firsttry! realm.write &#123; myPuppy!.age = 2&#125;print(\"age of my dog: \\(myDog.age)\") // =&gt; 2 Modelsï¼ˆæ•°æ®åº“ä¸­çš„è¡¨ï¼‰å±æ€§ Realm supports the following property types: Bool, Int, Int8, Int16, Int32, Int64, Double, Float, String, Date, and Data. CGFloat properties are discouraged, as the type is not platform independent. String, Date and Data properties can be optional. Object properties must be optional. Storing optional numbers is done using RealmOptional. åœ¨Swiftä¸­å­˜å‚¨å¯¹è±¡å¿…é¡»ä½¿ç”¨optionalï¼Œå­˜å‚¨optional numbersä½¿ç”¨RealmOptional String, Data, Date è¿™ä¸‰ç§ç±»å‹çš„å±æ€§å¯æ˜¯å¯é€‰ç±»å‹å¯ä¹Ÿä»¥ä¸æ˜¯ 12345678910111213141516class Person: Object &#123; // Optional string property, defaulting to nil @objc dynamic var name: String? = nil // Optional int property, defaulting to nil // RealmOptional properties should always be declared with `let`, // as assigning to them directly will not work as desired let age = RealmOptional&lt;Int&gt;()&#125;let realm = try! Realm()try! realm.write() &#123; var person = realm.create(Person.self, value: [\"Jane\", 27]) // Reading from or modifying a `RealmOptional` is done via the `value` property person.age.value = 28&#125; ä¸»é”®ä¸»é”®ä¸€æ—¦è¢«æ·»åŠ äº†å°±ä¸èƒ½è¢«ä¿®æ”¹ 12345678class Person: Object &#123; @objc dynamic var id = 0 @objc dynamic var name = \"\" override static func primaryKey() -&gt; String? &#123; return \"id\" &#125;&#125; ç´¢å¼•éå¿…è¦çš„æ—¶å€™ä¸å»ºè®®æ·»åŠ ç´¢å¼•ï¼Œè¿™ä¼šå¢åŠ æ•°æ®åº“çš„å¤§å°ã€‚ 12345678class Book: Object &#123; @objc dynamic var price = 0 @objc dynamic var title = \"\" override static func indexedProperties() -&gt; [String] &#123; return [\"title\"] &#125;&#125; ç´¢å¼•æ”¯æŒ string, integer, boolean, Dateç±»å‹çš„å±æ€§ Ignoring propertiesä¸æƒ³è¦å­˜å‚¨åˆ°Realmä¸­çš„å±æ€§å¯ä»¥æ·»åŠ æ ‡è®°ä¸ºignoredProperties 123456789101112class Person: Object &#123; @objc dynamic var tmpID = 0 var name: String &#123; // read-only properties are automatically ignored return \"\\(firstName) \\(lastName)\" &#125; @objc dynamic var firstName = \"\" @objc dynamic var lastName = \"\" override static func ignoredProperties() -&gt; [String] &#123; return [\"tmpID\"] &#125;&#125; å±æ€§ä¿®é¥°è¯ Type Non-optional Optional Bool @objc dynamic var value = false let value = RealmOptional() Int @objc dynamic var value = 0 let value = RealmOptional() Float @objc dynamic var value: Float = 0.0 let value = RealmOptional() Double @objc dynamic var value: Double = 0.0 let value = RealmOptional() String @objc dynamic var value = â€œâ€ @objc dynamic var value: String? = nil Data @objc dynamic var value = Data() @objc dynamic var value: Data? = nil Date @objc dynamic var value = Date() @objc dynamic var value: Date? = nil Object n/a: must be optional @objc dynamic var value: Class?=nil List let value = List() n/a: must be non-optional LinkingObjects let value = LinkingObjects(fromType: Class.self, property: â€œpropertyâ€) n/a: must be non-optional Relationshipså…³ç³»è¿æ¥æ•°æ®åº“çš„ä¸¤ä¸ªå¯¹è±¡ï¼ˆè¡¨ï¼‰ï¼Œåªéœ€è¦é€šè¿‡Objectå’ŒListè¿™ä¸ªä¸¤ä¸ªå±æ€§å°±å¯ä»¥äº†ã€‚ Listéå¸¸åƒArrayï¼ŒListä¸­åªèƒ½å­˜åœ¨å•ç§ç±»å‹çš„å¯¹è±¡ã€‚ Many-to-One å¤šå¯¹ä¸€åˆ›å»ºä¸€å¯¹ä¸€æˆ–è€…å¤šå¯¹ä¸€çš„å…³ç³»æ—¶ï¼Œåªéœ€è¦åœ¨æ¨¡å‹ä¸­åˆ›å»ºä¸€ä¸ªå°†è¦å…³è”å¯¹è±¡ç±»å‹çš„å¯¹è±¡ã€‚ 12345678class Dog: Object &#123; @objc dynamic var name = \"\"&#125;class Dog: Object &#123; // ... other property declarations @objc dynamic var owner: Person? // to-one relationships must be optional&#125; Usage 123let jim = Person()let rex = Dog()rex.owner = jim Many-to-Many å¤šå¯¹å¤šä½¿ç”¨Listå±æ€§åˆ›å»ºå…³ç³» 12345678class Person: Object &#123; // ... other property declarations let dogs = List&lt;Dog&gt;()&#125;let someDogs = realm.objects(Dog.self).filter(\"name contains 'Fido'\")jim.dogs.append(objectsIn: someDogs)jim.dogs.append(rex) Inverse relationships é€†å…³ç³»ä»Personå¯ä»¥æ‰¾åˆ°Dogå¯¹è±¡ï¼Œä½†æ˜¯ä¸èƒ½å¤Ÿä»Dogæ‰¾åˆ°å®ƒçš„ä¸»äººå¯¹è±¡ã€‚é™¤éæ˜¯ä½¿ç”¨ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œä½†æ˜¯è¿™ä¸ªå…³ç³»æ˜¯ç‹¬ç«‹çš„ï¼Œç»™Personå¯¹è±¡æ·»åŠ ä¸€ä¸ªæ–°çš„Dogï¼Œå¹¶ä¸ä¼šè®²è¿™ä¸ªDogå¯¹è±¡ä¸­çš„ownerå±æ€§è®¾ç½®åˆ°æ­£ç¡®çš„Personã€‚å› æ­¤å¼•å…¥äº†é€†å…³ç³» 12345class Dog: Object &#123; @objc dynamic var name = \"\" @objc dynamic var age = 0 let owners = LinkingObjects(fromType: Person.self, property: \"dogs\")&#125; ä¸Šé¢çš„Dogå¯¹è±¡ä¸­çš„ownerså±æ€§ä¸­å°†åŒ…å«æ‰€æœ‰æ‹¥æœ‰è¿™ä¸ªDogå¯¹è±¡çš„Personå¯¹è±¡ã€‚ NotificationsRealm Notificationé€šçŸ¥è¿”å›çš„æ˜¯è¿™ä¸ªé€šçŸ¥çš„tokenï¼Œä¸€æ—¦tokenè¢«é‡Šæ”¾äº†ï¼Œå°±æ„å‘³ç€è¿™ä¸ªé€šçŸ¥ä¹Ÿè¢«æ³¨é”€äº†ã€‚ ä¸€æ—¦æœ‰ç›¸å…³çš„å†™æ“ä½œè¢«æäº¤ï¼Œæ— è®ºåœ¨ä»€ä¹ˆçº¿ç¨‹ä¸Šçš„å†™æ“ä½œï¼Œé€šçŸ¥å°†ä¼šå¼‚æ­¥åœ°è¢«è§¦å‘ï¼Œæ­¤æ—¶å¯ä»¥è¿›è¡ŒUIçš„åˆ·æ–°ã€‚ 1234567// Observe Realm Notificationslet token = realm.observe &#123; notification, realm in viewController.updateUI()&#125;// latertoken.invalidate() åœ¨é€šçŸ¥çš„blockä¸­è¿›è¡Œæ•°æ®åº“çš„å†™æ“ä½œå°†ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¯ä»¥ä½¿ç”¨Realm.isInWriteTransactionæ¥åŒºåˆ†å½“å‰æ˜¯å¦å¤„äºå†™çš„äº‹åŠ¡ä¸­ã€‚ æ³¨æ„é€šçŸ¥æ‰€åœ¨çš„çº¿ç¨‹å°†äºæ³¨å†Œé€šçŸ¥æ—¶æ‰€å¤„çš„çº¿ç¨‹ç›¸åŒã€‚å¦‚æœä¸æ˜¯åœ¨ä¸»çº¿ç¨‹æ³¨å†Œçš„é€šçŸ¥ï¼Œåˆ™éœ€è¦ç»™è¯¥çº¿ç¨‹å¯åŠ¨ä¸€ä¸ªrun loopã€‚å› ä¸ºé€šçŸ¥çš„ä¼ é€’éœ€è¦ä¾é run loopï¼Œå½“ä¸€ä¸ªrun loopä¸­æœ‰å…¶ä»–çš„ä»»åŠ¡åœ¨æ‰§è¡Œï¼Œé‚£ä¹ˆrealmçš„é€šçŸ¥å¯èƒ½ä¼šè¢«å»¶è¿Ÿï¼Œå› æ­¤ä¼šæœ‰å¤šä¸ªå†™æ“ä½œäº‹åŠ¡åˆå¹¶åˆ°åŒä¸€ä¸ªé€šçŸ¥ä¸­ã€‚ Collection NotificationCollectionçš„é€šçŸ¥åœ¨objectsæ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹çš„æ—¶å€™éƒ½ä¼šè§¦å‘ï¼Œä½†ä¸ä¼šæ¥æ”¶æ•´ä¸ªrealmï¼Œåªä¼šæ¥æ”¶æ”¹å˜çš„éƒ¨åˆ†æ•°æ®ã€‚é€šè¿‡Blockçš„å‚æ•°RealmCollectionChangeå¯ä»¥è·å–åˆ°æ”¹å˜çš„å€¼ï¼ŒåŒ…æ‹¬åˆ é™¤ã€æ’å…¥ã€ä¿®æ”¹å½±å“åˆ°çš„ç´¢å¼•ä½ç½®ã€‚ ä¸€ä¸ªå¯¹è±¡çš„å±æ€§å‘ç”Ÿå˜åŒ–ã€å±æ€§Listä¸­çš„å¯¹è±¡å‘ç”Ÿå˜åŒ–ï¼Œä¸ç®¡æ˜¯å¯¹å¤šè¿˜æ˜¯å¯¹ä¸€çš„å…³ç³»ï¼Œéƒ½ä¼šè§¦å‘é€šçŸ¥ã€‚ 123456789class Dog: Object &#123; @objc dynamic var name = \"\" @objc dynamic var age = 0&#125;class Person: Object &#123; @objc dynamic var name = \"\" let dogs = List&lt;Dog&gt;()&#125; 123456789101112131415161718192021222324252627282930313233343536class ViewController: UITableViewController &#123; var notificationToken: NotificationToken? = nil override func viewDidLoad() &#123; super.viewDidLoad() let realm = try! Realm() let results = realm.objects(Person.self).filter(\"age &gt; 5\") // Observe Results Notifications notificationToken = results.observe &#123; [weak self] (changes: RealmCollectionChange) in guard let tableView = self?.tableView else &#123; return &#125; switch changes &#123; case .initial: // Results are now populated and can be accessed without blocking the UI tableView.reloadData() case .update(_, let deletions, let insertions, let modifications): // Query results have changed, so apply them to the UITableView tableView.beginUpdates() tableView.insertRows(at: insertions.map(&#123; IndexPath(row: $0, section: 0) &#125;), with: .automatic) tableView.deleteRows(at: deletions.map(&#123; IndexPath(row: $0, section: 0)&#125;), with: .automatic) tableView.reloadRows(at: modifications.map(&#123; IndexPath(row: $0, section: 0) &#125;), with: .automatic) tableView.endUpdates() case .error(let error): // An error occurred while opening the Realm file on the background worker thread fatalError(\"\\(error)\") &#125; &#125; &#125; deinit &#123; notificationToken?.invalidate() &#125;&#125; å¦‚æ­¤å°±å¯ä»¥æ ¹æ®å…·ä½“éœ€è¦åˆ·æ–°çš„ä½ç½®æ¥å±€éƒ¨åˆ·æ–°åˆ—è¡¨ï¼Œä¸éœ€è¦æ•´ä¸ªé‡æ–°åœ°åˆ·æ–°ã€‚ Object Notificationså¯ä»¥ç›‘å¬å¯¹è±¡ï¼Œå½“å¯¹è±¡è¢«åˆ é™¤æˆ–è€…å¯¹è±¡çš„å†…å®¹æ”¹å˜çš„æ—¶å€™ä¼šè§¦å‘é€šçŸ¥ã€‚ä¿®æ”¹å¯¹è±¡å±æ€§çš„æ—¶å€™è§¦å‘é€šçŸ¥çš„å‚æ•°ä¼šè¿”å›å¯¹è±¡çš„å±æ€§æ•°ç»„ï¼ŒåŒ…å«æ¯ä¸ªå±æ€§çš„æ—§å€¼å’Œæ–°å€¼ 12345678910111213141516171819202122232425class StepCounter: Object &#123; @objc dynamic var steps = 0&#125;let stepCounter = StepCounter()let realm = try! Realm()try! realm.write &#123; realm.add(stepCounter)&#125;var token : NotificationToken?token = stepCounter.observe &#123; change in switch change &#123; case .change(let properties): for property in properties &#123; if property.name == \"steps\" &amp;&amp; property.newValue as! Int &gt; 1000 &#123; print(\"Congratulations, you've exceeded 1000 steps.\") token = nil &#125; &#125; case .error(let error): print(\"An error occurred: \\(error)\") case .deleted: print(\"The object was deleted.\") &#125;&#125; Interface-driven writesåœ¨æ·»åŠ æ•°æ®ä¹‹åéœ€è¦åŒæ­¥åˆ·æ–°UIçš„æ“ä½œï¼Œå°±ä¸éœ€è¦å†å‡ºå‘ä¸€ä¸ªå¼‚æ­¥çš„é€šçŸ¥å»åˆ·æ–°TableViewäº†ï¼Œä»¥å…å¼•èµ·crashã€‚ åœ¨æäº¤å†™æ“ä½œçš„æ—¶å€™åªéœ€è¦è°ƒç”¨Realm.commitWrite(withoutNotifying:) 123456789101112131415161718192021222324252627282930// Add fine-grained notification blocktoken = collection.observe &#123; changes in switch changes &#123; case .initial: tableView.reloadData() case .update(_, let deletions, let insertions, let modifications): // Query results have changed, so apply them to the UITableView tableView.beginUpdates() tableView.insertRows(at: insertions.map(&#123; IndexPath(row: $0, section: 0) &#125;), with: .automatic) tableView.deleteRows(at: deletions.map(&#123; IndexPath(row: $0, section: 0)&#125;), with: .automatic) tableView.reloadRows(at: modifications.map(&#123; IndexPath(row: $0, section: 0) &#125;), with: .automatic) tableView.endUpdates() case .error(let error): // handle error () &#125;&#125;func insertItem() throws &#123; // Perform an interface-driven write on the main thread: collection.realm!.beginWrite() collection.insert(Item(), at: 0) // And mirror it instantly in the UI tableView.insertRows(at: [IndexPath(row: 0, section: 0)], with: .automatic) // Making sure the change notification doesn't apply the change a second time try collection.realm!.commitWrite(withoutNotifying: [token])&#125;","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"Realm è§¦æ„Ÿè®°å½•","date":"2018-05-26T15:36:24.000Z","path":"2018/05/26/Realm-touch-feeling/","text":"ç®€å•åœ°çœ‹äº†Realmçš„demoï¼Œæ„Ÿè§‰è¿™ä¸ªæ•°æ®åº“åœ¨ç§»åŠ¨ç«¯ç»™äººçš„æ„Ÿè§‰æ˜¯å†™ç€åŸç”Ÿçš„ä»£ç ï¼Œç¼–å†™ä¸€ä¸ªä¸ªå¯¹è±¡å°±å¯ä»¥æ¯«æ— æ„ŸçŸ¥åœ°åˆ›å»ºä¸€ä¸ªä¸ªæ•°æ®åº“è¡¨ã€‚è¿™é‡Œè®°å½•Realmæ•°æ®åº“çš„åˆ›å»ºå’Œåˆ é™¤ã€‚ Realmæ–‡æ¡£åœ°å€ æŸ¥çœ‹æœ¬åœ°çš„æ•°æ®åº“æ‰“å°åœ°å€ï¼š 1print(Realm.Configuration.defaultConfiguration.fileURL!) æˆ–è€…åœ¨æ–­ç‚¹çš„æ—¶å€™ï¼š 1234567891011Objective-C:(lldb) po [RLMRealmConfiguration defaultConfiguration].fileURLSwift using Realm Objective-C:(lldb) po RLMRealmConfiguration.defaultConfiguration().fileURLSwift using Realm Swift:(lldb) po Realm.Configuration.defaultConfiguration.fileURLOr if you have an RLMRealm instance at hand, you can use:(lldb) po myRealm.configuration.fileURL stackoverflow: How to find my realm file? åˆ›å»ºå¤šä¸ªæ•°æ®åº“Appç™»å½•ä¸åŒçš„ç”¨æˆ·å¯ä»¥åˆ›å»ºä¸€ä¸ªæ¯ä¸ªç”¨æˆ·ç‹¬ç«‹çš„æ•°æ®åº“æ–‡ä»¶ã€‚ 123456789101112131415//create default Realm.let realm = try! Realm()//create configured Realmlet config = Realm.Configuration( // Get the URL to the bundled file fileURL: Bundle.main.url(forResource: \"MyBundledData\", withExtension: \"realm\"), // Open the file in read-only mode as application bundles are not writeable readOnly: true)// Open the Realm with the configurationlet realm = try! Realm(configuration: config) åˆ›å»ºçš„åœ°å€é»˜è®¤éƒ½æ˜¯åœ¨Documentsæ–‡ä»¶å¤¹ä¸‹ï¼Œåˆå§‹åŒ–çš„æ—¶å€™æŒ‡å®šäº†fileUrléœ€è¦ä¿è¯èƒ½æœ‰å†™çš„æƒé™ï¼Œåƒä¸Šé¢ä¾‹å­ä¸­åœ¨Bundleä¸­çš„æ•°æ®åº“ï¼Œå®ƒå°†æ˜¯åªè¯»çš„ï¼Œéœ€è¦åœ¨æ‰“å¼€çš„æ—¶å€™å¸¦ä¸ŠreadOnlyï¼Œå¦‚æœéœ€è¦å†™çš„è¯å°±å¤åˆ¶åˆ°æ²™ç›’ä¸­ä½¿ç”¨ã€‚ åˆ›å»ºå­˜å‚¨åœ¨å†…å­˜ä¸­çš„æ•°æ®åº“1let realm = try! Realm(configuration: Realm.Configuration(inMemoryIdentifier: \"MyInMemoryRealm\")) åˆ›å»ºè¿œç¨‹åŒæ­¥çš„æ•°æ®åº“1234567// Create the configurationlet syncServerURL = URL(string: \"realm://localhost:9080/~/userRealm\")!let config = Realm.Configuration(syncConfiguration: SyncConfiguration(user: user, realmURL: syncServerURL))// Open the remote Realmlet realm = try! Realm(configuration: config)// Any changes made to this Realm will be synced across all devices! å¦‚æœæ‰“å¼€ä¸€ä¸ªæ•°æ®åº“éœ€è¦ä¼´éšç€è€—æ—¶çš„æ“ä½œï¼Œæˆ–è€…æ‰“å¼€è¿œç¨‹æ•°æ®åº“æ˜¯åªè¯»å±æ€§çš„ï¼Œé‚£ä¹ˆéœ€è¦ä½¿ç”¨asyncOpenAPI 12345678910let config = Realm.Configuration(schemaVersion: 1, migrationBlock: &#123; migration, oldSchemaVersion in // potentially lengthy data migration&#125;)Realm.asyncOpen(configuration: config) &#123; realm, error in if let realm = realm &#123; // Realm successfully opened, with migration applied on background thread &#125; else if let error = error &#123; // Handle error that occurred while opening the Realm &#125;&#125; 12345678let config = Realm.Configuration(syncConfiguration: SyncConfiguration(user: user, realmURL: realmURL))Realm.asyncOpen(configuration: config) &#123; realm, error in if let realm = realm &#123; // Realm successfully opened, with all remote data available &#125; else if let error = error &#123; // Handle error that occurred while opening or downloading the contents of the Realm &#125;&#125; åˆ›å»ºåªèƒ½å­˜è´®æŒ‡å®šç±»å‹æ•°æ®çš„æ•°æ®åº“ä¸‹é¢è¿™ä¸ªæ•°æ®åº“ä¸­å°±èƒ½å­˜å‚¨MyClasså’ŒMyOtherClass 12let config = Realm.Configuration(objectTypes: [MyClass.self, MyOtherClass.self])let realm = try! Realm(configuration: config) å½»åº•åˆ é™¤ä¸€ä¸ªæœ¬åœ°æ•°æ®åº“å†åˆ é™¤æ•°æ®åº“ä¹‹å‰ï¼Œéœ€è¦ä¿è¯æ‰€æœ‰è¢«RealmæŒæœ‰çš„å¯¹è±¡éƒ½è¢«é‡Šæ”¾äº†ï¼ŒåŒ…æ‹¬æ‰€æœ‰ä»Realmæ•°æ®åº“ä¸­è¯»å–çš„å’Œæ·»åŠ åˆ°æ•°æ®åº“ä¸­çš„å¯¹è±¡ã€‚åœ¨åˆ é™¤realmæ–‡ä»¶çš„æ—¶å€™ä¹Ÿéœ€è¦åˆ é™¤å…¶ä»–çš„é™„å±æ–‡ä»¶ã€‚ 1234567891011121314151617autoreleasepool &#123; // all Realm usage here&#125;let realmURL = Realm.Configuration.defaultConfiguration.fileURL!let realmURLs = [ realmURL, realmURL.appendingPathExtension(\"lock\"), realmURL.appendingPathExtension(\"note\"), realmURL.appendingPathExtension(\"management\")]for URL in realmURLs &#123; do &#123; try FileManager.default.removeItem(at: URL) &#125; catch &#123; // handle error &#125;&#125;","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"AFNetworking å®ç°æ–­ç‚¹ç»­ä¼ ","date":"2018-05-15T15:14:19.000Z","path":"2018/05/15/breakpoint-resume-in-iOS/","text":"æ€è·¯ ä»åè®®å±‚é¢æ¥è¯´ï¼Œæ–­ç‚¹ç»­ä¼ çš„å®ç°éƒ½æ˜¯é€šè¿‡httpå¤´é‡Œé¢çš„Rangeæ¥å®ç°çš„ã€‚å¯¹äºä»¥å‰asiçš„å®ç°å’ŒåŸºäºNSURLConnectionçš„å®ç°æ¥è¯´ï¼Œæˆ‘ä»¬éƒ½æ˜¯é€šè¿‡æ‰‹åŠ¨ä¿å­˜å½“å‰å¤§å°ç„¶åå¡«å……åˆ°Rangeçš„ç­–ç•¥æ¥å®ç°æ–­ç‚¹ç»­ä¼ åŠŸèƒ½çš„ã€‚ NSURLSessionå†…ç½®äº†å¯¹äºæ–­ç‚¹ç»­ä¼ çš„apiæ”¯æŒï¼Œä¸»è¦æ˜¯é€šè¿‡resumeDataå’Œtmpä¸­é—´æ–‡ä»¶ã€‚åœ¨NSURLSessionæš‚åœæ—¶ï¼Œå…¶ä¸­é—´æ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯è¢«ä¿å­˜åˆ°resumeDataï¼Œæˆ‘ä»¬åªè¦é€šè¿‡è¿™ä¸ªresumeDataï¼Œå³å¯ä»ä¹‹å‰çš„ä¸‹è½½è¿›åº¦ä¸­æ¢å¤ã€‚ä¹Ÿå°±æ˜¯è¯´1ä¸­çš„ç»†èŠ‚è¢«å°è£…åœ¨apiå†…éƒ¨äº†ã€‚ ç›®å‰æ¥çœ‹ï¼ŒåŸºäºNSURLSessionçš„æ–­ç‚¹ç»­ä¼ ä¸»è¦æœ‰ä¸¤ä¸ªé—®é¢˜éœ€è¦è€ƒè™‘ï¼š a. ç¨‹åºé€€å‡ºï¼ˆæ‰‹åŠ¨killç­‰ï¼‰æ—¶éœ€è¦è‡ªåŠ¨ä¿å­˜resumeDataï¼Œåç»­åº”ç”¨èµ·æ¥æ—¶å†æ¢å¤ä¹‹ã€‚ b. iOS10é‡Œé¢çš„resumeDataçš„ä¿å­˜æœ‰ç‚¹é—®é¢˜ï¼Œéœ€è¦ç‰¹åˆ«å¤„ç†ï¼Œå¯ä»¥å‚è€ƒæ­¤demo:https://github.com/HustHank/BackgroundDownloadDemo. ä¸Šè¿°å¼•ç”¨ä¸­çš„ ç¬¬2ç‚¹å°±æ˜¯æˆ‘ä»¬æ–¹æ¡ˆä¸­çš„Appç”Ÿå‘½å‘¨æœŸå†…çš„æ–­ç‚¹ç»­ä¼ ï¼Œåªæ˜¯æˆ‘ä»¬è°ƒç”¨çš„æ˜¯AFNetworkingçš„API ç¬¬1ç‚¹æ˜¯æˆ‘ä»¬æ–¹æ¡ˆä¸­ç¦»çº¿ç‚¹æ–­ç»­ä¼ çš„æ€è·¯ï¼Œä¸åŒçš„æ˜¯æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯åŸºäºNSURLSessionçš„AFNetworkingæ¥å®ç°è¿™ä¸ªé€»è¾‘ï¼ˆAFNetworkingåŸç”Ÿä¹Ÿä¸æ”¯æŒç¦»çº¿æ–­ç‚¹ç»­ä¼ ï¼‰ã€‚å®ç°çš„æ–¹æ¡ˆè·Ÿå¼•ç”¨ä¸­æåˆ°è‡ªåŠ¨ä¿å­˜resumeDataä¹Ÿä¸ä¸€è‡´ï¼Œæˆ‘ä»¬ä½¿ç”¨æ–‡ä»¶æµä¿å­˜æ•°æ®ï¼Œæ²¡æœ‰å–ç³»ç»Ÿæä¾›çš„resumeDataä½¿ç”¨ã€‚ è®¾è®¡æµç¨‹ æŸ¥çœ‹å¤§å›¾ æ–‡ä»¶ä¿å­˜é€»è¾‘æ–­ç‚¹ç»­ä¼ æœ‰ä¸€ä¸ªå¿…è¦çš„é€»è¾‘ï¼š åœ¨å¼€å§‹å‘èµ·è¯·æ±‚ä»»åŠ¡ä¹‹å‰ï¼Œåœ¨æœ¬åœ°æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è®¡ç®—ä¸‹è½½æ•°æ®å¼€å§‹çš„ä½ç½®ã€‚ è¿™é‡Œé¢æœ‰ä¸€ä¸ªéšè—çš„é—®é¢˜ï¼š å½“æŸä¸ªæ–‡ä»¶åœ¨ä¸Šä¸€æ¬¡ä¸‹è½½ä»»åŠ¡ä¸­å·²ç»ä¸‹è½½å®Œæˆï¼Œè¿™æ¬¡å‘èµ·è¯·æ±‚çš„æ—¶å€™ä¼šè¯»å–è¿™ä¸ªæ–‡ä»¶çš„å¤§å°è®¾ç½®åˆ°è¯·æ±‚å¤´çš„Rangeï¼Œä»è€Œå‘èµ·ä¸€ä¸ªä¸éœ€è¦ä¸‹è½½ä»»ä½•æ•°æ®çš„è¯·æ±‚ã€‚ è§£å†³è¿™ä¸ªé—®é¢˜é€”å¾„æœ‰ä¸¤ä¸ªï¼š åœ¨è§¦å‘ä¸‹è½½ä»»åŠ¡ä¹‹å‰è¿›è¡Œæ–‡ä»¶åˆ†æåˆ¤æ–­æ˜¯å¦éœ€è¦ä¸‹è½½ åŒºåˆ†ä¸‹è½½ä¸­å’Œä¸‹è½½å®Œæˆçš„è·¯å¾„ å‰è€…åœ¨å®ç°è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œåœ¨è¯·æ±‚å‘èµ·ä¹‹å‰æ²¡åŠæ³•åˆ‡ç¡®åˆ¤æ–­æœ¬åœ°è¯»å–åˆ°çš„æ–‡ä»¶æ•°æ®æ˜¯å¦å®Œæ•´ã€‚æˆ–è®¸å¯ä»¥ä½¿ç”¨æŸäº›ç±»å‹æ–‡ä»¶çš„ç‰¹æ€§æ¥è¿›è¡Œåˆ¤æ–­ã€‚ åè€…çš„æ–¹å¼å°±æ¯”è¾ƒé€šç”¨ç®€å•ï¼Œç®€å•æè¿°å°±æ˜¯å°†ä¸‹è½½æœªå®Œæˆçš„æ–‡ä»¶æ”¾åœ¨ç‰¹å®šçš„ä¸´æ—¶ç›®å½•ï¼Œä¸‹è½½å®Œæˆä¹‹åå†ç»Ÿä¸€è¿ç§»åˆ°ç›®æ ‡ç›®å½•ï¼Œä¸´æ—¶ç›®å½•ä¸­çš„æ–‡ä»¶ä¹Ÿä¼šéšä¹‹è¢«åˆ é™¤ã€‚ æˆ‘ä»¬é€‰æ‹©ç¬¬äºŒç§æ–¹æ¡ˆï¼Œé’ˆå¯¹iOSçš„æ²™ç›’ï¼Œtempæœ€é€‚åˆä½œä¸ºæ–¹æ¡ˆä¸­çš„ä¸´æ—¶ç›®å½•ã€‚ï¼ˆä½¿ç”¨è¿‡ç¨‹ä¸­æ³¨æ„NSFileManagerçš„çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼‰å¦‚æ­¤èƒ½ä¿è¯æ–­ç‚¹ç»­ä¼ è¿‡ç¨‹ä¸­å€¼æ“ä½œä¸´æ—¶æ–‡ä»¶ï¼Œä¸ä¼šå½±å“å¤–éƒ¨æµç¨‹ä¸­å¯¹æ˜¯å¦éœ€è¦å‘èµ·è¯·æ±‚çš„åˆ¤æ–­ã€‚ æœ€åæˆ‘ä»¬çš„é€»è¾‘æ˜¯ï¼š å¾…ä¼˜åŒ–ç‚¹ åå°ä¸‹è½½ ä¸‹è½½æ–‡ä»¶çš„æ ¡éªŒ Referencehttps://my.oschina.net/snOS/blog/795412 https://blog.csdn.net/u012198553/article/details/53613253 https://github.com/AFNetworking/AFNetworking https://www.jianshu.com/p/01390c7a4957","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"èµ‹äºˆH5ä»¥Nativeçš„ç”Ÿå‘½ â€”â€”ã€ŠWebViewä¼˜åŒ–ã€‹","date":"2018-05-02T10:07:40.000Z","path":"2018/05/02/èµ‹äºˆH5ä»¥Nativeçš„ç”Ÿå‘½-â€”â€”ã€ŠWebViewä¼˜åŒ–ã€‹/","text":"æœ¬æ–‡æ˜¯ä»å®¢æˆ·ç«¯ä¸ºèµ·ç‚¹å‘æ•£åˆ°WebViewä½¿ç”¨è¿‡ç¨‹ä¸­çš„ä¼˜åŒ–ç‚¹ã€‚å½“å‰å¸‚åœºä¸Šçš„Native Appä¸­WebViewä½¿ç”¨çš„æƒ…å†µè¿˜æ˜¯æ¯”è¾ƒå¤šçš„ï¼Œåƒæ‰‹æœºQQï¼Œæ·˜å®ä¸šåŠ¡æ›´æ›¿å¿«é€Ÿçš„äº§å“ï¼Œä½¿ç”¨WebViewåŠ¨æ€æ¸²æŸ“é¡µé¢æ˜¯å¿…ç„¶çš„é€‰æ‹©(æˆ–è€…è¯´æ›¾ç»)ï¼Œç„¶è€Œéµä»è¿™ä¸ªé€‰æ‹©å°±å¿…é¡»æ‰¿æ‹…ç€å®ƒå¸¦æ¥çš„å¼Šç—…ï¼Œæ›´ç¡®åˆ‡åœ°è¯´åº”è¯¥æ˜¯å°½å¯èƒ½è§£å†³å®ƒçš„å¼Šç—…ã€‚ å‰è¨€ä¼—æ‰€å‘¨çŸ¥åœ¨ç§»åŠ¨ç«¯ä½¿ç”¨WebViewç»™äººæœ€ç›´è§‚çš„æ„Ÿè§‰æ˜¯æ…¢ã€‚é€ æˆè¿™ä¸ªç°è±¡çš„åŸå› æ˜¯å¤šå±‚æ¬¡çš„ï¼Œä¸è¿‡ä¸»è¦å¯ä»¥å½’çº³ä¸ºä¸¤ä¸ªæ–¹é¢[2] ï¼š é¡µé¢å¯åŠ¨æ—¶é—´ï¼šæ‰“å¼€ä¸€ä¸ª H5 é¡µé¢éœ€è¦åšä¸€ç³»åˆ—å¤„ç†ï¼Œä¼šæœ‰ä¸€æ®µç™½å±æ—¶é—´ï¼Œä½“éªŒç³Ÿç³•ã€‚ å“åº”æµç•…åº¦ï¼šç”±äº webkit çš„æ¸²æŸ“æœºåˆ¶ï¼Œå•çº¿ç¨‹ï¼Œå†å²åŒ…è¢±ç­‰åŸå› ï¼Œé¡µé¢åˆ·æ–°/äº¤äº’çš„æ€§èƒ½ä½“éªŒä¸å¦‚åŸç”Ÿã€‚ åœ¨WebViewçš„å…ˆå¤©ç¼ºé™·è§’åº¦â€“å“åº”æµç•…åº¦ å¤§å‚ç»™å‡ºè§£å†³æ–¹æ¡ˆï¼š FB çš„ React-Nativeï¼ˆå¤šç§°RNï¼‰ å’Œ é˜¿é‡Œçš„ Weexã€‚RNå’ŒWeexçš„æ ¸å¿ƒå®ç°è·ŸWebViewå¹¶æ²¡æœ‰å…³ç³»ï¼Œå®ƒä»¬å®ç°çš„å¹¶ä¸æ˜¯Hybrid Appï¼Œé‡Œé¢æ˜¯ä½¿ç”¨JavaScriptå¼•æ“æ‰§è¡ŒJSè°ƒç”¨åŸç”Ÿçš„ç»„ä»¶ã€‚ ä¸è¿‡å®ƒä»¬çš„ç†å¿µæœ‰ä¸€å®šçš„å·®å¼‚æ€§ weex react-native Vue.js React write once, run anywhere learn once, write anywhere è¿™éƒ½ä¸æ˜¯æˆ‘ä»¬ä»Šå¤©çš„ä¸»è§’ï¼Œä»Šæ—¥ä¸»åœºå±äºWebViewï¼Œé‚£ä¹ˆæˆ‘ä»¬æ‰€é¢ä¸´çš„é—®é¢˜æ˜¯ï¼š H5é¡µé¢å¯åŠ¨æ—¶é—´ æµç¨‹åˆ†æä¸‹å›¾æ˜¯ä¸€ä¸ªH5é¡µé¢å±•ç¤ºè¿‡ç¨‹ä¸­è¦ç»å†çš„æµç¨‹ï¼š ç®€å•çš„é¡µé¢å¯èƒ½ä¼šæ²¡æœ‰JSè¯·æ±‚æ•°æ®è¿™ä¸€ä¸ªæ­¥éª¤ï¼Œä¸€èˆ¬é¡µé¢åœ¨ dom æ¸²æŸ“åèƒ½æ˜¾ç¤ºé›å½¢ï¼Œåœ¨è¿™ä¹‹å‰ç”¨æˆ·çœ‹åˆ°çš„éƒ½æ˜¯ç™½å±ï¼Œç­‰åˆ°ä¸‹è½½æ¸²æŸ“å›¾ç‰‡åæ•´ä¸ªé¡µé¢æ‰å®Œæ•´æ˜¾ç¤ºï¼Œæ‰“å¼€é¡µé¢ä¼˜åŒ–å°±æ˜¯è¦å‡å°‘è¿™ä¸ªè¿‡ç¨‹çš„è€—æ—¶ã€‚ ä¼˜åŒ–å‰ç«¯B/Sç»“æ„æ¨¡å¼ä¸Šå¯¹webçš„ä¼˜åŒ–å·²ç»æœ‰åšå¾—æ¯”è¾ƒæè‡´æ–¹æ³•ï¼Œæœ¬æ–‡å°±ä¸å†ä»‹ç»äº†ï¼ˆä½œä¸ºå®¢æˆ·ç«¯åŒå­¦ä¹Ÿæ²¡æœ‰ä»€ä¹ˆç»éªŒï¼‰è¿™é‡Œç»™ä¸€ä¸ªå‚è€ƒä¼ é€é—¨[5]ï¼šå”¯å¿«ä¸ç ´ï¼šWeb åº”ç”¨çš„ 13 ä¸ªä¼˜åŒ–æ­¥éª¤ æ¯”è¾ƒé‡è¦ä¹Ÿæ˜¯ä¼˜åŒ–æ•ˆæœæ¯”è¾ƒæ˜¾è‘—çš„æ˜¯èƒ½å¤Ÿç†Ÿæ‚‰HTTPç¼“å­˜åè®®ä½¿ç”¨ï¼Œè¿™ä¸ªéœ€è¦æœåŠ¡ç«¯é…åˆä¸€èµ·ä¼˜åŒ–ã€‚ å®¢æˆ·ç«¯å®¢æˆ·ç«¯ä¸Šçš„H5å±•ç¤ºè·Ÿä¼ ç»Ÿçš„webé¡µé¢æœ‰æ‰€ä¸åŒï¼Œæœ‰ä¼˜åŠ¿ä¹Ÿæ›´æœ‰åŠ£åŠ¿ã€‚ç›¸å¯¹äºPCç«¯çš„å¤„ç†å™¨ï¼Œç§»åŠ¨å®¢æˆ·ç«¯ä¸Šçš„CPUæ€§èƒ½ä¼šæœ‰æ‰€å·®è·ã€‚ä¸è¿‡ç”±äºå®¢æˆ·ç«¯çš„H5æ˜¯é€šè¿‡WebViewå†…åµŒåœ¨Appä¸­ï¼Œæƒ…å†µä¸ä¼šåƒä¼ ç»Ÿwebä¸€æ ·ï¼Œæ‰€æœ‰çš„ä¼˜åŒ–éƒ½å—é™åœ¨æµè§ˆå™¨ä¹‹ä¸‹ï¼Œåœ¨å®¢æˆ·ç«¯æˆ‘ä»¬å¯ä»¥æ‹¿åˆ°æ›´å¤šçš„æƒé™ï¼Œåšæ›´æ·±çš„ä¼˜åŒ–ã€‚ ç¼“å­˜ï¼ˆä¸»è¦é’ˆå¯¹iOSç«¯ï¼Œæ…è¯»ï¼å¤§ç‰‡OCä»£ç é£æ ¼å¯èƒ½å¼•èµ·æ‚¨çš„ä¸é€‚ï¼‰å®¢æˆ·ç«¯å¯ä»¥æ‹¦æˆªæ‰€æœ‰çš„ç½‘ç»œè¯·æ±‚ï¼Œå¹¶è‡ªå·±å®ç°ç¼“å­˜æœºåˆ¶ã€‚iOSç«¯çš„Cocoaæ¡†æ¶UIWebViewæä¾›äº†å®¢æˆ·ç«¯å±‚é¢çš„ç¼“å­˜ç­–ç•¥ï¼š 1234567NSURLRequestUseProtocolCachePolicy //ç¼“å­˜ç­–ç•¥å®šä¹‰åœ¨ web åè®®å®ç°ä¸­ï¼Œç”¨äºè¯·æ±‚ç‰¹å®šçš„URLã€‚æ˜¯é»˜è®¤çš„URLç¼“å­˜ç­–ç•¥ã€‚NSURLRequestReloadIgnoringLocalCacheData //ä»æœåŠ¡ç«¯è·å–æ•°æ®ï¼Œå¿½ç•¥æœ¬åœ°ç¼“å­˜NSURLRequestReloadIgnoringLocalAndRemoteCacheData //æºæ–‡ä»¶æ³¨é‡Šä¸­å†™åˆ°æ²¡æœ‰å®ç°NSURLRequestReloadIgnoringCacheData //è¢«NSURLRequestReloadIgnoringLocalCacheDataæ›¿æ¢äº†NSURLRequestReturnCacheDataElseLoad //å·²ç»å­˜åœ¨çš„ç¼“å­˜æ•°æ®ç”¨äºè¯·æ±‚è¿”å›ï¼Œä¸ç®¡å®ƒçš„è¿‡æœŸæ—¥æœŸå’Œå·²ç»å­˜åœ¨äº†å¤šä¹…ã€‚å¦‚æœæ²¡æœ‰è¯·æ±‚å¯¹åº”çš„ç¼“å­˜æ•°æ®ï¼Œä»æ•°æ®æºè¯»å–NSURLRequestReturnCacheDataDontLoad //å·²ç»å­˜åœ¨çš„ç¼“å­˜æ•°æ®ç”¨äºè¯·æ±‚è¿”å›ï¼Œä¸ç®¡å®ƒçš„è¿‡æœŸæ—¥æœŸå’Œå·²ç»å­˜åœ¨äº†å¤šä¹…ã€‚å¦‚æœæ²¡æœ‰è¯·æ±‚å¯¹åº”çš„ç¼“å­˜æ•°æ®ï¼Œä¸è¦å»æ•°æ®æºè¯»å–ï¼Œè¯¥è¯·æ±‚è¢«è®¾ç½®ä¸ºå¤±è´¥ï¼Œè¿™ç§æƒ…å†µå¤šç”¨äºç¦»çº¿æ¨¡å¼NSURLRequestReloadRevalidatingCacheData //æºæ–‡ä»¶ä¸­å†™åˆ°æ²¡æœ‰å®ç° å…¶ä¸­é»˜è®¤ç¼“å­˜ç­–ç•¥ï¼ˆæœ€é€šç”¨ï¼‰NSURLRequestUseProtocolCachePolicyçš„æµç¨‹å¦‚ä¸‹ï¼š å…¶å®æˆ‘ä»¬è‡ªå®šä¹‰ç¼“å­˜ç­–ç•¥ï¼ŒåŠ ä¸Šæ›´å¤šä¼˜åŒ–çš„ç‚¹ï¼Œæ¯”å¦‚è‡ªå®šä¹‰ç¼“å­˜çš„å­˜å‚¨æ–¹å¼èƒ½å¤Ÿå®ç°ç¦»çº¿ç¼“å­˜ï¼Œåˆèƒ½å¤Ÿå®æ—¶æ›´æ–°ï¼Œå®šä¹‰æœ¬åœ°ç¼“å­˜å¤±æ•ˆæ—¶é—´ç­‰ã€‚ è‡ªå®šä¹‰æµç¨‹çš„å®ç°åœ¨iOSä¸­æ˜¯é€šè¿‡ç»§æ‰¿NSURLProtocolæ‹¦æˆªå¤„ç†æ‰€æœ‰çš„ç½‘ç»œè¯·æ±‚æ¥å®ç°çš„ï¼Œè¿™æ˜¯æˆ‘çš„ä¸€ç§å®ç°æ–¹æ¡ˆï¼šYJURLProtocol å½“ç„¶GitHubä¸Šæœ‰å¾ˆå¤šå®ç°æ–¹æ¡ˆï¼Œæœ€å¥½æ˜¯æ ¹æ®è‡ªå·±çš„éœ€æ±‚å»è‡ªå®šä¹‰ã€‚ WKWebViewæ˜¯å¦æ”¯æŒNSURLProtocolï¼Ÿåœ¨ä½¿ç”¨WKWebViewåŠ è½½ç½‘é¡µçš„æ—¶å€™ï¼ŒNSURLProtocolå­ç±»ä¼šä¸èƒ½æ‹¦æˆªåˆ°è¯·æ±‚ï¼ŒåŸå› æ˜¯WKWebViewçš„è¯·æ±‚æ˜¯åœ¨å•ç‹¬çš„è¿›ç¨‹é‡Œï¼Œæ‰€ä»¥ä¸ä¼šèµ°NSURLProtocolã€‚å½“ç„¶è§£å†³åŠæ³•æ˜¯æœ‰çš„ï¼Œå› ä¸ºå…¶å®WKWebViewæ˜¯æ”¯æŒNSURLProtocolåè®®çš„ï¼Œåªæ˜¯è¿˜ä¸å¤Ÿå®Œå–„ï¼Œå½“å‰å¯ä»¥é€šè¿‡è°ƒç”¨ç§æœ‰çš„APIå»å®Œæˆè¿™é¡¹ä»»åŠ¡ï¼ˆè¯¦ç»†åˆ†æè¿‡ç¨‹è§å‚è€ƒ[6]ï¼‰,ä»¥ä¸‹æ˜¯å®ç°çš„å…³é”®ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041FOUNDATION_STATIC_INLINE Class ContextControllerClass() &#123; static Class cls; if (!cls) &#123; cls = [[[WKWebView new] valueForKey:@\"browsingContextController\"] class]; &#125; return cls;&#125;FOUNDATION_STATIC_INLINE SEL RegisterSchemeSelector() &#123; return NSSelectorFromString(@\"registerSchemeForCustomProtocol:\");&#125;FOUNDATION_STATIC_INLINE SEL UnregisterSchemeSelector() &#123; return NSSelectorFromString(@\"unregisterSchemeForCustomProtocol:\");&#125;@implementation NSURLProtocol (WebKitSupport)+ (void)wk_registerScheme:(NSString *)scheme &#123; Class cls = ContextControllerClass(); SEL sel = RegisterSchemeSelector(); if ([(id)cls respondsToSelector:sel]) &#123;#pragma clang diagnostic push#pragma clang diagnostic ignored \"-Warc-performSelector-leaks\" [(id)cls performSelector:sel withObject:scheme];#pragma clang diagnostic pop &#125;&#125;+ (void)wk_unregisterScheme:(NSString *)scheme &#123; Class cls = ContextControllerClass(); SEL sel = UnregisterSchemeSelector(); if ([(id)cls respondsToSelector:sel]) &#123;#pragma clang diagnostic push#pragma clang diagnostic ignored \"-Warc-performSelector-leaks\" [(id)cls performSelector:sel withObject:scheme];#pragma clang diagnostic pop &#125;&#125;@end é™„ä¸Šè§£å†³æ–¹æ¡ˆæºç ï¼šhttps://github.com/Yeatse/NSURLProtocol-WebKitSupportå…¶ä¸­ä¼šä½¿ç”¨åˆ°ç§æœ‰çš„APIï¼Œå…³äºä½¿ç”¨ç§æœ‰APIè‚¯å®šæ‹…å¿ƒçš„æ˜¯èƒ½ä¸èƒ½é€šè¿‡Appleçš„å®¡æ ¸ã€‚æ‘˜å½•ä¸€æ®µå‰ç™¾åº¦å·¥ç¨‹å¸ˆsunnyxxçš„æè¿°ï¼š å…³äºç§æœ‰APIå¤§å®¶ä¼šè´¨ç–‘è¯´ï¼Œè¿™ç”¨åˆ°äº† UIKit çš„ç§æœ‰å±æ€§å’Œç§æœ‰ APIï¼Œè¦æ˜¯ç³»ç»Ÿå‡çº§å˜äº†å’‹åŠï¼Ÿè¦æ˜¯å®¡æ ¸è¢«æ‹’äº†å’‹åŠï¼Ÿé¦–å…ˆï¼ŒiOS ç³»ç»Ÿçš„ SDK ä¸ºäº†å‘ä¸‹å…¼å®¹ï¼Œä¸€èˆ¬åªä¼šå¢åŠ æ–¹æ³•æˆ–è€…ä¿®æ”¹æ–¹æ³•å®ç°ï¼Œä¸å¤ªå¯èƒ½ç›´æ¥åˆ é™¤ä¸€ä¸ªå…±æœ‰æ–¹æ³•ï¼Œè€Œç§æœ‰æ–¹æ³•çš„è¡Œä¸ºç¡®å®å¯èƒ½æœ‰å˜åŒ–ï¼Œä½†ç³»ç»Ÿ release é¢‘ç‡æ¯•ç«Ÿå¾ˆä½ï¼Œæ¯å½“æ–°ç‰ˆæœ¬å‘å¸ƒæ—¶ check ä¸‹åŸæ¥çš„åŠŸèƒ½æ˜¯å¦èƒ½ work å°±å¥½äº†ï¼Œå¤§å¯ä¸å¿…æ‹…å¿ƒè¿™ä¹ˆè¿œï¼ŒSDK æ˜¯æ­»çš„äººæ˜¯æ´»çš„ã€‚ä¸è®ºæ˜¯ kvc è¿˜æ˜¯ selector åå°„ï¼Œéƒ½æ˜¯åˆ©ç”¨ objc runtime å®Œæˆçš„ï¼Œè€Œåˆ°äº†è¿™ä¸€å±‚ï¼ŒçœŸçš„å°±æ²¡å•¥å…¬æœ‰ç§æœ‰å¯è¨€äº†ã€‚è®¾æƒ³ä½ å°±æ˜¯å¼€å‘ Apple ç§æœ‰ API æ£€æŸ¥å·¥å…·çš„å·¥ç¨‹å¸ˆï¼Œç»™ä½ ä¸€ä¸ª ipa çš„åŒ…ï¼Œä½ ä¼šå¦‚ä½•æ£€æŸ¥å‡ºå…¶ä¸­æœ‰æ²¡æœ‰ç§æœ‰ API å‘¢ï¼Ÿ é¦–å…ˆï¼Œè¿™ä¸ªæ£€æŸ¥ä¸€å®šæ˜¯ä¸ªé™æ€æ£€æŸ¥ï¼Œä¸å¯èƒ½æ˜¯è¿è¡Œæ—¶æ£€æŸ¥ï¼Œå› ä¸ºä»£ç é€»è¾‘é‚£ä¹ˆå¤æ‚ï¼ŒæŠŠç¨‹åºè·‘èµ·æ¥çœ‹æ‰€æœ‰ objc_msgSend ä¸­åŒ…ä¸åŒ…æ‹¬ç§æœ‰è°ƒç”¨è¿™ä»¶äº‹å¤ªä¸ç°å®äº†ã€‚å¯¹ ipa æ–‡ä»¶åšé™æ€æ£€æŸ¥çš„è¯è‚¯å®šæ˜¯å»åˆ†æ Mach-O å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå› ä¸ºè¿™æ—¶å¾ˆå¤šæºä»£ç çº§åˆ«çš„ä¿¡æ¯å·²ç»ä¸¢å¤±ï¼Œç»åˆ†æå¯ä»¥é‡‡å–ä¸‹é¢å‡ ç§æ‰‹æ®µï¼š æ˜¯å¦ link äº†ç§æœ‰ framework æˆ–è€…å…¬å¼€ framework ä¸­çš„ç§æœ‰ç¬¦å·ï¼Œè¿™å¯ä»¥é˜²æ­¢å¼€å‘è€…æŠŠç§æœ‰ header éƒ½ dump å‡ºæ¥ä¾›ç¨‹åºç›´æ¥è°ƒç”¨ã€‚åŒä¸Šï¼Œä½¿ç”¨@selector(_private_sel)åŠ ä¸Š-performSelector:çš„æ–¹å¼ç›´æ¥è°ƒç”¨ç§æœ‰ APIã€‚æ‰«ææ‰€æœ‰ç¬¦å·ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰ç»§æ‰¿è‡ªç§æœ‰ç±»ï¼Œé‡è½½ç§æœ‰æ–¹æ³•ï¼Œæ–¹æ³•åæ˜¯å¦æœ‰é‡åˆã€‚æ‰«ææ‰€æœ‰stringï¼Œçœ‹å­—ç¬¦ä¸²å¸¸é‡æ®µæ˜¯å¦å‡ºç°å’Œç§æœ‰ API å¯¹åº”çš„ã€‚æˆ‘è§‰å¾—å‰ä¸‰æ¡è¢« catch ä½çš„å¯èƒ½æ€§æœ€é«˜ï¼Œä¹Ÿæœ€å®¹æ˜“è¢«æ£€æŸ¥å‡ºæ¥ã€‚å†æ¥çœ‹æˆ‘ä»¬ç”¨åˆ°ç”¨å­—ç¬¦ä¸²çš„æ–¹æ³• kvc å’Œ åå°„ selectorï¼Œåº”è¯¥å±äºæœ€åä¸€æ¡ï¼Œè¿™æ—¶å€™å°±å¾ˆéš¾æŠ‰æ‹©äº†ï¼Œæ‹¿ handleNavigationTransition: æ¥è¯´ï¼Œçœ‹ä¸Šå»äººç•œæ— å®³å•Šï¼Œæˆ‘è‡ªå·±ç±»é‡Œé¢çš„æ–¹æ³•ä¹Ÿå®Œå…¨å¯èƒ½å‘½åå‡ºè¿™ä¸ªæ¥ï¼Œæ‰€ä»¥å•å•å‡­å€Ÿå­—ç¬¦ä¸²å‘½ä¸­ç§æœ‰ API åˆ¤å®šï¼Œè‹¹æœå¾ˆå®¹æ˜“è¯¯ä¼¤ä¸€å¤§ç¥¨å¼€å‘è€…ã€‚ç»¼ä¸Šï¼Œæˆ‘è§‰å¾—ä½¿ç”¨å­—ç¬¦ä¸²çš„æ–¹å¼ä½¿ç”¨ç§æœ‰ API æ˜¯ç›¸å¯¹å®‰å…¨çš„ PS: iOS11ä¹‹åå¯ä»¥é€šè¿‡WKURLSchemeHandlerå»å®Œæˆå¯¹WKWebViewçš„è¯·æ±‚æ‹¦æˆª,ä¸éœ€è¦å†è°ƒç”¨ç§æœ‰APIè§£å†³ä¸Šè¿°é—®é¢˜äº†ã€‚ ä¸Šè¿°æ–¹æ¡ˆä¼¼ä¹å·²ç»å®Œç¾è§£å†³ç¼“å­˜é—®é¢˜ï¼Œä½†å®é™…ä¸Šè¿˜æœ‰å¾ˆå¤šé—®é¢˜ï¼š æ²¡æœ‰é¢„åŠ è½½ï¼šç¬¬ä¸€æ¬¡æ‰“å¼€çš„ä½“éªŒå¾ˆå·®ï¼Œæ‰€æœ‰æ•°æ®éƒ½è¦ä»ç½‘ç»œè¯·æ±‚ã€‚ ç¼“å­˜ä¸å¯æ§ï¼šç¼“å­˜çš„å­˜å–ç”±ç³»ç»Ÿ webview æ§åˆ¶ï¼Œæ— æ³•æ§åˆ¶å®ƒçš„ç¼“å­˜é€»è¾‘ï¼Œå¸¦æ¥çš„é—®é¢˜åŒ…æ‹¬ï¼š i. æ¸…ç†é€»è¾‘ä¸å¯æ§ï¼Œç¼“å­˜ç©ºé—´æœ‰é™ï¼Œå¯èƒ½ç¼“å­˜å‡ å¼ å¤§å›¾ç‰‡åï¼Œé‡è¦çš„ HTML/JS/CSS ç¼“å­˜å°±è¢«æ¸…é™¤äº†ã€‚ ii.ç£ç›˜ IO æ— æ³•æ§åˆ¶ï¼Œæ— æ³•ä»ç£ç›˜é¢„åŠ è½½æ•°æ®åˆ°å†…å­˜ã€‚ æ›´æ–°ä½“éªŒå·®ï¼šåå° HTML/JS/CSS æ›´æ–°æ—¶å…¨é‡ä¸‹è½½ï¼Œæ•°æ®é‡å¤§ï¼Œå¼±ç½‘ä¸‹è½½è€—æ—¶é•¿ã€‚ æ— æ³•é˜²åŠ«æŒï¼šè‹¥ HTML é¡µé¢è¢«è¿è¥å•†æˆ–å…¶ä»–ç¬¬ä¸‰æ–¹åŠ«æŒï¼Œå°†é•¿æ—¶é—´ç¼“å­˜åŠ«æŒçš„é¡µé¢ã€‚ è¿˜æœ‰ä¸€ä¸ªæ–¹æ¡ˆå°±æ˜¯ä½¿ç”¨zipåŒ…å­˜æ”¾HTMLæ–‡ä»¶å’Œèµ„æºæ–‡ä»¶ï¼Œè¿›è¡Œç»Ÿä¸€ç®¡ç†ã€‚ ç¦»çº¿H5 zip åŒ…ä»¥ä¸‹æ˜¯ç°ä»»èŒèš‚èšé‡‘æœçš„bangæä¾›çš„ä¸€ä¸ªæ¯”è¾ƒå®Œå–„çš„å®¢æˆ·ç«¯ç¦»çº¿åŒ…æ–¹æ¡ˆï¼š åç«¯ä½¿ç”¨æ„å»ºå·¥å…·æŠŠåŒä¸€ä¸ªä¸šåŠ¡æ¨¡å—ç›¸å…³çš„é¡µé¢å’Œèµ„æºæ‰“åŒ…æˆä¸€ä¸ªæ–‡ä»¶ï¼ŒåŒæ—¶å¯¹æ–‡ä»¶åŠ å¯†/ç­¾åã€‚ å®¢æˆ·ç«¯æ ¹æ®é…ç½®è¡¨ï¼Œåœ¨è‡ªå®šä¹‰æ—¶æœºå»æŠŠç¦»çº¿åŒ…æ‹‰ä¸‹æ¥ï¼Œåšè§£å‹/è§£å¯†/æ ¡éªŒç­‰å·¥ä½œã€‚ æ ¹æ®é…ç½®è¡¨ï¼Œæ‰“å¼€æŸä¸ªä¸šåŠ¡æ—¶è½¬æ¥åˆ°æ‰“å¼€ç¦»çº¿åŒ…çš„å…¥å£é¡µé¢ã€‚ æ‹¦æˆªç½‘ç»œè¯·æ±‚ï¼Œå¯¹äºç¦»çº¿åŒ…å·²ç»æœ‰çš„æ–‡ä»¶ï¼Œç›´æ¥è¯»å–ç¦»çº¿åŒ…æ•°æ®è¿”å›ï¼Œå¦åˆ™èµ° HTTP åè®®ç¼“å­˜é€»è¾‘ã€‚ ç¦»çº¿åŒ…æ›´æ–°æ—¶ï¼Œæ ¹æ®ç‰ˆæœ¬å·åå°ä¸‹å‘ä¸¤ä¸ªç‰ˆæœ¬é—´çš„ diff æ•°æ®ï¼Œå®¢æˆ·ç«¯åˆå¹¶ï¼Œå¢é‡æ›´æ–°ã€‚ æˆ‘åœ¨é¡¹ç›®ä¸­å‡†å¤‡å®è·µè¿™ä¸ªæ–¹æ¡ˆï¼Œå½“å‰åªä½¿ç”¨äº†ä¸€æ­¥ï¼Œé…ç½®ä¸šåŠ¡è½¬æ¥å…¥å£+æœ¬åœ°zipåŒ…è§£å¯†è§£å‹è¿›è¡ŒåŠ è½½ã€‚ é¡¹ç›®ä½¿ç”¨SSZipArchiveå¯¹zipåŒ…è¿›è¡Œè§£å‹ï¼Œæ”¾åˆ°temporaryç›®å½•åŠ è½½èµ„æºã€‚è§£å‹zipåŒ…å’Œè¿ç§»æ–‡ä»¶çš„å·¥ä½œæ”¾åœ¨Appå¯åŠ¨ä¹‹åçš„å¼‚æ­¥çº¿ç¨‹æ‰§è¡Œï¼Œä¸ä¼šå½±å“Appçš„å¯åŠ¨é€Ÿåº¦ã€‚ 12345- (void)unZipFile &#123; NSString *zipFile = [[NSBundle mainBundle] pathForResource:@\"dist\" ofType:@\"zip\"]; NSString *destinationPath = [NSURL fileURLWithPath:NSTemporaryDirectory()].path; [SSZipArchive unzipFileAtPath:zipFile toDestination:destinationPath overwrite:YES password:@\"******\" error:nil];&#125; å…³äºç¦»çº¿åŒ…çš„å¢é‡æ›´æ–°æ–¹æ¡ˆçš„å‚è€ƒ:å®ç°å‰ç«¯èµ„æºå¢é‡å¼æ›´æ–°çš„ä¸€ç§æ€è·¯ä¸¤ç§å¢é‡æ›´æ–°æ–¹æ¡ˆ è¿™ä¸€å—è¿˜æœ‰å¾ˆå¤šéœ€è¦å®è·µçš„ç‚¹.. é¢„åŠ è½½ webviewæ— è®ºæ˜¯ iOS è¿˜æ˜¯ Androidï¼Œæœ¬åœ° webview åˆå§‹åŒ–éƒ½è¦ä¸å°‘æ—¶é—´ï¼Œå¯ä»¥é¢„å…ˆåˆå§‹åŒ–å¥½ webviewã€‚è¿™é‡Œåˆ†ä¸¤ç§é¢„åŠ è½½ï¼š é¦–æ¬¡é¢„åŠ è½½ï¼šåœ¨ä¸€ä¸ªè¿›ç¨‹å†…é¦–æ¬¡åˆå§‹åŒ– webview ä¸ç¬¬äºŒæ¬¡åˆå§‹åŒ–ä¸åŒï¼Œé¦–æ¬¡ä¼šæ¯”ç¬¬äºŒæ¬¡æ…¢å¾ˆå¤šã€‚åŸå› é¢„è®¡æ˜¯ webview é¦–æ¬¡åˆå§‹åŒ–åï¼Œå³ä½¿ webview å·²ç»é‡Šæ”¾ï¼Œä½†ä¸€äº›å¤š webview å…±ç”¨çš„å…¨å±€æœåŠ¡æˆ–èµ„æºå¯¹è±¡ä»æ²¡æœ‰é‡Šæ”¾ï¼Œç¬¬äºŒæ¬¡åˆå§‹åŒ–æ—¶ä¸éœ€è¦å†ç”Ÿæˆè¿™äº›å¯¹è±¡ä»è€Œå˜å¿«ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ APP å¯åŠ¨æ—¶é¢„å…ˆåˆå§‹åŒ–ä¸€ä¸ª webview ç„¶åé‡Šæ”¾ï¼Œè¿™æ ·ç­‰ç”¨æˆ·çœŸæ­£èµ°åˆ° H5 æ¨¡å—å»åŠ è½½ webviewæ—¶å°±å˜å¿«äº†ã€‚ webview æ± ï¼šå¯ä»¥ç”¨ä¸¤ä¸ªæˆ–å¤šä¸ª webview é‡å¤ä½¿ç”¨ï¼Œè€Œä¸æ˜¯æ¯æ¬¡æ‰“å¼€ H5 éƒ½æ–°å»º webviewã€‚ä¸è¿‡è¿™ç§æ–¹å¼è¦è§£å†³é¡µé¢è·³è½¬æ—¶æ¸…ç©ºä¸Šä¸€ä¸ªé¡µé¢ï¼Œå¦å¤–è‹¥ä¸€ä¸ª H5 é¡µé¢ä¸Š JS å‡ºç°å†…å­˜æ³„æ¼ï¼Œå°±å½±å“åˆ°å…¶ä»–é¡µé¢ï¼Œåœ¨ APP è¿è¡ŒæœŸé—´éƒ½æ— æ³•é‡Šæ”¾äº†ã€‚ æ€»ç»“WebViewå±‚é¢åŠ è½½æé«˜æ€§èƒ½æœ€å¤§çš„ä¼˜åŒ–æ–¹å‘è¿˜æ˜¯ç¼“å­˜ï¼Œé¢„åŠ è½½ï¼Œåœ¨æœ‰é™çš„èµ„æºå’Œæ—¶é—´å†…æ›´åˆç†åœ°è°ƒåº¦èµ„æºã€‚ Reference [1]. Httpç¼“å­˜ [2]. ç§»åŠ¨ H5 é¦–å±ç§’å¼€ä¼˜åŒ–æ–¹æ¡ˆæ¢è®¨ [3]. WebViewæ€§èƒ½ã€ä½“éªŒåˆ†æä¸ä¼˜åŒ– [4]. 70%ä»¥ä¸Šä¸šåŠ¡ç”±H5å¼€å‘ï¼Œæ‰‹æœºQQ Hybrid çš„æ¶æ„å¦‚ä½•ä¼˜åŒ–æ¼”è¿›ï¼Ÿ [5]. å”¯å¿«ä¸ç ´ï¼šWeb åº”ç”¨çš„ 13 ä¸ªä¼˜åŒ–æ­¥éª¤ [6]. ä¸€ä¸ªå®Œç¾çš„åŠæˆå“-WKWebView","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"CheckBox in React Native","date":"2018-04-05T03:54:23.000Z","path":"2018/04/05/CheckBox-in-RN/","text":"å…³äºRN CheckBoxç»„ä»¶åœ¨å†™hello worldè¿‡ç¨‹ä¸­iOSåŒå­¦å‘ç°CheckBoxç»„ä»¶å±•ç¤ºä¸äº†ï¼Œä½†æ˜¯æ–‡æ¡£ä¸Šç¡®ç¡®å®å®æ˜¯å­˜åœ¨è¿™ä¸ªç»„ä»¶çš„ä»‹ç»çš„ï¼Œåªä¸è¿‡æ²¡æœ‰demoã€‚ æˆ‘æŸ¥äº†æºç çš„CheckBoxå®ç°å’Œå‘å¸ƒè¯´æ˜å‘ç°ä»¥ä¸‹ä¿¡æ¯ï¼Œåˆ†äº«ä¸‹ï¼š CheckBox è¿™ä¸ªç»„ä»¶æ˜¯åœ¨ RN v0.49.0ç‰ˆæœ¬å¼•å…¥ï¼Œè¿™æ˜¯CheckBoxçš„é¦–ç°ç‰ˆæœ¬çš„è¯´æ˜ï¼š https://github.com/facebook/react-native/releases/tag/v0.49.0 å¯ä»¥çœ‹åˆ°å½“æ—¶åªæ˜¯å‘å¸ƒåœ¨äº†Androidçš„æ–°åŠŸèƒ½åˆ—è¡¨ä¸­ ä»¥ä¸‹æ˜¯0.49.0ç‰ˆæœ¬ä¸­å…³äºCheckBoxçš„æºç ï¼šhttps://github.com/facebook/react-native/commit/84b11dd5185c017a316510de6ace608dc82321e8 commit è®°å½•ä¸­ä¹Ÿè¯´æ˜æ˜¯Androidçš„åŠŸèƒ½ 1234Add Android React Native CheckboxReviewed By: achen1Differential Revision: D5281736fbshipit-source-id: 9a3c93eeace2d80be4ddbd4ffc3258c1d3637480 åæ¥ä¼°è®¡å¾ˆå¤šiOSçš„åŒå­¦å»ä½¿ç”¨äº†CheckBoxï¼Œæ¯•ç«Ÿæ–‡æ¡£ä¸­æ²¡æœ‰ç‰¹åˆ«è¯´æ˜åªæœ‰Androidå¯ä»¥ä½¿ç”¨(iOSåŒå­¦ä½¿ç”¨ä¼šæŠ¥é”™)ã€‚äºæ˜¯åœ¨v0.50.0ç‰ˆæœ¬çš„æ›´æ–°è¯´æ˜ä¸­ï¼Œç‰¹åœ°å¯¹CheckBoxæ·»åŠ äº†æ³¨é‡Šï¼Œå¹¶ä¿®æ”¹æ–‡ä»¶åï¼ŒåŠ äº†Androidå­—æ ·ğŸ™ƒ 1../Libraries/Components/CheckBox/CheckBox.js ä¿®æ”¹ä¸ºï¼š 1&apos;../Libraries/Components/CheckBox/CheckBox.android.js&apos;, å¹¶ä¸”æ·»åŠ äº†ä¸€ä¸ªæ–°çš„æ–‡ä»¶iOSç‰ˆæœ¬çš„CheckBoxï¼å–œå‡ºæœ›å¤–ï¼ ç»“æœiOSçš„å®ç°å¦‚ä¸‹ï¼š ğŸ¤”ğŸ¤”ğŸ¤”æ€è€ƒäººç”Ÿâ€¦ğŸ¤”ğŸ¤”ğŸ¤” ä»¥ä¸‹æ˜¯è¿™æ¬¡ï¼ˆ0.50.0ï¼‰å…³äºCheckBoxçš„commitä¿¡æ¯ 12345678910111213141516171819202122Use UnimplementedView for CheckBox on iOSSummary:`CheckBox` component was introduced in v0.49.0 and not implemented on iOS.Users who are trying to use `CheckBox` on iOS will get a warning that&gt; Native component for &quot;AndroidCheckBox&quot; does not existWe should declare in the document that this component is Android only and use `UnimplementedView` for iOS.- Use `react-native init` new project- Apply pull request changes- Add `&lt;Checkbox /&gt;` after welcome text in `App.js`- Run the app in iOS simulatorCloses #16211Differential Revision: D6005393Pulled By: hramosfbshipit-source-id: 1c9b68b5e1c933496c4d7c2f487f0500264b603a æå–ä¸€ä¸‹å…³é”®å­—çœ¼ï¼š use UnimplementedView for iOS. UnimplementedViewæ˜¯å•¥ï¼Ÿä¸€è„¸æ‡µX æŸ¥æºç å‘—ï¼Œä»¥ä¸‹æ˜¯UnimplementedView.jsä¸­çš„å®ç° æºç åœ°å€ 12345678910111213141516171819202122232425262728class UnimplementedView extends React.Component&lt;$FlowFixMeProps&gt; &#123; setNativeProps() &#123; // Do nothing. // This method is required in order to use this view as a Touchable* child. // See ensureComponentIsNative.js for more info &#125; render() &#123; // Workaround require cycle from requireNativeComponent const View = require('View'); return ( &lt;View style=&#123;[styles.unimplementedView, this.props.style]&#125;&gt; &#123;this.props.children&#125; &lt;/View&gt; ); &#125;&#125;const styles = StyleSheet.create(&#123; unimplementedView: __DEV__ ? &#123; alignSelf: 'flex-start', borderColor: 'red', borderWidth: 1, &#125; : &#123;&#125;,&#125;); å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªUnimplementedViewåœ¨DEVæ¨¡å¼ä¸‹ä¼šæä¾›1ä¸ªå•ä½çš„çº¢æ¡†ï¼ˆå¦‚æœæˆ‘ä»¬ä½¿ç”¨çš„æ—¶å€™æ²¡æœ‰æŒ‡å®šstyleï¼‰ã€‚ é™¤æ­¤ä¹‹å¤–å°±æ˜¯ä¸ªç©ºçš„Viewâ€¦ æ‰€ä»¥iOSçš„åŒå­¦è¦ä½¿ç”¨ç±»ä¼¼CheckBoxçš„ç»„ä»¶ï¼Œå°±è‡ªå·±å®ç°æˆ–è€…æ‰¾ä¸‰æ–¹æ³•çš„å®ç°å§ã€‚å…¶å®ï¼ŒCheckBoxçš„å•é€‰åŠŸèƒ½ï¼Œå¯¹åº”åœ¨iOSä¸Šçš„ç»„ä»¶åº”è¯¥æ˜¯Switchæ§ä»¶å–½ï¼Œå¤šé€‰çš„è¯æˆ‘ä¸€èˆ¬æ˜¯ä½¿ç”¨Buttonå®ç°ã€‚ è§ä»è§æ™ºï¼Œç½‘ä¸Šä¹Ÿæœ‰åˆ«äººå®ç°çš„CheckBoxï¼Œä¾‹å¦‚ä»Šå¤©è¢«æˆ‘è¯¯è§£ä¸ºRNè‡ªå¸¦åº“çš„è¿™å®¶ä¼™ï¼ˆè°è®©ä»–åå­—è¿™ä¹ˆå®˜æ–¹èŒƒï¼‰ï¼šhttps://www.npmjs.com/package/react-native-checkbox, ä¸è¿‡è¿™Staræ•°ä¹Ÿä¸å¤šå“ˆå“ˆã€‚ ä¹‹åä½¿ç”¨çš„æ—¶å€™å¤šå¤šå°è¯•å§~","tags":[{"name":"React Native","slug":"React-Native","permalink":"http://www.yangjie.hu//tags/React-Native/"}]},{"title":"æœºå™¨å­¦ä¹ -ç»Ÿè®¡åŸºç¡€-Tæ£€éªŒï¼ˆ2ï¼‰","date":"2018-02-08T03:09:59.000Z","path":"2018/02/08/æœºå™¨å­¦ä¹ -ç»Ÿè®¡åŸºç¡€-tæ£€éªŒï¼ˆ2ï¼‰/","text":"tæ£€éªŒçš„å¥½å¤„æ˜¯æˆ‘ä»¬ä¸éœ€è¦çŸ¥é“æ€»ä½“çš„å‚æ•° ä½†æ˜¯ æˆ‘ä»¬éœ€è¦çŸ¥é“ æ ·æœ¬å‡å€¼ å’Œ æ¯ä¸ªæ ·æœ¬é‡ä»¥åŠå®ƒä»¬çš„ æ ‡å‡†åå·® stdevæ˜¯excleä¸­è®¡ç®—æ ‡å‡†åå·®çš„å‡½æ•° è®¡ç®—tç»Ÿè®¡é‡ æ ‡å‡†è¯¯å·® è®¡ç®—tç»Ÿè®¡é‡ å†³ç­–ä½¿ç”¨tä¸´ç•Œå€¼æ¥è¿›è¡Œè·Ÿtç»Ÿè®¡é‡è¿›è¡Œæ¯”è¾ƒ åˆå¹¶æ–¹å·®ï¼ˆPooled varianceï¼‰ æ ¡æ­£çš„æ ‡å‡†è¯¯å·® ä½¿ç”¨åˆå¹¶æ–¹å·®çš„æ—¶å€™çš„å‰ææ¡ä»¶ Xå’ŒYåº”è¯¥æ˜¯æ¥è‡ªä¸¤ä¸ªç‹¬ç«‹æ€»ä½“çš„éšæœºæ ·æœ¬ Xå’ŒYæ¥è‡ªçš„æ€»ä½“åº”è¯¥å¤§æ¦‚æ˜¯æ­£æ€çš„ æ ·æœ¬æ•°æ®å¯ä»¥ç”¨æ¥ä¼°è®¡æ€»ä½“æ–¹å·® æ€»ä½“æ–¹å·®åº”è¯¥å¤§æ¦‚ç›¸ç­‰ï¼Œä½¿æˆ‘èƒ½èƒ½å¤Ÿå°†è¿™ä¸ªåˆå¹¶æ–¹å·®ä½œäºŒè€…çš„ä¼°è®¡å€¼","tags":[{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://www.yangjie.hu//tags/Machine-Learning/"}]},{"title":"æœºå™¨å­¦ä¹ -ç»Ÿè®¡åŸºç¡€-Tæ£€éªŒ","date":"2018-02-08T03:09:26.000Z","path":"2018/02/08/æœºå™¨å­¦ä¹ -ç»Ÿè®¡åŸºç¡€-tæ£€éªŒ/","text":"æ¦‚å¿µè®°å½•tåˆ†å¸ƒæ˜¯ç”¨è‡ªç”±åº¦æ¥å®šä¹‰è‡ªç”±åº¦ï¼ˆDegrees of freedomï¼‰ è‡ªç”±åº¦-é€‰æ‹©nä¸ªæ•°å­—: è‡ªç”±åº¦æ˜¯n è‡ªç”±åº¦-æ·»åŠ è‡³10: æœ‰nä¸ªæ•°å­—ç›¸åŠ ç­‰äº10ï¼Œé‚£è‡ªç”±åº¦å°±ä¸ºn-1 è‡ªç”±åº¦-è¾¹é™…æ€»æ•°: ï¼ˆn*nï¼‰çš„è¡¨æ ¼è‡ªç”±åº¦å°±æœ‰(n-1)*(n-1) éšç€è‡ªç”±åº¦çš„å¢å¤§ï¼Œtåˆ†å¸ƒä¼šè¶Šæ¥è¶Šæ¥è¿‘äºæ­£æ€åˆ†å¸ƒ tè¡¨æ ¼tè¡¨æ˜¾ç¤ºçš„æ˜¯ä¸´ç•Œå€¼ï¼Œå·¦è¾¹æ˜¾ç¤ºçš„æ˜¯è‡ªç”±åº¦ï¼Œå³è¾¹ï¼ˆé¡¶éƒ¨ï¼‰æ˜¾ç¤ºçš„æ˜¯å³å°¾çš„é¢ç§¯ï¼Œ åº•éƒ¨çš„æ˜¯ç½®ä¿¡åŒºé—´tè¡¨æ ¼ å¤§å›¾ç‚¹å‡»è¿™é‡Œ å½±å“tç»Ÿè®¡é‡ å°†tåˆ†å¸ƒçš„ä¸­å¿ƒæ”¾åœ¨ Î¼0 å¤„ï¼Œç„¶åçœ‹çœ‹xæ‹”ä½äºè¿™ä¸ªåˆ†å¸ƒçš„é‚£ä¸ªä½ç½®ï¼Œxæ‹”è¶Šé è¿‘ä¸¤ç«¯ï¼Œæ›´æœ‰å¯èƒ½æ‰€æ¥è‡ªçš„æ€»ä½“çš„å‡å€¼å’Œ Î¼0 æ˜¾è‘—ä¸åŒã€‚ På€¼På€¼ç­‰äºtç»Ÿè®¡é‡åœ¨çº¢è‰²çš„åŒºåŸŸå†…çš„æ¦‚ç‡ å½“På€¼å°äºÎ±æ°´å¹³æ—¶ï¼Œæˆ‘ä»¬ä¼šæ‹’ç»é›¶å‡è®¾ ä½¿ç”¨GraphPadæ¥æ‰¾åˆ°På€¼ ã€ç–‘é—®ã€‘ ç»Ÿè®¡æ˜¾è‘—æ€§ (statistically significant)æ ¹æ®ä¸€èˆ¬è§„åˆ™ï¼Œé€šå¸¸Î±æ°´å¹³ç­‰äº0.05ï¼Œ è¿™ä¸€å·®åˆ«ä¸å…·æœ‰ç»Ÿè®¡æ˜¾è‘—æ€§ æ‹’ç»é›¶å‡è®¾ï¼Œä»£è¡¨å…·æœ‰ç»Ÿè®¡æ˜¾è‘—æ€§ Cohenâ€™s dä»¥ç»Ÿè®¡å­¦å®¶Jacob Cohenå‘½å Cohenâ€™s d æ˜¯ä¸€ç§æ•ˆåº”é‡åº¦é‡ç”¨æ¥è¡¡é‡ä¸¤ä¸ªå‡å€¼ä¹‹é—´çš„æ ‡å‡†åŒ–å‡å€¼å·®ï¼ˆä»¥æ ‡å‡†åå·®ä¸ºå•ä½ï¼‰ï¼Œ é™¤ä»¥çš„æ˜¯æ ·æœ¬æ ‡å‡†å·® ç½®ä¿¡åŒºé—´(xÌ…-t*S/âˆšnï¼Œ xÌ…+t*S/âˆšnï¼‰ è¯¯å·®èŒƒå›´t*S/âˆšn ç›¸ä¾æ ·æœ¬å¦‚æœåŒæ„å—è¯•è€…å‚åŠ ä¸¤æ¬¡æµ‹è¯•ï¼Œåˆ™è¿™ä¸¤æ¬¡ç»“æœæ˜¯ç›¸ä¾æ ·æœ¬ã€‚ä¸ºäº†è¡¡é‡è¿™äº›å€¼ä¹‹é—´çš„å·®åˆ« Di = xi - yi Î¼Q - Î¼A = Î¼D ç›¸ä¾æ ·æœ¬tæ£€éªŒ è®¾è®¡ç±»å‹10a 31 é‡å¤è¡¡é‡è®¾è®¡(Two conditions) æ£€éªŒå¹¶è¡¡é‡ä¸åŒæ¡ä»¶ä¸‹çš„æ ·æœ¬ é›¶å‡è®¾æ˜¯æŒ‡è¿™ä¸¤ä¸ªæ¡ä»¶ä¸‹çš„å‡å€¼å°†ç›¸åŒ çºµå‘è®¾è®¡ï¼ˆGrowth over time [longitudinal study] ï¼‰ åœ¨ä¸€ä¸ªæ—¶é—´æ®µè¡¡é‡æŸä¸ªå˜é‡ï¼Œåœ¨æ™šäº›æ—¶å€™çš„æŸä¸ªæ—¶é—´ç‚¹å†è¡¡é‡åŒä¸€å˜é‡ é›¶å‡è®¾ä¹Ÿæ˜¯ä¸¤ä¸ªæ€»ä½“å‡å€¼ç›¸åŒï¼Œè·Ÿé‡å¤è¡¡é‡è®¾è®¡ä¸åŒçš„æ˜¯åœ¨è¡¡é‡å˜é‡æ—¶ä¸­é—´é—´éš”äº†å¾ˆé•¿æ—¶é—´ é¢„æœŸæ£€éªŒå’ŒåæœŸæ£€éªŒ(pre-test, post-test) å…ˆè¡¡é‡æŸä¸ªå˜é‡ï¼Œç„¶åè¿›è¡ŒæŸç§å¤„ç†ï¼Œç„¶ååœ¨å¤„ç†ä¹‹åå†å¯¹åŒä¸€æ ·æœ¬è¡¡é‡åŒä¸€å˜é‡ï¼Œçœ‹çœ‹å¤„ç†æªæ–½æ˜¯å¦å¯¼è‡´äº†æ˜¾è‘—çš„æ•ˆåº” é›¶å‡è®¾æ˜¯ä¿æŒä¸å˜ï¼Œå³åœ¨å¤„ç†å‰å’Œå¤„ç†åæ”¹å˜é‡æ²¡æœ‰å‡ºç°æ˜¾è‘—çš„å˜åŒ– ç›¸ä¾æ ·æœ¬çš„ä¼˜ç¼ºç‚¹Advantages æ§åˆ¶ä¸ªä½“å·®å¼‚æ€§ ä½¿ç”¨æ›´å°‘çš„å—è¯•è€… æˆæœ¬æ›´ä½ èŠ±è´¹æ—¶é—´æ›´å°‘ å¼€æ”¯æ›´å°‘ Disadvantages æ®‹ç•™æ•ˆåº”ï¼ˆå› ä¸ºæ§åˆ¶ä¸ªä½“å·®å¼‚æ€§ï¼Œä½¿ä¸ªä½“å‚ä¸äº†ä¸¤æ¬¡è¯•éªŒï¼Œç¬¬ä¸€æ¬¡è¯•éªŒå¯èƒ½ä¼šå½±å“åˆ°ç¬¬äºŒæ¬¡çš„ç»“æœï¼‰ è¯•éªŒçš„å¤„ç†é¡ºåºå¯èƒ½ä¼šå½±å“åˆ°ç»“æœ ç‹¬ç«‹æ ·æœ¬ç‹¬ç«‹æ ·æœ¬çš„ä¼˜åŠ¿å°±æ˜¯ç›¸ä¾æ ·æœ¬çš„åŠ£åŠ¿ï¼ŒåŠ£åŠ¿æ˜¯ç›¸ä¾æ ·æœ¬çš„ä¼˜åŠ¿ å¼€å±•å®éªŒæ€§æ£€éªŒå¯¹å—è¯•è€…å®æ–½å¤„ç†æªæ–½ï¼Œæˆ–å¼€å±•è§‚å¯Ÿæ€§æ£€éªŒï¼Œæˆ‘ä»¬åªæ˜¯è§‚å¯Ÿä¸¤ç»„ä¸åŒæ€»ä½“çš„ç‰¹æ€§ æ•ˆåº”é‡åœ¨å®éªŒæ€§ç ”ç©¶ä¸­ï¼Œæˆ–å­˜åœ¨å¤„ç†å˜é‡çš„ç ”ç©¶ä¸­ï¼Œæ•ˆåº”é‡æ˜¯æŒ‡å¤„ç†æ•ˆåº”çš„å¤§å°åœ¨éå®éªŒæ€§ç ”ç©¶ä¸­ï¼Œæ•ˆåº”é‡æ˜¯æŒ‡å˜é‡ä¹‹é—´çš„å…³ç³»å¼ºåº¦ï¼Œåœ¨zæ£€éªŒæˆ–è€…tæ£€éªŒä¸­ï¼Œæœ€ç®€å•çš„æ•ˆåº”é‡è¡¡é‡æŒ‡æ ‡æ˜¯å‡å€¼å·®å¼‚ ç»Ÿè®¡æ˜¾è‘—æ€§ï¼ˆstatistically significantï¼‰ç»Ÿè®¡æ˜¾è‘—æ€§çŸ¥è¯†è¡¨ç¤ºç»“æœå¯èƒ½ä¸æ˜¯å¶ç„¶å‘ç”Ÿçš„ï¼Œåœ¨è§£é‡Šç»“æœæ—¶æ’é™¤äº†éšæœºå› ç´ æˆ–æŠ½æ ·é”™è¯¯ å¦‚ä½•åˆ¤æ–­æŸä¸ªè°ƒæŸ¥ç ”ç©¶çš„ç»“æœæ˜¯å¦æœ‰æ„ä¹‰ åº¦é‡çš„æ˜¯ä»€ä¹ˆï¼Ÿ æ•ˆåº”æœ‰å¤šå¤§ï¼Ÿ åœ¨è§£é‡Šç»“æœæ—¶èƒ½æ’é™¤éšæœºå› ç´ å—ï¼Ÿ è§£é‡Šç»“æœæ—¶èƒ½æ’é™¤æ½œåœ¨å˜é‡å—ï¼Ÿ r^2r^2è¡¨ç¤ºçš„æ˜¯ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„å…³ç³»ç¨‹åº¦ä¹Ÿç§°ä¸ºç¡®å®šç³»æ•°ã€‚r^2æ˜¯ä¸€ä¸ªæ¯”ä¾‹ï¼ŒèŒƒå›´ä»0åˆ°1. 0ä»£è¡¨ä¸¤ä¸ªå˜é‡æ ¹æœ¬æ²¡æœ‰å…³ç³»ï¼Œ1ä»£è¡¨ä¸¤ä¸ªå˜é‡å®Œå…¨ç›¸å…³ è¿™é‡Œçš„tä¸æ˜¯ä¸´ç•Œå€¼ï¼Œæ˜¯ä»tæ£€éªŒä¸­è·å¾—çš„å€¼ æŠ¥å‘Šç»“æœAPA Style tæ£€éªŒt(df) = X.XX, p=.XX, directiontå€¼ï¼Œpå€¼ï¼Œå•å°¾æ£€éªŒè¿˜æ˜¯åŒå°¾æ£€éªŒ ç½®ä¿¡åŒºé—´95% CI = ï¼ˆ4,6ï¼‰ æ•ˆåº”é‡d = X.XX, r^2 = .XX tæ£€éªŒå…¬å¼","tags":[{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://www.yangjie.hu//tags/Machine-Learning/"}]},{"title":"æœºå™¨å­¦ä¹ -ç»Ÿè®¡åŸºç¡€-å‡è®¾æ£€éªŒ","date":"2018-02-08T03:09:08.000Z","path":"2018/02/08/æœºå™¨å­¦ä¹ -ç»Ÿè®¡åŸºç¡€-å‡è®¾æ£€éªŒ/","text":"æ¦‚å¿µè®°å½•Î± æ°´å¹³ä¸å¤ªå¯èƒ½å‘ç”Ÿçš„æ¦‚ç‡å«åš Î± æ°´å¹³ Zä¸´ç•Œå€¼ (Z critical value)å°†ä¸´ç•ŒåŒºå’Œå…¶ä»–åŒºåŸŸåˆ†å¼€çš„Zå€¼ä¸º Zçš„ä¸´ç•Œå€¼ Zä¸´ç•Œå€¼0.001ï¼Œ è¿™æ—¶å€™åœ¨Zè¡¨ä¸­æœ‰è·Ÿå¤šä¸ª0.9990ï¼Œéœ€è¦é€‰æ‹©ç¬¬ä¸€ä¸ªã€‚Zå€¼ä¸ºæ­£è´Ÿ3.08 ä¸´ç•ŒåŒºå¦‚æœæ ·æœ¬å‡å€¼å¤„äºä¸´ç•ŒåŒºä¸­ï¼Œè¡¨æ˜æˆ‘ä»¬çš„æ ·æœ¬ç»Ÿè®¡æ•°æ®ä¸æ€»ä½“å‚æ•°éå¸¸ä¸åŒï¼Œå¾ˆå¯èƒ½é‡‡å–äº†ä»»ä½•å½¢å¼çš„è®¤ä¸ºå¤„ç†æªæ–½ å•å°¾æ£€éªŒå•å°¾æ£€éªŒå³æ–¹å‘æ€§å‡è®¾æ£€éªŒï¼Œåªå…³å¿ƒä¸€ä¸ªæ–¹å‘ä¸Šçš„æ•ˆåº” Î± = 0.05æ—¶ï¼Œï¼ˆå•å°¾æ£€éªŒï¼‰çš„Zä¸´ç•Œå€¼æ˜¯å¤šå°‘ï¼Ÿ ã€1.64ã€‘ æœ«ç«¯çš„æ¦‚ç‡ä¹Ÿè¿˜æ˜¯0.025 åŒå°¾æ£€éªŒåŒå°¾æ£€éªŒé€šå¸¸ä½¿ç”¨åœ¨éæ–¹å‘æ€§æ£€éªŒã€‚ è®¡ç®—åŒå°¾ä¸´ç•Œå€¼0.01ï¼Œ å³æ¯ä¸ªæœ«ç«¯çš„æ¦‚ç‡ä¸º0.005 å‡è®¾é›¶å‡è®¾ &amp; å¯¹ç«‹å‡è®¾ é›¶å‡è®¾æ˜¯æŒ‡å¹²é¢„åçš„æ€»ä½“å’Œå½“å‰æ€»ä½“å‚æ•°ä¹‹é—´æ²¡æœ‰æ˜¾è‘—å·®åˆ« å¯¹ç«‹å‡è®¾å¯ä»¥ä½¿ä¸€ä¸‹ä¸‰ç§æƒ…å†µï¼š å½“å‰æ€»ä½“æ¯”å¹²é¢„åçš„å° å½“å‰æ€»ä½“æ¯”å¹²é¢„åçš„å¤§ å½“å‰æ€»ä½“å’Œå¹²é¢„ååªæ˜¯ä¸åŒ æ‹’ç»é›¶å‡è®¾ï¼ˆReject the nullï¼‰æ‹’ç»é›¶å‡è®¾ï¼Œåˆ™è¡¨æ˜æ¥å—å¯¹ç«‹å‡è®¾ã€‚å³å­˜åœ¨æ˜¾è‘—çš„å·®è·ã€‚æ¦‚ç‡å¾ˆå°ï¼Œæ¯” Î± æ°´å¹³è¿˜å°å°±å¯ä»¥æ‹’ç»é›¶å‡è®¾ å†³ç­–å¤±è¯¯H0: é›¶å‡è®¾æˆç«‹ HAï¼š å¯¹ç«‹å‡è®¾æˆç«‹ Iå‹é”™è¯¯ï¼š æˆ‘æ‹’ç»é›¶å‡è®¾ï¼Œå…¶å®é›¶å‡è®¾æˆç«‹ IIå‹é”™è¯¯ï¼š æˆ‘è®¤ä¸ºé›¶å‡è®¾æˆç«‹ï¼Œå…¶å®å¯¹ç«‹å‡è®¾æˆç«‹ ä¾‹å­ï¼ˆç†è§£Type I errorå’Œ Type II errorï¼‰ï¼š ä¹ é¢˜è®°å½•ä¸´ç•ŒåŒºåŸŸä»£è¡¨å½“é›¶å‡è®¾ä¸ºçœŸæ—¶ï¼Œå¯èƒ½æ€§å¾ˆä½çš„å€¼ã€‚ å½“æ ·æœ¬é‡è¾ƒå¤§æ—¶ï¼Œå¤„ç†æ•ˆæœ(è‹¥æœ‰)æ›´å®¹æ˜“è¢«æ£€æµ‹åˆ° å½“æ ‡å‡†å·®è¾ƒå¤§æ—¶ï¼Œå¤„ç†æ•ˆæœï¼ˆè‹¥æœ‰ï¼‰æ›´ä¸å®¹æ˜“è¢«æ£€æµ‹åˆ°","tags":[{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://www.yangjie.hu//tags/Machine-Learning/"}]},{"title":"å®Œæˆä¸€ä¸ªä»ªè¡¨ç›˜åŠ¨ç”»çš„é£é›¨å†ç¨‹","date":"2018-02-08T03:02:33.000Z","path":"2018/02/08/å®Œæˆä¸€ä¸ªä»ªè¡¨ç›˜åŠ¨ç”»çš„é£é›¨å†ç¨‹/","text":"å ä½â€¦ç­‰å¾…å¡«å……","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"},{"name":"åŠ¨ç”»","slug":"åŠ¨ç”»","permalink":"http://www.yangjie.hu//tags/åŠ¨ç”»/"}]},{"title":"æœºå™¨å­¦ä¹ -ç»Ÿè®¡åŸºç¡€-ä¼°è®¡","date":"2017-12-13T15:50:02.000Z","path":"2017/12/13/æœºå™¨å­¦ä¹ -ç»Ÿè®¡åŸºç¡€-ä¼°è®¡/","text":"æ¦‚å¿µè®°å½•ç½®ä¿¡åŒºé—´ï¼ˆConfidence Interval, CIï¼‰(xÌ…-Z*Ïƒ/âˆšnï¼Œ xÌ…+Z*Ïƒ/âˆšn) ç§°ä¸ºå‡å€¼çš„95%ç½®ä¿¡åŒºé—´ æ ·æœ¬è¶Šå¤§ï¼Œç½®ä¿¡åŒºé—´è¶Šå°è®¡ç®—ç½®ä¿¡åŒºé—´ä½¿ç”¨çš„å¹³å‡å€¼ï¼Œ æ˜¯å‡å€¼åˆ†å¸ƒä¸­çš„å¹³å‡å€¼ã€‚å¹¶éæ€»ä½“ä¸­çš„å‡å€¼ äººå·¥å¹²é¢„ä¹‹åçš„æˆæœä¸€èˆ¬çœ‹ç½®ä¿¡åŒºé—´çš„èŒƒå›´æ¥æ–­å®š ç²¾ç¡®çš„Zå€¼ ä½¿ç”¨ç²¾ç¡®çš„Zå€¼æ¥è®¡ç®—ç½®ä¿¡åŒºé—´ Zçš„ä¸´ç•Œå€¼ä¾‹å­ï¼šæ­£è´Ÿæ•°2.33(Zè¡¨ä¸Šçš„å€¼) ç§°ä¸º98%ç½®ä¿¡åŒºé—´çš„Zçš„ä¸´ç•Œå€¼ å¤§æ¦‚çš„è¯¯å·®èŒƒå›´ï¼ˆmargin of errorï¼‰Z*sigma / sqrt(n)","tags":[{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://www.yangjie.hu//tags/Machine-Learning/"}]},{"title":"æœºå™¨å­¦ä¹ -ç»Ÿè®¡åŸºç¡€-å½’ä¸€åŒ–&æ­£æ€åˆ†å¸ƒ&æŠ½æ ·åˆ†å¸ƒ","date":"2017-12-10T03:00:54.000Z","path":"2017/12/10/æœºå™¨å­¦ä¹ -ç»Ÿè®¡åŸºç¡€-å½’ä¸€åŒ–-æ­£æ€åˆ†å¸ƒ-æŠ½æ ·åˆ†å¸ƒ/","text":"å½’ä¸€åŒ–æ¦‚å¿µè®°å½•Zå€¼åŸå§‹å€¼è·Ÿå‡å€¼ä¹‹é—´ç›¸å·®å‡ ä¸ªæ ‡å‡†å·® å…¬å¼ z = (x - Î¼) / Ïƒå¯ä»¥å°†æ•°æ®å½’ä¸€åŒ– æ ‡å‡†æ­£æ€åˆ†å¸ƒå¹³å‡å€¼ä¸º0ï¼Œ æ ‡å‡†å·®ä¸º1 æ­£æ€åˆ†å¸ƒæ¦‚å¿µè®°å½•æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆPDFï¼‰æ¦‚ç‡å¯†åº¦å‡½æ•°æ›²çº¿ä¸‹çš„é¢ç§¯æ˜¯1ï¼Œå› ä¸ºå®ƒæ˜¯ç”¨åˆ†å¸ƒæ•°æ®çš„ç›¸å¯¹é¢‘ç‡ï¼ˆæ¯”ä¾‹ï¼‰æ¥ç»˜åˆ¶æ•°æ®æ¨¡å‹çš„ æ¦‚ç‡å¯†åº¦å‡½æ•°çš„ç™¾åˆ†ä½é€‰ä¸­ä¸€ä¸ªXå€¼å¦‚æœå°äºç­‰äºè¯¥å€¼çš„æ¦‚ç‡æ˜¯80%ï¼Œé‚£ä¹ˆå°±ç§°Xæ˜¯ç¬¬80ä¸ªç™¾åˆ†ä½ æ¦‚ç‡ Z è¡¨æ ¼ç‚¹å‡»æŸ¥çœ‹å¤§å›¾ åœ¨è®¡ç®—çš„æ—¶å€™éœ€è¦å–„äºä½¿ç”¨æŠ€å·§ï¼Œä½¿ç”¨æ­£æ€åˆ†å¸ƒå·¦å³å¯¹ç§°ï¼Œ å’Œå‡ ä¸ªç‰¹å®šçš„ç‚¹çš„æ¦‚ç‡å¯ä»¥åŠ å¿«è®¡ç®—çš„é€Ÿåº¦ã€‚ æŠ½æ ·åˆ†å¸ƒæ¦‚å¿µè®°å½•æ ·æœ¬å‡å€¼åˆ†å¸ƒä»æ€»ä½“ä¸­å–å‡ºå¤šä¸ªæ ·æœ¬åˆ†åˆ«è®¡ç®—å‡ºå‡å€¼çš„åˆ†å¸ƒ æ‰€æœ‰æ ·æœ¬å‡å€¼çš„æ ‡å‡†å·®ï¼ˆSEï¼‰ï¼ˆStandard deviation of distribution of Sample meansï¼‰æ ·æœ¬é‡ n æ€»ä½“çš„æ ‡å‡†å·® sigma Ïƒ Ïƒ / âˆšn = SE å‡å€¼çš„æ ‡å‡†åå·®ç­‰äºæ€»ä½“æ ‡å‡†åå·®é™¤ä»¥æ ·æœ¬é‡çš„å¹³æ–¹æ ¹ ä¸­å¿ƒæé™å®šç†(The Central Limit Theorern)å¯¹äºå‡å€¼åˆ†å¸ƒï¼Œå…¶ä¸­æ¯ä¸ªå‡å€¼éƒ½æ˜¯æ ·æœ¬é‡ä¸ºnçš„å‡å€¼ï¼Œè¯¥åˆ†å¸ƒçš„æ ‡å‡†å·®å°±ç­‰äºæ€»ä½“æ ‡å‡†å·®é™¤ä»¥å¹³æ–¹æ ¹n æŠ½æ ·åˆ†å¸ƒæ€»æ˜¯è¶‹è¿‘äºæ­£æ€åˆ†å¸ƒæŠ½æ ·åˆ†å¸ƒçš„å‡å€¼è·Ÿæ€»ä½“çš„å‡å€¼ç›¸åŒ","tags":[{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://www.yangjie.hu//tags/Machine-Learning/"}]},{"title":"ä¸€ä¸ª48å°æ—¶çš„å‘¨æœ«","date":"2017-12-03T05:13:33.000Z","path":"2017/12/03/ä¸€ä¸ª48å°æ—¶çš„å‘¨æœ«/","text":"å‘¨æœ«è¿™çœŸæ˜¯ä¸€ä¸ªè®©äººå¿ƒæƒ…æ„‰æ‚¦çš„è¯ï¼Œå› ä¸ºåœ¨è¿™æ®µæ—¶é—´å†…æˆ‘ä»¬å¯ä»¥æ²¡æœ‰çº¦æŸåœ°åšè‡ªå·±çš„äº‹ï¼ˆå¤§éƒ¨åˆ†æ˜¯è¿™æ ·å§ğŸ™ƒï¼‰,å¯ä»¥æƒ³ä»€ä¹ˆæ—¶å€™ç¡å°±ä»€ä¹ˆæ—¶å€™ç¡ï¼Œçº¦æƒ³çº¦çš„äººé€›æƒ³é€›çš„åœ°å„¿ï¼Œè¿½æƒ³è¿½çš„å‰§ï¼Œæ•²æƒ³æ•²çš„ä»£ç ğŸ¤¥ æœ‰äººé—®æˆ‘ä½ ä¸€èˆ¬å‘¨æœ«éƒ½åšä»€ä¹ˆçš„ï¼Ÿæˆ‘å¯èƒ½ä¼šå›ç­”ï¼šç¡è§‰ æ ¹æ®æˆ‘ä»¥å¾€çš„æ—¶é—´æ¥ç®—ï¼Œå¦‚æœå‘¨æœ«æ²¡æœ‰ä»€ä¹ˆæˆ·å¤–çš„å®‰æ’ï¼Œé‚£æœ€å¤šçš„æ—¶é—´è‚¯å®šæ˜¯åœ¨åºŠä¸Šç¡è§‰ï¼Œè€Œä¸”å¯ä»¥ç¡åˆ°ä¸Šåˆåä¸€äºŒç‚¹é‚£ç§ğŸ˜£ï¼ˆç½ªæ¶æ„Ÿï¼‰ çœŸæ˜¯æµªè´¹ï¼å‘¨æœ«è¿™ä¹ˆå®è´µçš„æ—¶é—´æ€ä¹ˆå¯ä»¥æ‹¿æ¥ç¡è§‰å‘¢ï¼Ÿï¼ è¿™48ä¸ªå°æ—¶æ€ä¹ˆå°±å˜å¾—è®©äººè§‰å¾—å®è´µå‘¢ï¼Ÿ è‡ªç”±å‘¨æœ«èµ‹äºˆäº†æˆ‘ä»¬è‡ªç”±ï¼Œåœ¨è¿™48å°æ—¶å†…æˆ‘ä»¬äº«æœ‰å®Œå…¨çš„æ—¶é—´å’Œç²¾åŠ›ã€‚è¿™æ˜¯æå¤§çš„å¸å¼•åŠ›ï¼è¢«å·¥ä½œæˆ–æ˜¯å­¦ä¹ é™åˆ¶ç€åœ°åŸŸå’Œæ—¶é—´äº”å¤©ä¹‹åï¼Œä¸€ç§è¢«é‡Šæ”¾çš„å¿«æ„Ÿèƒ½è®©äººä¸ç”±ç”Ÿæ‚¦ã€‚å‘¨æœ«å°±åƒåœ¨ç©ºä¸­å³å°†æ•£å¼€çš„çƒŸèŠ±ï¼Œæœ‰äººå¯ä»¥æŠŠå®ƒè¿‡å¾—ç»šä¸½å¤šå½©ã€è½°è½°çƒˆçƒˆï¼Œä¹Ÿæœ‰äººä¼šæŠŠçƒŸèŠ±æ¸²æŸ“æˆé™é»˜ã€é€æ˜ã€‚æ²¡æœ‰æ™®ä¸–çš„ç¾ï¼Œåªæœ‰å¤§ä¼—è®¤å¯çš„å½¢æ€ã€‚ å­˜åœ¨æ„è¯†ä¸­æœ‰ç§æ„Ÿè§‰ï¼Œå‘¨æœ«è¿™48å°æ—¶å…¶å®ä¹Ÿæ˜¯å¾ˆææ€–çš„ä¸€ç§å­˜åœ¨ã€‚å®ƒçš„ç´¯åŠ èƒ½è®©åŒä¸€ä¸ªé˜¶æ®µçš„äººæ…¢æ…¢äº§ç”Ÿå·®åˆ«ï¼Œæœ€åè¢«åˆ†ç¦»åˆ°ä¸åŒé˜¶æ®µã€‚ æˆ‘æœ‰è¿™ç§æ„Ÿè§‰æ˜¯å› ä¸ºåœ¨æˆ‘çœ‹å‡ ä½æŠ€æœ¯å¤§ç‰›çš„åšå®¢çš„æ—¶å€™ï¼Œå‘ç°ä»–ä»¬å¹¶ä¸æ˜¯è…¾ç©ºè€Œå‡ºï¼ˆå½“ç„¶è¿™æ˜¯åºŸè¯ğŸ˜’ï¼‰ï¼Œä½†æ˜¯æˆé•¿æ›²çº¿æ˜¯éå¸¸é™¡å³­çš„ã€‚æˆ‘ç¿»ä»–ä»¬äº”å¹´å‰ï¼Œå…­å¹´å‰ç”šè‡³æ›´æ—©ä¹‹å‰çš„æ–‡ç« ï¼Œä»–ä»¬ä¹Ÿå°±åˆšæ¯•ä¸šæˆ–è€…è¿˜åœ¨å­¦æ ¡ã€‚æˆ‘å°è¯•æŠŠä»–ä»¬å½“æ—¶çš„æ–‡ç« ä¸­çš„çŠ¶æ€çš„ä»–ä»¬ç«‹ä½“å‡ºæ¥ï¼Œå‘ç°ä»–ä»¬å¤§æ–¹åœ°å¯¹å­¦ä¹ èŠ±æ—¶é—´ï¼Œä¸åå•¬è´¡çŒ®ç»™ä»£ç çš„æ—¶é—´å’Œç²¾åŠ›ã€‚ æ‰€ä»¥æˆ‘åœ¨ç¿»çœ‹ä»–ä»¬åšå®¢çš„æ—¶å€™éƒ½å¸¦ç€æ•¬ä»°çš„å¿ƒæƒ…ï¼Œæ˜¯è‡ªç„¶è€Œç„¶äº§ç”Ÿçš„ã€‚çœ‹åˆ°æŸä¸€ç¯‡æ–‡ç« ä¸‹é¢çš„è¯„è®ºä¸­æœ‰æœ‹å‹é—®é“ï¼šâ€œæˆ‘å¹´çºªæ¯”ä½ å¤§äº›ï¼ŒæŠ€æœ¯é“è¡Œå´è·Ÿä½ å·®å¤šäº†ï¼Œæƒ³çŸ¥é“éœ€è¦æ€æ ·çš„å­¦ä¹ è§„åˆ’æ‰èƒ½è¾¾åˆ°ä½ è¿™æ ·çš„æ°´å‡†ï¼Ÿâ€æƒ³å¿…å¾ˆå¤šäººéƒ½è¿™æ ·æƒ³ï¼Œæˆ‘ä¹Ÿæ˜¯ï¼Œè™½ç„¶æˆ‘å¹´çºªè¿˜æ²¡åˆ°ã€‚æŠ€æœ¯æ°´å¹³æˆ–è®¸æœ‰ä¸€å®šçš„é‡åŒ–æ ‡å‡†ï¼Œä½†æ˜¯åˆ«äººåœ¨è‡ªå·±å¿ƒä¸­çš„æ°´å‡†å´æ˜¯æ— æ³•é‡åŒ–ï¼Œæ˜¯ä¸€ç›´è®¤ä¸ºé¥ä¸å¯åŠçš„ç­‰çº§ï¼Œè¿˜æ˜¯èƒ½è¢«è‡ªå·±çš„ä½“ç³»è§¦åŠçš„ç­‰çº§ã€‚åšä¸»æ²¡æœ‰å›ç­”é‚£ä¸ªé—®é¢˜ï¼Œå³ä½¿ä»–å›ç­”äº†ä¹Ÿä¸ä¼šæœ‰å¤šå°‘äººèƒ½åšåˆ°ä»–é‚£æ ·ã€‚è¿™ä¸æ˜¯æ–¹æ³•çš„é—®é¢˜ï¼Œæ˜¯è‡ªæˆ‘çº¦æŸåŠ›çš„é—®é¢˜ï¼ˆæš‚æ—¶å¿½ç•¥æ™ºå•†å› ç´ ï¼Œæ¯•ç«Ÿåšè¿™ä¸–ç•Œä¸Š90%çš„äº‹æƒ…è¿˜è§¦åŠä¸äº†è€ƒéªŒä¸€ä¸ªäººæ™ºå•†çš„ç¨‹åº¦ï¼‰ å…¶å®çœŸæ­£ææ€–çš„ä¹Ÿä¸æ˜¯è¿™48ä¸ªå°æ—¶ï¼Œè€Œæ˜¯è‡ªæˆ‘çš„çº¦æŸåŠ›ï¼Œæ—¶é—´åªæ˜¯ä¸€ä¸ªè½½ä½“å’Œå‚¬åŒ–å‰‚ã€‚ æˆ‘ä¼šåœ¨å‘¨æœ«æ¥ä¸´ä¹‹å‰ç»™è‡ªå·±å®‰æ’ä¸€å®šé‡çš„å­¦ä¹ ä»»åŠ¡ï¼Œæœ‰äº›æ—¶å€™æ˜¯å®šé‡çš„ï¼Œä¹Ÿæœ‰æ›´å¤šçš„æ—¶å€™åªæ˜¯ä¸€ä¸ªå¿µå¤´æƒ³æ³•è€Œå·²ã€‚æ‰€ä»¥æˆ‘åœ¨å‘¨æœ«å¯¹è¿™äº›ä»»åŠ¡çš„æ‰§è¡ŒåŠ›ä¹Ÿå°±ä¸ç¡®å®šã€‚ å‘æ˜å¾ˆå¤§çš„æ—¶é—´å’Œç²¾åŠ›æ˜¯åœ¨è¿™48ä¸ªå°æ—¶å†…æ²¡æœ‰è¢«åˆç†åˆ©ç”¨çš„ï¼Œå½“ç„¶è¿™é‡Œçš„â€œåˆç†â€å› äººè€Œå®šã€‚ä¸¤å¤©å®‰ç¨³çš„è§‰ç¼“è§£ç–²åŠ³çš„ç²¾ç¥åŠ›ï¼Œè¿™ä¹Ÿæ˜¯éå¸¸å€¼å¾—çš„ã€‚è€Œå¦‚æœç–²åŠ³çš„ç²¾ç¥åŠ›çŠ¶æ€ä¸‹åè€Œç”¨å‘¨æœ«æ¥åšé«˜å¼ºåº¦å·¥ä½œæˆ–æ˜¯å¨±ä¹ï¼Œé‚£å°±ä¸â€œåˆç†â€ç›¸å·®ç”šè¿œäº†ã€‚ å‘ç°ï¼Œå¹¶å»æŒ–æ˜å¯ä»¥è¢«æ›´åŠ åˆç†åˆ©ç”¨çš„æ—¶é—´ï¼Œpushè‡ªå·±ä¸€æ³¢ï¼Œåœ¨æ—¶é—´çš„å®¹å™¨é‡Œç´¯ç§¯ï¼Œç›¸ä¿¡ä¼šå¾—åˆ°å¥½çš„ç»“æœçš„ï¼ è‡ªå¾‹ç»™æˆ‘è‡ªç”±å¥—ç”¨ä¸‹Keep ä¸Šçš„slogan â€œè‡ªå¾‹ç»™æˆ‘è‡ªç”±â€ï¼Œä¸åªæ˜¯å¥èº«ï¼Œä¸ªäººæˆé•¿ä¸Šèƒ½çº¦æŸè‡ªå·±æ‰èƒ½è·å¾—æ­£çœŸçš„è‡ªç”±ã€‚ å‡†å¤‡è¯•ç”¨ä¸‹åŒäº‹æ¨èç»™æˆ‘çš„34æšé‡‘å¸æ—¶é—´ç®¡ç†æ³•æŠŠè‡ªå·±çš„æ—¶é—´é‡åŒ–å‡ºæ¥ï¼Œä¹‹åç»ƒä¹ æœºå™¨å­¦ä¹ çš„æ—¶å€™æˆ–è®¸ä¹Ÿå¯ä»¥ç”¨æ¥å½“åšä¸€ä»½ç´ æã€‚","tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://www.yangjie.hu//tags/éšç¬”/"}]},{"title":"æœºå™¨å­¦ä¹ -ç»Ÿè®¡åŸºç¡€-å·®å¼‚æ€§","date":"2017-12-02T09:38:08.000Z","path":"2017/12/02/æœºå™¨å­¦ä¹ -ç»Ÿè®¡åŸºç¡€-å·®å¼‚æ€§/","text":"æ¦‚å¿µè®°å½•å€¼åŸŸ (Range)æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹é—´çš„å·® ç»Ÿè®¡çš„æ—¶å€™ä¸€èˆ¬ä¼šå»é™¤ top 25% å’Œ bottom 25% å››åˆ†ä½å·®ï¼ˆIQRï¼‰å°†æ•°æ®ç­‰åˆ†ä¸º4ä¸ªéƒ¨åˆ† Q1: part1 å’Œpart2 çš„åˆ†ç•Œç‚¹ Q2ï¼š part2 å’Œ part3çš„åˆ†ç•Œç‚¹ Q3: part3 å’Œ part4çš„åˆ†ç•Œç‚¹ IQR = Q3 - Q1 å¼‚å¸¸å€¼ ï¼ˆOutlierï¼‰Outlier &lt; Q1 - 1.5(IQR)Outlier &gt; Q3 + 1.5 (IQR) ç®±çº¿å›¾ ï¼ˆBoxplots)Minçº¿å’ŒMaxçº¿å¤–çš„ç‚¹ä»£è¡¨å¼‚å¸¸å€¼ å‡å€¼ä¸ä¸€å®šåœ¨IQRä¸­ï¼Œä¼—æ•°ä¸€å®šåœ¨IQRä¸­ å¹³å‡åå·® (average deviation)æ ·æœ¬ä¸­æ¯ä¸ªå€¼ä¸å‡å€¼çš„å·® çš„å¹³å‡æ•° å¹³å‡ç»å¯¹åå·®æ ·æœ¬ä¸­æ¯ä¸ªå€¼ä¸å‡å€¼çš„å·®çš„ç»å¯¹å€¼ çš„å¹³å‡æ•° å¹³å‡å¹³æ–¹åå·®æ ·æœ¬ä¸­æ¯ä¸ªå€¼å’Œå‡å€¼çš„å·®çš„å¹³æ–¹ çš„å¹³å‡æ•° æ ‡å‡†åå·® ï¼ˆstandard deviationï¼‰å¹³æ–¹å·®å¼€æ–¹ä¹‹åçš„å€¼ æ­£æ€åˆ†å¸ƒä¸­çš„æ ‡å‡†å·®çš„ä½œç”¨ è´å¡å°”æ ¡æ­£ä»‹äºåœ¨æ­£æ€åˆ†å¸ƒçš„æ€»ä½“æŠ½æ ·ç»Ÿè®¡ä¸­ï¼Œæ ·æœ¬å¤šæ•°éƒ½å¤„äºä¸­å¿ƒä½ç½®ï¼Œä¸ºäº†æ•°æ®æ›´åŠ å¹³è¡¡å‡†ç¡®ï¼Œåšäº†è´å¡å°”æ ¡æ­£ï¼Œè·å¾—æ ·æœ¬æ ‡å‡†å·®(Sample standard deviationï¼‰ ä¸¤è€…çš„ä½¿ç”¨åŒºåˆ«ï¼š å¦‚æœæœ‰æ ·æœ¬ï¼Œå¹¶ä¸”éœ€è¦ä¼°ç®—æ€»ä½“æ ‡å‡†å·®ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨â€œæ ·æœ¬æ ‡å‡†å·®â€å…¬å¼ï¼ˆåˆ†æ¯ä¸ºn-1ï¼‰, è®©æ€»ä½“æ ‡å‡†å·®çš„ä¼°ç®—æ›´åŠ å‡†ç¡® å¦‚æœæœ‰ä¸€ä¸ªæ•°æ®é›†ï¼Œå¹¶ä¸”éœ€è¦è®¡ç®—è¯¥æ•°æ®é›†çš„æ ‡å‡†å·®ï¼Œé‚£å°±ä½¿ç”¨æ ‡å‡†å·®å…¬å¼","tags":[{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://www.yangjie.hu//tags/Machine-Learning/"}]},{"title":"æœºå™¨å­¦ä¹ -ç»Ÿè®¡åŸºç¡€-æ•°æ®å¯è§†åŒ–","date":"2017-11-30T06:38:56.000Z","path":"2017/11/30/æœºå™¨å­¦ä¹ -ç»Ÿè®¡åŸºç¡€-æ•°æ®å¯è§†åŒ–/","text":"æ¦‚å¿µè®°å½•ç›´æ–¹å›¾çš„åˆ†å¸ƒä¸‹å›¾æ˜¯æ­£åæ–œåˆ†å¸ƒ ä¸€å…±æœ‰å››ç§åˆ†å¸ƒæ–¹å¼ æ­£æ€åˆ†å¸ƒ(normal distribution) åæ–œåˆ†å¸ƒ(skewed) åŒå³°åˆ†å¸ƒ(bimodal) å‡åŒ€åˆ†å¸ƒ (uniform) æ­£æ€åˆ†å¸ƒçš„ å‡å€¼ã€ä¸­ä½æ•°ã€ä¼—æ•°éƒ½ç›¸ç­‰ ç›´æ–¹å›¾çš„ç»„è·(bin size)ç›´æ–¹å›¾æ¯ä¸€æ¡çš„å®½åº¦ ç›´æ–¹å›¾çš„æ¨ªåæ ‡æœ‰ï¼š Numerical æ•°å€¼å‹ Categorical ç±»åˆ«å‹ ä¼—æ•° ï¼ˆmodeï¼‰åœ¨æ ·æœ¬ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„æ•°ä¸æ˜“æ”¶åˆ°ç»„è·çš„å½±å“ä¼—æ•°æ˜¯æœ€å¸¸è§çš„å¾—åˆ† å‡å€¼ ï¼ˆmeanï¼‰ â–¡ åˆ†å¸ƒä¸­çš„æ‰€æœ‰åˆ†å€¼éƒ½å½±å“å¹³å‡å€¼â–¡ å¹³å‡å€¼å¯ç”¨å…¬å¼æ¥æè¿°â–¡ åŒä¸€ä¸ªæ€»ä½“ä¸­çš„å¤šä¸ªæ ·æœ¬ä¼šæœ‰ç›¸ä¼¼çš„å¹³å‡å€¼â–¡ ä¸€ä¸ªæ ·æœ¬çš„å¹³å‡å€¼å¯ä»¥ç”¨æ¥æ¨è®ºå…¶æ‰€åœ¨çš„æ€»ä½“â–¡ å¦‚æœå‘æ•°æ®é›†ä¸­æ·»åŠ ä¸€ä¸ªæå€¼ï¼Œå®ƒçš„å¹³å‡å€¼ä¼šå‘ç”Ÿæ”¹å˜ ä¸å®¹æ˜“æ”¶åˆ°ç»„è·çš„å½±å“ ä¸­ä½æ•° (median)ä¸­ä½æ•°éœ€è¦å»é™¤å¼‚å¸¸å€¼ï¼Œç„¶åæ’åºè®¡ç®—å…¬å¼ ä¸å®¹æ˜“å—å¼‚å¸¸å€¼çš„å½±å“ä¸å®¹æ˜“æ”¶åˆ°ç»„è·çš„å½±å“ excleè¡¨æ ¼è®¡ç®—å¹³å‡å€¼","tags":[{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://www.yangjie.hu//tags/Machine-Learning/"}]},{"title":"æœºå™¨å­¦ä¹ -ç»Ÿè®¡åŸºç¡€-ç ”ç©¶æ–¹æ³•å…¥é—¨","date":"2017-11-27T01:43:20.000Z","path":"2017/11/27/æœºå™¨å­¦ä¹ -ç»Ÿè®¡åŸºç¡€-ç ”ç©¶æ–¹æ³•å…¥é—¨/","text":"æ¦‚å¿µè®°å½•å‚æ•° ï¼ˆparametersï¼‰è¡¨ç¤ºæ€»ä½“äººæ•°çš„æ•°å­—è¢«ç§°ä¸ºå‚æ•° æ€»ä½“å‚æ•° Î¼ ï¼ˆpopulation parametersï¼‰æŠ½æ ·æ€»ä½“çš„å¹³å‡å¾—åˆ†å«åšæ€»ä½“å‚æ•° æ ·æœ¬ç»Ÿè®¡é‡ xÌ… ï¼ˆsample statisticsï¼‰æ ·æœ¬çš„å¹³å‡å€¼å«åšæ ·æœ¬ç»Ÿè®¡é‡ æŠ½æ ·è¯¯å·® ï¼ˆsampling errorï¼‰ä¸¤è€…ä¹‹é—´çš„å·®åˆ«å«åš æŠ½æ ·è¯¯å·® æ ·æœ¬å¤§å°ä½¿ç”¨ n æ¥è¡¨ç¤º è‡ªå˜é‡ Independent variableé¢å¤–å˜é‡ï¼ˆæ½œåœ¨å˜é‡ï¼‰Extraneous(lurking) variableå› å˜é‡ Dependent variableå®šé‡å˜é‡ Quantitative variableé¢„æµ‹å˜é‡ Predictor variable å•ç›²å®éªŒå®éªŒå¯¹è±¡ä¸çŸ¥é“è‡ªå·±æ˜¯å¦æœç”¨æœ‰æ•ˆè¯ç‰‡ï¼Œä½†æ˜¯ç ”ç©¶äººå‘˜çŸ¥é“ åŒç›²å®éªŒå®éªŒç»“æœå‡ºæ¥ä¹‹å‰ï¼Œç ”ç©¶äººå‘˜å’Œå®éªŒå¯¹è±¡éƒ½ä¸çŸ¥é“æœç”¨æœ‰æ•ˆè¯ç‰‡çš„äººå‘˜ æ“ä½œå®šä¹‰ä»€ä¹ˆæ˜¯æ“ä½œå®šä¹‰ï¼š ä¸€ç§å°†æ„é€ ï¼ˆconstructsï¼‰è½¬å˜ä¸ºæˆ‘ä»¬å¯è¡¡é‡çš„å˜é‡çš„æ–¹å¼ ä¸€ç§ç”¨æˆ‘ä»¬è¡¡é‡å®ƒçš„æ–¹å¼æè¿°å˜é‡çš„æ–¹å¼ å½“é€‰å–äº†ä¸€ç§åº¦é‡æ–¹æ³•ï¼Œå°±æœ‰äº†ä¸€ç§å¯æ“ä½œçš„å®šä¹‰ã€‚æˆ‘ä»¬é€šè¿‡è¿™ç§å¯æ“ä½œå®šä¹‰å°±å¯ä»¥åœ¨ç°å®ä¸–ç•Œä¸­åº¦é‡æ„å»º æ½œåœ¨å˜é‡ï¼ˆExtraneous variablesï¼‰â–¡ å¯ä¸ºå˜é‡ä¹‹é—´è§‚å¯Ÿåˆ°çš„å…³ç³»æä¾›å¯èƒ½çš„å¦ä¸€ç§è§£é‡Šâ–¡ æ˜¯ä¼šå½±å“æˆ‘ä»¬è¡¡é‡çš„ä¸¤ä¸ªæˆ–å¤šä¸ªå˜é‡ä¹‹é—´å…³ç³»çš„å› ç´ â–¡ åœ¨æˆ‘ä»¬åšå‡ºç¡®å®šçš„å› æœå£°æ˜ä¹‹å‰ï¼Œå¿…é¡»åœ¨è¯•éªŒä¸­åŠ ä»¥æ§åˆ¶â–¡ ä½¿ä»è§‚å¯Ÿæ€§ç ”ç©¶çš„æ•°æ®ä¸­ç¡®å®šå› æœå…³ç³»å˜å¾—å›°éš¾ éšæœºæ ·æœ¬â–¡ ä»¥é€‰ä¸­æ¦‚ç‡ç›¸åŒçš„æ–¹å¼é€‰æ‹©ä¸ªä½“ã€‚â–¡ ä»¥é€‰ä¸­ä¸€ä¸ªä¸ªä½“ä¸ä¼šå½±å“å¦ä¸€ä¸ªä¸ªä½“è¢«é€‰ä¸­å‡ ç‡çš„æ–¹å¼é€‰æ‹©ä¸ªä½“ã€‚ åœ¨è¯•éªŒä¸­ï¼Œç ”ç©¶äººå‘˜æ“çºµ (è‡ª) å˜é‡ï¼Œæµ‹é‡ (å› ) å˜é‡çš„å˜åŒ–ï¼Œç„¶åå°è¯•æ§åˆ¶(æ½œä¼)å˜é‡ã€‚ é”™é¢˜è®°å½• â€œä½ æ¯å¤©æ‰€èµ°çš„è·ç¦»â€ è¿™æ˜¯ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼ A construct is a variable that is not directly observable or measurable, and units are at the heart of measurement. What units do you think should be used to measure distance? Some possibilities are miles, kilometers, calories expended, state lines crossed, road signs passed, etc. å•ä½æ˜¯åº¦é‡çš„æ ¸å¿ƒï¼Œæ²¡æœ‰å¸¦å•ä½çš„æ¦‚å¿µéƒ½å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œæ¯”å¦‚â€œä½ çš„å¹´é¾„â€ ï¼Œå¹´é¾„å¯ä»¥ç”¨å¹´æ¥åº¦é‡ï¼Œä¹Ÿå¯ä»¥æ˜¯è¡¨ç¤ºä¸€ä¸ªäººçš„å¿ƒæ™ºæˆç†Ÿç¨‹åº¦ï¼Œæˆ–è€…ç”¨å¤©æ¥è¡¡é‡ã€‚","tags":[{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://www.yangjie.hu//tags/Machine-Learning/"}]},{"title":"iOSåº”ç”¨æ€§èƒ½ä¼˜åŒ–å°è®°","date":"2017-11-25T14:49:44.000Z","path":"2017/11/25/iOSåº”ç”¨æ€§èƒ½ä¼˜åŒ–å°è®°/","text":"æ€§èƒ½ï¼Œç§»åŠ¨åº”ç”¨æœ€ç›´è§‚çš„ä½“éªŒå°±æ˜¯ç•Œé¢æ˜¯å¦æµç•…ã€‚åœ¨ç¼–ç¨‹è¿‡ç¨‹ä¸­å¤§å®¶æˆ–å¤šæˆ–å°‘æ€»æœ‰é‡åˆ°è¿‡å…³äºæé«˜åº”ç”¨æ€§èƒ½çš„æ“ä½œï¼Œæ¯”å¦‚ç®€å•çš„â€œå¼‚æ­¥çº¿ç¨‹åŠ è½½å›¾ç‰‡â€ï¼Œâ€œåœ†è§’ç»˜åˆ¶ä¼˜åŒ–â€ï¼Œâ€œæ‡’åŠ è½½è§†å›¾â€ï¼Œâ€œç¼“å­˜å›¾ç‰‡â€ï¼Œâ€œé¿å…æ—¥æœŸæ ¼å¼è½¬æ¢â€ç­‰ç­‰ï¼Œéƒ½æ˜¯åœ¨æŠŠè€—æ—¶è€—èµ„æºçš„æ“ä½œåˆ†æ•£åˆ°å…¶ä»–æ—¶æœºæ‰§è¡Œï¼Œæˆ–è€…é¿å…æ‰§è¡Œã€‚ä¹Ÿå°±æ˜¯è®©UIä¸»çº¿ç¨‹åªæ‰§è¡Œè½»é‡çš„ä»»åŠ¡ä»¥ä¿è¯ç•Œé¢çš„æµç•…ã€‚è€Œæœ¬æ–‡è¦è®²çš„æ˜¯åªèƒ½åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œçš„åŠ¨ç”»æ€§èƒ½çš„ä¼˜åŒ–ã€‚ åŠ¨ç”»è¿‡ç¨‹æ˜¯æµç•…å¯¹æœ€ç›´è§‚çš„ä½“ç°ï¼Œè€ŒåŠ¨ç”»æ•ˆæœå¯¹è®¾å¤‡çš„ç¡¬ä»¶èµ„æºæœ‰ä¸€å®šçš„è¦æ±‚ã€‚é’ˆå¯¹ç°ä»£iOSè®¾å¤‡æ¥è¯´ï¼Œé€ æˆåº”ç”¨æ€§èƒ½çš„ä¸‹é™åœ¨äºèµ„æºçš„è¿‡åº¦æ¶ˆè€—ã€‚è¿™é‡Œçš„â€œèµ„æºâ€æŒ‡çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ CPU &amp; GPUå…³äºç»˜å›¾å’ŒåŠ¨ç”»æœ‰ä¸¤ç§å¤„ç†çš„æ–¹å¼ï¼šCPUï¼ˆä¸­å¤®å¤„ç†å™¨ï¼‰å’ŒGPUï¼ˆå›¾å½¢å¤„ç†å™¨ï¼‰ã€‚åœ¨ç°ä»£iOSè®¾å¤‡ä¸­ï¼Œéƒ½æœ‰å¯ä»¥è¿è¡Œä¸åŒè½¯ä»¶çš„å¯ç¼–ç¨‹èŠ¯ç‰‡ï¼Œä½†æ˜¯ç”±äºå†å²åŸ å› ï¼Œæˆ‘ä»¬å¯ä»¥è¯´CPUæ‰€åšçš„å·¥ä½œéƒ½åœ¨è½¯ä»¶å±‚é¢ï¼Œè€ŒGPUåœ¨ç¡¬ä»¶å±‚é¢ã€‚æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è½¯ä»¶ï¼ˆä½¿ç”¨CPUï¼‰åšä»»ä½•äº‹æƒ…ï¼Œä½†æ˜¯å¯¹äºå›¾åƒå¤„ç†ï¼Œé€šå¸¸ ç”¨ç¡¬ä»¶ä¼šæ›´å¿«ï¼Œå› ä¸ºGPUä½¿ç”¨å›¾åƒå¯¹é«˜åº¦å¹¶è¡Œæµ®ç‚¹è¿ç®—åšäº†ä¼˜åŒ–ã€‚ç”±äºæŸäº›åŸå› ï¼Œ æˆ‘ä»¬æƒ³å°½å¯èƒ½æŠŠå±å¹•æ¸²æŸ“çš„å·¥ä½œäº¤ç»™ç¡¬ä»¶å»å¤„ç†ã€‚é—®é¢˜åœ¨äºGPUå¹¶æ²¡æœ‰æ— é™åˆ¶å¤„ç† æ€§èƒ½ï¼Œè€Œä¸”ä¸€æ—¦èµ„æºç”¨å®Œçš„è¯ï¼Œæ€§èƒ½å°±ä¼šå¼€å§‹ä¸‹é™äº†ï¼ˆå³ä½¿CPUå¹¶æ²¡æœ‰å®Œå…¨å ç”¨ï¼‰ å¤§å¤šæ•°åŠ¨ç”»æ€§èƒ½ä¼˜åŒ–éƒ½æ˜¯å…³äºæ™ºèƒ½åˆ©ç”¨GPUå’ŒCPUï¼Œä½¿å¾—å®ƒä»¬éƒ½ä¸ä¼šè¶…å‡ºè´Ÿè·ã€‚ äºæ˜¯æˆ‘ä»¬é¦–å…ˆéœ€è¦çŸ¥é“Core Animationæ˜¯å¦‚ä½•åœ¨è¿™ä¸¤ä¸ªå¤„ç†å™¨ä¹‹é—´åˆ†é…å·¥ä½œçš„ã€‚ ä¸€æ®µåŠ¨ç”»çš„å…­ä¸ªé˜¶æ®µï¼ˆå»¶ä¼¸é˜…è¯»ï¼‰å…¶å®iOSç³»ç»Ÿä¸­åˆ°å¤„å……æ»¡ç€åŠ¨ç”»ï¼ŒåŒå‡»Homeé”®å‡ºæ¥äº†åº”ç”¨åˆ‡æ¢ç•Œé¢ã€ä¸‹æ‹‰å‡ºç°é€šçŸ¥ä¸­å¿ƒï¼Œæ‰“å¼€ä»»ä½•Appæ—¶è¿‡ç¨‹ï¼Œéƒ½æ˜¯åŠ¨ç”»åœ¨è£…é¥°ç€è¿™äº›æ“ä½œã€‚è¿˜æœ‰åœ¨ç¼–ç¨‹çš„æ—¶å€™ï¼Œä»»æ„çš„UIViewåŠ¨ç”»éƒ½é»˜è®¤åŒ…å«ç€Core Animationå®ç°çš„0.25ç§’çš„éšå¼åŠ¨ç”»ã€‚Core Animation å¤„åœ¨iOSçš„æ ¸å¿ƒåœ°ä½ã€‚å½“è¿è¡Œä¸€æ®µåŠ¨ç”»çš„æ—¶ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šè¢«åˆ†ç¦»ä¸ºå››ä¸ªé˜¶æ®µï¼š å¸ƒå±€ - è¿™æ˜¯å‡†å¤‡ä½ çš„è§†å›¾/å›¾å±‚çš„å±‚çº§å…³ç³»ï¼Œä»¥åŠè®¾ç½®å›¾å±‚å±æ€§ï¼ˆä½ç½®ï¼ŒèƒŒæ™¯ è‰²ï¼Œè¾¹æ¡†ç­‰ç­‰ï¼‰çš„é˜¶æ®µ æ˜¾ç¤º - è¿™æ˜¯å›¾å±‚çš„å¯„å®¿å›¾ç‰‡è¢«ç»˜åˆ¶çš„é˜¶æ®µã€‚ç»˜åˆ¶æœ‰å¯èƒ½æ¶‰åŠä½ çš„-drawReact: å’Œ drawLayer:inContext:æ–¹æ³•çš„è°ƒç”¨è·¯å¾„ã€‚ å‡†å¤‡ - è¿™æ˜¯Core Animationå‡†å¤‡å‘é€åŠ¨ç”»æ•°æ®åˆ°æ¸²æŸ“æœåŠ¡çš„é˜¶æ®µã€‚è¿™åŒæ—¶ä¹Ÿæ˜¯ Core Animationå°†è¦æ‰§è¡Œä¸€äº›åˆ«çš„äº‹åŠ¡ä¾‹å¦‚è§£ç åŠ¨ç”»è¿‡ç¨‹ä¸­å°†è¦æ˜¾ç¤ºçš„å›¾ç‰‡çš„ æ—¶é—´ç‚¹ã€‚ æäº¤ - è¿™æ˜¯æœ€åçš„é˜¶æ®µï¼ŒCore Animationæ‰“åŒ…æ‰€æœ‰å›¾å±‚å’ŒåŠ¨ç”»å±æ€§ï¼Œç„¶åé€šè¿‡ IPCï¼ˆå†…éƒ¨å¤„ç†é€šä¿¡ï¼‰å‘é€åˆ°æ¸²æŸ“æœåŠ¡è¿›è¡Œæ˜¾ç¤ºã€‚ ä¸Šé¢çš„é˜¶æ®µåªæ˜¯å‘ç”Ÿåœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå†…ï¼Œåœ¨åŠ¨ç”»å±•ç¤ºæ—©å±å¹•ä¸Šä¹‹å‰è¿˜æœ‰æ›´å¤šçš„æ“ä½œã€‚ä¸€æ—¦æ‰“åŒ…çš„å›¾å±‚å’ŒåŠ¨ç”»åˆ°è¾¾æ¸²æŸ“æœåŠ¡è¿›ç¨‹ï¼Œä»–ä»¬ä¼šè¢«ååºåˆ—åŒ–æ¥å½¢ æˆå¦ä¸€ä¸ªå«åšæ¸²æŸ“æ ‘çš„å›¾å±‚æ ‘ã€‚ä½¿ç”¨è¿™ä¸ªæ ‘çŠ¶ç»“ æ„ï¼Œæ¸²æŸ“æœåŠ¡å¯¹åŠ¨ç”»çš„æ¯ä¸€å¸§åšå‡ºå¦‚ä¸‹å·¥ä½œï¼š å¯¹æ‰€æœ‰çš„å›¾å±‚å±æ€§è®¡ç®—ä¸­é—´å€¼ï¼Œè®¾ç½®OpenGLå‡ ä½•å½¢çŠ¶ï¼ˆçº¹ç†åŒ–çš„ä¸‰è§’å½¢ï¼‰æ¥æ‰§è¡Œæ¸²æŸ“ åœ¨å±å¹•ä¸Šæ¸²æŸ“å¯è§çš„ä¸‰è§’å½¢ æ‰€ä»¥ä¸€å…±æœ‰6ä¸ªé˜¶æ®µï¼Œæœ€åä¸¤ä¸ªé˜¶æ®µåœ¨åŠ¨ç”»è¿‡ç¨‹ä¸­ä¸åœåœ°é‡å¤ã€‚å‰äº”ä¸ªé˜¶æ®µéƒ½åœ¨è½¯ä»¶å±‚é¢å¤„ç†ï¼ˆé€šè¿‡CPUï¼‰ï¼Œåªæœ‰æœ€åä¸€ä¸ªè¢«GPUæ‰§è¡Œã€‚è€Œä¸”ï¼Œæˆ‘ä»¬çœŸæ­£èƒ½æ§åˆ¶çš„åªæ˜¯å‰ä¸¤ä¸ªé˜¶æ®µï¼Œå¸ƒå±€å’Œæ˜¾ç¤ºã€‚å‰©ä¸‹çš„éƒ½ç”±Core Animationæ¡†æ¶åœ¨å†…éƒ¨å¤„ç†ï¼Œæˆ‘ä»¬æ§åˆ¶ä¸äº†ã€‚ä¸è¿‡è¿™å¹¶æ²¡æœ‰ä»€ä¹ˆå½±å“ï¼Œåœ¨å¸ƒå±€å’Œæ˜¾ç¤ºé˜¶æ®µï¼Œæˆ‘ä»¬å°±å¯ä»¥å†³å®šå“ªäº›ç”±CPUæ‰§è¡Œï¼Œå“ªäº›äº¤ç»™GPUæ‰§è¡Œã€‚ GPUGPUä¸ºä¸€ä¸ªå…·ä½“çš„ä»»åŠ¡åšäº†ä¼˜åŒ–ï¼šå®ƒç”¨æ¥é‡‡é›†å›¾ç‰‡å’Œå½¢çŠ¶ï¼ˆä¸‰è§’å½¢ï¼‰ï¼Œè¿è¡Œå˜ æ¢ï¼Œåº”ç”¨çº¹ç†å’Œæ··åˆç„¶åæŠŠå®ƒä»¬è¾“é€åˆ°å±å¹•ä¸Šã€‚å¤§å¤šæ•°çš„CALayerçš„å±æ€§éƒ½æ˜¯GPUæ¥ç»˜åˆ¶çš„ã€‚ä¸‹é¢å‡ é¡¹æ“ä½œä¼šé™ä½åŸºäºGPUçš„å›¾å±‚ç»˜åˆ¶ï¼š å¤ªå¤šçš„å‡ ä½•ç»“æ„ - è¿™å‘ç”Ÿåœ¨éœ€è¦å¤ªå¤šçš„ä¸‰è§’æ¿æ¥åšå˜æ¢ï¼Œä»¥åº”å¯¹å¤„ç†å™¨çš„æ …æ ¼ åŒ–çš„æ—¶å€™ã€‚ç°ä»£iOSè®¾å¤‡çš„å›¾å½¢èŠ¯ç‰‡å¯ä»¥å¤„ç†å‡ ç™¾ä¸‡ä¸ªä¸‰è§’æ¿ï¼Œæ‰€ä»¥åœ¨Core Animationä¸­å‡ ä½•ç»“æ„å¹¶ä¸æ˜¯GPUçš„ç“¶é¢ˆæ‰€åœ¨ã€‚ä½†ç”±äºå›¾å±‚åœ¨æ˜¾ç¤ºä¹‹å‰é€šè¿‡IPCå‘é€åˆ°æ¸²æŸ“æœåŠ¡å™¨çš„æ—¶å€™ï¼ˆå›¾å±‚å®é™…ä¸Šæ˜¯ç”±å¾ˆå¤šå°ç‰©ä½“ç»„æˆçš„ç‰¹åˆ«é‡é‡çº§çš„å¯¹ è±¡ï¼‰ï¼Œå¤ªå¤šçš„å›¾å±‚å°±ä¼šå¼•èµ·CPUçš„ç“¶é¢ˆã€‚è¿™å°±é™åˆ¶äº†ä¸€æ¬¡å±•ç¤ºçš„å›¾å±‚ä¸ªæ•° é‡ç»˜ - ä¸»è¦ç”±é‡å çš„åŠé€æ˜å›¾å±‚å¼•èµ·ã€‚GPUçš„å¡«å……æ¯”ç‡ï¼ˆç”¨é¢œè‰²å¡«å……åƒç´ çš„æ¯” ç‡ï¼‰æ˜¯æœ‰é™çš„ï¼Œæ‰€ä»¥éœ€è¦é¿å…é‡ç»˜ï¼ˆæ¯ä¸€å¸§ç”¨ç›¸åŒçš„åƒç´ å¡«å……å¤šæ¬¡ï¼‰çš„å‘ç”Ÿã€‚ åœ¨ç°ä»£iOSè®¾å¤‡ä¸Šï¼ŒGPUéƒ½ä¼šåº”å¯¹é‡ç»˜ï¼›å³ä½¿æ˜¯iPhone 3GSéƒ½å¯ä»¥å¤„ç†é«˜è¾¾ 2.5çš„é‡ç»˜æ¯”ç‡ï¼Œå¹¶ä»»ç„¶ä¿æŒ60å¸§ç‡çš„æ¸²æŸ“ï¼ˆè¿™æ„å‘³ç€ä½ å¯ä»¥ç»˜åˆ¶ä¸€ä¸ªåŠçš„æ•´ å±çš„å†—ä½™ä¿¡æ¯ï¼Œè€Œä¸å½±å“æ€§èƒ½ï¼‰ï¼Œå¹¶ä¸”æ–°è®¾å¤‡å¯ä»¥å¤„ç†æ›´å¤šã€‚ ç¦»å±ç»˜åˆ¶ - è¿™å‘ç”Ÿåœ¨å½“ä¸èƒ½ç›´æ¥åœ¨å±å¹•ä¸Šç»˜åˆ¶ï¼Œå¹¶ä¸”å¿…é¡»ç»˜åˆ¶åˆ°ç¦»å±å›¾ç‰‡çš„ä¸Š ä¸‹æ–‡ä¸­çš„æ—¶å€™ã€‚ç¦»å±ç»˜åˆ¶å‘ç”Ÿåœ¨åŸºäºCPUæˆ–è€…æ˜¯GPUçš„æ¸²æŸ“ï¼Œæˆ–è€…æ˜¯ä¸ºç¦»å±å›¾ ç‰‡åˆ†é…é¢å¤–å†…å­˜ï¼Œä»¥åŠåˆ‡æ¢ç»˜åˆ¶ä¸Šä¸‹æ–‡ï¼Œè¿™äº›éƒ½ä¼šé™ä½GPUæ€§èƒ½ã€‚å¯¹äºç‰¹å®šå›¾ å±‚æ•ˆæœçš„ä½¿ç”¨ï¼Œæ¯”å¦‚åœ†è§’ï¼Œå›¾å±‚é®ç½©ï¼Œé˜´å½±æˆ–è€…æ˜¯å›¾å±‚å…‰æ …åŒ–éƒ½ä¼šå¼ºåˆ¶Core Animationæå‰æ¸²æŸ“å›¾å±‚çš„ç¦»å±ç»˜åˆ¶ã€‚ä½†è¿™ä¸æ„å‘³ç€ä½ éœ€è¦é¿å…ä½¿ç”¨è¿™äº›æ•ˆ æœï¼Œåªæ˜¯è¦æ˜ç™½è¿™ä¼šå¸¦æ¥æ€§èƒ½çš„è´Ÿé¢å½±å“ã€‚ è¿‡å¤§çš„å›¾ç‰‡ - å¦‚æœè§†å›¾ç»˜åˆ¶è¶…å‡ºGPUæ”¯æŒçš„2048x2048æˆ–è€…4096x4096å°ºå¯¸çš„ çº¹ç†ï¼Œå°±å¿…é¡»è¦ç”¨CPUåœ¨å›¾å±‚æ¯æ¬¡æ˜¾ç¤ºä¹‹å‰å¯¹å›¾ç‰‡é¢„å¤„ç†ï¼ŒåŒæ ·ä¹Ÿä¼šé™ä½æ€§ èƒ½ã€‚ CPUå¤§å¤šæ•°å·¥ä½œåœ¨Core Animationçš„CPUéƒ½å‘ç”Ÿåœ¨åŠ¨ç”»å¼€å§‹ä¹‹å‰ã€‚ä½†æ˜¯ä»–ä¼šå»¶è¿ŸåŠ¨ç”»å¼€å§‹çš„æ—¶é—´ï¼Œè®©ä½ çš„ç•Œé¢çœ‹èµ·æ¥ä¼šæ¯”è¾ƒè¿Ÿé’ã€‚ ä»¥ä¸‹çš„CPUæ“ä½œéƒ½ä¼šå»¶è¿ŸåŠ¨ç”»çš„å¼€å§‹æ—¶é—´ï¼š å¸ƒå±€è®¡ç®— - å¦‚æœä½ çš„è§†å›¾å±‚çº§è¿‡äºå¤æ‚ï¼Œå½“è§†å›¾å‘ˆç°æˆ–è€…ä¿®æ”¹çš„æ—¶å€™ï¼Œè®¡ç®—å›¾ å±‚å¸§ç‡å°±ä¼šæ¶ˆè€—ä¸€éƒ¨åˆ†æ—¶é—´ã€‚ç‰¹åˆ«æ˜¯ä½¿ç”¨iOS6çš„è‡ªåŠ¨å¸ƒå±€æœºåˆ¶å°¤ä¸ºæ˜æ˜¾ï¼Œå®ƒåº” è¯¥æ˜¯æ¯”è€ç‰ˆçš„è‡ªåŠ¨è°ƒæ•´é€»è¾‘åŠ å¼ºäº†CPUçš„å·¥ä½œã€‚ è§†å›¾æ‡’åŠ è½½ - iOSåªä¼šå½“è§†å›¾æ§åˆ¶å™¨çš„è§†å›¾æ˜¾ç¤ºåˆ°å±å¹•ä¸Šæ—¶æ‰ä¼šåŠ è½½å®ƒã€‚è¿™å¯¹ å†…å­˜ä½¿ç”¨å’Œç¨‹åºå¯åŠ¨æ—¶é—´å¾ˆæœ‰å¥½å¤„ï¼Œä½†æ˜¯å½“å‘ˆç°åˆ°å±å¹•ä¸Šä¹‹å‰ï¼ŒæŒ‰ä¸‹æŒ‰é’®å¯¼è‡´ çš„è®¸å¤šå·¥ä½œéƒ½ä¼šä¸èƒ½è¢«åŠæ—¶å“åº”ã€‚æ¯”å¦‚æ§åˆ¶å™¨ä»æ•°æ®åº“ä¸­è·å–æ•°æ®ï¼Œæˆ–è€…è§†å›¾ ä»ä¸€ä¸ªnibæ–‡ä»¶ä¸­åŠ è½½ï¼Œæˆ–è€…æ¶‰åŠIOçš„å›¾ç‰‡æ˜¾ç¤ºï¼ˆè§åç»­â€œIOç›¸å…³æ“ä½œâ€ï¼‰ï¼Œéƒ½ä¼š æ¯”CPUæ­£å¸¸æ“ä½œæ…¢å¾—å¤šã€‚ Core Graphicsç»˜åˆ¶ - å¦‚æœå¯¹è§†å›¾å®ç°äº†-drawReact:æ–¹æ³•ï¼Œæˆ–è€… -drawLayer:inContext:æ–¹æ³•ï¼Œé‚£ä¹ˆåœ¨ç»˜åˆ¶ä»»ä½•ä¸œè¥¿ä¹‹å‰éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªå·¨å¤§çš„æ€§èƒ½å¼€é”€ã€‚ä¸ºäº†æ”¯æŒå¯¹å›¾å±‚å†…å®¹çš„ä»»æ„ç»˜åˆ¶ï¼ŒCore Animationå¿…é¡»åˆ›å»ºä¸€ä¸ªå†…å­˜ä¸­ç­‰å¤§å°çš„å¯„å®¿å›¾ç‰‡ã€‚ç„¶åä¸€æ—¦ç»˜åˆ¶ç»“æŸä¹‹åï¼Œ å¿…é¡»æŠŠå›¾ç‰‡æ•°æ®é€šè¿‡IPCä¼ åˆ°æ¸²æŸ“æœåŠ¡å™¨ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼ŒCore Graphicsç»˜åˆ¶å°± ä¼šå˜å¾—ååˆ†ç¼“æ…¢ï¼Œæ‰€ä»¥åœ¨ä¸€ä¸ªå¯¹æ€§èƒ½ååˆ†æŒ‘å‰”çš„åœºæ™¯ä¸‹è¿™æ ·åšååˆ†ä¸å¥½ã€‚ è§£å‹å›¾ç‰‡ - PNGæˆ–è€…JPEGå‹ç¼©ä¹‹åçš„å›¾ç‰‡æ–‡ä»¶ä¼šæ¯”åŒè´¨é‡çš„ä½å›¾å°å¾—å¤šã€‚ä½†æ˜¯åœ¨å›¾ç‰‡ç»˜åˆ¶åˆ°å±å¹•ä¸Šä¹‹å‰ï¼Œå¿…é¡»æŠŠå®ƒæ‰©å±•æˆå®Œæ•´çš„æœªè§£å‹çš„å°ºå¯¸ï¼ˆé€šå¸¸ç­‰åŒ äºå›¾ç‰‡å®½ x é•¿ x 4ä¸ªå­—èŠ‚ï¼‰ã€‚ä¸ºäº†èŠ‚çœå†…å­˜ï¼ŒiOSé€šå¸¸ç›´åˆ°çœŸæ­£ç»˜åˆ¶çš„æ—¶å€™æ‰å» è§£ç å›¾ç‰‡ï¼ˆ14ç« â€œå›¾ç‰‡IOâ€ä¼šæ›´è¯¦ç»†è®¨è®ºï¼‰ã€‚æ ¹æ®ä½ åŠ è½½å›¾ç‰‡çš„æ–¹å¼ï¼Œç¬¬ä¸€æ¬¡å¯¹ å›¾å±‚å†…å®¹èµ‹å€¼çš„æ—¶å€™ï¼ˆç›´æ¥æˆ–è€…é—´æ¥ä½¿ç”¨UIImageViewï¼‰æˆ–è€…æŠŠå®ƒç»˜åˆ¶åˆ° Core Graphicsä¸­ï¼Œéƒ½éœ€è¦å¯¹å®ƒè§£å‹ï¼Œè¿™æ ·çš„è¯ï¼Œå¯¹äºä¸€ä¸ªè¾ƒå¤§çš„å›¾ç‰‡ï¼Œéƒ½ä¼š å ç”¨ä¸€å®šçš„æ—¶é—´ã€‚ å½“å›¾å±‚è¢«æˆåŠŸæ‰“åŒ…ï¼Œå‘é€åˆ°æ¸²æŸ“æœåŠ¡å™¨ä¹‹åï¼ŒCPUä»ç„¶è¦åšå¦‚ä¸‹å·¥ä½œï¼šä¸ºäº†æ˜¾ç¤º å±å¹•ä¸Šçš„å›¾å±‚ï¼ŒCore Animationå¿…é¡»å¯¹æ¸²æŸ“æ ‘ç§çš„æ¯ä¸ªå¯è§å›¾å±‚é€šè¿‡OpenGLå¾ªç¯ è½¬æ¢æˆçº¹ç†ä¸‰è§’æ¿ã€‚ç”±äºGPUå¹¶ä¸çŸ¥æ™“Core Animationå›¾å±‚çš„ä»»ä½•ç»“æ„ï¼Œæ‰€ä»¥å¿…é¡» è¦ç”±CPUåšè¿™äº›äº‹æƒ…ã€‚è¿™é‡ŒCPUæ¶‰åŠçš„å·¥ä½œå’Œå›¾å±‚ä¸ªæ•°æˆæ­£æ¯”ï¼Œæ‰€ä»¥å¦‚æœåœ¨ä½ çš„å±‚ çº§å…³ç³»ä¸­æœ‰å¤ªå¤šçš„å›¾å±‚ï¼Œå°±ä¼šå¯¼è‡´CPUæ²¡ä¸€å¸§çš„æ¸²æŸ“ï¼Œå³ä½¿è¿™äº›äº‹æƒ…ä¸æ˜¯ä½ çš„åº”ç”¨ç¨‹åºå¯æ§çš„ã€‚ Referenceã€ŠiOSæ ¸å¿ƒåŠ¨ç”»ã€‹æ€§èƒ½è°ƒä¼˜","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"},{"name":"åŠ¨ç”»","slug":"åŠ¨ç”»","permalink":"http://www.yangjie.hu//tags/åŠ¨ç”»/"}]},{"title":"ä¸€ä¸ªç®€æ˜“é®ç½©è¿›åº¦åŠ¨ç”»","date":"2017-10-29T15:38:51.000Z","path":"2017/10/29/ä¸€ä¸ªç®€æ˜“é®ç½©è¿›åº¦åŠ¨ç”»/","text":"éœ€æ±‚è¿‘æœŸå·¥ä½œéœ€æ±‚ä¸€ä¸ªå±•ç¤ºä»»åŠ¡è¿›åº¦çš„åŠ¨ç”»ï¼Œé€šè¿‡å¡«å……ç°æœ‰è¿›åº¦å›¾çš„æ–¹å¼å±•ç¤ºï¼Œå¹¶ä¸”æœ‰é‡Œç¨‹ç¢‘çš„èŠ‚ç‚¹éœ€è¦é…åˆæ•°æ®è¿›è¡Œæš‚åœã€‚å¥½å§ï¼Œæ–‡å­—è®²å¾—æˆ‘è‡ªå·±éƒ½å¾ˆéš¾ç†è§£ï¼Œæ¥çœ‹ä¸€ä¸‹æ•ˆæœå§ã€‚ çº¢è‰²çš„å¡«å……ä¸ºå½“å‰çš„è¿›åº¦ï¼ŒéªŒè¯ç™»å½•é˜¶æ®µåˆ°å¯¼å…¥è´¦å•é˜¶æ®µï¼ˆå¯¼å…¥é˜¶æ®µåˆ°å®Œæˆï¼‰æ˜¯æœ‰ä¸€ä¸ªé‡Œç¨‹ç¢‘çš„èŠ‚ç‚¹çš„ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡æ•°æ®æ¥æ§åˆ¶è¿›åº¦ï¼Œè®©çº¢è‰²çš„è¿›åº¦æ¡æš‚åœåœ¨æŸä¸€ä¸ªä½ç½®ç­‰å¾…æ•°æ®ã€‚ æ–¹æ¡ˆæ€è€ƒ1.åŠ¨ç”»éƒ¨åˆ†å±•ç¤ºä¸€ä¸‹å±‚æ¬¡ç»“æ„ï¼Œä¸€åˆ‡ä¸€ç›®äº†ç„¶ ç®€å•çš„æ¥è®²ï¼šå…¶å®æ˜¯æœ‰ä¸¤ä¸ªè¿›åº¦æ§åˆ¶Viewï¼Œåˆ†åˆ«æ˜¯ç°è‰²å’Œçº¢è‰²ï¼Œè¿™é‡Œç§°çº¢è‰²çš„ä¸ºmaskViewï¼Œç°è‰²ä¸ºbottomViewã€‚ åœ¨ç»“æ„å±‚æ¬¡å›¾ä¸­å¯ä»¥æ„è¯†åˆ°åªè¦è®©maskViewæœ‰ä¸ªä½ç§»åŠ¨ç”»å°±å¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚æ³¨æ„ï¼šè¿™ä¸ªä½ç§»åŠ¨ç”»å¹¶ä¸æ˜¯UIViewå±‚é¢çš„åŠ¨ç”»ï¼Œå•çº¯ç§»åŠ¨æ•´ä¸ªmaskViewå…¶å®æ˜¯ä¼šé€ æˆbottomViewå’ŒmaskViewå›¾æ ‡é”™ä½çš„ç°è±¡ï¼Œè¿™å¹¶ä¸æ˜¯æƒ³è¦çš„æ•ˆæœã€‚æ­£ç¡®çš„æ˜¯å¯¹maskViewlayerçš„maskLayerå±‚è¿›è¡ŒåŠ¨ç”»æ“ä½œã€‚ å®ç°æ€è·¯ï¼šè®©maskViewçš„maskLayeråˆå§‹ä½ç½®åœ¨maskViewçš„frameä¹‹å¤–çš„å·¦ä¾§ã€‚åŠ¨ç”»å¼€å§‹ä¹‹åè®©maskLayeræ…¢æ…¢å‘å³ç§»åŠ¨ï¼Œè¾¾åˆ°çº¢è‰²æ…¢æ…¢å‘å³å¡«å……çš„æ•ˆæœã€‚å¯¹maskLayerä½¿ç”¨çš„åŠ¨ç”»å¯ä»¥æ˜¯CABasicAnimation æˆ–è€…CAKeyframeAnimationã€‚æ­¤demoä¸­ä½¿ç”¨å…³é”®å¸§åŠ¨ç”» CAKeyframeAnimation å…³é”®ä»£ç ç¤ºä¾‹ï¼š123456//åˆå§‹åŒ–maksViewçš„maskLayerä½ç½® CALayer *maskLayer; = [CALayer layer]; maskLayer.backgroundColor = [[UIColor whiteColor] CGColor]; //ä»»ä½•é¢œè‰²ï¼Œç”¨åˆ°çš„åªæ˜¯alpha maskLayer.anchorPoint = CGPointZero; maskLayer.frame = CGRectOffset(self.frame,-CGRectGetWidth(self.frame), 0); self.layer.mask = maskLayer; 123456789101112//å¼€å§‹åŠ¨ç”» NSArray *values = @[[NSValue valueWithCGPoint:CGPointMake(-CGRectGetWidth(self.frame), 0)], [NSValue valueWithCGPoint:CGPointMake(0, 0)]]; CGFloat duration = 4.0; CAKeyframeAnimation *animation = [CAKeyframeAnimation animationWithKeyPath:@\"position\"]; animation.values = values; animation.duration = duration; animation.delegate = self; animation.fillMode = kCAFillModeForwards; animation.removedOnCompletion = NO; [maskLayer addAnimation:animation forKey:@\"MaskAnimation\"]; 2.è¿›åº¦æ§åˆ¶éƒ¨åˆ†å¦‚æœåªéœ€è¦æœ¬æ–‡åˆšå¼€å§‹çš„è´´å›¾é‚£æ ·çš„æ•ˆæœï¼Œç¬¬ä¸€éƒ¨åˆ†å·²ç»è¶³å¤Ÿäº†ã€‚ ç¬¬ä¸€éƒ¨åˆ†åªæ˜¯è§£å†³äº†ç”ŸæˆåŠ¨ç”»çš„é—®é¢˜ï¼Œä½¿ç”¨CAKeyframeAnimationå¯¹maskLayerè¿›è¡Œå…³é”®å¸§åŠ¨ç”»æ˜¯æ¯”è¾ƒå¸¸è§çš„åšæ³•ï¼Œå¦‚æœå¯¹CAKeyframeAnimationæˆ–è€…CABasicAnimationä½¿ç”¨ä¸ç†Ÿæ‚‰å¯ä»¥å‚é˜…ã€ŠiOSæ ¸å¿ƒåŠ¨ç”»ã€‹ç¼“å†² æ¥ä¸‹æ¥è¦å®Œæˆçš„æ˜¯æ ¹æ®æ•°æ®çŠ¶æ€æ¥æ§åˆ¶åŠ¨ç”»ï¼Œç®€å•æ¢³ç†äº†ä¸‹æˆ‘ä»¬è¦å®Œæˆçš„ç›®æ ‡ï¼š çŠ¶æ€ åŠ¨ç”»æè¿° ç™»å½•ä¸­ çº¢è‰²maskLayerå¼€å§‹å‘å³ç§»åŠ¨ ç™»å½•è¶…æ—¶ çº¢è‰²maskLayerç§»åŠ¨æš‚åœåœ¨1ï¼Œ2ä¸¤ä¸ªå›¾æ ‡ä¹‹é—´çš„è¿›åº¦æ¡é—´ ç™»å½•æˆåŠŸ çº¢è‰²maskLayerç»§ç»­å‘å³ç§»åŠ¨ å¯¼å…¥ä¸­ çº¢è‰²maskLayerç»§ç»­å‘å³ç§»åŠ¨åˆ°2è‡³3éƒ¨åˆ† å¯¼å…¥è¶…æ—¶ çº¢è‰²maskLayerç§»åŠ¨æš‚åœåœ¨2ï¼Œ3ä¸¤ä¸ªå›¾æ ‡ä¹‹é—´çš„è¿›åº¦æ¡é—´ å¯¼å…¥å®Œæˆ çº¢è‰²maskLayerç»§ç»­å®Œæˆå‰©ä¸‹çš„åŠ¨ç”» æå‰å®Œæˆ ç›´æ¥ä»å½“å‰çš„ç™¾åˆ†æ¯”ä½ç½®å¿«é€Ÿå®Œæˆå‰©ä¸‹çš„åŠ¨ç”» æ¢å¤è¿›åº¦ ä»ä»»æ„è¿›åº¦æ¢å¤åŠ¨ç”» æŠ›å¼€æ˜¯æ•°æ®ï¼Œæˆ‘ä»¬è¦å®Œæˆçš„æ˜¯ä»¥ä¸‹äº”ç‚¹ï¼š è®¾å®šè¶…æ—¶æœºåˆ¶ æš‚åœåŠ¨ç”» æ¢å¤åŠ¨ç”» ä»ä»»æ„è¿›åº¦å€¼åˆå§‹åŒ–åŠ¨ç”» ä»å½“å‰è¿›åº¦å€¼å¿«é€Ÿå®ŒæˆåŠ¨ç”» 2.1 è®¾å®šè¶…æ—¶æœºåˆ¶è¿™ä¸€æ­¥å…¶å®æ¯”è¾ƒç®€å• å…ˆè®¾å®šé»˜è®¤çš„ç™»å½•è¶…æ—¶æ—¶é—´å’Œå¯¼å…¥è¶…æ—¶æ—¶é—´ 12static const CGFloat kGeneralLoginTime = 20.0;static const CGFloat kGeneralImportTime = 30.0; åœ¨è§†å›¾ä¸­åˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨ï¼Œä»åŠ¨ç”»å¼€å§‹è®¡ç®—ç»è¿‡çš„æ—¶é—´ï¼Œä¸é»˜è®¤çš„æ—¶é—´åˆ¤æ–­æ˜¯å¦åœ¨è¯¥çŠ¶æ€å·²ç»è¶…æ—¶ã€‚ 1234567891011- (void)displayLinkEvent &#123; _currentTime ++; if (_currentTime == kGeneralLoginTime * 60 &amp;&amp; self.status == Logining) &#123; [self waitForVerify]; NSLog(@\"ç™»å½•è¶…æ—¶ %ld\", _currentTime / 60); &#125; else if (_currentTime - _loginSuccessTime == kGeneralImportTime * 60 &amp;&amp; self.status == Importing) &#123; [self waitForImport]; NSLog(@\"å¯¼å…¥è¶…æ—¶ %ld\", (_currentTime - _loginSuccessTime)/60); &#125; _lastPresentPosition = _maskLayer.presentationLayer.position;&#125; 2.2 æš‚åœåŠ¨ç”»123456//æš‚åœåŠ¨ç”»- (void)pauseLayer &#123; CFTimeInterval pausedTime = [_maskLayer convertTime:CACurrentMediaTime() fromLayer:nil]; self.layer.speed = 0.0; self.layer.timeOffset = pausedTime;&#125; 2.3 æ¢å¤åŠ¨ç”»123456789//æ¢å¤åŠ¨ç”»- (void)resumeLayer &#123; CFTimeInterval pausedTime = [self.layer timeOffset]; self.layer.speed = 1.0; self.layer.timeOffset = 0.0; self.layer.beginTime = 0.0; CFTimeInterval timeSincePause = [_maskLayer convertTime:CACurrentMediaTime() fromLayer:nil] - pausedTime; self.layer.beginTime = timeSincePause;&#125; 2.4 ä»ä»»æ„è¿›åº¦å€¼åˆå§‹åŒ–123456789//è®¾ç½®ä¸€ä¸ªstartVlaueçš„åˆå§‹åŒ–å€¼- (void)setStartValue:(CGFloat)startValue &#123; [self stopAnimation]; _startValue = startValue; //_lastPresentPositionä¸ºmaskLayerä¸Šä¸€æ¬¡å±•ç¤ºpositionå±æ€§ _lastPresentPosition = CGPointMake(startValue * CGRectGetWidth(self.frame) - CGRectGetWidth(self.frame), 0); [self resumeLayer]; [self startAnimation];&#125; 12345678910111213141516//ä»ä¸Šä¸€æ¬¡åŠ¨ç”»- (void)startAnimation &#123; NSArray *values = @[[NSValue valueWithCGPoint:_lastPresentPosition], [NSValue valueWithCGPoint:CGPointMake(0, 0)]]; CGFloat duration = kGeneralLoginTime + kGeneralImportTime + 1; CAKeyframeAnimation *animation = [CAKeyframeAnimation animationWithKeyPath:@\"position\"]; animation.values = values; animation.duration = duration; animation.delegate = self; //è‡ªç„¶å¯¼å…¥å®Œæˆä¹‹åä¸ä¿ç•™maskå±‚çš„ä½ç½®ä¿¡æ¯ï¼Œå›å½’åˆ°åˆå§‹ä½ç½® animation.fillMode = kCAFillModeRemoved; animation.removedOnCompletion = YES; [_maskLayer addAnimation:animation forKey:@\"MaskAnimation\"]; _displayLink.paused = NO;&#125; 2.5 ä»å½“å‰è¿›åº¦å€¼å¿«é€Ÿå®ŒæˆåŠ¨ç”»1234567891011121314151617// æå‰ç»“æŸåŠ¨ç”»- (void)animationAdvancedFinished&#123; [self resumeLayer]; CGFloat duration = _advancedFinishDuring; NSArray *values = @[[NSValue valueWithCGPoint:_lastPresentPosition], [NSValue valueWithCGPoint:CGPointMake(0, 0)]]; CAKeyframeAnimation *animation = [CAKeyframeAnimation animationWithKeyPath:@\"position\"]; animation.values = values; animation.duration = duration; animation.delegate = self; //æå‰ç»“æŸåŠ¨ç”»å®Œæˆä¹‹åä¿ç•™maskå±‚çš„ä½ç½®ä¿¡æ¯ï¼Œä¿æŒåŠ¨ç”»å®Œæˆæ—¶çš„æ ·å¼ animation.fillMode = kCAFillModeForwards; animation.removedOnCompletion = NO; [_maskLayer addAnimation:animation forKey:@\"AdvancedMaskAnimation\"];&#125; ä¸Šé¢ä»£ç ç‰‡æ®µä¸­çš„_advancedFinishDuringåŠ¨ç”»æ—¶é—´ï¼Œæ˜¯æ ¹æ®è§¦å‘å¿«é€Ÿå®ŒæˆåŠ¨ç”»æ—¶çš„è¿›åº¦å€¼ç™¾åˆ†æ¯” ä¹˜ä»¥ å¿«é€Ÿå®ŒæˆåŠ¨ç”»æ‰€éœ€è¦çš„æ€»æ—¶é—´è®¡ç®—å‡ºæ¥çš„ã€‚ä¸‹é¢æ˜¯è®¡ç®—çš„ä¸€ä¸ªä¾‹å­ï¼š 123456789- (void)verifySuccess &#123; [self resumeLayer]; self.status = Importing; self.displayLink.paused = NO; if (!self.loginSuccessTime) &#123; self.loginSuccessTime = self.currentTime; &#125; self.advancedFinishDuring = ((-_lastPresentPosition.x) / CGRectGetWidth(self.frame)) * kGeneralCacheCompleteTime;&#125; è‡³æ­¤è¿›åº¦æ§åˆ¶å°±å¯ä»¥çš„éœ€æ±‚å°±å¯ä»¥ä½¿ç”¨ä»¥ä¸Šçš„å…³é”®æ–¹æ³•å®Œæˆäº†, æŸ¥çœ‹å®Œæˆçš„é€»è¾‘å¯ä»¥ä¸‹è½½demoæŸ¥çœ‹ Demoåœ°å€ ä¸è¶³ è¿›åº¦æ§åˆ¶éƒ¨åˆ†çš„è¶…æ—¶è·ŸmaskLayerä½ç½®çš„å¯¹åº”å…³ç³»æ¯”è¾ƒç”Ÿç¡¬ ä¸ªäººå¯¹åŠ¨ç”»ç†è§£è¿˜ä¸æ·±ï¼Œä»£ç ç¬¨æ‹™ã€‚è¿˜è¯·æœ‹å‹å¤šæ‰¹è¯„æŒ‡æ•™ï¼","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"1024","date":"2017-10-24T16:31:43.000Z","path":"2017/10/25/1024/","text":"1024â€œç¨‹åºå‘˜èŠ‚æ—¥â€åˆšè¿‡ï¼Œåœ¨10.24è¿™ä¸ªèŠ‚æ—¥ä¸­ï¼Œåœ¨å…¬å¸åŠ ç­ç»ˆäºæ‰“åŒ…æå®¡äº†å‡ ç»å‘¨æŠ˜çš„Appï¼Œç°åœ¨å°±ä¼ç›¼èƒ½å¤Ÿé¡ºåˆ©åœ°é€šè¿‡å®¡æ ¸å§ã€‚æ¥æ‰‹é¡¹ç›®ä¸¤ä¸ªå¤šæœˆï¼Œåˆ°ç°åœ¨æ­£å¼åœ°æå®¡ï¼Œä¹Ÿæ˜¯æ—¶å€™å¯¹è‡ªå·±è¿™ä¸ªé˜¶æ®µçš„çŠ¶æ€åšä¸€ä¸ªæ€»ç»“å’Œåˆ†æã€‚ åˆè°™ä¸–äº‹è¿™ä¸¤ä¸ªæœˆï¼Œæˆ‘æ‰å¼€å§‹çœŸåˆ‡åœ°è®¤è¯†åˆ°ç¨‹åºå‘˜è¿™ä¸ªè¡Œä¸šï¼Œä¹Ÿå¼€å§‹ä½“ä¼šåˆ°åŒäº‹ä¹‹é—´çš„æˆ˜å‹æƒ…ã€‚ åˆå¿ƒä¸ç®¡ç¯å¢ƒæ€ä¹ˆæ”¹å˜ï¼Œä¿æŒè‡ªå·±çš„çŠ¶æ€ã€‚æˆé•¿ï¼Œä¸å¿˜è‡ªå·±çš„åˆå¿ƒã€‚ è‡ªå¾‹çš„è‡ªç”±è‡ªç”±çš„ä¸–ç•Œå……æ»¡çš„ä¸è‡ªç”±çš„ä¸ªä½“ï¼Œè‡ªæˆ‘çš„æŸç¼šæ˜¯æ— å½¢çš„ã€‚å¯¹ä¸€ä¸ªä¹ æƒ¯çš„åšæŒï¼Œå¯¹ç›®æ ‡çš„æ‰§ç€æ˜¯å‰å¾€è‡ªç”±çš„ğŸ”‘ã€‚","tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://www.yangjie.hu//tags/éšç¬”/"}]},{"title":"iOSåŠ¨ç”»ç¼“å†²","date":"2017-10-09T15:28:26.000Z","path":"2017/10/09/iOSåŠ¨ç”»ç¼“å†²/","text":"Core Animationå†…åµŒäº†ä¸€ç³»åˆ—æ ‡å‡†å‡½æ•°æ¥æ¨¡æ‹Ÿç‰©ä½“åœ¨è¿åŠ¨ä¸­çš„åŠ é€Ÿå’Œå‡é€Ÿã€‚CAMediaTimingFunctionè®¾ç½®ç¼“å†²æ–¹ç¨‹å¼é¦–å…ˆéœ€è¦è®¾ç½®CAAnimationçš„timingFunctionå±æ€§ï¼Œæ˜¯CAMediaTimingFunctionç±»çš„ä¸€ä¸ªå¯¹è±¡ã€‚CAMediaTimingFunctionçš„å·¥å‚æ–¹æ³•ï¼š+timingFunctionWithName: çš„å‚æ•°å¸¸é‡å¦‚ä¸‹ï¼š 123456789kCAMediaTimingFunctionLinear kCAMediaTimingFunctionEaseIn kCAMediaTimingFunctionEaseOut kCAMediaTimingFunctionEaseInEaseOutkCAMediaTimingFunctionDefault kCAMediaTimingFunctionLinearï¼ˆçº¿æ€§è®¡æ—¶å‡½æ•°ï¼‰ æ˜¯ CAAnimation çš„ timingFunction å±æ€§çš„é»˜è®¤å‡½æ•°ã€‚ kCAMediaTimingFunctionEaseIn å¸¸é‡åˆ›å»ºäº†ä¸€ä¸ªæ…¢æ…¢åŠ é€Ÿç„¶åçªç„¶åœæ­¢çš„æ–¹æ³•ã€‚ kCAMediaTimingFunctionEaseOut åˆ™æ°æ°ç›¸åï¼Œå®ƒä»¥ä¸€ä¸ªå…¨é€Ÿå¼€å§‹ï¼Œç„¶åæ…¢æ…¢å‡é€Ÿåœæ­¢ã€‚ kCAMediaTimingFunctionEaseInEaseOut åˆ›å»ºäº†ä¸€ä¸ªæ…¢æ…¢åŠ é€Ÿç„¶åå†æ…¢æ…¢å‡é€Ÿçš„è¿‡ç¨‹ã€‚ æœ€åè¿˜æœ‰ä¸€ä¸ª kCAMediaTimingFunctionDefault ï¼Œå®ƒå’Œ kCAMediaTimingFunctionEaseInEaseOut å¾ˆç±»ä¼¼ï¼Œä½†æ˜¯åŠ é€Ÿå’Œå‡é€Ÿçš„è¿‡ç¨‹éƒ½ç¨å¾®æœ‰äº›æ…¢ã€‚ å½“åˆ›å»ºæ˜¾å¼çš„CAAnimationï¼ŒkCAMediaTimingFunctionDefaultå¹¶ä¸æ˜¯é»˜è®¤é€‰é¡¹ åœ¨UIViewçš„åŠ¨ç”»ä¸­ï¼ŒkCAMediaTimingFunctionEaseInEaseOut ç›¸å¯¹åº”çš„å¸¸é‡æ˜¯é»˜è®¤æ•ˆæœ ç¼“å†²å’Œå…³é”®å¸§åŠ¨ç”»CAKeyframeAnimationæœ‰ä¸€ä¸ªNSArrayç±»å‹çš„timingFunctionså±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥å¯¹æ¯æ¬¡åŠ¨ç”»çš„æ­¥éª¤æŒ‡å®šä¸åŒçš„è®¡æ—¶å‡½æ•°ã€‚ä½†æ˜¯æŒ‡å®šå‡½æ•°çš„ä¸ªæ•°ä¸€å®šè¦ç­‰äºkeyframesæ•°ç»„çš„å…ƒç´ ä¸ªæ•°å‡ä¸€ï¼Œå› ä¸ºå®ƒæ˜¯æè¿°æ¯ä¸€å¸§ä¹‹é—´åŠ¨ç”»é€Ÿåº¦çš„å‡½æ•°ã€‚ 1234567891011121314151617- (IBAction)changeColor&#123; //create a keyframe animation CAKeyframeAnimation *animation = [CAKeyframeAnimation animation]; animation.keyPath = @\"backgroundColor\"; animation.duration = 2.0; animation.values = @[ (__bridge id)[UIColor blueColor].CGColor, (__bridge id)[UIColor redColor].CGColor, (__bridge id)[UIColor greenColor].CGColor, (__bridge id)[UIColor blueColor].CGColor ]; //add timing function CAMediaTimingFunction *fn = [CAMediaTimingFunction functionWithName: kCAMediaTimingFunctionEaseIn]; animation.timingFunctions = @[fn, fn, fn]; //apply animation to layer [self.colorLayer addAnimation:animation forKey:nil];&#125; Referenceã€ŠiOSæ ¸å¿ƒåŠ¨ç”»ã€‹ç« èŠ‚ ç¼“å†²","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"è¢«æ€ç»ªæˆ³ç©¿çš„å›½åº†","date":"2017-10-06T06:03:31.000Z","path":"2017/10/06/è¢«æ€ç»ªæˆ³ç©¿çš„å›½åº†/","text":"æˆ‘ä¸€ç›´è§‰å¾—è‡ªå·±æ˜¯ä¸€ä¸ªå¯¹è¿‡å»è®°å¿†å¾ˆä¸æ•æ„Ÿçš„äººï¼Œå†™è¿™æ®µæ–‡å­—çš„æ—¶å€™åœ¨å›æƒ³ç€å¾€å¹´çš„å›½åº†åœ¨å“ªã€‚ç²—ç²—ä¸€æƒ³æœ‰å°è±¡åœ°åªæœ‰å¤§äºŒçš„æ—¶å€™è·Ÿä¸¤ä¸ªåŒå­¦ä¸€èµ·éª‘è½¦å»ç©·æ¸¸çš„ç»å†ã€‚ æˆ‘ç°åœ¨ä¸å¤ªå–œæ¬¢æ—…æ¸¸ï¼Œæ²¡æœ‰å‘å¾€å“ªé‡Œç‰¹åˆ«æƒ³å»æŸä¸ªåœ°æ–¹æ—…æ¸¸çš„æƒ³æ³•ã€‚ä»Šå¹´çš„å›½åº†é•¿å‡ï¼Œæœ‰å‡ ä¸ªè€å‹ç›¸çº¦å‡ºæ¸¸ï¼Œå´ä¹Ÿæä¸èµ·å…´è¶£ï¼Œä¹‹åç›¸äº’ä¹Ÿæ²¡æœ‰å†å“åº”å‡ºæ¸¸è®¡åˆ’ä¹Ÿå°±ä¸äº†äº†ä¹‹ï¼Œæœ€åç›¸äº’ä¸€å¥ â€œä¸‹æ¬¡â€ ä¸€æºœè€Œè¿‡ã€‚ æ›¾æ›¾ç»ä¹Ÿæ˜¯å‘å¾€è¿‡ä¸€ç¾¤æœ‹å‹å‡ºæ¸¸ï¼Œè¿˜æœ‰è·Ÿå¥³æœ‹å‹ä¸€èµ·æ—…æ¸¸ã€‚ç°åœ¨æ²¡æœ‰äº†å‘å¾€ï¼Œé‡åˆ°ä¸€æ¬¡å‡ºæ¸¸çš„æœºä¼šæˆ‘ç”šè‡³ä¼šè¯„ä¼°å¥½ä¹…è¿™æ ·çš„ä¸€æ®µæ—…è¡Œæœ‰ä»€ä¹ˆæ„ä¹‰ã€‚å¤šæ•°éƒ½æ¿€ä¸èµ·æˆ‘å¿ƒä¸­çš„æ³¢æ¾œï¼Œå› ä¸ºå‡ æ¬¡æ›¾ç»çš„ç»å†è®©æˆ‘çš„å¿ƒå¢ƒä¸å†ä¸ºå®ƒä»¬æ‰€é¢¤åŠ¨ã€‚æ›¾ç»å¬ä¸€ä¸ªäººè¯´ç†æ€§çš„è‡ªå·±å’Œæ„Ÿæ€§çš„è‡ªå·±è¿™æ ·çš„æ¦‚å¿µï¼Œè¿™ä¸¤ä¸ªè‡ªå·±åšå‡ºæ¥çš„å†³å®šæ˜¯æˆªç„¶ä¸åŒçš„ï¼Œæ²¡æœ‰æ³¢æ¾œçš„è‡ªå·±å½“ç„¶éƒ½æ˜¯ç†æ€§çš„ã€‚å†·æ·¡çš„æ—¥å­å®‰é™çš„è‡ªå·±ï¼Œå®æ„¿å›å®¶å¾…7å¤©ã€‚ åå¹´åå¹´ è¿™ä¸ªè¯ï¼Œå¯¹æˆ‘æ¥è¯´æ›¾ä¸€ç›´æ˜¯å¾ˆåºå¤§çš„é‡çº§ï¼Œè¿™æ¬¡ç«Ÿè¢«æˆ‘çˆ¸è½»æ˜“åœ°ç”¨åœ¨äº†æˆ‘èº«ä¸Šã€‚ä»¥å¾€å¬åˆ°è¿™ä¸ªè¯åé¢è·Ÿçš„è¯ï¼Œéƒ½ä¸åœ¨æˆ‘çš„è®°å¿†èŒƒå›´å†…ï¼Œä½†æ˜¯è¿™å›â€¦åå¹´å‰çš„é‚£äº›æˆ‘éƒ½å†å†åœ¨ç›®ã€‚åªè®°å¾—å‡ å¹´å‰ï¼Œå´ä¸æ›¾æƒ³å·²ç»æ˜¯åå¹´å‰ã€‚ å˜å¬è¯´æˆ‘å›å®¶ä¹‹å‰å‡ ä¸ªè¡¨å¦¹å·²ç»å›æ¥è¿‡åˆèµ°äº†ï¼Œè€Œä¸”è¿˜æ˜¯æŠ±ç€è‡ªå·±åˆšå‡ºç”Ÿçš„å­©å­æ¥çš„ã€‚å ‚å¼Ÿä¹Ÿå¸¦ç€çš„ä»–å¥³æœ‹å‹è·Ÿä»–å¦ˆå¦ˆæ­£æ‰“éº»å°†ã€‚æˆ‘å§å§çš„åŒèƒèƒè¿™ä¸ªæœˆåº•ä¹Ÿè¦å‡ºç”Ÿäº†ã€‚æˆ‘ï¼Ÿ æˆ‘ç°åœ¨ä¸€å¤´é»„å‘ï¼Œæ»¡å˜´èƒ¡æ¸£ã€‚ä¸€ç›´é»˜é»˜åœ°è€•è€˜ç€è‡ªå·±çš„æœªæ¥ï¼Œä¸€å›å¤´å‘ç°å‘¨å›´çš„æœªæ¥å·²æ¥ã€‚å½“ç„¶ä¹Ÿæœ‰ä¸å˜å¾—ï¼Œç»è¿‡10å¤šå¹´ï¼Œä¹¡ä¸‹çš„æ ·è²Œå€’æ”¹å˜ä¸æ˜¯å¾ˆå¤§ï¼Œè¿˜æ˜¯æœ‰å„¿æ—¶çš„æ„Ÿè§‰ã€‚ å¯‚åœ¨å®¶æˆ‘é€‰æ‹©äº†ç”µè„‘ï¼Œå†å¹´é•¿æ­¤ä»¥å¾€ã€‚æˆ‘ä¸çŸ¥é“åœ¨æˆé•¿è¿‡ç¨‹ä¸­ï¼Œç”µè„‘æ˜¯ä¸æ˜¯å¯¹æ€§æ ¼çš„å…»æˆæœ‰åŠ©æ”»ã€‚å®ƒç»™äº†é€ƒé¿çš„æ¸¯æ¹¾ï¼Ÿæˆ‘åªæ˜¯è§‰å¾—å®ƒæ›´æœ‰æ„ä¹‰ã€‚æˆ‘ç»™äººçš„å°è±¡å°±è·Ÿç”µè„‘å…³è”åœ¨äº†ä¸€èµ·ã€‚å‡ºå»ç©ï¼Œæˆ‘ä¹Ÿå¯ä»¥ç©å¾—å¾ˆå¥½ã€‚ä½†å¾€å¾€ä¸æƒ³ï¼Œæˆ–è®¸ç”¨ä¸€ä¸ªå­—æ¦‚æ‹¬ â€œå®…â€ ï¼Ÿ ç»“çœ‹äº†ä¸¤å¤©çš„ã€Šæƒåˆ©çš„æ¸¸æˆã€‹ï¼Œå‡†å¤‡å¼€å§‹ä»£ç ä¸€æ³¢ã€‚ç„¶åæ•´ç†æ€ç»ªï¼Œç»§ç»­è€•è€˜æˆ‘çš„ä¸–ç•Œã€‚","tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://www.yangjie.hu//tags/éšç¬”/"}]},{"title":"iOSéšå¼åŠ¨ç”»","date":"2017-07-19T01:08:59.000Z","path":"2017/07/19/iOSéšå¼åŠ¨ç”»/","text":"å…ˆæ¥ä¸€æ®µå¼•ç”¨æ”¹å˜ä¸‹å¯¹åŠ¨ç”»çš„ä¸–ç•Œè§‚ï¼š Core AnimationåŸºäºä¸€ä¸ªå‡è®¾ï¼Œè¯´å±å¹•ä¸Šçš„ä»»ä½•ä¸œè¥¿éƒ½å¯ä»¥ï¼ˆæˆ–è€…å¯èƒ½ï¼‰åšåŠ¨ç”»ã€‚ åŠ¨ç”»å¹¶ä¸éœ€è¦ä½ åœ¨Core Animationä¸­æ‰‹åŠ¨æ‰“å¼€ï¼Œç›¸åéœ€è¦æ˜ç¡®åœ°å…³é—­ï¼Œå¦åˆ™ä»–ä¼šä¸€ç›´å­˜åœ¨ã€‚ 123456CGFloat red = arc4random() / (CGFloat)INT_MAX; CGFloat green = arc4random() / (CGFloat)INT_MAX; CGFloat blue = arc4random() / (CGFloat)INT_MAX; self.colorLayer.backgroundColor = [UIColor colorWithRed:red green:green blue:blue alpha:1.0].CGColor; ä¸Šé¢è¿™æ ·çš„ä¸€æ®µä»£ç ï¼Œæ²¡æœ‰è®¾ç½®ä»»ä½•åŠ¨ç”»ï¼Œä½†æ˜¯åœ¨è¿è¡Œçš„æ—¶å€™ä¼šå‘ç°é¢œè‰²çš„å˜åŒ–å¹¶ä¸æ˜¯çªå˜çš„ï¼Œæœ‰ä¸€å®šçš„åŠ¨ç”»æ•ˆæœã€‚è¿™ä¸ªåŠ¨ç”»æ€ä¹ˆå®ç°çš„ï¼Œæ—¶é—´åˆæ˜¯å¤šå°‘å‘¢ï¼Ÿ è¿™å¾—å…ˆä»äº‹åŠ¡è¯´èµ·ã€‚ äº‹åŠ¡æ˜¯Core Animationç”¨æ¥åŒ…å«ä¸€ç³»åˆ—å±æ€§åŠ¨ç”»é›†åˆçš„æœºåˆ¶ï¼Œä»»ä½•ç”¨æŒ‡å®šäº‹åŠ¡å»æ”¹å˜å¯ä»¥åšåŠ¨ç”»çš„å›¾å±‚å±æ€§éƒ½ä¸ä¼šç«‹åˆ»å‘ç”Ÿå˜åŒ–ï¼Œè€Œæ˜¯å½“äº‹åŠ¡ä¸€æ—¦æäº¤çš„æ—¶å€™å¼€å§‹ç”¨ä¸€ä¸ªåŠ¨ç”»è¿‡æ¸¡åˆ°æ–°å€¼ã€‚ äº‹åŠ¡é€šè¿‡ CATransaction ç±»æ¥åšç®¡ç†ï¼Œä½¿ç”¨+beginå’Œ+commitæ¥å…¥æ ˆå’Œå‡ºæ ˆã€‚ Core Animationåœ¨æ¯ä¸ªrun loopå‘¨æœŸä¸­è‡ªåŠ¨å¼€å§‹ä¸€æ¬¡æ–°çš„äº‹åŠ¡ï¼Œå³ä½¿ä¸æ˜¾å¼çš„è°ƒç”¨[CATransaction begin] å¼€å§‹ä¸€æ¬¡äº‹åŠ¡ï¼Œä»»ä½•åœ¨ä¸€æ¬¡run loopå¾ªç¯ä¸­å±æ€§çš„æ”¹å˜éƒ½ä¼šè¢«é›†ä¸­èµ·æ¥ï¼Œç„¶ååšä¸€æ¬¡0.25ç§’çš„åŠ¨ç”»ã€‚ å…³é—­éšå¼åŠ¨ç”»Core Animationé€šå¸¸å¯¹CALayerçš„æ‰€æœ‰å±æ€§ï¼ˆå¯åŠ¨ç”»çš„å±æ€§ï¼‰åšåŠ¨ç”»ï¼Œä½†æ˜¯UIViewæŠŠå®ƒå…³è”çš„å›¾å±‚çš„è¿™ä¸ªç‰¹æ€§å…³é—­äº†ã€‚ æˆ‘ä»¬æŠŠæ”¹å˜å±æ€§æ—¶CALayerè‡ªåŠ¨åº”ç”¨çš„åŠ¨ç”»ç§°ä½œè¡Œä¸ºï¼Œå½“CALayerçš„å±æ€§è¢«ä¿®æ”¹æ—¶å€™ï¼Œå®ƒä¼šè°ƒç”¨-actionForKey:æ–¹æ³•ï¼Œä¼ é€’å±æ€§çš„åç§°ã€‚å…·ä½“çœ‹çœ‹æ˜¯éšå¼åŠ¨ç”»çš„å®ç°æ­¥éª¤ï¼š è¿™æ˜¯CALayerå¤´æ–‡ä»¶é‡Œå¯¹actionForKey:æ–¹æ³•è°ƒç”¨çš„æè¿° 1234567891011121314/* Returns the action object associated with the event named by the * string &apos;event&apos;. The default implementation searches for an action * object in the following places: * * 1. if defined, call the delegate method -actionForLayer:forKey: * 2. look in the layer&apos;s `actions&apos; dictionary * 3. look in any `actions&apos; dictionaries in the `style&apos; hierarchy * 4. call +defaultActionForKey: on the layer&apos;s class * * If any of these steps results in a non-nil action object, the * following steps are ignored. If the final result is an instance of * NSNull, it is converted to `nil&apos;. */- (nullable id&lt;CAAction&gt;)actionForKey:(NSString *)event; å›¾å±‚é¦–å…ˆæ£€æµ‹å®ƒæ˜¯å¦æœ‰å§”æ‰˜ï¼Œå¹¶ä¸”æ˜¯å¦å®ç°CALayerDelegateåè®®æŒ‡å®šçš„-actionForLayer:forKeyæ–¹æ³•ã€‚å¦‚æœæœ‰ï¼Œç›´æ¥è°ƒç”¨å¹¶è¿”å›ç»“æœã€‚ å¦‚æœæ²¡æœ‰å§”æ‰˜ï¼Œæˆ–è€…å§”æ‰˜æ²¡æœ‰å®ç°-actionForLayer:forKeyæ–¹æ³•ï¼Œå›¾å±‚æ¥ç€æ£€æŸ¥åŒ…å«å±æ€§åç§°å¯¹åº”è¡Œä¸ºæ˜ å°„çš„actionså­—å…¸ã€‚ å¦‚æœactionså­—å…¸æ²¡æœ‰åŒ…å«å¯¹åº”çš„å±æ€§ï¼Œé‚£ä¹ˆå›¾å±‚æ¥ç€åœ¨å®ƒçš„styleå­—å…¸æ¥ç€æœç´¢å±æ€§åã€‚ æœ€åï¼Œå¦‚æœåœ¨styleé‡Œé¢ä¹Ÿæ‰¾ä¸åˆ°å¯¹åº”çš„è¡Œä¸ºï¼Œé‚£ä¹ˆå›¾å±‚å°†ä¼šç›´æ¥è°ƒç”¨å®šä¹‰äº†æ¯ä¸ªå±æ€§çš„æ ‡å‡†è¡Œä¸ºçš„-defaultActionForKey:æ–¹æ³•ã€‚ æ‰€ä»¥ä¸€è½®å®Œæ•´çš„æœç´¢ç»“æŸä¹‹åï¼Œ-actionForKey:è¦ä¹ˆè¿”å›ç©ºï¼ˆè¿™ç§æƒ…å†µä¸‹å°†ä¸ä¼šæœ‰åŠ¨ç”»å‘ç”Ÿï¼‰ï¼Œè¦ä¹ˆæ˜¯CAActionåè®®å¯¹åº”çš„å¯¹è±¡ï¼Œæœ€åCALayeræ‹¿è¿™ä¸ªç»“æœå»å¯¹å…ˆå‰å’Œå½“å‰çš„å€¼åšåŠ¨ç”»ã€‚ è¿™å°±è§£é‡Šäº†UIKitæ˜¯å¦‚ä½•ç¦ç”¨éšå¼åŠ¨ç”»çš„ï¼šæ¯ä¸ªUIViewå¯¹å®ƒå…³è”çš„å›¾å±‚éƒ½æ‰®æ¼”äº†ä¸€ä¸ªå§”æ‰˜ï¼Œå¹¶ä¸”æä¾›äº†-actionForLayer:forKeyçš„å®ç°æ–¹æ³•ã€‚å½“ä¸åœ¨ä¸€ä¸ªåŠ¨ç”»å—çš„å®ç°ä¸­ï¼ŒUIViewå¯¹æ‰€æœ‰å›¾å±‚è¡Œä¸ºè¿”å›nilï¼Œä½†æ˜¯åœ¨åŠ¨ç”»blockèŒƒå›´ä¹‹å†…ï¼Œå®ƒå°±è¿”å›äº†ä¸€ä¸ªéç©ºå€¼ã€‚ ps : [CATransaction begin]ä¹‹åæ·»åŠ ä¸‹é¢çš„ä»£ç ï¼ŒåŒæ ·ä¹Ÿä¼šé˜»æ­¢åŠ¨ç”»çš„å‘ç”Ÿï¼š [CATransaction setDisableActions:YES]; å…³è”å›¾å±‚è®¾ç½®åŠ¨ç”» UIViewå…³è”çš„å›¾å±‚ç¦ç”¨äº†éšå¼åŠ¨ç”»ï¼Œå¯¹è¿™ç§å›¾å±‚åšåŠ¨ç”»çš„å”¯ä¸€åŠæ³•å°±æ˜¯ä½¿ç”¨UIViewçš„åŠ¨ç”»å‡½æ•°ï¼ˆè€Œä¸æ˜¯ä¾èµ–CATransactionï¼‰ï¼Œæˆ–è€…ç»§æ‰¿UIViewï¼Œå¹¶è¦†ç›–-actionForLayer:forKey:æ–¹æ³•ï¼Œæˆ–è€…ç›´æ¥åˆ›å»ºä¸€ä¸ªæ˜¾å¼åŠ¨ç”»ï¼ˆç­‰å¾…ä¸‹ä¸€ç¯‡ç¬”è®°ï¼‰ã€‚ å¯¹äºå•ç‹¬å­˜åœ¨çš„å›¾å±‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç°å›¾å±‚çš„-actionForLayer:forKey:å§”æ‰˜æ–¹æ³•ï¼Œæˆ–è€…æä¾›ä¸€ä¸ªactionså­—å…¸æ¥æ§åˆ¶éšå¼åŠ¨ç”»ã€‚ è‡ªå®šä¹‰è¡Œä¸ºè¡Œä¸ºé€šå¸¸æ˜¯ä¸€ä¸ªè¢«Core Animationéšå¼è°ƒç”¨çš„æ˜¾å¼åŠ¨ç”»ã€‚ æˆ‘ä»¬æ¥å¯¹é¢œè‰²æ¸å˜çš„ä»£ç ï¼ˆæ–‡ç« é¡¶éƒ¨ï¼‰ä½¿ç”¨ä¸€ä¸ªä¸åŒçš„è¡Œä¸ºï¼Œé€šè¿‡ç»™colorLayerè®¾ç½®ä¸€ä¸ªè‡ªå®šä¹‰çš„actionså­—å…¸ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å§”æ‰˜æ¥å®ç°ï¼Œä½†æ˜¯actionså­—å…¸å¯ä»¥å†™æ›´å°‘çš„ä»£ç ã€‚ PS: CATransitionå“åº”CAActionåè®®ï¼Œå¹¶ä¸”å¯ä»¥å½“åšä¸€ä¸ªå›¾å±‚è¡Œä¸º 12345//add a custom action CATransition *transition = [CATransition animation]; transition.type = kCATransitionPush; transition.subtype = kCATransitionFromLeft; self.colorLayer.actions = @&#123;@\"backgroundColor\": transition&#125;; åœ¨åˆå§‹åŒ–çš„æ—¶å€™ç»™layeræ·»åŠ äº†è¿™æ ·çš„è¡Œä¸ºä¹‹åï¼Œå°±å¯ä»¥å¯¹éšå¼åŠ¨ç”»æ·»åŠ äº†ä¸€ä¸ª æ¨è¿›è¿‡åº¦ çš„æ•ˆæœ ReferenceiOS Core Animation ååˆ†æ„Ÿè°¢è¯‘è€…","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"Hiï¼CALayeræˆ‘ä»¬èŠèŠ","date":"2017-07-17T07:39:59.000Z","path":"2017/07/17/Hiï¼CALayeræˆ‘ä»¬èŠèŠ/","text":"CALayerå’ŒUIViewæœ€å¤§çš„ä¸åŒå°±æ˜¯ï¼ŒCALayerä¸å¤„ç†ç”¨æˆ·äº¤äº’ã€‚å› ä¸ºå®ƒå¹¶ä¸æ¸…æ¥šå…·ä½“çš„å“åº”é“¾ã€‚ 1. iOS å’Œ MacOS çš„åæ ‡ç³»ç»Ÿ ç‚¹ â€”â€” åœ¨iOSå’ŒMac OSä¸­æœ€å¸¸è§çš„åæ ‡ä½“ç³»ã€‚ç‚¹å°±åƒæ˜¯è™šæ‹Ÿçš„åƒç´ ï¼Œä¹Ÿè¢«ç§° ä½œé€»è¾‘åƒç´ ã€‚åœ¨æ ‡å‡†è®¾å¤‡ä¸Šï¼Œä¸€ä¸ªç‚¹å°±æ˜¯ä¸€ä¸ªåƒç´ ï¼Œä½†æ˜¯åœ¨Retinaè®¾å¤‡ä¸Šï¼Œä¸€ ä¸ªç‚¹ç­‰äº2*2ä¸ªåƒç´ ã€‚iOSç”¨ç‚¹ä½œä¸ºå±å¹•çš„åæ ‡æµ‹ç®—ä½“ç³»å°±æ˜¯ä¸ºäº†åœ¨Retinaè®¾å¤‡ å’Œæ™®é€šè®¾å¤‡ä¸Šèƒ½æœ‰ä¸€è‡´çš„è§†è§‰æ•ˆæœã€‚ åƒç´  â€”â€” ç‰©ç†åƒç´ åæ ‡å¹¶ä¸ä¼šç”¨æ¥å±å¹•å¸ƒå±€ï¼Œä½†æ˜¯ä»ç„¶ä¸å›¾ç‰‡æœ‰ç›¸å¯¹å…³ç³»ã€‚ UIImageæ˜¯ä¸€ä¸ªå±å¹•åˆ†è¾¨ç‡è§£å†³æ–¹æ¡ˆï¼Œæ‰€ä»¥æŒ‡å®šç‚¹æ¥åº¦é‡å¤§å°ã€‚ä½†æ˜¯ä¸€äº›åº•å±‚ çš„å›¾ç‰‡è¡¨ç¤ºå¦‚CGImageå°±ä¼šä½¿ç”¨åƒç´ ï¼Œæ‰€ä»¥ä½ è¦æ¸…æ¥šåœ¨Retinaè®¾å¤‡å’Œæ™®é€šè®¾å¤‡ ä¸Šï¼Œä»–ä»¬è¡¨ç°å‡ºæ¥äº†ä¸åŒçš„å¤§å°ã€‚ å•ä½ â€”â€” å¯¹äºä¸å›¾ç‰‡å¤§å°æˆ–æ˜¯å›¾å±‚è¾¹ç•Œç›¸å…³çš„æ˜¾ç¤ºï¼Œå•ä½åæ ‡æ˜¯ä¸€ä¸ªæ–¹ä¾¿çš„ åº¦é‡æ–¹å¼ï¼Œ å½“å¤§å°æ”¹å˜çš„æ—¶å€™ï¼Œä¹Ÿä¸éœ€è¦å†æ¬¡è°ƒæ•´ã€‚å•ä½åæ ‡åœ¨OpenGLè¿™ç§ çº¹ç†åæ ‡ç³»ç»Ÿä¸­ç”¨å¾—å¾ˆå¤šï¼ŒCore Animationä¸­ä¹Ÿç”¨åˆ°äº†å•ä½åæ ‡ã€‚ 2. CALayerå±‚çš„ç®€å•ä½¿ç”¨ï¼š2.1 ç»™UIViewè®¾ç½®å¯„å®¿å›¾ç‰‡12345//è®¾ç½®å›¾ç‰‡layer.contents = (__bridge id)image.CGImage;//è®¾ç½®å›¾ç‰‡çš„å±•ç¤ºæ¨¡å¼layer.contentsGravity = kCAGravityResizeAspect; contentsGravityçš„å¯é€‰å¸¸é‡ï¼š 123456789101112kCAGravityCenter kCAGravityTop kCAGravityBottom kCAGravityLeft kCAGravityRight kCAGravityTopLeft kCAGravityTopRight kCAGravityBottomLeft kCAGravityBottomRight kCAGravityResize kCAGravityResizeAspect kCAGravityResizeAspectFill å°†contentsScaleè®¾ç½®ä¸º1.0ï¼Œå°†ä¼šä»¥æ¯ä¸ªç‚¹1ä¸ªåƒç´ ç»˜åˆ¶å›¾ç‰‡ï¼Œå¦‚æœè®¾ç½®ä¸º2.0ï¼Œåˆ™ä¼šä»¥æ¯ä¸ªç‚¹2ä¸ªåƒç´ ç»˜åˆ¶å›¾ç‰‡ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬ç†ŸçŸ¥çš„Retinaå±å¹•ã€‚(å‰ææ˜¯contentsGravityæ²¡æœ‰è¢«è®¾ç½®)ï¼Œè§†å›¾å±‚UIViewæœ‰ä¸€ä¸ªç±»ä¼¼çš„å±æ€§contentScaleFactor å½“ç”¨ä»£ç çš„æ–¹å¼æ¥å¤„ç†å¯„å®¿å›¾çš„æ—¶å€™ï¼Œä¸€å®šè¦è®°ä½è¦æ‰‹åŠ¨çš„è®¾ç½®å›¾å±‚ çš„ contentsScale å±æ€§ï¼Œå¦åˆ™ï¼Œä½ çš„å›¾ç‰‡åœ¨Retinaè®¾å¤‡ä¸Šå°±æ˜¾ç¤ºå¾—ä¸æ­£ç¡®å•¦ã€‚ 1layer.contentsScale = [UIScreen mainScreen].scale; 2.2 ä½¿ç”¨contentsRectå®ç°image spritesï¼ˆå›¾ç‰‡æ‹¼åˆï¼‰ä¸»è¦æ€æƒ³ï¼šè½½å…¥ä¸€å¼ åŒ…å«å¾ˆå¤šå°å›¾çš„å¤§å›¾ï¼Œç„¶åé€šè¿‡contentsRectå°†å¤§å›¾ä¸­çš„å°å›¾åˆ†åˆ«å±•ç¤ºåˆ°ä¸åŒçš„è§†å›¾å±‚ä¸­ã€‚ ä¼˜ç‚¹ï¼šå›¾ç‰‡çš„è½½å…¥ä¼šæ›´åŠ å¿«ï¼Œæé«˜äº†è½½å…¥æ€§èƒ½ contentsRectçš„{0, 0, 0.5, 0.5}æ•ˆæœ 1234567891011121314- (void)viewDidLoad &#123; [super viewDidLoad]; //load sprite sheet UIImage *image = [UIImage imageNamed:@&quot;Sprites.png&quot;]; //set igloo sprite [self addSpriteImage:image withContentRect:CGRectMake(0, 0, 0.5, 0.5) toLayer:self.iglooView.layer]; //set cone sprite [self addSpriteImage:image withContentRect:CGRectMake(0.5, 0, 0.5, 0.5) toLayer:self.coneView.layer]; //set anchor sprite [self addSpriteImage:image withContentRect:CGRectMake(0, 0.5, 0.5, 0.5) toLayer:self.anchorView.layer]; //set spaceship sprite [self addSpriteImage:image withContentRect:CGRectMake(0.5, 0.5, 0.5, 0.5) toLayer:self.shipView.layer];&#125; 2.3 ä½¿ç”¨contentsCenterè°ƒæ•´å¯æ‹‰ä¼¸åŒºåŸŸçš„å¤§å°contentsCenter å…¶å®æ˜¯ä¸€ä¸ªCGRectï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªå›ºå®šçš„è¾¹æ¡†å’Œä¸€ä¸ªåœ¨å›¾ å±‚ä¸Šå¯æ‹‰ä¼¸çš„åŒºåŸŸã€‚ é™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥ç”¨IBæ¥æ§åˆ¶contentsCenterå±æ€§ã€‚ åœ¨è§†å›¾çš„ç¬¬å››ä¸ªæ£€æŸ¥å™¨ä¸­ï¼Œæœ‰ä¸€ä¸ªstretchingå±æ€§ï¼Œç®€ç›´ä¸è¦å¤ªèµğŸ‘ Referenceã€ŠiOS æ ¸å¿ƒåŠ¨ç”»ã€‹ æ„Ÿè°¢è¯‘è€…çš„ä»˜å‡ºï¼ğŸ‘","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"è‡ªå®šä¹‰NSURLProtocolå®ç°UIWebViewç¼“å­˜æœºåˆ¶","date":"2017-07-14T02:08:43.000Z","path":"2017/07/14/è‡ªå®šä¹‰NSURLProtocolå®ç°UIWebViewç¼“å­˜æœºåˆ¶/","text":"è¿‘æœŸæ­£åœ¨ç ”ç©¶UIWebViewåŠ è½½ç½‘é¡µçš„ç¼“å­˜çš„å®ç°ï¼Œæ¯”è¾ƒå¸¸è§çš„æ˜¯ä½¿ç”¨è‡ªå®šä¹‰çš„NSURLProtocolè¿›è¡Œæ‹¦æˆªå¤„ç†ã€‚æ ¹æ®ç½‘ä¸Šçš„èµ„æ–™ï¼Œç»“åˆè¯•éªŒå’Œè‡ªå·±çš„ç†è§£åšä¸ªè®°å½•ã€‚ ä»‹ç»ä»‹ç»ä¸‹æˆ‘äº§å‡ºçš„YJURLProtocolå®Œæˆçš„åŠŸèƒ½ åŠŸèƒ½ æ”¯æŒ è¯´æ˜ ç¼“å­˜æ•°æ® æ˜¯ å°†æ•´ä¸ªrequestç¼“å­˜ä¸‹æ¥ï¼Œä»¥åŠå…¶response è®¾ç½®è¿‡æœŸæ—¶é—´ æ˜¯ é»˜è®¤ä¸ºä¸¤å¤©è¿‡æœŸï¼Œè¿‡æœŸåè¯·æ±‚ä¼šåˆ é™¤åŸæœ‰ç¼“å­˜ è‡ªåŠ¨æ›´æ–°ç¼“å­˜ æ˜¯ é—´éš”æ—¶é—´è¶…è¿‡1minçš„è¯·æ±‚ï¼ŒåŠ è½½é¡µé¢åå¼‚æ­¥æ›´æ–°ç¼“å­˜ UIWebViewç¼“å­˜ä½¿ç”¨æœºåˆ¶ï¼š ä¸¤ä¸ªç›¸åŒçš„è¯·æ±‚æ—¶é—´ç›¸éš”åœ¨60sä¹‹å†…ï¼Œç›´æ¥ä½¿ç”¨ç¼“å­˜ï¼Œä¸è¿›è¡Œå¼‚æ­¥æ›´æ–°ç¼“å­˜ ä¸¤ä¸ªç›¸åŒçš„è¯·æ±‚ç›¸éš”60s+ä½†æ˜¯æ²¡æœ‰è¿‡æœŸï¼Œä½¿ç”¨ç¼“å­˜åŠ è½½é¡µé¢åï¼Œ1minåè¿›è¡Œå¼‚æ­¥æ›´æ–°ç¼“å­˜å¹¶åˆ·æ–°é¡µé¢ ç¼“å­˜å‘½ä¸­ä½†æ˜¯æ—¶é—´å·²ç»æ˜¯ä¸¤å¤©å‰ï¼Œåˆ™åˆ é™¤ç¼“å­˜èµ°ç½‘ç»œæ•°æ® NSURLProtocolä»€ä¹ˆæ˜¯NSURLPrototol ï¼ˆNSURLProtocolä»€ä¹ˆçš„æˆ‘éƒ½æ‡‚ï¼Œæˆ‘è¦ç›´æ¥çœ‹ğŸŒ°ï¼‰Appleçš„URL Loading Systemçš„æ ¸å¿ƒæ˜¯NSURLç±»ï¼ŒNSURLæä¾›ç»™appè¦è®¿é—®èµ„æºçš„åœ°å€ï¼ŒNSURLRequestå¯¹è±¡å†é¢å¤–æ·»åŠ HTTP headersï¼Œ bodyä¹‹ç±»çš„ä¿¡æ¯ï¼Œç„¶åURL Loading Systemæä¾›NSURLSessionå’ŒNSURLConnectionçš„å„ç§å­ç±»æ–¹æ³•å»æ‰§è¡Œè¿™ä¸ªè¯·æ±‚ã€‚ è¯·æ±‚è¿”å›çš„æ•°æ®ä¼šæœ‰ä¸¤åˆ†éƒ¨åˆ†ï¼Œmetadata å’Œ dataã€‚metadataè¢«åŒ…æ‹¬åœ¨NSURLResponseå¯¹è±¡ä¸­ï¼Œå®ƒä¼šæä¾›MIME typeï¼Œå’Œ text encodingã€‚ dataçš„æ•°æ®æ˜¯NSDataç±»å‹ã€‚ åœ¨ä»¥ä¸Šè¿‡ç¨‹ä¹‹åï¼ŒURL Loading Systemé€šè¿‡NSURLRequestä¸‹è½½äº†ä¿¡æ¯ä¹‹åï¼Œå®ƒå°†ä¼šåˆ›å»ºä¸€ä¸ªNSURLProtocolå­ç±»çš„å¯¹è±¡ã€‚ Note: Remember that Objective-C doesnâ€™t actually have abstract classes as a first class citizen. Itâ€™s only by definition and documentation that a class is marked as abstract. åƒä¸‡ä¸èƒ½ç›´æ¥å®ä¾‹åŒ–NSURLProtocol, å¿…é¡»è¦ç»§æ‰¿NSURLProtocol,åœ¨å­ç±»ä¸­åˆ›å»ºNSURLResponseå¤„ç†responseã€‚ ä½¿ç”¨NSURLProtocolèƒ½åšä»€ä¹ˆ ä¸ºç½‘ç»œè¯·æ±‚æä¾›è‡ªå®šä¹‰çš„Response å¯ä»¥åœ¨ç½‘ç»œè°ƒè¯•çš„æ—¶å€™ï¼Œå‘èµ·ç½‘ç»œè¯·æ±‚åè¿›è¡Œè‡ªå®šä¹‰è¿”å›æ•°æ®è°ƒè¯•è‡ªå·±çš„APP è°ƒè¿‡ç½‘ç»œè¯·æ±‚ï¼ŒåŠ è½½æœ¬åœ°æ•°æ® æŸäº›æƒ…å†µä¸‹ï¼Œå‘èµ·çš„è¯·æ±‚å¹¶æ²¡æœ‰å»è¯·æ±‚ç½‘ç»œçš„å¿…è¦ï¼Œå¯ä»¥ä¿®æ”¹ä½¿ç”¨æœ¬åœ°çš„æ•°æ®ã€‚ï¼ˆè‡ªå®šä¹‰webViewçš„ç¼“å­˜å°±æ˜¯å¦‚æ­¤å®ç°ï¼‰ é‡å®šå‘ç½‘ç»œè¯·æ±‚ å¯ä»¥å°†è¯·æ±‚é‡å®šå‘åˆ°æŸä¸ªä»£ç†æœåŠ¡å™¨ï¼Œä¸éœ€è¦é€šè¿‡iOSç»™ç”¨æˆ·å¼¹å‡ºæˆæƒçª—å£ ä¿®æ”¹Requestçš„User-agent å¦‚æœä½ çš„ä¸€ä¸ªé¡µé¢æ˜¯åˆ†ä¸åŒçš„è®¾å¤‡è¿”å›æ•°æ®çš„ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨è¿™é‡Œè®¾ç½®è‡ªå®šçš„user-agentï¼Œæ¥è¾¾åˆ°ä½ çš„éœ€æ±‚ã€‚ ä½¿ç”¨è‡ªå·±çš„ç½‘ç»œåè®® å¯ä»¥æ›¿æ¢ä½¿ç”¨è‡ªå·±å®ç°çš„ç½‘ç»œåè®®ï¼Œæ¯”å¦‚æœ‰äº›å»ºç«‹åœ¨UDPä¹‹ä¸Šçš„åè®®ã€‚ NSURLProtocolçš„ä½¿ç”¨1[NSURLProtocol registerClass:[JakeyURLProtocol class]]; ä»¥ä¸Šä»£ç è¡¨ç¤ºï¼Œä½ å·²ç»å‘URL Loading Systemæ³¨å†Œäº†è‡ªå·±çš„NSURLProtocolå­ç±»ï¼Œè¿™ä¸ªå­ç±»å°†æœ‰æœºä¼šå¤„ç†æ¯ä¸€ä¸ªå‘é€åˆ°URL Loading Systemçš„è¯·æ±‚ã€‚ åœ¨NSURLProtocolçš„å­ç±»å®ç°æ–‡ä»¶ä¸­ï¼š123+ (BOOL)canInitWithRequest:(NSURLRequest *)request &#123; return YES;&#125; é‡è½½ä»¥ä¸Šä»£ç ï¼Œè¿”å›YESã€‚è¡¨ç¤ºæ­¤å­ç±»æ³¨å†Œä¹‹åå°†ä½¿ç”¨æ­¤å­ç±»å¤„ç†æ‰€æœ‰çš„è¯·æ±‚ï¼Œè¿”å›NOåˆ™ä»ç„¶ä½¿ç”¨URL Loading Systemçš„é»˜è®¤protocolå¤„ç†è¯·æ±‚ã€‚ 1234567891011121314151617181920//è¿™æ˜¯ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå­ç±»å¿…é¡»æä¾›å®ç°æ–¹æ³•ã€‚æ­¤æ–¹æ³•å¯ç”¨äºä¿®æ”¹requestï¼Œæ·»åŠ ä¸€ä¸ªheaderç­‰+ (NSURLRequest *)canonicalRequestForRequest:(NSURLRequest *)request &#123; return request;&#125;//ç”¨äºåˆ¤æ–­ä½ çš„è‡ªå®šä¹‰reqeustæ˜¯å¦ç›¸åŒï¼Œè¿™é‡Œè¿”å›é»˜è®¤å®ç°å³å¯ã€‚å®ƒçš„ä¸»è¦åº”ç”¨åœºæ™¯æ˜¯æŸäº›ç›´æ¥ä½¿ç”¨ç¼“å­˜è€Œéå†æ¬¡è¯·æ±‚ç½‘ç»œçš„åœ°æ–¹ã€‚+ (BOOL)requestIsCacheEquivalent:(NSURLRequest *)a toRequest:(NSURLRequest *)b &#123; return [super requestIsCacheEquivalent:a toRequest:b];&#125;//å¼€å§‹è¯·æ±‚- (void)startLoading &#123; self.connection = [NSURLConnection connectionWithRequest:self.request delegate:self];&#125;//è¯·æ±‚ç»“æŸ- (void)stopLoading &#123; [self.connection cancel]; self.connection = nil;&#125; è‡ªå®šä¹‰NSURLProtocolå®ç°UIWebViewç¼“å­˜æœºåˆ¶å¼€å§‹è¯·æ±‚ä¹‹åï¼Œå°†æ­¤è¯·æ±‚æ ‡è®°ä¸ºå·²å¤„ç† 12345- (void)startLoading &#123; NSMutableURLRequest *newRequest = [self.request mutableCopy]; [NSURLProtocol setProperty:@YES forKey:kHandledKey inRequest:newRequest]; self.connection = [NSURLConnection connectionWithRequest:newRequest delegate:self];&#125; åˆ¤æ–­è¯·æ±‚æ˜¯å¦å·²ç»è¢«å¤„ç†è¿‡ï¼Œé¿å…å¾ªç¯è¢«å¤„ç† 12345678910+ (BOOL)canInitWithRequest:(NSURLRequest *)request &#123; NSString *scheme = request.URL.scheme; if ([scheme caseInsensitiveCompare:@\"http\"]==NSOrderedSame||[scheme caseInsensitiveCompare:@\"https\"]==NSOrderedSame) &#123; if ([NSURLProtocol propertyForKey:kHandledKey inRequest:request]) &#123; return NO; &#125; return YES; &#125; return NO;&#125; è‡ªå®šä¹‰YJCacheResponseå¯¹è±¡ï¼Œå†…å®¹åŒ…å«å†…å®¹å¦‚ä¸‹ä»£ç  123456789101112131415161718192021@interface YJCachedResponse : NSObject@property (nonatomic, strong) NSData *data;@property (nonatomic, strong) NSString *url;@property (nonatomic, strong) NSString *mimeType;@property (nonatomic, strong) NSString *encoding;@property (nonatomic, strong, readonly) NSURLResponse *response;/** åˆå§‹åŒ–å°è£…çš„YJResponseå¯¹è±¡ @param data è¯·æ±‚ç»“æœæ•°æ® @param response @param timeInterval ç¼“å­˜è¿‡æœŸæ—¶é—´ @return å°è£…çš„YJResponseå¯¹è±¡ */- (instancetype)initWithData:(NSData *)data response:(NSURLResponse *)response limiteTime:(NSTimeInterval)timeInterval;//æ£€æŸ¥ç¼“å­˜æ˜¯å¦è¿‡æœŸ 0 ï¼šå·²è¿‡æœŸ , 1 ï¼š éœ€æ›´æ–°ç¼“å­˜, 2 ï¼šæ— éœ€æ›´æ–°ç¼“å­˜- (CacheStatus)isCacheEffective;@end åœ¨å¼€å§‹è¯·æ±‚- (void)startLoadingæ–¹æ³•ä¸­ï¼Œåˆ¤æ–­æ˜¯èµ°ç¼“å­˜è¿˜æ˜¯ä½¿ç”¨ç½‘ç»œè¯·æ±‚æ•°æ® 12345678910111213141516171819202122232425262728- (void)startLoading &#123; NSString *docPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) firstObject]; self.cachedFilePath = [docPath stringByAppendingPathComponent:md5(self.request.URL.absoluteString)]; //åœ¨ç¼“å­˜è¡¨ä¸­è·å–å½“å‰requestæ˜¯å¦æœ‰ç¼“å­˜ YJCachedResponse *cachedResponse = [self cachedResponseForCurrentRequest]; if (cachedResponse) &#123; switch ([cachedResponse isCacheEffective]) &#123; case OutOfDate: [self useNetData]; break; case UpdateNeedLess: [self useCacheData:cachedResponse]; break; case UpdateNeeded: [self useCacheData:cachedResponse]; //1ç§’é’Ÿä¹‹åé‡æ–°è¯·æ±‚ï¼Œæ›´æ–°ç¼“å­˜ dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(1 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123; [self useNetData]; &#125;); break; default: break; &#125; &#125; else &#123; [self useNetData]; &#125;&#125; åœ¨NSURLConnectionDelegateæ–¹æ³•ä¸­è¿›è¡ŒResponseä¿å­˜å’Œèµ‹å€¼ 1234567891011121314151617- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response &#123; [self.client URLProtocol:self didReceiveResponse:response cacheStoragePolicy:NSURLCacheStorageNotAllowed]; self.response = response; self.mutableData = [[NSMutableData alloc] init];&#125;- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data &#123; [self.client URLProtocol:self didLoadData:data]; [self.mutableData appendData:data];&#125;- (void)connectionDidFinishLoading:(NSURLConnection *)connection &#123; [self.client URLProtocolDidFinishLoading:self]; [self saveCachedResponse];&#125; ä»¥ä¸Šåªåˆ—å‡ºéƒ¨åˆ†å…³é”®é€»è¾‘ä»£ç ï¼Œè¯¦ç»†å®ç°è¯·ä¸‹è½½demoæŸ¥çœ‹æºç é—®é¢˜ç¼ºé™· ä¸€ä¸ªç½‘ç«™ä¼šæœ‰äº›ç½‘ç»œè¯·æ±‚åœ°å€è·Ÿæ—¶é—´æˆ³æˆ–è€…å…¶ä»–éšæœºå­—ç¬¦ç›¸å…³ï¼Œç¼“å­˜æœºåˆ¶ä¼šç¼“å­˜ä¸‹æ¥ï¼Œå¹¶ä¸”ä¹‹åä¸€ç›´æ²¡æœ‰æœºä¼šå‘½ä¸­å®ƒä»¬ï¼Œæ²¡æœ‰åŠæ³•è‡ªåŠ¨åˆ é™¤è¿™äº›ç¼“å­˜ï¼Œä¼šé€ æˆå†…å­˜æµªè´¹ã€‚ å› æœ¬äººæ°´å¹³æœ‰é™ï¼Œæ–‡ä¸­æœ‰ä»€ä¹ˆä¸æ­£ç¡®ä¹‹å¤„ï¼Œè¿˜è¯·æŒ‡å‡ºï¼Œä¸èƒœæ„Ÿè°¢ï¼ Referencehttps://www.raywenderlich.com/59982/nsurlprotocol-tutorial","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"å°ç¨‹åºé€»è¾‘å±‚","date":"2017-06-03T08:51:50.000Z","path":"2017/06/03/å°ç¨‹åºé€»è¾‘å±‚/","text":"æ³¨å†Œå°ç¨‹åºå‰å°ã€åå°å®šä¹‰ï¼š å½“ç”¨æˆ·ç‚¹å‡»å·¦ä¸Šè§’å…³é—­ï¼Œæˆ–è€…æŒ‰äº†è®¾å¤‡ Home é”®ç¦»å¼€å¾®ä¿¡ï¼Œå°ç¨‹åºå¹¶æ²¡æœ‰ç›´æ¥é”€æ¯ï¼Œè€Œæ˜¯è¿›å…¥äº†åå°ï¼›å½“å†æ¬¡è¿›å…¥å¾®ä¿¡æˆ–å†æ¬¡æ‰“å¼€å°ç¨‹åºï¼Œåˆä¼šä»åå°è¿›å…¥å‰å°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šåªæœ‰å½“å°ç¨‹åºè¿›å…¥åå°ä¸€å®šæ—¶é—´ï¼Œæˆ–è€…ç³»ç»Ÿèµ„æºå ç”¨è¿‡é«˜ï¼Œæ‰ä¼šè¢«çœŸæ­£çš„é”€æ¯ã€‚ å…³é—­å°ç¨‹åº(å…¬å…±åº“ç‰ˆæœ¬1.1.0å¼€å§‹æ”¯æŒ)ï¼š å½“ç”¨æˆ·ä»æ‰«ä¸€æ‰«ã€è½¬å‘ç­‰å…¥å£(åœºæ™¯å€¼ä¸º1007, 1008, 1011, 1025)è¿›å…¥å°ç¨‹åºï¼Œä¸”æ²¡æœ‰ç½®é¡¶å°ç¨‹åºçš„æƒ…å†µä¸‹é€€å‡ºï¼Œå°ç¨‹åºä¼šè¢«é”€æ¯ã€‚ åœ¨onLaunchå’ŒonShowæ–¹æ³•ä¸­å¯ä»¥è·å¾—çš„å‚æ•°ï¼š æ³¨æ„ï¼š App() å¿…é¡»åœ¨ app.js ä¸­æ³¨å†Œï¼Œä¸”ä¸èƒ½æ³¨å†Œå¤šä¸ªã€‚ ä¸è¦åœ¨å®šä¹‰äº App() å†…çš„å‡½æ•°ä¸­è°ƒç”¨ getApp() ï¼Œä½¿ç”¨ this å°±å¯ä»¥æ‹¿åˆ° app å®ä¾‹ã€‚ ä¸è¦åœ¨ onLaunch çš„æ—¶å€™è°ƒç”¨ getCurrentPages()ï¼Œæ­¤æ—¶ page è¿˜æ²¡æœ‰ç”Ÿæˆã€‚ é€šè¿‡ getApp() è·å–å®ä¾‹ä¹‹åï¼Œä¸è¦ç§è‡ªè°ƒç”¨ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚ æ³¨å†Œé¡µé¢ç”Ÿå‘½å‘¨æœŸå‡½æ•° onLoad: é¡µé¢åŠ è½½ ä¸€ä¸ªé¡µé¢åªä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œå¯ä»¥åœ¨ onLoad ä¸­è·å–æ‰“å¼€å½“å‰é¡µé¢æ‰€è°ƒç”¨çš„ query å‚æ•°ã€‚ onShow: é¡µé¢æ˜¾ç¤º æ¯æ¬¡æ‰“å¼€é¡µé¢éƒ½ä¼šè°ƒç”¨ä¸€æ¬¡ã€‚ onReady: é¡µé¢åˆæ¬¡æ¸²æŸ“å®Œæˆ ä¸€ä¸ªé¡µé¢åªä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œä»£è¡¨é¡µé¢å·²ç»å‡†å¤‡å¦¥å½“ï¼Œå¯ä»¥å’Œè§†å›¾å±‚è¿›è¡Œäº¤äº’ã€‚ å¯¹ç•Œé¢çš„è®¾ç½®å¦‚wx.setNavigationBarTitleè¯·åœ¨onReadyä¹‹åè®¾ç½®ã€‚è¯¦è§ç”Ÿå‘½å‘¨æœŸ onHide: é¡µé¢éšè— å½“navigateToæˆ–åº•éƒ¨tabåˆ‡æ¢æ—¶è°ƒç”¨ã€‚ onUnload: é¡µé¢å¸è½½ å½“redirectToæˆ–navigateBackçš„æ—¶å€™è°ƒç”¨ã€‚ onShareAppMessageè½¬å‘å°ç¨‹åºæ—¶éœ€è¦æ·»åŠ çš„è‡ªå®šä¹‰è½¬å­—æ®µï¼š 12345678Page(&#123; onShareAppMessage: function () &#123; return &#123; title: 'è‡ªå®šä¹‰è½¬å‘æ ‡é¢˜', path: '/page/user?id=123' &#125; &#125;&#125;) äº‹ä»¶å¤„ç†å‡½æ•°123&lt;!--index.wxml--&gt;&lt;view&gt;&#123;&#123;text&#125;&#125;&lt;/view&gt;&lt;button bindtap=&quot;changeText&quot;&gt; Change normal data &lt;/button&gt; 12345678910Page(&#123; data: &#123; text: 'init data', &#125;, changeText: function() &#123; // this.data.text = 'changed data' // bad, it can not work this.setData(&#123; text: 'changed data' &#125;) &#125; Tips ç›´æ¥ä¿®æ”¹ this.data è€Œä¸è°ƒç”¨ this.setData æ˜¯æ— æ³•æ”¹å˜é¡µé¢çš„çŠ¶æ€çš„ï¼Œè¿˜ä¼šé€ æˆæ•°æ®ä¸ä¸€è‡´ å•æ¬¡è®¾ç½®çš„æ•°æ®ä¸èƒ½è¶…è¿‡1024kBï¼Œè¯·å°½é‡é¿å…ä¸€æ¬¡è®¾ç½®è¿‡å¤šçš„æ•°æ®ã€‚ ä¸‹å›¾ä¸ºpageå®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸï¼š è·¯ç”±å°ç¨‹åºçš„é¡µé¢ç”¨æ ˆçš„å½¢å¼è¿›è¡Œç»´æŠ¤ç®¡ç†ï¼Œå¤§è‡´ä¸iOSç›¸ä¼¼ã€‚ è·¯ç”±æ–¹å¼ API é¡µé¢æ ˆè¡¨ç° åˆå§‹åŒ– æ–°é¡µé¢å…¥æ ˆ æ‰“å¼€æ–°é¡µé¢ wx.navigateTo æ–°é¡µé¢å…¥æ ˆ é¡µé¢é‡å®šå‘ wx.redirectTo å½“å‰é¡µé¢å‡ºæ ˆï¼Œæ–°é¡µé¢å…¥æ ˆ é¡µé¢è¿”å› wx.navigateBack é¡µé¢ä¸æ–­å‡ºæ ˆï¼Œç›´åˆ°ç›®æ ‡è¿”å›é¡µï¼Œæ–°é¡µé¢å…¥æ ˆ Tab åˆ‡æ¢ wx.switchTab é¡µé¢å…¨éƒ¨å‡ºæ ˆï¼Œåªç•™ä¸‹æ–°çš„ Tab é¡µé¢ é‡åŠ è½½ wx.reLaunch é¡µé¢å…¨éƒ¨å‡ºæ ˆï¼Œåªç•™ä¸‹æ–°çš„é¡µé¢ é¡µé¢é‡å®šå‘åœ¨iOSçš„UINavigationä¸­æ²¡æœ‰å¯¹åº”ã€‚ tabåˆ‡æ¢åœ¨å°ç¨‹åºé‡Œç«Ÿç„¶æ˜¯é¡µé¢å…¨éƒ¨å‡ºæ ˆï¼Œç•™ä¸‹æœ€æ–°çš„tabé¡µã€‚æˆ‘åœ¨iOSä¸­çš„å¤„ç†ä¸€èˆ¬æ˜¯ï¼Œæ¯ä¸ªtabé¡µæ‹¥æœ‰è‡ªå·±çš„Navigationï¼Œåˆ‡æ¢tabå°±åˆ‡æ¢å½“å…ˆä½¿ç”¨çš„Navigationã€‚ç³»ç»Ÿåº•å±‚çš„å®ç°åº”è¯¥ä¹Ÿæ˜¯ä¸æ˜¯å°ç¨‹åºè¿™æ ·ï¼Œç­‰å¾…å»ç ”ç©¶ä¸‹å›æ¥è·Ÿæ–°è¿™é‡Œå§ é‡åŠ è½½ï¼Œè¿™ä¸€é¡¹æœ‰ç‚¹ç–‘æƒ‘ã€‚å½“æˆ‘åœ¨æ¯”è¾ƒæ·±å±‚çš„é¡µé¢åˆ·æ–°é‡åŠ è½½ä¸€ä¸‹ï¼Œæ•´ä¸ªæ ˆé‡Œå°±åªå‰©ä¸‹å½“å‰é¡µé¢äº†ï¼Ÿï¼é‚£ç¨‹åºçš„å±‚æ¬¡ç»“æ„æ€ä¹ˆåŠï¼Œè¿˜æ˜¯è¯´å›åˆ°äº†é¦–é¡µï¼Œè¿™ä½“éªŒå¾ˆç³Ÿç³•å•Šã€‚ Tips: navigateTo, redirectTo åªèƒ½æ‰“å¼€é tabBar é¡µé¢ã€‚ switchTab åªèƒ½æ‰“å¼€ tabBar é¡µé¢ã€‚ reLaunch å¯ä»¥æ‰“å¼€ä»»æ„é¡µé¢ã€‚ é¡µé¢åº•éƒ¨çš„ tabBar ç”±é¡µé¢å†³å®šï¼Œå³åªè¦æ˜¯å®šä¹‰ä¸º tabBar çš„é¡µé¢ï¼Œåº•éƒ¨éƒ½æœ‰ tabBarã€‚ è°ƒç”¨é¡µé¢è·¯ç”±å¸¦çš„å‚æ•°å¯ä»¥åœ¨ç›®æ ‡é¡µé¢çš„onLoadä¸­è·å–ã€‚ æ¨¡å—åŒ–å°†å…¬å…±çš„ä»£ç æŠ½ç¦»å‡ºæ¥ï¼Œæ”¾åˆ°ä¸€ä¸ªå•ç‹¬çš„jsæ–‡ä»¶ä¸­ä½œä¸ºä¸€ä¸ªæ¨¡å—ã€‚æ¨¡å—åªæœ‰é€šè¿‡ module.exports æˆ–è€… exports æ‰èƒ½å¯¹å¤–æš´éœ²æ¥å£ã€‚ 12345// common.jsfunction sayHello(name) &#123; console.log(`Hello $&#123;name&#125; !`)&#125;module.exports.sayHello = sayHello åœ¨è°ƒç”¨çš„æ—¶å€™ä½¿ç”¨require(path)æŠŠéœ€è¦çš„ä»£ç å¼•å…¥ 123456var common = require('common.js')Page(&#123; helloMINA: function() &#123; common.sayHello('MINA') &#125;,&#125;) å‚è€ƒå¾®ä¿¡å°ç¨‹åºæ–‡æ¡£","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://www.yangjie.hu//tags/JavaScript/"}]},{"title":"å¾®ä¿¡å°ç¨‹åºåˆè¯†","date":"2017-06-03T06:20:19.000Z","path":"2017/06/03/å¾®ä¿¡å°ç¨‹åºåˆè¯†/","text":"å¼€å§‹äº†è§£å°ç¨‹åºå•¦ï¼Œè¿‘æœŸè¦å‡†å¤‡ä¿®æ”¹ä¸€ä¸ªå°ç¨‹åºï¼Œæ·»åŠ ä¸¤ä¸ªè‡ªå®šä¹‰çš„åŠŸèƒ½ï¼Œè®°å½•ä¸‹å­¦ä¹ è¿‡ç¨‹ä¸­çš„ä½“ä¼šã€‚ ç›®å½•åˆå§‹å°ç¨‹åºæœ€å…³é”®ä¹Ÿæ˜¯å¿…ä¸å¯å°‘çš„æ˜¯ app.jsã€app.jsonã€app.wxss è¿™ä¸‰ä¸ªã€‚å…¶ä¸­ï¼Œ.jsåç¼€çš„æ˜¯è„šæœ¬æ–‡ä»¶ï¼Œ.jsonåç¼€çš„æ–‡ä»¶æ˜¯é…ç½®æ–‡ä»¶ï¼Œ.wxssåç¼€çš„æ˜¯æ ·å¼è¡¨æ–‡ä»¶ã€‚ app.jsapp.jsæ˜¯å°ç¨‹åºçš„è„šæœ¬ä»£ç ã€‚æˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ç›‘å¬å¹¶å¤„ç†å°ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€å£°æ˜å…¨å±€å˜é‡ã€‚è°ƒç”¨æ¡†æ¶æä¾›çš„ä¸°å¯Œçš„ APIã€‚ app.jsonapp.json æ˜¯å¯¹æ•´ä¸ªå°ç¨‹åºçš„å…¨å±€é…ç½®ã€‚æˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­é…ç½®å°ç¨‹åºæ˜¯ç”±å“ªäº›é¡µé¢ç»„æˆï¼Œé…ç½®å°ç¨‹åºçš„çª—å£\bèƒŒæ™¯è‰²ï¼Œé…ç½®å¯¼èˆªæ¡æ ·å¼ï¼Œé…ç½®é»˜è®¤æ ‡é¢˜ã€‚æ³¨æ„è¯¥æ–‡ä»¶ä¸å¯æ·»åŠ ä»»ä½•æ³¨é‡Šã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªåŒ…å«æ‰€æœ‰é…ç½®é¡¹çš„app.jsonæ–‡ä»¶ 1234567891011121314151617181920212223&#123; \"pages\": [ \"pages/index/index\", \"pages/logs/index\" ], \"window\": &#123; \"navigationBarTitleText\": \"Demo\" &#125;, \"tabBar\": &#123; \"list\": [&#123; \"pagePath\": \"pages/index/index\", \"text\": \"é¦–é¡µ\" &#125;, &#123; \"pagePath\": \"pages/logs/logs\", \"text\": \"æ—¥å¿—\" &#125;] &#125;, \"networkTimeout\": &#123; \"request\": 10000, \"downloadFile\": 10000 &#125;, \"debug\": true&#125; pagespagesä¸­ä¸ºæ‰€æœ‰çš„é¡µé¢ï¼Œç¬¬ä¸€é¡¹ä¸ºå°ç¨‹åºçš„åˆå§‹é¡µé¢ window12345678910&#123; \"window\":&#123; \"navigationBarBackgroundColor\": \"#ffffff\", //å¯¼èˆªæ èƒŒæ™¯è‰² \"navigationBarTextStyle\": \"black\", //å¯¼èˆªæ æ ‡é¢˜é¢œè‰²ï¼Œä»…æ”¯æŒ black/white \"navigationBarTitleText\": \"å¾®ä¿¡æ¥å£åŠŸèƒ½æ¼”ç¤º\", //å¯¼èˆªæ æ ‡é¢˜æ–‡å­—å†…å®¹ \"backgroundColor\": \"#eeeeee\", //çª—å£èƒŒæ™¯è‰² \"backgroundTextStyle\": \"light\", //ä¸‹æ‹‰èƒŒæ™¯å­—ä½“ã€loading å›¾çš„æ ·å¼ï¼Œä»…æ”¯æŒ dark/light \"enablePullDownRefresh\": \"true\" //æ˜¯å¦å¼€å¯ä¸‹æ‹‰åˆ·æ–° &#125;&#125; tabbarTipï¼š å½“è®¾ç½® position ä¸º top æ—¶ï¼Œå°†ä¸ä¼šæ˜¾ç¤º icon tabBar æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåªèƒ½é…ç½®æœ€å°‘2ä¸ªã€æœ€å¤š5ä¸ª tabï¼Œtab æŒ‰æ•°ç»„çš„é¡ºåºæ’åºã€‚ 12345678910111213141516\"tabBar\": &#123; \"color\": \"#F8F8F8\", //tabä¸Šæ–‡å­—é»˜è®¤é¢œè‰² \"selectedColor\": \"#ffffff\", //tabä¸Šæ–‡å­—é€‰æ‹©åçš„é¢œè‰² \"backgroundColor\": \"#ffffff\", //tabçš„èƒŒæ™¯è‰² \"borderStyle\": \"black\", //ï¼ˆéå¿…å¡«ï¼‰tabbarä¸Šè¾¹æ¡†çš„é¢œè‰²ï¼Œ ä»…æ”¯æŒ black/white \"position\": \"top\", //ï¼ˆéå¿…å¡«ï¼‰ bottomã€top(é»˜è®¤ä¸ºtop) \"list\": [&#123; \"pagePath\": \"pages/index/index\", \"text\": \"é¦–é¡µ\", \"iconPath\": \"\", //ï¼ˆéå¿…å¡«ï¼‰å›¾ç‰‡è·¯å¾„ï¼Œicon å¤§å°é™åˆ¶ä¸º40kbï¼Œå»ºè®®å°ºå¯¸ä¸º 81px * 81pxï¼Œå½“ postion ä¸º top æ—¶ï¼Œæ­¤å‚æ•°æ— æ•ˆ \"selectedIconPath\": \"\" //ï¼ˆéå¿…å¡«ï¼‰é€‰æ‹©åçš„å›¾ç‰‡è·¯å¾„ ï¼ŒåŒä¸Š &#125;, &#123; \"pagePath\": \"pages/logs/logs\", \"text\": \"æ—¥å¿—\" &#125;] &#125;, networkTimeout å±æ€§ ç±»å‹ å¿…å¡« è¯´æ˜ request Number å¦ wx.requestçš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼Œé»˜è®¤ä¸ºï¼š60000 connectSocket Number å¦ wx.connectSocketçš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼Œé»˜è®¤ä¸ºï¼š60000 uploadFile Number å¦ wx.uploadFileçš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼Œé»˜è®¤ä¸ºï¼š60000 downloadFile Number å¦ wx.downloadFileçš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼Œé»˜è®¤ä¸ºï¼š60000 app.wxssapp.wxss æ˜¯æ•´ä¸ªå°ç¨‹åºçš„å…¬å…±æ ·å¼è¡¨ã€‚æˆ‘ä»¬å¯ä»¥åœ¨é¡µé¢ç»„ä»¶çš„ class å±æ€§ä¸Šç›´æ¥ä½¿ç”¨ app.wxss ä¸­å£°æ˜çš„æ ·å¼è§„åˆ™ã€‚ é¡µé¢å°ç¨‹åºçš„æ¯ä¸ªé¡µé¢éƒ½æœ‰è‡ªå·±æ‰€å±çš„ .js .json .wxssæ–‡ä»¶è¿˜æœ‰ .wxmlæ–‡ä»¶ï¼Œå‰é¢ä¸‰è€…åŒå…¨å±€çš„æ–‡ä»¶ä½œç”¨ç›¸åŒï¼Œåªæ˜¯åœ¨è¿™ä¸ªé¡µé¢å®ƒä»¬çš„ä¼˜å…ˆçº§ä¼šæ›´é«˜ï¼Œæ¯”å¦‚pageè‡ªå·±çš„æ ·å¼ä¼šè¦†ç›–å…¨å±€çš„æ ·å¼ã€‚.wxmlæ–‡ä»¶æ˜¯è¿™ä¸ªé¡µé¢çš„å¸ƒå±€æ–‡ä»¶ã€‚ æ¯ä¸ªé¡µé¢çš„è¿™å››ä¸ªåç¼€çš„æ–‡ä»¶ï¼Œå°ç¨‹åºè¦æ±‚è¦æœ‰ç›¸åŒçš„è·¯å¾„çš„æ–‡ä»¶åã€‚ æŸä¸ªé¡µé¢çš„page.jsonæ–‡ä»¶ä¸­ä¼šè¦†ç›–è·Ÿapp.jsonç›¸åŒçš„é…ç½®ï¼Œåªèƒ½è®¾ç½®windowç›¸å…³çš„é…ç½®ã€‚ å±æ€§ ç±»å‹ é»˜è®¤å€¼ æè¿° navigationBarBackgroundColor HexColor #000000 å¯¼èˆªæ èƒŒæ™¯é¢œè‰²ï¼Œå¦‚â€#000000â€ navigationBarTextStyle String white å¯¼èˆªæ æ ‡é¢˜é¢œè‰²ï¼Œä»…æ”¯æŒ black/white navigationBarTitleText String å¯¼èˆªæ æ ‡é¢˜æ–‡å­—å†…å®¹ backgroundColor HexColor #ffffff çª—å£çš„èƒŒæ™¯è‰² backgroundTextStyle String dark ä¸‹æ‹‰èƒŒæ™¯å­—ä½“ã€loading å›¾çš„æ ·å¼ï¼Œä»…æ”¯æŒ dark/light enablePullDownRefresh Boolean false æ˜¯å¦å¼€å¯ä¸‹æ‹‰åˆ·æ–°ï¼Œè¯¦è§é¡µé¢ç›¸å…³äº‹ä»¶å¤„ç†å‡½æ•°ã€‚ disableScroll Boolean false è®¾ç½®ä¸º true åˆ™é¡µé¢æ•´ä½“ä¸èƒ½ä¸Šä¸‹æ»šåŠ¨ï¼›åªåœ¨ page.json ä¸­æœ‰æ•ˆï¼Œæ— æ³•åœ¨ app.json ä¸­è®¾ç½®è¯¥é¡¹ 1234567&#123; \"navigationBarBackgroundColor\": \"#ffffff\", \"navigationBarTextStyle\": \"black\", \"navigationBarTitleText\": \"å¾®ä¿¡æ¥å£åŠŸèƒ½æ¼”ç¤º\", \"backgroundColor\": \"#eeeeee\", \"backgroundTextStyle\": \"light\"&#125;","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://www.yangjie.hu//tags/JavaScript/"}]},{"title":"Apple Debugging---ä½¿ç”¨LLDBæ›¿æ¢æ–¹æ³•ä¸ºè‡ªå®šä¹‰çš„block","date":"2017-05-25T14:26:02.000Z","path":"2017/05/25/Apple-debugging-ä½¿ç”¨LLDBæ›¿æ¢æ–¹æ³•ä¸ºè‡ªå®šä¹‰çš„block/","text":"Swizzling with block injectionè¦åœ¨lldbä¸­ä½¿ç”¨Objective-Cçš„runtimeï¼Œå¯ä»¥é€šè¿‡å¯¼å…¥å¤´æ–‡ä»¶æ¥è·å¾—è¿è¡Œæ—¶çš„å„ç§é»‘è‰²ç§‘æŠ€ã€‚ po @import Foundation åœ¨æ§åˆ¶å°è¾“å…¥po ï¼ˆlldb) po Enter expressions, then terminate with an empty line to evaluate: 1: ç„¶åå¯è¾“å…¥å¤šè¡Œä»£ç ï¼Œå°±åƒåœ¨Xcodeä¸­å†™ä»£ç ä¸€æ ·ã€‚åœ¨ç¼–å†™å®Œæ¯•åï¼Œå›è½¦ç©ºä¸€è¡Œï¼Œå†å›è½¦ä»£ç å°±ä¼šè¢«æ‰§è¡Œäº†ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š 1: @import Cocoa; 2: id $class = [NSObject class]; 3: SEL $sel = @selector(init); 4: void *$method = (void *)class_getInstanceMethod($class , $sel); 5: IMP $oldImp = (IMP)method_getImplementation($method); id (^$block)(id) = ^id(id object) { if ((BOOL)[object isKindOfClass:[NSView class]]) { fprintf(stderr, &quot;%s\\n&quot;, (char *)[[[object class] description] UTF8String]); } return object; } IMP $newImp = (IMP)imp_implementationWithBlock($block); method_setImplementation($method, $newImp); è‡³æ­¤ï¼ŒNSObjectçš„initæ–¹æ³•å°±è¢«æ›¿æ¢ä¸ºäº†ä¸Šè¿°ä»£ç ä¸­çš„blockï¼ŒLLDBä¸­æœ‰ä¸€ä¸ªbugï¼Œåœ¨blockä¸­æ‰§è¡ŒIMPSå°±ä¼šå´©æºƒã€‚ å†…å®¹æ¥è‡ªï¼šã€ŠAdvanced Apple Debugging &amp; Reverse Engineeringã€‹","tags":[]},{"title":"Apple Debugging---å¼€å§‹ä½¿ç”¨LLDB","date":"2017-05-23T15:43:58.000Z","path":"2017/05/23/Apple-Debugging-å¼€å§‹ä½¿ç”¨LLDB/","text":"Getting around RootlessOS X 10.11 ä¸­å¼•å…¥çš„ Rootlessï¼Œå³ä½¿æ˜¯rootç”¨æˆ·ï¼Œä¹Ÿæ— æ³•å¯¹ä»¥ä¸‹è·¯å¾„æœ‰å†™å’Œæ‰§è¡Œçš„æƒé™ï¼š /System /bin /sbin /usr (except /usr/local) åªæœ‰Appleè‡ªèº«ç­¾åçš„è½¯ä»¶ï¼ˆå«å‘½ä»¤è¡Œå·¥å…·ï¼‰å¯ä»¥ã€‚ Appleçš„Rootlessæœºåˆ¶è™½ç„¶ä¿æŠ¤äº†ç³»ç»Ÿçš„å®‰å…¨ï¼Œé˜²æ­¢äº†å¤§éƒ¨åˆ†æ¶æ„è½¯ä»¶æƒ³é€šè¿‡å•çº¯çš„å¼•å¯¼ç”¨æˆ·ï¼Œè¾“å…¥è‡ªå·±çš„å¯†ç ç‚¹å‡»ç¡®å®šæ¥ç›´æ¥åˆ‡æ¢åˆ°rootåšä¸€äº›è¿æ³•çš„äº‹æƒ…ã€‚ä¹Ÿå¯ä»¥é˜²æ­¢é»‘å®¢é»‘äº†ä¸€ä¸ªç”¨æˆ·ç„¶åå°±æœ‰rootæƒé™å¯ä»¥è‚†æ„å¦„ä¸ºçš„æƒ…å†µï¼Œä¸è¿‡å¯¹äºçœŸæ­£çš„é»‘å®¢æ¥è¯´ Disabling Rootlessåœ¨ç”µè„‘çš„Recovery Modeï¼Œæ‰“å¼€ç»ˆç«¯è¾“å…¥ csrutil disable; reboot ç”µè„‘ä¼šé‡å¯ï¼Œæ­¤æ—¶ç”µè„‘å°±ç¦ç”¨äº†Rootlessï¼Œå¯ä»¥è°ƒè¯•ç³»ç»Ÿçº§åˆ«çš„åº”ç”¨ã€‚ å¯ä»¥ä½¿ç”¨å‘½ä»¤ï¼š lldb -n Finder çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹ä¿¡æ¯å°±è¡¨ç¤ºæˆåŠŸ Process XXX stoped . . . Attaching LLDB to Xcode ä½¿ç”¨lldb attach åˆ°æœ€å¸¸ç”¨çš„å·¥å…·Xcodeï¼ æ–¹å¼ä¸€ï¼š lldb file /Applications/Xcode.app/Contents/MacOS/Xcode æ–¹å¼äºŒï¼š lldb -n Xcode //éœ€è¦Xcodeåœ¨è¿è¡ŒçŠ¶æ€ æ–¹å¼ä¸‰ï¼š pgrep -x Xcode //éœ€è¦Xcodeåœ¨è¿è¡ŒçŠ¶æ€ lldb -p 89921 //89921ä¸ºXcodeçš„PID æ–¹å¼å››ï¼š(attaching ä¸€ä¸ªå°†ä¼šè¿è¡Œçš„ç¨‹åº) lldb -n Finder -w pkill Finder è¿è¡Œç¨‹åºï¼š process lanuch -e /dev/ttys004 -- è¿™é‡Œçš„ttys004æ˜¯shellä¸­çš„æŸä¸ªtabçš„å”¯ä¸€id è¿è¡Œç¨‹åºæ—¶å¯ä»¥æºå¸¦çš„å‚æ•°ï¼š é€šè¿‡-wå‚æ•°æ”¹å˜è¿è¡Œç¨‹åºçš„ç›®å½•ï¼š 1(lldb) process launch -w /Applications ä¹Ÿå¯ä»¥ç›´æ¥å°†å‚æ•°åŠ åˆ°ç¨‹åºåé¢ï¼š 1(lldb) process launch -- /Applications -Xå‚æ•°è®© shell æ¥å—ä»»ä½•æ ¼å¼å‚æ•°ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ç§ ~ å­—ç¬¦ 1(lldb) process launch -X true -- ~/Desktop psï¼š run å‘½ä»¤æ˜¯ä¸Šé¢ process launch -X true -- çš„ç®€å†™ å¯ä»¥ç›´æ¥ run ~/Desktop -o å‘½ä»¤è®©LLDBè¾“å‡ºåˆ°æŒ‡å®šçš„æ–‡ä»¶ 1(lldb) process launch -o /tmp/ls_output.txt -- /Applications -i å‘½ä»¤å¯ä»¥ä»å¤–éƒ¨æ–‡ä»¶è¯»å–æ•°æ®ï¼Œè¿™åœ¨ä¸æƒ³stdinçš„çŠ¶å†µä¸‹å¾ˆæœ‰ç”¨ï¼ˆè¿˜æ²¡æœ‰ä½“ä¼šåˆ°ğŸ˜Œ ï¼‰ 1234(lldb) process launch -i /tmp/wc_input.txtç­‰åŒäºwc &lt; /tmp/wc_input.txt //wcä¸ºå½“å‰lldbçš„target -n å‘½ä»¤å‘Šè¯‰LLDBä¸è¦åˆ›å»ºstdin 1(lldb) process launch -n æŒ‰Ctrl + Cå¯ä»¥æš‚åœdebuggerï¼Œ æ·»åŠ ä¸€ä¸ªæ–­ç‚¹ï¼š breakpoint set -n &quot;-[NSView hitTest:]&quot; continue //æ–­ç‚¹åç»§ç»­æ‰§è¡Œ po $rdi // æŸ¥çœ‹RDI CPU register //ä¿®æ”¹ä¸€ä¸ªæ–­ç‚¹ï¼Œæ·»åŠ ä¸€ä¸ªè§¦å‘æ¡ä»¶ breakpoint modify 1 -c &quot;(BOOL)[$rdi isKindOfClass:[NSTextView class]]&quot; å†…å®¹å‡ºå¤„ï¼šã€ŠAdvanced Apple Debugging &amp; Reverse Engineeringã€‹","tags":[]},{"title":"ä¸€æ¬¡ç‰ˆæœ¬å‘å¸ƒçš„å¯ç¤º","date":"2017-05-03T01:17:42.000Z","path":"2017/05/03/ä¸€æ¬¡ç‰ˆæœ¬å‘å¸ƒçš„å¯ç¤º/","text":"ä»Šå¤©æ—©ä¸Šæ€€ç€æƒ´æƒ´ä¸å®‰çš„å¿ƒæƒ…ï¼Œç‚¹å¼€äº†iTunes Connectï¼Œç­‰å¾…æ¼«é•¿çš„loadingâ€¦ å®¡æ ¸é€šè¿‡äº†ï¼ æ˜¯ä¸æ˜¯æˆ‘å¯¹Appleå®¡æ ¸å¤ªæ•æ„Ÿäº†ï¼ŸğŸ˜‚ï¼Œåªå› ä¸ºè¿™ä¸ªç‰ˆæœ¬çš„å‘å¸ƒå› ä¸ºå®¡æ ¸è¢«æ‹–å»¶å¥½ä¹…äº†ğŸ˜• åˆšå¥½è¿™æ®µæ—¶é—´æœ‰åœ¨çœ‹ã€Šç¨‹åºå‘˜çš„èŒä¸šç´ å…»ã€‹è¿™æœ¬ä¹¦ï¼Œç»“åˆè¿™æ¬¡çš„ç‰ˆæœ¬å‘å¸ƒäº‹æ•…è®©æˆ‘æ”¶è·äº†æ–°çš„ä½“ä¼šã€‚ äº‹æ•…ç°åœºç›´æ¥æ¥çœ‹äº‹æ•…ç°åœºå§ï¼š 25å·æäº¤ç‰ˆæœ¬ï¼Œ27å·æ­£å¸¸é€šè¿‡å®¡æ ¸ã€‚å½“è¦å‘å¸ƒçš„å‰ä¸€åˆ»ï¼Œæµ‹è¯•å§å§å‘ŠçŸ¥æˆ‘ä»¬æœ‰ä¸ªåŠŸèƒ½è¿™ä¸ªç‰ˆæœ¬ä¸éœ€è¦ä¸Šï¼Œäºæ˜¯æˆ‘ä»¬æ‰“ç®—å¯ç”¨çº¿ä¸Šé¢„åŸ‹çš„å¼€å…³æ›¿æ¢è¿™ç‰ˆä¸éœ€è¦ä¸Šçš„åŠŸèƒ½çš„ç•Œé¢ï¼Œä»è€Œæ­£å¸¸ä¸Šçº¿å½“å‰ç­‰å¾…å‘å¸ƒåŒºçš„ç‰ˆæœ¬ã€‚ç„¶è€Œä¸€åˆ‡æ²¡æœ‰é‚£ä¹ˆé¡ºåˆ©ï¼Œæ–™æƒ³ä¸åˆ°çš„æ˜¯è¿™ä¸ªç•Œé¢åœ¨é¢„åŸ‹çš„å¤„ç†ä¸­å‚æ•°æ²¡æœ‰æ­£ç¡®å¤„ç†ï¼Œå¯¼è‡´äº†ä¸Šè¿°æ–¹æ¡ˆæ²¡æ³•æ­£å¸¸è¿è¡Œã€‚ åªå¥½æ’¤ä¸‹å·²ç»è¿‡å®¡çš„ç‰ˆæœ¬ï¼Œä¿®æ”¹é—®é¢˜é‡æ–°æäº¤ã€‚ä¹Ÿå°±æ˜¯å›¾ä¸­åœˆèµ·æ¥çš„è¿™ä¸€æ­¥ï¼Œä¹Ÿæ­£æ˜¯è¿™ä¸€æ­¥å¼€å¯äº†ä¸‡æ¶çš„è½®å›ã€‚ã€‚ã€‚ æ—¥å­æ…¢æ…¢é è¿‘äº”ä¸€å‡æœŸï¼Œé¡¹ç›®çš„ä¸Šçº¿æ—¶é—´å€’æ²¡æœ‰è¦å»å‡‘èŠ‚æ—¥è¿™æ ·çš„è¦æ±‚ï¼Œåªæ˜¯å¦‚æœåœ¨å‡æœŸä¸­å‡ºç°çº¿ä¸Šä»€ä¹ˆé—®é¢˜ï¼Œè§£å†³èµ·æ¥å°±æ²¡æœ‰é‚£ä¹ˆé«˜æ•ˆï¼Œä¸‡ä¸€æ¶‰åŠåˆ°è·Ÿå…¶ä»–éƒ¨é—¨ä¹‹é—´çš„é…åˆä¿®æ”¹ï¼Œå¯å°±æ›´åŠ éº»çƒ¦ã€‚æ¯•ç«Ÿå°é•¿å‡éƒ½åœ¨happyã€‚ æ²¡æƒ³åˆ°ï¼Œæˆå‰§æ€§çš„å‡ºç°äº†ä¸‹å›¾ä¸­çš„è¿™å‡ºæˆ é‡æ–°æäº¤åçš„ç¬¬äºŒå¤©ï¼Œè¢«Appleæ‹’ç»äº†ã€‚æ‡µé€¼äº†ï¼Œæ²¡æœ‰ä¿®æ”¹è¿‡å…¶ä»–ä»£ç ï¼Œç«Ÿç„¶å‰ä¸€å¤©é€šè¿‡ï¼Œè¿™å¤©å°±è¢«æ‹’ç»ï¼Œè‹¹æœçˆ¸çˆ¸æœç„¶å¼ºåŠ¿ã€‚æ‹’ç»åŸå› è¿˜è®©äººæ— æ³•æ‹’ç»ï¼Œâ€œAPPçš„æè¿°å›¾ç‰‡ä¸ç¬¦åˆè§„èŒƒâ€ã€‚è¿™ï¼Œï¼Œæˆ‘ä»¬éƒ½å·²ç»ç”¨äº†ä¸¤ä¸ªç‰ˆæœ¬äº†ã€‚å¥½å§ï¼Œè®©è§†è§‰å¤§å“¥é‡æ–°è®¾è®¡ï¼Œè¿è¥é‡æ–°æäº¤äº†å®¡æ ¸ã€‚ç°åœ¨ä¹Ÿå°±å¸Œæœ›äº”ä¸€æœŸé—´æ­£å¸¸ä¸Šçº¿å°±è¡Œäº†ã€‚ å‡æœŸç¬¬ä¸€å¤©29å·ï¼Œä»ç„¶è¢«æ‹’ã€‚è€Œä¸”è¢«æ‹’åŸå› å‡çº§äº†ã€‚Appleå®¡æ ¸äººå‘˜å‘ŠçŸ¥æˆ‘ä»¬APPåœ¨å¯åŠ¨çš„æ—¶å€™crashäº†ğŸ˜±ï¼Œå®šä½äº†ä»–ä»¬æä¾›çš„å¥”æºƒæ—¥å¿—åå‘ç°ï¼Œå®ƒè²Œä¼¼æ˜¯å¹³å¸¸æˆ‘ä»¬crashæ”¶é›†åˆ—è¡¨ä¸­çš„ä¸€ä¸ªå°æ¦‚ç‡å‡ºç°çš„bugï¼Œä½†æ˜¯ä¹‹å‰ä¸€ç›´æ²¡æœ‰æ‰¾åˆ°æ ¹æºåœ¨å“ªã€‚ è¿™æ¬¡æ‹¿åˆ°çš„æ—¥å¿—ä¿¡æ¯è®©æˆ‘æ‰¾åˆ°äº†å¥”æºƒå¤„çš„ä»£ç ï¼Œè¿™æ˜¯åŒäº‹è´Ÿè´£çš„æ¨¡å—ã€‚æˆ‘æ‰¾åˆ°å¯ç–‘çš„åœ°æ–¹ï¼Œé—®äº†åŒäº‹ä¼šä¸ä¼šå‡ºç°æˆ‘æƒ³è±¡çš„é”™è¯¯å¯¼è‡´å´©æºƒï¼ŒåŒäº‹è¯´ä¸ä¼šï¼Œæ²¡æœ‰é‡åˆ°è¿‡ã€‚æˆ‘æƒ³ç€æ¯•ç«Ÿæ˜¯ä»–çš„æ¨¡å—ï¼Œå°±ä¸å¤šè¯´äº†ï¼ŒåŒäº‹å»ºè®®ä¸ä¿®æ”¹å†æäº¤ä¸€æ¬¡å®¡æ ¸ï¼Œæˆ‘æƒ³ç€è¿™ä¸ªé—®é¢˜æœ¬ä¹Ÿæ˜¯æ¦‚ç‡å‡ºç°æ—¶ï¼Œè¯´ä¸å®šæ˜¯å®¡æ ¸äººå‘˜è¿æ°”å¤ªå¥½é‡åˆ°äº†ã€‚äºæ˜¯æˆ‘ä»¬å†æ¬¡æäº¤å®¡æ ¸ã€‚ã€‚ã€‚ ä¸¤å¤©å 5.2å°é•¿å‡ç»“æŸï¼Œå›æ¥ä¸Šç­äº†ï¼Œæ‰“å¼€iTunes Connectå‘ç°è¿˜æ˜¯è¢«æ‹’ç»äº†ğŸ˜–ï¼Œæˆ‘å½“æ—¶å¿ƒé‡Œçš„ç¬¬ä¸€æ„Ÿè§‰æ˜¯åæ‚”ï¼Œåæ‚”æ²¡æœ‰å»ä¿®æ”¹é‚£ä¸ªé—®é¢˜ï¼ŒæŒ‡ä¸å®šå°±è¿‡äº†ã€‚ç°åœ¨è¦å‘é¢†å¯¼æ±‡æŠ¥è¿™æ¬¡å¤±è¯¯ï¼Œè¿˜è¦ç»§ç»­ç¡®è®¤é—®é¢˜ã€‚å†™äº†ä»½ä¸Šçº¿è¢«æ‹’è¯´æ˜çš„pdfæ–‡æ¡£ç»™è€å¤§å¹¶è§£é‡Šï¼Œè€å¤§è®©æˆ‘èµ¶ç´§å®šä½é—®é¢˜ï¼Œä¿®æ”¹å†æäº¤ä¸Šçº¿ï¼Œå¹¶è¯­é‡å¿ƒé•¿åœ°è·Ÿæˆ‘é‡ç”³äº†æˆ‘ä»¬å®šå¥½çš„æ¯åŠä¸ªæœˆæ›´æ–°çº¿ä¸Šç‰ˆæœ¬çš„è®¡åˆ’ï¼Œå‘Šè¯‰æˆ‘è¿™æ¬¡çš„æ—¶é—´å¤ªä¹…äº†ã€‚å€æ„Ÿå‹åŠ›å’Œè‡ªè´£ã€‚ã€‚ã€‚ æŒ‰ç…§ä¹‹å‰æ€€ç–‘è¿‡çš„æ€è·¯ç»§ç»­å¾€ä¸‹æŸ¥ï¼Œæˆ‘æ‰¾åˆ°äº†ç¡®å‡¿çš„è¯æ®ï¼Œå¯¼è‡´crashçš„åœ°æ–¹æœç„¶æ˜¯é‚£é‡Œã€‚ æˆ‘ç«‹é©¬ä¿®æ”¹äº†ä»£ç é‡æ–°æäº¤å®¡æ ¸ï¼Œå¹¶å‘äº†testFlightè®©æµ‹è¯•åŒå­¦åœ¨é’ˆå¯¹æ€§åœ°ç‚¹ä¸€ç‚¹ï¼Œè‡ªå·±ä¹Ÿåœ¨ç´§å¼ åœ°reviewç€ï¼Œå¿ƒé‡Œä¸æ–­é»˜å¿µç€ï¼šå¯ä¸èƒ½å†è¢«æ‹’ç»äº†å•Š ç„¶è€Œï¼ŒæŠ˜ç£¨æˆ‘çš„è·¯å£æ€»æ˜¯ä¸€ä¸ªä¸ªä¸æ–­å‡ºç°ã€‚ä¸Šåˆæäº¤åï¼Œæˆ‘åœ¨ä¸‹åˆçš„reviewä¸­å‘ç°äº†ä¸€ä¸ªä¸å¤§ä¸å°çš„é—®é¢˜ï¼ŒåŒäº‹æµ‹è¯•åœ¨iPadç‰ˆæœ¬ï¼ˆå› ä¸ºAppleå®¡æ ¸äººå‘˜ä½¿ç”¨iPadè¿›è¡Œæµ‹è¯•ï¼‰ä¸­å‘ç°äº†å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼Œè®©æˆ‘ä¸å¾—ä¸é‡æ–°æ’¤å›å®¡æ ¸ï¼Œä¿®æ”¹äº†é—®é¢˜ä»£ç é‡æ–°æäº¤ã€‚è¿™æ ·æ–­æ–­ç»­ç»­æŠ˜è…¾äº†ä¸€å¤©ã€‚ ç»ˆäºåœ¨5.3ï¼Œä»Šå¤©æ—©ä¸Šå¾—åˆ°äº†ä¸€ä¸ªå¥½æ¶ˆæ¯ï¼Œç£¨äººçš„å®¡æ ¸ã€‚ æ„Ÿæ‚Ÿçº¢è‰²å­—ä½“çš„åœ°æ–¹éƒ½æ˜¯æˆ‘æ„Ÿæ‚Ÿçš„è§¦å‘ç‚¹ã€‚ â€œå‚æ•°æ²¡æœ‰æ­£ç¡®å¤„ç†â€ ã€Šç¨‹åºå‘˜çš„èŒä¸šç´ å…»ã€‹ä¸­æåˆ°ä¸€ä¸ªé«˜æ•ˆå·¥ä½œçš„çŠ¶æ€ç§°ä½œæµæ€åŒºã€‚å½“äººå¤„åœ¨æµæ€åŒºä¸­ï¼Œå…¶å®æ˜¯å¤„åœ¨äº†ä¸€ç§æµ…å±‚çš„å†¥æƒ³ä¹‹ä¸­ï¼Œä¼šè¿½æ±‚å·¥ä½œçš„é€Ÿåº¦ï¼Œç†æ€§æ€è€ƒçš„èƒ½åŠ›ä¼šä¸‹é™ã€‚å½“ç„¶æˆ‘è§‰å¾—ï¼Œè¿™å½“ç„¶æ’é™¤éœ€è¦é«˜å¼ºåº¦è„‘åŠ›æ€è€ƒçš„å·¥ä½œã€‚ä½†æ˜¯è¿™ç§å¼ºåº¦åœ¨å¹³å¸¸å·¥ä½œä¸­åŸºæœ¬é‡ä¸åˆ°ã€‚ ä¸ºäº†å°½å¿«å®Œæˆä»»åŠ¡ï¼Œæˆ‘å¸¸ä¼šé™·å…¥æµæ€åŒºï¼Œé¢„åŸ‹å¼€å…³è¿™ç§å¹³å¸¸ç”¨ä¸åˆ°çš„å‚æ•°è®¾ç½®å°±æ²¡æœ‰æ³¨æ„å»è®¾ç½®ï¼Œå¹¶ä¸”æ²¡æœ‰å»éªŒè¯ä¿è¯æ­£ç¡®ã€‚ä¸ºäº†å®ŒæˆæŸä¸ªä»»åŠ¡è€Œçœç•¥äº†éªŒè¯çš„æ­¥éª¤å¾€å¾€ä¼šç»™è‡ªå·±å¾€åå¢åŠ æ›´å¤šçš„éº»çƒ¦ã€‚ æœ‰ä¸ªåŠŸèƒ½è¿™ä¸ªç‰ˆæœ¬ä¸éœ€è¦ä¸Š æµ‹è¯•åŒå­¦åœ¨æˆ‘ä»¬è¦ä¸Šçº¿çš„æ—¶å€™å‘Šè¯‰æˆ‘ä»¬é‚£ä¸ªåŠŸèƒ½ä¸ç”¨ä¸Šçº¿ï¼Œè¿™ä¸ªä¹Ÿæ˜¯æŒºå†¤æ‰çš„ï¼Œä½†æ˜¯ä¹Ÿè¯¥æ€ªæˆ‘ä»¬è‡ªå·±ã€‚è¿™ä¸ªåŠŸèƒ½å‰ä¸ªç‰ˆæœ¬å°±åšå¥½äº†ï¼Œæ²¡æœ‰æ˜è¯´ä¸Šä¸ä¸Šï¼Œä¸Šç‰ˆæœ¬ä¸Šäº†è®©æ’¤ä¸‹æ¥ï¼Œè¿™æ¬¡ä¸Šäº†åˆè®©æ’¤ä¸‹æ¥ã€‚æ€ªåœ¨æˆ‘ä»¬ä¸€ç›´æ‹–ç€æ²¡æœ‰å»ç¡®è®¤æ¸…æ¥šå‡†ç¡®çš„æ—¶é—´ï¼Œå°±ç®—æ‹¿ä¸åˆ°å‡†ç¡®çš„æ—¶é—´ä¹Ÿè¯¥åœ¨æäº¤è¿™æ¬¡ç‰ˆæœ¬ä¹‹å‰å»ç¡®è®¤è¿™ç‰ˆè¦ä¸è¦ä¸Šã€‚æ›´å¥½çš„è§£å†³åŠæ³•æ˜¯ï¼Œåœ¨è¿™é‡Œçš„é…ç½®ä¸€ä¸ªè¿™ä¸ªåŠŸèƒ½çš„å¼€å…³ï¼Œå¯ä»¥åœ¨çº¿ä¸Šæ§åˆ¶å°±å…å»è¿™ä¸ªéº»çƒ¦ã€‚å¾—è¿‡ä¸”è¿‡çš„æƒ°æ€§æŠ‘åˆ¶äº†ç”Ÿäº§åŠ› å¦‚æœå¸Œæœ›è‡ªå·±çš„è½¯ä»¶çµæ´»å¯å˜ï¼Œé‚£å°±åº”è¯¥æ—¶å¸¸ä¿®æ”¹å®ƒï¼ è®©è½¯ä»¶ä¿æŒå›ºå®šä¸å˜æ˜¯å±é™©çš„ï¼å¦‚æœä¸€ç›´ä¸é‡æ„ä»£ç ï¼Œç­‰åˆ°æœ€åä¸å¾—ä¸é‡æ„æ—¶ï¼Œå°±ä¼šå‘ç°ä»£ç å·²ç»åƒµåŒ–äº†ã€‚ æ—¶å¸¸ä¿®æ”¹ï¼Œå¹¶ä¸”å¤§åˆ€é˜”æ–§åœ°ä¿®æ”¹çš„å‰æä¿è¯æœ€å¥½è¦æœ‰ä¸€å¥—è¦†ç›–äº†ä»£ç çš„è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚ ä¸å®³æ€•ä¿®æ”¹ä»£ç é‚£å°±æ˜¯ä¸€ç›´åœ¨æ”¹ã€‚ åƒã€Šç¨‹åºå‘˜çš„èŒä¸šç´ å…»ã€‹ä¸­æåˆ°ï¼Œä»£ç å°±çš„æ—¶å¸¸ä¼˜åŒ–ï¼Œæˆ‘æœ‰ä¸€ä¸ªç‰ˆæœ¬çš„æ—¶é—´ï¼Œå´æ²¡æœ‰å»ä¼˜åŒ–è¿™ä¸ªåŠŸèƒ½ï¼Œé€ æˆäº†åé¢ä¸€ç³»åˆ—çš„é—®é¢˜ğŸ˜« æˆ‘æƒ³ç€æ¯•ç«Ÿæ˜¯ä»–çš„æ¨¡å—ï¼Œå°±ä¸å¤šè¯´äº† ä¸å¾—ä¸æ‰¿è®¤ï¼Œå½“æ—¶æƒ³ç€æ˜¯è¿™æ˜¯åŒäº‹çš„æ¨¡å—ï¼Œæˆ‘ä¹Ÿè¯¢é—®è¿‡æ˜¯å¦å‡ºç°æœ‰æˆ‘è€ƒè™‘åˆ°çš„é—®é¢˜ï¼Œæœ€åè¦æ˜¯è¿˜æœ‰é—®é¢˜é‚£å°±æ²¡æœ‰æˆ‘ä»€ä¹ˆè´£ä»»äº†ã€‚ å¤ªå‚»ï¼å…¸å‹çš„ç¼ºå¤±è´£ä»»æ„Ÿï¼Œæˆ‘çŸ¥é“æˆ‘å¯¹é‚£æ®µä»£ç å­˜åœ¨æ€€ç–‘ï¼ŒåŒäº‹å‘ŠçŸ¥ä¸ä¼šæœ‰é—®é¢˜ä¹Ÿå¹¶æ²¡æœ‰è¯´æœæˆ‘ã€‚ä¸çŸ¥é“å¯é€‰å€¼æ˜¯å¦å¯èƒ½ä¸ºç©ºçš„æƒ…å†µä¸‹å¯¹ä¸€ä¸ªå¯é€‰å€¼å¼ºåˆ¶è§£åŒ…ï¼Œæˆ‘ç¬¬ä¸€ååº”æ˜¯æ·»åŠ ä¸€ä¸ªåˆ¤ç©ºã€‚æ²¡æœ‰åšæŒï¼Œè§‰å¾—é—®é¢˜è·Ÿè‡ªå·±æ²¡å¤šå¤§å…³ç³»ï¼Œæ˜¯ä¸ªå¤§é”™è¯¯ã€‚ å‘ç°äº†æ½œåœ¨çš„é—®é¢˜ï¼Œå¹¶ä¸”æ˜¯åœ¨å®¡æ ¸çš„å…³é”®é˜¶æ®µï¼Œæå‡ºå¹¶å»éªŒè¯æ£€æŸ¥æ˜¯è¯¥æœ‰è´£ä»»ã€‚ åæ‚”æ²¡æœ‰å»ä¿®æ”¹é‚£ä¸ªé—®é¢˜ï¼ŒæŒ‡ä¸å®šå°±è¿‡äº† åœ¨é—®é¢˜å‘ç”Ÿåå†å»æƒ³è¿™æ ·çš„äº‹ï¼Œä¹Ÿæ˜¯ä¸ªé”™è¯¯ã€‚è¿™ç§æ€ç»´å›æƒ³è¿‡æ¥æ— éæ˜¯å¯¹ä¹‹å‰åŒäº‹åˆ¤æ–­çš„å¦å®šï¼Œå¹¶å¸¦ç€è´£æ€ªã€‚ä»”ç»†æƒ³æƒ³ï¼Œæˆ‘è‡ªå·±ä¸ä¹Ÿæ˜¯æ˜¯åŒæ„äº†è¿™æ ·å­å»åšäº†å—ï¼Ÿï¼æ²¡æœ‰åšæŒå»è¿½ç©¶å‘ç°çš„é—®é¢˜ï¼Œä¹Ÿæƒ³æŠ•æœºå–å·§æƒ³ç€è½»æ¾è¿‡å…³ï¼Œæ²¡æœ‰è®¤çœŸå¯¹å¾…è¿™ä¸ªé—®é¢˜ã€‚ ä¸å¾—ä¸é‡æ–°æ’¤å›å®¡æ ¸ åœ¨å†æ¬¡æäº¤è¿™ä¸ªç‰ˆæœ¬çš„æ—¶å€™ï¼Œè€å¤§æœ‰é—®è¿‡ä¸¤æ¬¡è¿˜æœ‰æ²¡æœ‰å‘ç°å…¶ä»–é—®é¢˜ã€‚æ»¡å£åœ°å›ç­”äº†æ²¡æœ‰ï¼Œæ²¡æƒ³åˆ°è¿˜æ˜¯ä¸­æ‹›äº†ã€‚è‡ªæˆ‘å®¡æŸ¥çš„è´£ä»»æ„Ÿï¼Œè¿˜éœ€è¦æé«˜ï¼Œä¸èƒ½æŠŠæµ‹è¯•ç»„å½“æˆæ˜¯æŠ“è™«æœºå™¨ã€‚å½“åˆçœŸçš„åœ¨è¿™æ ·çš„æ€æƒ³ä¸Šæ ½äº†å¤§è·Ÿå¤´ï¼Œè¿˜éœ€è¦ä¸æ–­åœ°æ”¹å–„ã€‚","tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://www.yangjie.hu//tags/éšç¬”/"}]},{"title":"å¤šç¡è§‰å¤šè¯»ä¹¦","date":"2017-04-28T05:29:31.000Z","path":"2017/04/28/å¤šç¡è§‰å¤šè¯»ä¹¦/","text":"æœ‰é‚£ä¹ˆä¸€æ®µæ—¶é—´ä¸€å¤©å†™12ä¸ªå°æ—¶çš„ä»£ç ï¼Œè€Œä¸”éƒ½æ˜¯ä¸šåŠ¡çš„ä»£ç ï¼Œè„‘å­å¡«å……æ»¡æ»¡åœ°ï¼Œæ²¡æœ‰æ€è€ƒç”Ÿæ´»ã€å­¦ä¹ å’Œå¨±ä¹çš„ä½™åœ°ã€‚ é‚£æ—¶æˆ‘æ„Ÿè§‰è‡ªå·±åƒæ˜¯æœ€å–œæ¬¢çš„ç¾å‰§ï¼šThe Walking Dead ä¸­çš„è¡Œå°¸èµ°è‚‰ï¼Œæ²¡æœ‰è‡ªå·±çš„æ€ç»´ï¼Œå¸ç€é›¾éœ¾è¸ç€è‡ªè¡Œè½¦ä¸Šç­ï¼Œè¸©ç€æœ¦èƒ§å¤œè‰²å½’æ¥ç‚¹ä»½å¤–å–ã€‚å‡ ä¹æ²¡æœ‰ä»£ç ä»¥å¤–çš„äº¤æµï¼Œæ²¡æœ‰ç›®çš„åœ°ä¹Ÿä¸çŸ¥é“å¾€å“ªèµ°ã€‚æˆ‘åŒæ¶è¿™æ ·çš„ç”Ÿæ´»çŠ¶æ€ï¼Œä½†æ˜¯ä¸çŸ¥é“è¯¥å¦‚ä½•é€ƒè„±ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆé™·å…¥äº†è¿™æ ·çš„å¿ƒæ€ã€‚ ç›´åˆ°æœ‰ä¸€æ¬¡æŠ½ç©ºçœ‹äº†ã€Šè½¯ä»¶å¼€å‘è€…è·¯çº¿å›¾-ä»å­¦å¾’åˆ°é«˜æ‰‹ã€‹è¿™æœ¬ä¹¦ï¼Œæˆ‘å¯¹è‡ªå·±å¤šäº†å†™æ€è€ƒã€‚ å›å¿†å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œè·ç¦»çœ‹å®Œè¿™æœ¬ä¹¦å·²ç»æœ‰äº›æ—¶é—´äº†ï¼Œæˆ‘æ„Ÿè§‰åˆ°è‡ªå·±ç°åœ¨çš„çŠ¶æ€å·²ç»è°ƒæ•´å¥½äº†ä¸å°‘ï¼Œä¸è¿‡ä¹Ÿä¸æ˜¯ç†æƒ³ã€‚ åˆ°ç°åœ¨æˆ‘å°è±¡æœ€æ·±ï¼Œä¹Ÿå°±æ˜¯è¿™æœ¬ä¹¦ç»™æˆ‘æœ€å¤§çš„å¯è¿ªæ˜¯ï¼šå–„äºæš´éœ²è‡ªå·±çš„ä¸è¶³ äººæœ‰äºŒçŸ¥äºŒä¸çŸ¥ I know that I know I know that I donâ€™t know I donâ€™t know that I know I donâ€™t know that I donâ€™t know èµ„è´¨å¹³åº¸è€Œåˆåˆšæ¯•ä¸šä¸€å¹´çš„å°é¸Ÿï¼Œåœ¨ä¸€ä¸ªé¢†åŸŸä¼šæœ‰ä»€ä¹ˆæ ·çš„å»ºæ ‘ï¼Ÿ å¯ç¬‘çš„æ˜¯æˆ‘æ›¾è§‰å¾—è‡ªå·±çš„æŠ€æœ¯æ°´å¹³å·²ç»å±äºæŒºä¸é”™ğŸ˜…åŸºæœ¬iOSä¸Šå¼€å‘æœ‰æ·±æœ‰æµ…çš„éƒ½äº†è§£äº†ã€‚äºæ˜¯æƒ³ç€è¦è£…è£…Xï¼Œå†™å†™åšå®¢å±•ç¤ºä¸‹è‡ªå·±çš„æ°´å¹³ã€‚å¯å½“æ­å¥½äº†åšå®¢æ¡†æ¶æƒ³è¦åŠ¨ç¬”æ—¶ï¼Œæ‰å‘ç°è‡ªå·±è„‘å­çš„â€œå¹²è´§â€ä»“åº“ä¸­çš„ä¸œè¥¿æ˜¯å¤šä¹ˆå¹³åº¸ã€‚äºæ˜¯å¼€å§‹è¸®èµ·è„šå°–å†™åšå®¢ï¼Œè¾¹å­¦ä¹ è¾¹æ€»ç»“åˆ°åšå®¢ä¸Šï¼Œè¿™æˆäº†ä¹‹å‰çš„æ¨¡å¼ã€‚ è¿™æ—¶å€™ä¸æ•¢æŠŠè‡ªå·±ç›´æ¥æš´éœ²åœ¨é—®é¢˜ä¹‹ä¸‹ï¼Œå–œæ¬¢å¥—ç”¨ç»éªŒæ¨¡å¼ï¼ŒI donâ€™t know that I donâ€™t know æå‡æŠ€æœ¯çš„æå‡å’Œæˆé•¿æ˜¯ç”±å†…è€Œå¤–ï¼Œæ²¡æœ‰å¢¨æ°´å°±å†™ä¸å‡ºå­—ï¼Œæˆä¸ºä¸äº†ä¸€ä¸ªè¾“å‡ºè€…ã€‚ æ…¢æ…¢çœ‹äº†ä¸€äº›æ‹”é«˜çš„ä¹¦ä¹‹åï¼Œæˆ‘æ„è¯†åˆ°è‡ªå·±æœ‰é‚£ä¹ˆå¤šçš„ä¸çŸ¥é“ã€‚åšå®¢å¯¹äºæˆ‘çš„æ„ä¹‰å¼€å§‹æ”¹å˜ï¼Œå®ƒæˆäº†æˆ‘æš´éœ²ä¸è¶³å¼¥è¡¥ä¸è¶³çš„åœ°æ–¹ã€‚å¼ºè€…çš„å¼ºå¤§åœ¨äºå®ƒæœ€è„†å¼±çš„åœ°æ–¹ï¼Œå±•ç°è‡ªå·±çš„ä¸è¶³ã€‚ ä¿è¯ç²¾åŠ›ï¼Œå¤šç¡è§‰ï¼Œå¤šè¯»ä¹¦ï¼","tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://www.yangjie.hu//tags/éšç¬”/"}]},{"title":"è§£è¯»Objective-Cçš„NSDictionary","date":"2017-04-20T03:27:20.000Z","path":"2017/04/20/è§£è¯»Objective-Cçš„NSDictionary/","text":"NSDistionaryæ˜¯éå¸¸ç†Ÿæ‚‰å¸¸ç”¨çš„ä¸€ä¸ªFoundationä¸­çš„ç±»ï¼Œæœ€æ˜¾è‘—çš„å‡ ä¸ªç‰¹ç‚¹æ˜¯ï¼š ä»¥é”®å€¼å¯¹å­˜å‚¨æ•°æ® å­˜å‚¨çš„æ•°æ®å…·æœ‰å”¯ä¸€æ€§ æ•°æ®æ— åº æˆ‘ä»¬è¿™æ¬¡ä¸æ˜¯è®²NSDictionaryæˆ–NSMutableDictionaryçš„æ–¹æ³•ï¼Œè¿™äº›åœ¨Apple API Referenceä¸­æŸ¥è¯¢å³å¯äº†è§£å•¦~æˆ‘ä»¬æ¥æ¢ç´¢ä¸‹NSDictionaryçš„å†…éƒ¨ Appleæ–‡æ¡£çš„å¯ç¤ºè‹¹æœè²Œä¼¼å¹¶ä¸æ¨èæˆ‘ä»¬å»ç»§æ‰¿NSDictionaryæ¥ä½¿ç”¨å…¶å­ç±»ï¼ˆè‹¹æœå·²ç»å®ç°çš„å­ç±»ï¼šNSMutableDictionaryé™¤å¤–ï¼‰ Before making a custom class of NSDictionary, investigate NSMapTable and the corresponding Core Foundation type, CFDictionary. Because NSDictionary and CFDictionary are â€œtoll-free bridged,â€ you can substitute a CFDictionary object for a NSDictionary object in your code (with appropriate casting). Although they are corresponding types, CFDictionary and NSDictionary do not have identical interfaces or implementations, and you can sometimes do things with CFDictionary that you cannot easily do with NSDictionary. If the behavior you want to add supplements that of the existing class, you could write a category on NSDictionary. Keep in mind, however, that this category will be in effect for all instances of NSDictionary that you use, and this might have unintended consequences. Alternatively, you could use composition to achieve the desired behavior. å¤§è‡´æ„æ€æ˜¯è®©æˆ‘ä»¬æƒ³è¦ç»™NSDictionaryæ·»åŠ æ–°åŠŸèƒ½å°±ä½¿ç”¨åˆ†ç±»ï¼Œä¸è¦ç»§æ‰¿å­ç±»ã€‚å¦‚æœæ‰“ç®—è¦ç»§æ‰¿NSDictionaryï¼Œåˆ™éœ€è¦å¥½å¥½ç ”ç©¶ä¸‹NSMapTableå’Œç›¸å¯¹åº”çš„Core Foundationç±»å‹ï¼šCFDictionary CFDictionaryæ˜¯Core Foundationä¸­çš„å­—å…¸ï¼Œå’ŒNSDictionaryå¯ä»¥æ— ä»£ä»·è½¬æ¢ï¼Œä¸¤è€…å¯ä»¥äº’ç›¸è°ƒç”¨å¯¹æ–¹çš„æ–¹æ³•åˆ›å»ºå’Œé‡Šæ”¾ã€‚å¯ä»¥ä½¿ç”¨CFDictionaryæ¥å®ç°NSDictionaryä¸å®¹æ˜“å®ç°çš„åŠŸèƒ½ã€‚Â· å¦å¤–è‹¹æœæ¨èè®©æˆ‘ä»¬ç ”ç©¶çš„NSMapTableå…·ä½“æ˜¯ä»€ä¹ˆå‘¢? The NSMapTable class is a mutable collection modeled after NSDictionary çœ‹åˆ°è¿™å¥è¯åˆšå¼€å§‹æˆ‘æœ‰ç‚¹ä¸è§£ï¼ŒNSMapTableç«Ÿæ˜¯æ¨¡ä»¿NSDictionaryçš„ä¸€ä¸ªå¯å˜å¾—é›†åˆï¼Œé‚£è·ŸNSMutableDictionaryæœ‰ä»€ä¹ˆä¸åŒå•Šï¼Ÿ NSMapTableä¸NSDictionaryçš„å‡ ä¸ªä¸åŒç‚¹æ˜¯ï¼š å¯ä»¥weakçš„æ–¹å¼æŒæœ‰å¯¹è±¡ï¼Œå½“æŒæœ‰çš„å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ä¸º0çš„æ—¶å€™ï¼Œè¯¥å¯¹è±¡ä¼šè‡ªåŠ¨ä»é›†åˆä¸­ç§»é™¤ key å’Œ valueåœ¨è¾“å…¥çš„æ—¶å€™éƒ½å¯ä»¥copyï¼Œä½¿ç”¨æŒ‡é’ˆå¯¹åšisEqualæˆ–è€…hashingå¯¹æ¯” å¯ä»¥åŒ…å«ä»»ä½•æŒ‡é’ˆï¼Œä¸å†ä»…ä»…å±€é™äºObjective-Cçš„å¯¹è±¡ NSMapTableçš„åˆå§‹åŒ–å°±å¯ä»¥æŒ‡å®š key å’Œ value çš„æŒæœ‰æ–¹å¼ è‹¹æœæä¾›äº†å‡ ä¸ªä¾¿æ·çš„å·¥å‚æ–¹æ³•12345678//key strongï¼Œ value strong+ (NSMapTable&lt;KeyType, ObjectType&gt; *)strongToStrongObjectsMapTable NS_AVAILABLE(10_8, 6_0);//key weakï¼Œ value strong+ (NSMapTable&lt;KeyType, ObjectType&gt; *)weakToStrongObjectsMapTable NS_AVAILABLE(10_8, 6_0); // entries are not necessarily purged right away when the weak key is reclaimed//key strongï¼Œ value weak+ (NSMapTable&lt;KeyType, ObjectType&gt; *)strongToWeakObjectsMapTable NS_AVAILABLE(10_8, 6_0);//key weakï¼Œ value weak+ (NSMapTable&lt;KeyType, ObjectType&gt; *)weakToWeakObjectsMapTable NS_AVAILABLE(10_8, 6_0); // entries are not necessarily purged right away when the weak key or object is reclaimed æˆ–è€…åƒè¿™æ ·æŒ‡å®šï¼š 123456//è¿˜å¯ä»¥æŒ‡å®šNSMapTableCopyIn(æ·»åŠ å‰è¿›è¡Œcopy) ï¼Œ æˆ–è€…NSMapTableObjectPointerPersonalityï¼ˆä½¿ç”¨æŒ‡é’ˆå»hashingï¼‰ NSMapTable *mapTable = [NSMapTable mapTableWithKeyOptions:NSMapTableStrongMemory valueOptions:NSMapTableWeakMemory]; //éœ€è¦ä¸€ä¸ªå¯¹è±¡åˆ°å¯¹è±¡çš„æ˜ å°„é›†åˆï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„mapTable NSMapTable *objectToObjectMapping = [NSMapTable mapTableWithStrongToStrongObjects]; åŒæ ·ç±»æ¨ï¼ŒNSHashTableæ˜¯å¯¹NSSetçš„æ¨¡ä»¿å’Œè¡ç”Ÿï¼Œæ‰©å±•çš„åŠŸèƒ½ä¸NSMapTableç›¸åŒ æŠ›ä¸¤ä¸ªé—®é¢˜ğŸ™ˆQï¼šä¸Šåƒçš„å¯¹è±¡å­˜å‚¨åˆ°NSDictionaryæ—¶ï¼Œå‡ºç°æ•ˆç‡ä½ä¸‹çš„é—®é¢˜æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿç›´æ¥å…ˆå›ç­”é—®é¢˜ï¼šå› ä¸ºå­˜å‚¨çš„æ•°é‡å¾ˆå¤šåhashè¡¨ä¼šå‡ºç°æ¯”è¾ƒå¤šçš„å†²çªï¼Œè§£å†³å¤§é‡å†²çªä¼šå ç”¨å¤§é‡CPUèµ„æºï¼Œé€ æˆæ•ˆç‡ä½ä¸‹ã€‚ hashè¡¨æ˜¯ä»€ä¹ˆï¼Ÿè·ŸNSDictionaryåˆæœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ NSDictionaryæ˜¯ä½¿ç”¨hashè¡¨æ¥å®ç°keyå’Œvalueä¹‹é—´çš„æ˜ å°„å’Œå­˜å‚¨çš„ã€‚ hashè¡¨çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šå°†keyä½œä¸ºå…³é”®å­—ï¼Œæ”¾åˆ°hashå‡½æ•°Æ’(k)ä¸­è®¡ç®—å¾—åˆ°ç»“æœä¸ºhashåœ°å€ï¼Œç„¶åå°†valueå€¼çš„åœ°å€å­˜å‚¨åˆ°hashè¡¨ä¸­çš„Æ’(key)çš„hashåœ°å€ä¸­ã€‚ å½“å…³é”®å­—é›†åˆå¾ˆå¤§çš„æ—¶å€™ï¼Œä¸åŒçš„å…³é”®å­—å¯èƒ½ä¼šé€šè¿‡hashå‡½æ•°æ˜ å°„åˆ°hashè¡¨çš„åŒä¸€åœ°å€ä¸Šã€‚key1 â‰  key2, Æ’(key1) = Æ’(key2),è¿™ç§æƒ…å†µç§°ä¸ºå†²çªã€‚å†²çªæ˜¯ä¸å¯é¿å…çš„ï¼Œåªèƒ½é€šè¿‡æ”¹å–„å“ˆå¸Œå‡½æ•°æ¥å‡å°‘å†²çªã€‚ï¼ˆæ„é€ å“ˆå¸Œå‡½æ•°æ–¹æ³•è¯·å‚è€ƒè¿™é‡Œæˆ–æŸ¥æ‰¾å…¶ä»–èµ„æ–™ï¼‰ ç„¶è€Œæœ‰å†²çªå¿…å®šæ˜¯è¦è§£å†³çš„ï¼Œä¸ç„¶æ–°çš„å€¼æ€ä¹ˆå­˜å‚¨åˆ°å“ˆå¸Œè¡¨ä¸­å‘¢ã€‚å¤„ç†å†²çªä¸»è¦æœ‰ï¼ˆæŸ¥çœ‹åŸæ–‡è¯·ç§»æ­¥åº•éƒ¨å‚è€ƒé“¾æ¥ï¼šå“ˆå¸Œè¡¨ï¼‰ï¼š å¼€æ”¾å®šå€æ³• çº¿æ€§æ¢æµ‹ å¹³æ–¹æ¢æµ‹ ä¼ªéšæœºæ¢æµ‹ å•ç‹¬é“¾è¡¨æ³• å°†æ•£åˆ—åˆ°åŒä¸€ä¸ªå­˜å‚¨ä½ç½®çš„æ‰€æœ‰å…ƒç´ ä¿å­˜åœ¨ä¸€ä¸ªé“¾è¡¨ä¸­ã€‚å®ç°æ—¶ï¼Œä¸€ç§ç­–ç•¥æ˜¯æ•£åˆ—è¡¨åŒä¸€ä½ç½®çš„æ‰€æœ‰å†²çªç»“æœéƒ½æ˜¯ç”¨æ ˆå­˜æ”¾çš„ï¼Œæ–°å…ƒç´ è¢«æ’å…¥åˆ°è¡¨çš„å‰ç«¯è¿˜æ˜¯åç«¯å®Œå…¨å–å†³äºæ€æ ·æ–¹ä¾¿ã€‚ å†å“ˆå¸Œ ä¸Šä¸€æ¬¡å“ˆå¸Œè®¡ç®—å‘ç”Ÿå†²çªåï¼Œä½¿ç”¨å¦å¤–çš„å“ˆå¸Œå‡½æ•°è¿›è¡Œå“ˆå¸Œè®¡ç®—çŸ¥é“å†²çªä¸å†å‘ç”Ÿ å»ºç«‹å…¬å…±æº¢å‡ºåŒº ä¸ºå†²çªçš„å“ˆå¸Œåœ°å€å•ç‹¬å»ºç«‹ä¸€å—åŒºåŸŸï¼Œæ‰€æœ‰å†²çªçš„å“ˆå¸Œåœ°å€éƒ½å­˜æ”¾åœ¨æ­¤åŒºåŸŸä¸­ åˆ°è¿™é‡Œä¹Ÿå°±å¯ä»¥æ¨æ–­å‡ºï¼Œå¦‚æœåœ¨NSDictionaryå­˜å–æ—¶å‡ºç°æ•ˆç‡ä½ä¸‹çš„æƒ…å†µï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½æ˜¯ï¼š 1.é¢‘ç¹çš„æ‰©å®¹ 2.å†²çªè¿‡å¤š Qï¼šNSMapTableæ˜¯æ€æ ·çš„ç»“æ„å‘¢ï¼Ÿå…ˆæ¥çœ‹çœ‹NSMapTableçš„ç»“æ„(ä»£ç æ¥è‡ªäºcocotron)NSMapTableæ˜¯ä¸€ä¸ªkeyï¼valueçš„å®¹å™¨ï¼Œä¸‹é¢æ˜¯NSMapTableçš„éƒ¨åˆ†ä»£ç ï¼š 12345typedef struct &#123; NSMapTable *table; NSInteger i; struct _NSMapNode *j;&#125; NSMapEnumerator; ä¸Šè¿°ç»“æ„ä½“æè¿°äº†éå†ä¸€ä¸ªNSMapTableæ—¶çš„ä¸€ä¸ªæŒ‡é’ˆå¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«tableå¯¹è±¡è‡ªèº«çš„æŒ‡é’ˆï¼Œè®¡æ•°å€¼ï¼Œå’ŒèŠ‚ç‚¹æŒ‡é’ˆã€‚ 12345678typedef struct &#123; NSUInteger (*hash)(NSMapTable *table,const void *); BOOL (*isEqual)(NSMapTable *table,const void *,const void *); void (*retain)(NSMapTable *table,const void *); void (*release)(NSMapTable *table,void *); NSString *(*describe)(NSMapTable *table,const void *); const void *notAKeyMarker;&#125; NSMapTableKeyCallBacks; ä¸Šè¿°ç»“æ„ä½“ä¸­å­˜æ”¾çš„æ˜¯å‡ ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œç”¨äºè®¡ç®—keyçš„hashå€¼ï¼Œåˆ¤æ–­keyæ˜¯å¦ç›¸ç­‰ï¼Œretainï¼Œreleaseæ“ä½œã€‚ 12345typedef struct &#123; void (*retain)(NSMapTable *table,const void *); void (*release)(NSMapTable *table,void *); NSString *(*describe)(NSMapTable *table, const void *);&#125; NSMapTableValueCallBacks; ä¸Šè¿°å­˜æ”¾çš„ä¸‰ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œå®šä¹‰åœ¨å¯¹nsmaptableæ’å…¥ä¸€å¯¹keyï¼valueæ—¶ï¼Œå¯¹valueå¯¹è±¡çš„æ“ä½œã€‚ 1234567@interface NSMapTable : NSObject &#123; NSMapTableKeyCallBacks *keyCallBacks; NSMapTableValueCallBacks *valueCallBacks; NSUInteger count; NSUInteger nBuckets; struct _NSMapNode **buckets;&#125; ä¸Šé¢æ˜¯NSMtabtableçœŸæ­£çš„æè¿°ï¼Œå¯ä»¥çœ‹å‡ºæ¥NSMapTableæ˜¯ä¸€ä¸ªå“ˆå¸Œï¼‹é“¾è¡¨çš„æ•°æ®ç»“æ„(ä¹Ÿå°±æ˜¯ä½¿ç”¨Hashè¡¨ä¸­çš„å•é“¾è¡¨æ³•è§£å†³å†²çª)ï¼Œå› æ­¤åœ¨NSMapTableä¸­æ’å…¥æˆ–è€…åˆ é™¤ä¸€å¯¹å¯¹è±¡æ—¶ å¯»æ‰¾çš„æ—¶é—´æ˜¯Oï¼ˆ1ï¼‰ï¼‹Oï¼ˆmï¼‰ï¼Œmæœ€åæ—¶å¯èƒ½ä¸ºnã€‚ Oï¼ˆ1ï¼‰ï¼šä¸ºå¯¹keyè¿›è¡Œhashå¾—åˆ°bucketçš„ä½ç½® Oï¼ˆmï¼‰ï¼šéå†è¯¥bucketåé¢å†²çªçš„valueï¼Œé€šè¿‡é“¾è¡¨è¿æ¥èµ·æ¥ã€‚ å› æ­¤ï¼šNSDictionaryä¸­çš„key Valueéå†æ—¶æ˜¯æ— åºçš„ï¼Œè‡³å¦‚æŒ‰ç…§ä»€ä¹ˆæ ·çš„é¡ºåºï¼Œè·Ÿhashå‡½æ•°ç›¸å…³ã€‚NSMapTableä½¿ç”¨NSObjectçš„å“ˆå¸Œå‡½æ•°ã€‚ 123-(NSUInteger)hash &#123; return (NSUInteger)self&gt;&gt;4;&#125; ä¸Šè¿°æ˜¯NSObjectçš„å“ˆå¸Œå€¼çš„è®¡ç®—æ–¹å¼ï¼Œç®€å•é€šè¿‡ç§»ä½å®ç°ã€‚å³ç§»4ä½ï¼Œå·¦è¾¹è¡¥0.å› ä¸ºå¯¹è±¡å¤§å¤šå­˜äºå †ä¸­ï¼Œåœ°å€ç›¸å·®4ä½åº”è¯¥å¾ˆæ­£å¸¸ã€‚ å‚è€ƒï¼š NSMapTable: more than an NSDictionary for weak pointers Apple API Reference - NSMapTable Apple API Reference - NSHashTable ç»´åŸºç™¾ç§‘ - å“ˆå¸Œè¡¨(éœ€è¦ç¿»ä¸‹å¢™ï¼Œä¹Ÿå¯ä»¥é—®ä¸‹åº¦å¨˜) å…³äºNSDictionary NSDictionary çš„å†…éƒ¨å®ç° ã€ŠObjective-Cé«˜çº§ç¼–ç¨‹ï¼šiOSä¸OS Xå¤šçº¿ç¨‹å’Œå†…å­˜ç®¡ç†ã€‹ ARCçš„å®ç°","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"removeFromSuperViewæµ…è°ˆ","date":"2017-03-29T09:26:16.000Z","path":"2017/03/29/removeFromSuperViewæµ…è°ˆ/","text":"Unlinks the receiver from its superview and its window, and removes it from the responder chain. è¯‘ï¼šæŠŠå½“å‰Viewä»å®ƒçš„çˆ¶Viewå’Œçª—å£ä¸­ç§»é™¤ï¼ŒåŒæ—¶ä¹ŸæŠŠå®ƒä»å“åº”äº‹ä»¶æ“ä½œçš„å“åº”è€…é“¾ä¸­ç§»é™¤ã€‚ æ–¹æ³•è°ƒç”¨åçš„å†…å­˜ç®¡ç†å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š 1234567891011121314151617181920212223UIView *view = [UIView new];self.testView = view;[self.view addSubview:view];self.title = @\"jake\";[self.testView removeFromSuperview];@try &#123; for (int i = 0; i &lt; 10; i ++) &#123; NSLog(@\"å‰ %ld\", CFGetRetainCount((__bridge CFTypeRef)self.testView)); [self.testView removeFromSuperview]; NSLog(@\"å %ld\", CFGetRetainCount((__bridge CFTypeRef)self.testView)); self.testView.backgroundColor = [UIColor redColor]; [self.testView setUserInteractionEnabled:YES]; [self.testView removeFromSuperview]; [self.testView setNeedsDisplay]; &#125; &#125; @catch (NSException *exception) &#123; NSLog(@\"name : %@, reason : %@\", exception.name, exception.reason); &#125; @finally &#123; &#125; è¿™æ®µä»£ç æ‰§è¡Œä¸ä¼šå´©æºƒï¼Œself.testViewæ‰§è¡Œäº†å¤šæ¬¡removeFromSuperViewä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚ è‹¹æœçˆ¸çˆ¸å¯¹è¿™ä¸ªæ–¹æ³•è¿™æ ·è¯´çš„ï¼š The view is also released; if you plan to reuse it, be sure to retain it before sending this message and to release it as appropriate when adding it as a subview of another NSView. è°ƒäº†è¿™ä¸ªæ–¹æ³•å°±releaseäº†è¿™ä¸ªviewï¼Œå«æˆ‘ä»¬æƒ³è¦å†æ¬¡ä½¿ç”¨å°±å¾—æŠŠå®ƒretainä¸‹æ¥ã€‚ ç»“æœæˆ‘æ‰§è¡Œä¸Šæ®µä»£ç ï¼Œæ‰“å°å‡ºæ¥testViewçš„retainCountä¸ä½†æ²¡æœ‰å‡å°‘åè€Œå¢åŠ äº†1 (;ï¿¢ï¼¿ï¿¢) ï¼Œä¸è¿‡åœ¨è°ƒç”¨å®Œï¼ˆè¿™ä¸ªrunloopç»“æŸï¼‰ä¹‹åè¿˜æ˜¯ä¼šreleaseçš„ã€‚å¥½å§ï¼Œå…¶å®reatainCountä¸èƒ½å¤ªå½“å›äº‹ï¼Œä¹‹å‰åœ¨MRCæ—¶æœŸç»å¸¸å‘ç°retainCountä¸å‡†ç¡®ï¼Œè¿™ä¸»è¦æ˜¯å› ä¸ºiOSç³»ç»ŸAPIçš„å¼•ç”¨ã€æˆ–è‡ªåŠ¨é‡Šæ”¾æ± å¯¼è‡´çš„ï¼Œæ‰€ä»¥retainCountå¹¶ä¸èƒ½å½“åšå¯é çš„å‚è€ƒã€‚ æ— è®ºæ˜¯ARCè¿˜æ˜¯MRCä¸­å¤šæ¬¡è°ƒç”¨removeFromSuperviewå’ŒaddSubview:æ–¹æ³•ï¼Œéƒ½ä¸ä¼šé€ æˆé€ æˆé‡å¤é‡Šæ”¾å’Œæ·»åŠ ã€‚ æ°¸è¿œä¸è¦åœ¨ä½ çš„Viewçš„drawRect:æ–¹æ³•ä¸­è°ƒç”¨removeFromSuperviewã€‚","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"H5è·³è½¬Nativeè·¯ç”±æœºåˆ¶çš„æ¢ç´¢","date":"2017-03-24T01:20:47.000Z","path":"2017/03/24/H5è·³è½¬Nativeè·¯ç”±æœºåˆ¶çš„æ¢ç´¢/","text":"å…¬å¸çš„é¡¹ç›®æ ¸å¿ƒä¸šåŠ¡éƒ½åœ¨H5ï¼Œä¸ºäº†æé«˜APPçš„ä½¿ç”¨ä½“éªŒï¼Œè¿™æ®µæ—¶é—´åœ¨é‡æ„éƒ¨åˆ†åŠŸèƒ½ä¸šåŠ¡åˆ°Nativeã€‚é‡æ„è¿‡ç¨‹æŒç»­äº†4æœŸï¼ˆä¸€æœŸ1~2å‘¨ï¼‰ï¼Œå¤©å¤©å·¥ä½œé‡æ æ çš„ï¼ˆå› ä¸ºè¿½æ±‚é€Ÿåº¦ï¼Œçº¿ä¸Šè´¨é‡æ‰“äº†æŠ˜æ‰£ï¼Œç°åœ¨æ”¾æ…¢è„šæ­¥æ­£åœ¨ç¨³å›ºï¼Œæˆ‘æ‰å¾—ä»¥å†™è¿™ç¯‡æ–‡ç« ï¼Œæ¥ä¸‹æ¥è¿˜è¦ç»§ç»­ä¸‹ä¸€æœŸçš„é‡æ„,åˆæœŸå¾…åˆç´§å¼ ï¼‰ã€‚åœ¨é‡æ„è¿‡ç¨‹ä¸­ï¼Œæ”¶è·åˆ°äº†æŒºå¤šNativeä¸H5ä¹‹é—´äº¤äº’å’Œä¸€äº›åŠ¨æ€é…ç½®çš„ä½“ä¼šï¼Œå°±åœ¨è¿™è®°å½•ä¸‹è¿™äº›é£é›¨å†ç¨‹å§ã€‚ ps: æ–‡ä¸­ä¸æ¶‰åŠå…·ä½“ä»£ç ï¼Œä¸»è¦è®°å½•å®ç°çš„æœºåˆ¶å’Œé€»è¾‘ï¼Œä¹‹åå°†ä»£ç æ–¹æ¡ˆæŠ½ç¦»é¡¹ç›®åä¼šæ·»åŠ demoåœ°å€ åŠŸèƒ½éœ€æ±‚æ‰¯ä¸€æ‰¯ï¼šå…¬å¸ç°åœ¨ç‰ˆæœ¬çš„APPçš„ä¸»ä¸šåŠ¡åœ¨H5ç«¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬Nativeé‡æ„çš„é¡µé¢å°±é¿å…ä¸äº†è·ŸH5ä¹‹é—´çš„äº¤äº’ã€‚è¿™æ˜¯æœ€åŸºæœ¬çš„éœ€æ±‚ï¼Œå®Œæˆè¿™ä¸ªéœ€æ±‚çš„æ–¹æ¡ˆå·²ç»æ¯”è¾ƒç¨³å®šï¼Œæˆ‘ä»¬ä½¿ç”¨è‡ªå·±å®šä¹‰çš„åè®®å¯¹éœ€è¦äº¤äº’çš„åŠŸèƒ½è¿›è¡Œæ‹¦æˆªå®ç°H5åˆ°Nativeçš„äº¤äº’ã€‚Nativeåˆ°H5çš„è¯å°±ç›´æ¥åœ¨æ§åˆ¶å™¨å†…åŠ è½½æŒ‡å®šåœ°å€çš„webViewã€‚ å¾ˆæ˜¾ç„¶ï¼Œåœ¨Nativeåˆ°H5è¿™ä¸€æ­¥æœ‰å¾ˆå¤§çš„ä¼˜åŒ–ç©ºé—´ã€‚è€å¤§æå‡ºäº†è¿™æ ·çš„è¦æ±‚ï¼š æ‰€æœ‰è·³è½¬çš„H5åœ°å€éƒ½éœ€è¦èƒ½å¤Ÿåœ¨æœåŠ¡ç«¯åŠ¨æ€é…ç½®ï¼Œä¸‹æ–‡ç§°ï¼šDymaticH5æ–¹æ¡ˆ æ‰€æœ‰çš„Nativeé¡µé¢èƒ½å¤Ÿè¢«H5è°ƒèµ·ï¼Œä¸ç®¡åœ¨åº”ç”¨å†…è¿˜APPå¤–ï¼Œä¸‹æ–‡ç§°ï¼šNativeSchemeæ–¹æ¡ˆ å¦å¤–ä¸€ä½H5åŒäº‹é™„åŠ æå‡ºäº†ä¸€å¥—çº¿ä¸Šå®¹é”™æ–¹æ¡ˆ(æ‹¯æ•‘äº†ä¸¤æ¬¡çº¿ä¸Šbug) æ‰€æœ‰(æœ‰éœ€æ±‚)çš„Nativeé¡µé¢éƒ½èƒ½å¤Ÿé€šè¿‡æœåŠ¡ç«¯é…ç½®éšæ—¶æ›¿æ¢æˆH5ï¼Œ ä¸‹æ–‡ç§°ï¼šSwitchPageæ–¹æ¡ˆ æ–¹æ¡ˆæ¢ç´¢DymaticH5æ–¹æ¡ˆé¦–å…ˆä»‹ç»ä¸‹ç¯å¢ƒï¼š æˆ‘ä»¬çš„åœ¨çº¿ç¯å¢ƒé…ç½®æ–‡ä»¶éƒ½æ”¾åœ¨è‡ªå·±å®ç°çš„é™æ€æ¥å£å¹³å°ä¸‹é¢ç§°tmsï¼Œç”±æˆ‘ä»¬å‰ç«¯éƒ¨é—¨çš„åŒå­¦è‡ªå·±ç®¡ç†ï¼Œå¯ä»¥æ–¹ä¾¿åŠæ—¶åœ°é…åˆå®¢æˆ·ç«¯å’ŒH5çš„è¿­ä»£å’Œæ›´æ–°ã€‚ é¦–å…ˆæˆ‘ä»¬å°†æ‰€æœ‰éœ€è¦åŠ¨æ€åŒ–é…ç½®(ç”±Nativeè·³åˆ°H5)çš„H5åœ°å€é¡µé¢åœ°å€æ•´ç†æ”¾åˆ°tmsçš„é…ç½®æ–‡ä»¶ä¸­ï¼Œä¾‹å¦‚: 12345&#123; home : https://www.baidu.com, mine : https://www.mine.com, news : https://www.news.com&#125; å·¥ç¨‹é¡¹ç›®ä¸­æ·»åŠ ä¸tmsé…ç½®æ–‡ä»¶æ ¼å¼ç›¸åŒçš„plistæ–‡ä»¶,ç”¨äºå­˜å‚¨å½“tmsä¸Šæ²¡æœ‰é…ç½®åŠ¨æ€H5åœ°å€æ—¶çš„é»˜è®¤H5åœ°å€ã€‚ æ•´ä¸ªé¡¹ç›®ä¸­çš„H5åœ°å€ç”±URLCenterå·¥å…·ç±»é›†ä¸­ç®¡ç†ï¼Œè·å¾—H5åœ°å€åå­˜å‚¨åœ¨DynamicH5Modelä¸­ã€‚ DynamicH5ModelèŒè´£ï¼š è·å–plistä¸­çš„H5åœ°å€ç»™modelèµ‹å€¼ è¯»å–tmsè¿”å›çš„H5åœ°å€ç»™modelé‡æ–°èµ‹å€¼ URLCenterèŒè´£ï¼š è¯»å–DynamicH5Modelä¸­çš„H5åœ°å€ è·å–è°ƒç”¨è€…ä¼ å…¥H5åœ°å€æ‰€éœ€è¦å¸¦çš„å‚æ•° æ‹¼æ¥å‚æ•°è¿”å›è°ƒç”¨è€…éœ€è¦çš„å®Œæ•´çš„H5åœ°å€ æˆ‘ä»¬æ¥çœ‹ä¸€å¼ ç®€å•çš„æµç¨‹å›¾ï¼š APPå¯åŠ¨ç¨‹åºå…ˆè¯»å–plistä¸­çš„é»˜è®¤H5åœ°å€èµ‹å€¼åˆ°modelï¼Œåœ¨è¯·æ±‚tmsé…ç½®æ–‡ä»¶ä¹‹åï¼Œå†è·å–tmsä¸­é…ç½®çš„H5åœ°å€èµ‹å€¼åˆ°modelï¼Œè¿™æ ·å¯ä»¥ä¿è¯æ¯ä¸ªH5åœ°å€éƒ½å¯ä»¥æœ‰å€¼ï¼Œå¹¶ä¸”éƒ½æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„æœ€æ–°çš„åœ°å€ã€‚å¦‚æ­¤ï¼Œå³ä½¿åœ¨çº¿ä¸Šï¼Œä¸ç”¨å‘ç‰ˆæœ¬æˆ‘ä»¬çš„APPä¹Ÿå¯ä»¥è‡ªå¦‚åœ°æ§åˆ¶å’Œæ›´æ–°æ¯ä¸ªåŠŸèƒ½æ¨¡å—è·³è½¬çš„H5é¡µé¢å†…å®¹ã€‚ å½“ç„¶ï¼Œæ¯ä¸ªH5åœ°å€éœ€è¦ä»€ä¹ˆå‚æ•°è¿˜æ˜¯å¾—è°ƒç”¨è€…è‡ªå·±çŸ¥é“ï¼Œç„¶åå°†å‚æ•°èµ‹å€¼åˆ°URLCenterä¸­ã€‚ NativeSchemeæ–¹æ¡ˆ å–åå«NativeSchemeï¼Œå½“ç„¶è¿™ä¸ªæ–¹æ¡ˆè·Ÿshemeæœ‰å…³ï¼Œä½†ä¹Ÿä¸ä»…ä»…æ˜¯ä½¿ç”¨shemeã€‚ å…ˆè¯´æ˜è¿™ä¸ªæ–¹æ¡ˆæœ€ç»ˆè¾¾åˆ°çš„æ•ˆæœå§ï¼š APPä¸­çš„éƒ¨åˆ†åŠŸèƒ½æ¨¡å—ç‚¹å‡»è·³è½¬æŒ‡å‘æœ¬åœ°çš„å“ªä¸ªé¡µé¢ç”±æœåŠ¡ç«¯æ§åˆ¶ï¼Œä¸å†éœ€è¦æœ¬åœ°å›ºå®šã€‚å¯ä»¥éšæ—¶åˆ‡æ¢åŠŸèƒ½æ¨¡å—è·³è½¬åˆ°å¯¹åº”çš„H5é¡µé¢è¿˜æ˜¯å¯¹åº”çš„Nativeé¡µé¢ï¼Œå½“ç„¶å‰ææ˜¯è¿™ä¸¤è€…é¡µé¢éƒ½æœ‰å®ç°ã€‚ ä¾‹å¦‚ï¼š åœ¨è¿™æ ·çš„åŠŸèƒ½å—ä¸­ï¼Œæ¯ä¸ªåŠŸèƒ½æ¨¡å—ç‚¹å‡»åé€šè¿‡æœåŠ¡å™¨è¿”å›çš„NativeSchemeåˆ¤æ–­è·³è½¬åˆ°æœ¬åœ°çš„å¯¹åº”é¡µé¢ã€‚ å®ç°åŸç†ï¼š æœåŠ¡å™¨ç»™æ¯ä¸ªåŠŸèƒ½å—æ·»åŠ ä¸€ä¸ªnativeSchemeçš„å­—æ®µ, å¦‚ myApp://jakeApp/home å…¶ä¸­ myAppä¸ºAPPçš„info.plisté…ç½®æ–‡ä»¶ä¸­çš„URL Scheme è‹¥éƒ¨åˆ†é¡µé¢åˆå§‹åŒ–æ—¶æœ‰äº›å¿…è¦çš„å‚æ•°éœ€è¦æŒ‡å®šï¼ŒNativeSchemeå¯ä»¥é™„åŠ å¿…è¦çš„å‚æ•°ï¼Œå¦‚myApp://jakeApp/home?homeType=1 å·¥ç¨‹é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ªnativeScheme.plistï¼Œå…¶ä¸­å­˜å‚¨çš„æ˜¯æ¯ä¸ªnativeSchemeå¯¹åº”çš„æœ¬åœ°æ§åˆ¶å™¨çš„åå­—å’Œæ§åˆ¶å™¨åˆå§‹åŒ–çš„æ–¹å¼ï¼ˆstoryboardæˆ–xibæˆ–frameï¼‰ å¦‚ï¼š 1234567891011&#123; myApp://jakeApp/home : &#123; class : HomeViewController, type : storyboard &#125;, myApp://jakeApp/mine : &#123; class : MineViewController, type : xib &#125;&#125; æ•´ä¸ªé¡¹ç›®çš„æ§åˆ¶å™¨è·³è½¬ç”±URLRouteræ§åˆ¶ï¼Œå¯ä¼ å…¥H5åœ°å€æˆ–è€…NativeSchemeåœ°å€è·å¾—å°†è¦è·³è½¬åˆ°çš„æ§åˆ¶å™¨ URLRouterèŒè´£: ä¼ å…¥navtiveSchemeæ ¼å¼çš„åœ°å€ï¼Œåˆ™ä»æœ¬åœ°navtiveScheme.plistä¸­è·å–å¯¹åº”æ§åˆ¶å™¨å¹¶åˆå§‹åŒ–ä¼ å…¥ä»åœ°å€ä¸­è·å¾—çš„å‚æ•° ä¼ å…¥H5åœ°å€åˆ™è·å¾—å®Œæ•´çš„H5åœ°å€(è‹¥æœ‰ä½¿ç”¨ç¬¬ä¸€èŠ‚ä¸­çš„DynamicH5æ–¹æ¡ˆå¯ä»¥å°†å…¶ä¼ å…¥URLCenterè·å¾—åœ°å€)ï¼Œåˆ›å»ºwebViewè·³è½¬ APPå¯é€šè¿‡ URL Schemeå”¤èµ·ï¼Œåœ¨AppDelegateå¯¹åº”çš„æ–¹æ³•ä¸­ä½¿ç”¨URLRouterè·³è½¬åˆ°å¯¹åº”çš„Nativeé¡µé¢ æ–¹æ¡ˆæ‰©å±•ä½¿ç”¨ï¼š æˆ‘ä»¬è¿˜å¯ä»¥åœ¨nativeSchemeåˆ¤è¯»ç¯èŠ‚æ·»åŠ ä¸€ä¸ªåŠ¨æ€çš„èŠ‚ç‚¹(æ ¹æ®éœ€æ±‚)ï¼Œä»¥å®ç°ç‚¹å‡»åŠŸèƒ½å—åæ˜¯è·³è½¬åˆ°H5é¡µé¢è¿˜æ˜¯è·³è½¬æœ¬åœ°çš„é¡µé¢(æ­¤é€»è¾‘ä¸åŒäºæœ¬ç« ç¬¬ä¸‰èŠ‚ â€œSwitchPageæ–¹æ¡ˆâ€)ã€‚å¯ä»¥ç»™æ¯ä¸ªåŠŸèƒ½å—åˆ†åˆ«æ·»åŠ  æœ¬åœ°schemeåœ°å€ å’Œ H5åœ°å€ ä¸¤ä¸ªå­—æ®µï¼Œç”¨äºåˆ†åˆ«æ˜¯è·³å‘å“ªç§ç•Œé¢ã€‚åˆ¤æ–­è§„åˆ™å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ¥å®šã€‚ é™„ä¸ŠNativeSchemeçš„ç®€å•æµç¨‹å›¾ï¼š æ­¤æ–¹æ¡ˆéƒ¨åˆ†å‚è€ƒï¼šhttps://github.com/DarielChen/DCURLRouter æ„Ÿè°¢ä½œè€… SwitchPageæ–¹æ¡ˆè¿™å¥—æ–¹æ¡ˆçš„å­˜åœ¨ï¼Œåœ¨æŸç§æ„ä¹‰ä¸Šæ˜¯ä¸€å¥—çº¿ä¸Šçš„ç´§æ€¥å¤‡ç”¨æ–¹æ¡ˆâ€”-å½“é‡æ„çš„Nativeé¡µé¢å‡ºç°é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡æ­¤æ–¹æ¡ˆå°†è¯¥Nativeé¡µé¢æ›¿æ¢ä¸ºH5é¡µé¢ã€‚æ­¤æ–¹æ¡ˆï¼Œå¯ä»¥è¯´æ˜¯å¯¹æˆ‘ä»¬é¡¹ç›®ç°çŠ¶æ¯”è¾ƒé€‚ç”¨ï¼Œåœ¨å…¶ä»–é¡¹ç›®ä¸­æˆ–è®¸å­˜åœ¨çš„æ„ä¹‰æ²¡æœ‰é‚£ä¹ˆå¤§ã€‚ä½†æ˜¯è¿™å¥—åŸç†å¯ä»¥æ‹¿æ¥åšå‚è€ƒï¼Œæ¯•ç«ŸSwitchPageå¯ä»¥å°†ä»»æ„ä¸€ä¸ªNativeé¡µé¢æ›¿æ¢ä¸ºä»»æ„ä¸€ä¸ªH5çš„é¡µé¢ã€‚ å®ç°åŸç†ï¼š å®ç°é€»è¾‘ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œ tmsä¸Šé…ç½®éœ€è¦æ›¿æ¢çš„æ§åˆ¶å™¨åå­—å’Œéœ€è¦æ›¿æ¢æˆçš„H5åœ°å€çš„ç»å¯¹è·¯å¾„ï¼Œå¦‚ï¼š 123&#123; HomeViewController : https://www.baidu.com&#125; é‡å†™æœ¬åœ°çš„Nativgationçš„pushæ–¹æ³•ï¼Œ åœ¨æ­¤æ–¹æ³•è°ƒç”¨superä¹‹å‰ï¼Œåˆ¤æ–­å°†è¦è·³è½¬çš„æ§åˆ¶å™¨åç§°åœ¨tmsè¯·æ±‚è¿”å›çš„æ•°æ®ä¸­æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™è·³è½¬webViewæ§åˆ¶å™¨ï¼Œä¸å­˜åœ¨åˆ™æŒ‰ç…§åŸæ¥æ–¹æ³•è·³è½¬ã€‚ï¼ˆå¯ç»“åˆNativeSchemeæ–¹æ¡ˆä½¿ç”¨ï¼Œåœ¨URLRouterä¸­å®ç°æ­¤é€»è¾‘ï¼‰ é™„ä¸Šç®€å•æµç¨‹å›¾ï¼š æ€»ç»“ä¸è¶³ï¼šNativeSchemeæ–¹æ¡ˆä¸­çš„å‚æ•°ä¼ é€’æ¯”è¾ƒåœ°ç”Ÿç¡¬ï¼Œè‹¥æ˜¯éœ€è¦è·³è½¬çš„Nativeæ§åˆ¶å™¨éœ€è¦åˆ¶å®šçš„å‚æ•°éœ€è¦é¢å¤–å¤„ç†ï¼Œåˆ™æ— æ³•é€šè¿‡shcemeåå¸¦å‚æ•°çš„æ–¹å¼åœ¨URLRouterä¸­ç›´æ¥ç»™è¦è¿”å›çš„æ§åˆ¶å™¨æ·»åŠ å‚æ•° ä¸Šé¢ä¸‰å¥—æ–¹æ¡ˆå¯ä»¥åœ¨é¡¹ç›®ä¸­ä¸€èµ·ä½¿ç”¨ï¼Œç›¸äº’ä¹‹é—´ä¸ä¼šå½±å“ï¼Œä¹Ÿå¯ä»¥å•ç‹¬ä½¿ç”¨å…¶ä¸­çš„æŸä¸€å¥—æ–¹æ¡ˆã€‚ demoåœ°å€ï¼šå³å°†å‡ºç°","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"JSPatché‡ä¸ŠSwift","date":"2017-02-08T06:42:27.000Z","path":"2017/02/08/JSPatché‡ä¸ŠSwift/","text":"JSPatchçš„åŠ¨æ€æ›´æ–°æ˜¯ä¾èµ–äºObjective-Cçš„runtimeï¼Œé‚£ä½œä¸ºé™æ€è¯­è¨€çš„Swiftå°±æ²¡æœ‰åŠæ³•ä½¿ç”¨JSPatchäº†å—ï¼ŸSwiftç±»æˆå‘˜è¿˜æ˜¯å¯ä»¥ä½¿ç”¨Objective-Cçš„è¿è¡Œæ—¶åŠ¨æ€æ´¾å‘ï¼Œåªè¦Swiftç±»æ˜¯ç»§æ‰¿è‡ªNSObjectæˆ–è€…ä½¿ç”¨dynamicä¿®é¥°çš„ç±»çš„æˆå‘˜ã€‚ çº¯Swiftç±»æ²¡æœ‰åŠ¨æ€æ€§ æ— æ³•é‡å†™çº¯swiftç±»çš„æ–¹æ³•å’Œå±æ€§JSPatchåœ¨è¿›è¡Œåˆ°overrideMethodè¿›è¡Œæ–¹æ³•å®ç°IMPæ›¿æ¢æ—¶è¦æ±‚classå®ç°NSCopingåè®®ï¼Œè€Œä¸ç»§æ‰¿è‡ªNSObjectçš„swiftç±»æ˜¯ä¸éµå¾ªè¯¥åè®®çš„ï¼Œå› æ­¤ä¼šå´©æºƒã€‚ Swiftä¸­ä½¿ç”¨Method Swizzlingçš„åŸåˆ™æ‘˜è‡ªåº•éƒ¨å‚è€ƒèµ„æ–™ ç»§æ‰¿è‡ªNSObjectçš„Swiftç±»ï¼Œå…¶ç»§æ‰¿è‡ªçˆ¶ç±»çš„æ–¹æ³•å…·æœ‰åŠ¨æ€æ€§ï¼Œå…¶ä»–è‡ªå®šä¹‰æ–¹æ³•ã€å±æ€§éœ€è¦åŠ dynamicä¿®é¥°æ‰å¯ä»¥è·å¾—åŠ¨æ€æ€§ã€‚ è‹¥æ–¹æ³•çš„å‚æ•°ã€å±æ€§ç±»å‹ä¸ºSwiftç‰¹æœ‰ã€æ— æ³•æ˜ å°„åˆ°Objective-Cçš„ç±»å‹(å¦‚Characterã€Tuple)ï¼Œåˆ™æ­¤æ–¹æ³•ã€å±æ€§æ— æ³•æ·»åŠ dynamicä¿®é¥°ï¼ˆä¼šç¼–è¯‘é”™è¯¯ï¼‰ã€‚ çº¯Swiftç±»æ²¡æœ‰åŠ¨æ€æ€§ï¼Œä½†åœ¨æ–¹æ³•ã€å±æ€§å‰æ·»åŠ dynamicä¿®é¥°å¯ä»¥è·å¾—åŠ¨æ€æ€§ã€‚ å®˜æ–¹æ–‡æ¡£dynamicå£°æ˜ä¿®é¥°ç¬¦é‡Šä¹‰ è¯¥ä¿®é¥°ç¬¦ç”¨äºä¿®é¥°ä»»ä½•å…¼å®¹ Objective-C çš„ç±»çš„æˆå‘˜ã€‚è®¿é—®è¢«dynamicä¿®é¥°ç¬¦æ ‡è®°çš„ç±»æˆå‘˜å°†æ€»æ˜¯ç”±OCè¿è¡Œæ—¶ç³»ç»Ÿè¿›è¡ŒåŠ¨æ€æ´¾å‘ï¼Œè€Œä¸ä¼šç”±ç¼–è¯‘å™¨è¿›è¡Œå†…è”æˆ–æ¶ˆè™šæ‹ŸåŒ–ã€‚ JSPatchä¸Šæ‰‹ä½¿ç”¨ ç»§æ‰¿è‡ªNSObjectçš„Swiftç±»ä¸­ 123456class ViewController: UIViewController &#123; override func viewWillAppear(_ animated: Bool) &#123; super.viewWillAppear(animated) self.view.backgroundColor = UIColor.yellow; &#125;&#125; é‡è½½è‡ªçˆ¶ç±»çš„æ–¹æ³•ä¸éœ€è¦dynamicä¿®é¥°ç¬¦è¿›è¡Œä¿®é¥°ï¼Œå¯ä»¥ç›´æ¥è¿›è¡ŒJSPatchåŠ¨æ€æ›¿æ¢ã€‚ è‡ªå®šä¹‰çš„Swiftæ–¹æ³•éœ€è¦åŠ ä¸Šdynamicä¿®é¥°ç¬¦ 12345678910class ViewController: UIViewController &#123; override func viewWillAppear(_ animated: Bool) &#123; super.viewWillAppear(animated) self.view.backgroundColor = UIColor.yellow; &#125;&#125;dynamic func test() &#123; print(\"è¿™æ˜¯åŸç”Ÿçš„æ‰“å°\") &#125; Swiftä¸­Cocoaçš„APIæ–¹æ³•è·ŸObjective-Cä¸åŒæ—¶ï¼ŒJSPatchä»£ç  1234567891011dynamic func paramTest(paramOne: String, paramTwo: String) -&gt; String &#123; return \"åŸç”Ÿçš„å­—ç¬¦ä¸²\"; &#125; dynamic func paramTest2(_ paramOne: String, withParam paramTwo: String) -&gt; String &#123; return \"åŸç”Ÿå­—ç¬¦ä¸²2\" &#125; dynamic func paramTest3(withParamOne paramOne: String, andParamTwo paramTwo: String) -&gt; String &#123; return \"åŸç”Ÿå­—ç¬¦ä¸²3\" &#125; 1234567891011paramTestWithParamOne_paramTwo: function(paramOne, paramTwo) &#123; return \"JSå­—ç¬¦ä¸²\" &#125;, paramTest2_withParam: function(paramOne, paramTwo) &#123; return \"JSå­—ç¬¦ä¸²2\" &#125;, paramTest3WithParamOne_andParamTwo: function(paramOne, paramTwo) &#123; return \"JSå­—ç¬¦ä¸²3\" &#125;, defineClassä¸­æŒ‡å®šç±»åéœ€è¦å¸¦ä¸Šé¡¹ç›®targetçš„åå­— 12345678910111213141516171819202122232425require('UIColor')defineClass(\"Swift_JSPatch.ViewController\", &#123; viewWillAppear: function(animated) &#123; self.super().viewWillAppear(animated) self.view().setBackgroundColor(UIColor.redColor()) &#125;, test: function() &#123; console.log(\"JSè¾“å‡ºçš„ä»£ç \") &#125;, paramTestWithParamOne_paramTwo: function(paramOne, paramTwo) &#123; return \"JSå­—ç¬¦ä¸²\" &#125;, paramTest2_withParam: function(paramOne, paramTwo) &#123; return \"JSå­—ç¬¦ä¸²2\" &#125;, paramTest3WithParamOne_andParamTwo: function(paramOne, paramTwo) &#123; return \"JSå­—ç¬¦ä¸²3\" &#125;, &#125;, &#123;&#125;) å‚è€ƒï¼šJSPatchåœ¨Swiftä¸­çš„åº”ç”¨","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"},{"name":"Swift","slug":"Swift","permalink":"http://www.yangjie.hu//tags/Swift/"}]},{"title":"Swiftå’ŒObjective-Cçš„æ•°ç»„è½¬æ¢","date":"2017-01-20T02:45:57.000Z","path":"2017/01/20/Swiftå’ŒObjective-Cçš„æ•°ç»„è½¬æ¢/","text":"å½“æˆ‘ä»¬åœ¨ Objective-C ä»£ç ä¸­ä½¿ç”¨ Swift ç±»æˆ–è€…åè®®æ—¶ï¼Œæ¥å…¥çš„APIä¼šå°†å…¨éƒ¨æ‰€æœ‰ç±»å‹çš„Swiftæ•°ç»„ä»£æ›¿ä¸ºNSArrayã€‚ Swift çš„ç¼–è¯‘å™¨ä¼šåœ¨æ¥å…¥ Objective-C APIs çš„æ—¶å€™å°†NSArrayç±»æ›¿æ¢æˆAnyObject[] è‹¥æˆ‘ä»¬å°†ä¸€ä¸ªNSArrayå¯¹è±¡ä¼ é€’ç»™Swiftçš„APIå¹¶è¦æ±‚æ•°ç»„å…ƒç´ ä¸ºä¸€ä¸ªæ–°çš„ç±»å‹ï¼Œè¿è¡Œæ—¶å°±ä¼šäº§ç”Ÿé”™è¯¯ã€‚ å¦‚æœ Swift API è¿”å›ä¸€ä¸ªä¸èƒ½è¢«è½¬æ¢ä¸ºNSArrayç±»å‹çš„ Swift æ•°ç»„ï¼Œé”™è¯¯ä¹Ÿä¼šéšä¹‹äº§ç”Ÿã€‚ å¦‚æœæŸä¸ªå¯¹è±¡æ˜¯ Objective-C æˆ–è€… Swift ç±»çš„å®ä¾‹ï¼Œæˆ–è€…è¿™ä¸ªå¯¹è±¡å¯ä»¥è½¬æ¢æˆå¦ä¸€ç§ç±»å‹ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡åˆ™å±äºAnyObjectç±»å‹çš„å¯¹è±¡ ä¾‹å¦‚ï¼Œä¸€ä¸ªInt[]ç±»å‹çš„ Swift æ•°ç»„åŒ…å«Intç»“æ„çš„å…ƒç´ ã€‚Intç±»å‹å¹¶ä¸æ˜¯ä¸€ä¸ªç±»çš„å®ä¾‹ï¼Œä½†ç”±äºIntç±»å‹è½¬æ¢æˆäº†NSNumberç±»ï¼ŒIntç±»å‹å±äºAnyObjectç±»å‹çš„ã€‚ Swiftæ•°ç»„è½¬æ¢æˆNSArray: å½“æˆ‘ä»¬ä» Swift æ•°ç»„è½¬æ¢ä¸ºNSArrayå¯¹è±¡æ—¶ï¼ŒSwift æ•°ç»„é‡Œçš„å…ƒç´ å¿…é¡»æ˜¯å±äºAnyObjectçš„ã€‚ å½“æˆ‘ä»¬ä»ä¸€ä¸ª Swift æ•°ç»„è½¬æ¢æˆä¸€ä¸ªNSArrayå¯¹è±¡åï¼Œè½¬æ¢åçš„ç»“æœåˆ™æ˜¯ä¸€ä¸ª[ObjectType]ç±»å‹çš„æ•°ç»„. NSArrayå¯¹è±¡è½¬æ¢æˆSwiftæ•°ç»„: æˆ‘ä»¬å¯ä»¥å°†ä»»æ„NSArrayå¯¹è±¡è½¬æ¢æˆä¸€ä¸ªSwiftæ•°ç»„ï¼Œå› ä¸ºæ‰€æœ‰Objective-Cçš„å¯¹è±¡éƒ½æ˜¯AnyObjectç±»å‹ã€‚ å¦‚æœNSArrayå¯¹è±¡æ²¡æœ‰æŒ‡æ˜ä¸€ä¸ªç¡®åˆ‡çš„å‚æ•°ç±»å‹ï¼Œé‚£ä¹ˆå®ƒå°†ä¼šè½¬æ¢æˆ[AnyObject]ç±»å‹çš„Swiftæ•°ç»„ã€‚ 1234//Objective@property NSArray&lt;NSDate *&gt;* dates;//Swiftvar dates: [NSDate] NSArrayå¯¹è±¡è½¬æ¢æˆä¸€ä¸ª Swift æ•°ç»„åï¼Œä¹Ÿå¯ä»¥å°†æ•°ç»„å¼ºåˆ¶ç±»å‹è½¬æ¢æˆä¸€ä¸ªç‰¹å®šçš„ç±»å‹ã€‚ï¼Œä»AnyObjectç±»å‹çš„å¯¹è±¡è½¬æ¢æˆæ˜ç¡®çš„ç±»å‹å¹¶ä¸ä¼šä¿è¯æˆåŠŸï¼Œä»AnyObject[]è½¬æ¢ä¸ºSomeType[]ä¼šè¿”å›ä¸€ä¸ª optional çš„å€¼ã€‚ä¾‹å­ï¼š 1234let swiftyArray = foundationArray as AnyObject[]if let downcastedSwiftArray = swiftArray as? UIView[] &#123; // downcastedSwiftArray contains only UIView objects&#125; ä¹Ÿå¯ä»¥åœ¨forå¾ªç¯ä¸­å°†NSArrayå¯¹è±¡å®šå‘åœ°å¼ºåˆ¶è½¬æ¢ä¸ºç‰¹å®šç±»å‹çš„Swiftæ•°ç»„: 123for aView: UIView! in foundationArray &#123; // aView is of type UIView&#125; å‚è€ƒï¼šUsing Swift with Cocoa and Objective-C","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"},{"name":"Swift","slug":"Swift","permalink":"http://www.yangjie.hu//tags/Swift/"}]},{"title":"Using Swift With Cocoa and Objective-Cç¬”è®°_ONE","date":"2017-01-19T07:49:18.000Z","path":"2017/01/19/Using-Swift-with-Cocoa-and-Objective-Cç¬”è®°-ONE/","text":"Objective-Cå’ŒSwiftçš„éç©ºå€¼ã€å¯é€‰å€¼è½¬æ¢Objective-C èƒ½å¤Ÿä½¿ç”¨ç©ºå€¼æ ‡è®°æ¥è®¾å®šä¸€ä¸ªå‚æ•°ç±»å‹ï¼Œå±æ€§ç±»å‹æˆ–è€…è¿”å›å€¼ç±»å‹æ˜¯å¦å¯ä»¥ä¸º NULL æˆ–è€… ä¸º nil å€¼ã€‚å•ç‹¬çš„ç±»å‹å£°æ˜å¯ä»¥ä½¿ç”¨nullableå’Œnonnullæ ‡æ³¨ï¼Œç©ºå€¼çš„èŒƒå›´æ€§çš„å£°æ˜å¯ä»¥ä½¿ç”¨NS_ASSUME_NONNULL_BEGINå’ŒNS_ASSUME_NONNULL_ENDå®ã€‚å¦‚æœä¸€ä¸ªç±»å‹æ²¡æœ‰ä»»ä½•çš„ç©ºå€¼æ ‡æ³¨ä¿¡æ¯ï¼ŒSwift å°±ä¸èƒ½åˆ†è¾¨å‡ºå¯é€‰å€¼å’Œéå¯é€‰å€¼ç±»å‹ï¼Œå¹¶ä¸”å°†ä½œä¸ºéšå¼çš„è§£åŒ…å¯é€‰å€¼å¯¼å…¥ã€‚ ä»¥__nonnullæˆ–è€…èŒƒå›´å®æ ‡æ³¨å£°æ˜çš„ç©ºå€¼ç±»å‹ï¼Œè¢«ä½œä¸ºéç©ºå¯é€‰å€¼non-optionalå¯¼å…¥åˆ° Swiftã€‚ ä»¥__nullableæ ‡æ³¨å£°æ˜çš„ç©ºå€¼ç±»å‹ï¼Œè¢«ä½œä¸ºå¯é€‰å€¼å¯¼å…¥åˆ° Swiftã€‚ æ²¡æœ‰ä»¥ç©ºå€¼æ ‡æ³¨å£°æ˜çš„ç±»å‹è¢«ä½œä¸ºéšå¼çš„è§£åŒ…å¯é€‰å€¼å¯¼å…¥åˆ° Swiftã€‚ Objective-Cç”³æ˜ 1234567891011@property (nullable) id nullableProperty;@property (nonnull) id nonNullProperty;@property id unannotatedProperty;NS_ASSUME_NONNULL_BEGIN- (id)returnsNonNullValue;- (void)takesNonNullParameter:(id)value;NS_ASSUME_NONNULL_END- (nullable id)returnsNullableValue;- (void)takesNullableParameter:(nullable id)value;- (id)returnsUnannotatedValue;- (void)takesUnannotatedParameter:(id)value; å¯¼å…¥Swiftä¸­ï¼š 123456789var nullableProperty: AnyObject?var nonNullProperty: AnyObjectvar unannotatedProperty: AnyObject!func returnsNonNullValue() -&gt; AnyObjectfunc takesNonNullParameter(value: AnyObject)func returnsNullableValue() -&gt; AnyObject?func takesNullableParameter(value: AnyObject?)func returnsUnannotatedValue() -&gt; AnyObject!func takesUnannotatedParameter(value: AnyObject!) é—­åŒ…å’ŒBlockçš„äº¤äº’Objective-C ä¸­çš„blocksä¼šè¢«è‡ªåŠ¨å¯¼å…¥ä¸º Swift ä¸­çš„é—­åŒ…ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ª Objective-C ä¸­çš„ block å˜é‡ï¼š 1void (^completionBlock)(NSData *, NSError *) = ^(NSData *data, NSError *error) &#123;/* ... */&#125; è€Œå®ƒåœ¨ Swift ä¸­çš„å½¢å¼ä¸º: 1let completionBlock: (NSData, NSError) -&gt; Void = &#123;data, error in /* ... */&#125; Swift çš„é—­åŒ…ä¸ Objective-C ä¸­çš„ blocks èƒ½å¤Ÿå’Œç¦ç›¸å¤„ï¼Œæ‰€ä»¥ä½ å¯ä»¥æŠŠä¸€ä¸ª Swift é—­åŒ…ä¼ é€’ç»™ä¸€ä¸ªæŠŠ block ä½œä¸ºå‚æ•°çš„ Objective-C å‡½æ•°ã€‚Swift é—­åŒ…ä¸å‡½æ•°å…·æœ‰äº’é€šçš„ç±»å‹ï¼Œæ‰€ä»¥ä½ ç”šè‡³å¯ä»¥ä¼ é€’ Swift å‡½æ•°çš„åå­—ã€‚ é—­åŒ…ä¸ blocks è¯­ä¹‰ä¸Šç›¸é€šä½†æ˜¯åœ¨ä¸€ä¸ªåœ°æ–¹ä¸åŒï¼šå˜é‡æ˜¯å¯ä»¥ç›´æ¥æ”¹å˜çš„ï¼Œè€Œä¸æ˜¯åƒ block é‚£æ ·ä¼šæ‹·è´å˜é‡ã€‚æ¢å¥è¯è¯´ï¼ŒSwift ä¸­å˜é‡çš„é»˜è®¤è¡Œä¸ºä¸ Objective-C ä¸­ __block å˜é‡ä¸€è‡´ã€‚ Swiftç±»å‹å…¼å®¹æ€§ @objc å’Œ dynamic@objcå¯ä»¥è®©ä½ çš„ Swift API åœ¨ Objective-C ä¸­ä½¿ç”¨ã€‚æ¢å¥è¯è¯´ï¼Œä½ å¯ä»¥é€šè¿‡åœ¨ä»»ä½• Swift æ–¹æ³•ã€ç±»ã€å±æ€§å‰æ·»åŠ @objcï¼Œæ¥ä½¿å¾—ä»–ä»¬å¯ä»¥åœ¨ Objective-C ä»£ç ä¸­ä½¿ç”¨ã€‚å¦‚æœä½ æ­£åœ¨ä½¿ç”¨å¦‚é”®å€¼è§‚å¯Ÿçš„ API æ¥åŠ¨æ€æ›¿æ¢æ–¹æ³•çš„å®ç°ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨dynamicä¿®é¥°ç¬¦æ¥è·å¾—å¯¹ Objective-C è¿è¡Œæ—¶è¢«è‡ªåŠ¨æ´¾å‘çš„æˆå‘˜çš„è®¿é—®ã€‚ å½“ä½ åœ¨ Objective-C ä¸­ä½¿ç”¨ Swift APIï¼Œç¼–è¯‘å™¨é€šå¸¸ä¼šå¯¹è¯­å¥åšç›´æ¥çš„ç¿»è¯‘ã€‚ä¾‹å¦‚ï¼ŒSwift API func playSong(name: String)ä¼šè¢«è§£é‡Šä¸º- (void)playSong:(NSString *)nameã€‚ç„¶è€Œï¼Œæœ‰ä¸€ä¸ªä¾‹å¤–ï¼šå½“åœ¨ Objective-C ä¸­ä½¿ç”¨ Swift çš„åˆå§‹åŒ–å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šåœ¨æ–¹æ³•å‰æ·»åŠ â€œinitWithâ€å¹¶ä¸”å°†åŸåˆå§‹åŒ–å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°é¦–å­—æ¯å¤§å†™ã€‚ä¾‹å¦‚ï¼Œè¿™ä¸ª Swift åˆå§‹åŒ–å‡½æ•°init (songName: String, artist: String)å°†è¢«ç¿»è¯‘ä¸º- (instancetype)initWithSongName:(NSString *)songName artist:(NSString *)artistã€‚ Swift åŒæ—¶ä¹Ÿæä¾›äº†ä¸€ä¸ª@objcå…³é”®å­—çš„å˜ä½“ï¼Œé€šè¿‡å®ƒä½ å¯ä»¥è‡ªå®šä¹‰åœ¨ Objective-C ä¸­è½¬æ¢çš„å‡½æ•°åã€‚ ä¾‹å­ï¼š 12345678//Swift@objc(Squirrel)class Ğ‘ĞµĞ»ĞºĞ° &#123; @objc(initWithName:) init (Ğ¸Ğ¼Ñ: String) &#123; /*...*/ &#125; @objc(hideNuts:inTree:) func Ğ¿Ñ€ÑÑ‡ÑŒĞÑ€ĞµÑ…Ğ¸(Int, Ğ²Ğ”ĞµÑ€ĞµĞ²Ğµ: Ğ”ĞµÑ€ĞµĞ²Ğ¾) &#123; /*...*/ &#125;&#125; è½»é‡çº§æ³›å‹123@property NSArray&lt;NSDate *&gt;* dates;@property NSSet&lt;NSString *&gt;* words;@property NSDictionary&lt;KeyType: NSURL *, NSData *&gt;* cachedData; 123var dates: [NSDate]var words: Set&lt;String&gt;var cachedData: [NSURL: NSData] æ³¨æ„ é™¤äº† Foundation ä¸­çš„é›†åˆç±»ï¼Œ Objective-C çš„è½»é‡çº§æ³›å‹ä¼šè¢« Swift å¿½ç•¥æ‰ã€‚ä»»ä½•å…¶ä»–ä½¿ç”¨è½»é‡çº§æ³›å‹çš„ç±»å‹åœ¨å¯¼å…¥åˆ° Swift ä¸­æ—¶ä¼šè¢«è§†ä¸ºæ— å‚æ•°åŒ–ã€‚","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"},{"name":"Swift","slug":"Swift","permalink":"http://www.yangjie.hu//tags/Swift/"}]},{"title":"Swiftçš„weak Unowned Unowned(unsafe)","date":"2017-01-19T03:56:19.000Z","path":"2017/01/19/Swiftçš„weak-unowned-unowned-unsafe/","text":"SwiftåŒæ ·ä¹Ÿæ˜¯ç”¨ARCç®¡ç†å†…å­˜ï¼Œä¸ºäº†è§£å†³å¼•ç”¨å¾ªç¯ã€‚åŒOCä¸€æ ·ä½¿ç”¨weakä¿®é¥°å¯¹è±¡ï¼Œåœ¨weakå¼•ç”¨æŒ‡å‘çš„å¯¹è±¡è¢«é‡Šæ”¾ä¹‹åï¼Œå…¶è‡ªèº«ä¼šè¢«ç½®ä¸ºnilä¹Ÿä¼šè¢«é‡Šæ”¾ã€‚ è€Œåœ¨Swiftä¸­nilæ˜¯Optionalçš„ä¸“å±ï¼Œå¯¹äºéå¯é€‰ç±»å‹ï¼Œåˆ™ä½¿ç”¨æ— ä¸»å¼•ç”¨ï¼šunowned ä½¿ç”¨æ— ä¸»å¼•ç”¨ï¼Œä½ å¿…é¡»ç¡®ä¿å¼•ç”¨å§‹ç»ˆæŒ‡å‘ä¸€ä¸ªæœªé”€æ¯çš„å®ä¾‹ã€‚å¦‚æœä½ è¯•å›¾åœ¨å®ä¾‹è¢«é”€æ¯åï¼Œè®¿é—®è¯¥å®ä¾‹çš„æ— ä¸»å¼•ç”¨ï¼Œä¼šè§¦å‘è¿è¡Œæ—¶é”™è¯¯ã€‚ å®‰å…¨æ— ä¸»å¼•ç”¨unownedæŒ‡å‘çš„å¯¹è±¡è¢«é‡Šæ”¾ä¹‹åï¼Œå…¶è‡ªèº«ä¸ä¼šè¢«ç½®ä¸ºnilï¼Œä¹Ÿä¸å¯è®¿é—®ã€‚ ä¸å®‰å…¨æ— ä¸»å¼•ç”¨unownedï¼ˆunsafeï¼‰æŒ‡å‘çš„å¯¹è±¡è¢«é‡Šæ”¾ä¹‹åï¼Œä½ è¯•å›¾å»è®¿é—®è¿™ä¸ªå¼•ç”¨ï¼Œç¨‹åºä¼šå°è¯•è®¿é—®è¯¥å®ä¾‹ä¹‹å‰ååœ¨çš„å†…å­˜åœ°å€ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸å®‰å…¨çš„æ“ä½œ ä½¿ç”¨åœºæ™¯è§£æï¼šå‰ææè¿°ï¼š Aç±»ä¸­æœ‰ä¸€ä¸ªBç±»çš„å±æ€§ï¼Œ Bç±»ä¸­æœ‰ä¸€ä¸ªAç±»çš„å±æ€§ ä¸¤ä¸ªå±æ€§çš„å€¼éƒ½å…è®¸ä¸ºnilï¼Œå¹¶ä¼šæ½œåœ¨äº§ç”Ÿå¾ªç¯å¼•ç”¨ è¿™ç§æƒ…å†µé€‚åˆä½¿ç”¨weakæ¥è§£å†³ å…¶ä¸­ä¸€ä¸ªå±æ€§çš„å€¼å…è®¸ä¸ºnilï¼Œè€Œå¦ä¸€ä¸ªä¸å…è®¸ä¸ºnil è¿™ç§æƒ…å†µæœ€é€‚åˆé€šè¿‡æ— ä¸»å¼•ç”¨æ¥è§£å†³ ä¸¤ä¸ªå±æ€§éƒ½å¿…é¡»æœ‰å€¼ï¼Œå¹¶ä¸”åˆå§‹åŒ–å®Œæˆåæ°¸è¿œä¸ä¼šä¸ºnil è¿™ç§æƒ…å†µï¼Œéœ€è¦ä¸€ä¸ªé›·ä½¿ç”¨æ— ä¸»å±æ€§ï¼Œä¸ºå¦å¤–ä¸€ä¸ªç±»ä½¿ç”¨éšå¼è§£æå¯é€‰å±æ€§ åœºæ™¯3ä¾‹å­ï¼š 1234567891011121314151617class Country &#123; let name: String var capitalCity: City! init(name: String, capitalName: String) &#123; self.name = name self.capitalCity = City(name: capitalName, country: self) &#125; &#125;class City &#123; let name: String unowned let country: Country init(name: String, country: Country) &#123; self.name = name self.country = country &#125; &#125; è§£å†³é—­åŒ…å¼•èµ·çš„å¾ªç¯å¼•ç”¨ Swift æœ‰å¦‚ä¸‹è¦æ±‚ï¼šåªè¦åœ¨é—­åŒ…å†…ä½¿ç”¨ self çš„æˆå‘˜ï¼Œå°±è¦ç”¨ self.someProperty æˆ–è€… self.someMethod() ä¸åªæ˜¯ someProperty æˆ– someMethod() ï¼‰ã€‚è¿™æé†’ä½ å¯èƒ½ä¼šä¸€ä¸å°å¿ƒå°±æ•è·äº† self ã€‚ ç¬¬ä¸€æ•è·åˆ—è¡¨è§£å†³å¾ªç¯å¼•ç”¨ï¼Œä¾‹å­ï¼š æ•è·åˆ—è¡¨ä¸­çš„æ¯ä¸€é¡¹éƒ½ç”±ä¸€å¯¹å…ƒç´ ç»„æˆï¼Œä¸€ä¸ªå…ƒç´ æ˜¯ weak æˆ– unowned å…³é”®å­—ï¼Œå¦ä¸€ä¸ªå…ƒç´ æ˜¯ç±»å®ä¾‹çš„å¼•ç”¨ 1234lazy var someClosure: (Int, String) -&gt; String = &#123; [unowned self, weak delegate = self.delegate!] (index: Int, stringToProcess: String) -&gt; String in // è¿™é‡Œæ˜¯é—­åŒ…çš„å‡½æ•°ä½“ &#125; å¦‚æœè¢«æ•è·çš„å¼•ç”¨ç»å¯¹ä¸ä¼šå˜ä¸º nil ï¼Œåº”è¯¥ç”¨æ— ä¸»å¼•ç”¨ï¼Œè€Œä¸æ˜¯å¼±å¼•ç”¨ã€‚","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"},{"name":"Swift","slug":"Swift","permalink":"http://www.yangjie.hu//tags/Swift/"}]},{"title":"Cookie in iOS","date":"2017-01-12T08:37:13.000Z","path":"2017/01/12/cookie-in-iOS/","text":"èƒŒæ™¯é¡¹ç›®ä¸­ç”¨åˆ°äº†æœ¬åœ°ç™»å½•å­˜å‚¨cookieï¼Œå†è¿›è¡ŒwebViewè¯·æ±‚æ—¶é—´å¸¦ä¸Šcookieçš„åŠŸèƒ½ã€‚ä¸æ˜¯å¾ˆæ¸…æ™°é€»è¾‘ï¼Œäºæ˜¯å­¦ä¹ äº†è§£äº†ä¸‹iOSä¸­cookieçš„ä½¿ç”¨ï¼Œåšä¸ªå°ç»“ã€‚è·³è¿‡æ¦‚å¿µç›´æ¥çœ‹ä½¿ç”¨ğŸŒ° Cookieä»‹ç»Cookieåˆ†ç±»ä¸¤ç±»ï¼š ä¼šè¯cookie æŒä¹…cookie ä¼šè¯ cookie å’ŒæŒä¹… cookie ä¹‹é—´å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯å®ƒä»¬çš„è¿‡æœŸæ—¶é—´ã€‚ cookieå¦‚ä½•å·¥ä½œ cookie ä¸­åŒ…å«äº†ä¸€ä¸ªç”± åå­— = å€¼ ï¼ˆname=valueï¼‰ è¿™æ ·çš„ä¿¡æ¯æ„æˆçš„ä»»æ„åˆ—è¡¨ï¼Œå¹¶é€šè¿‡ Set-Cookie æˆ– Set-Cookie2 HTTP å“åº”ï¼ˆæ‰© å±•ï¼‰é¦–éƒ¨å°†å…¶è´´åˆ°ç”¨æˆ·èº«ä¸Šå»ã€‚ cookieç»„æˆç°åœ¨ä½¿ç”¨çš„ cookie è§„èŒƒæœ‰ä¸¤ä¸ªä¸åŒçš„ç‰ˆæœ¬ï¼šcookies ç‰ˆæœ¬ 0ï¼ˆæœ‰æ—¶è¢«ç§°ä¸º Netscape cookiesï¼‰ å’Œ cookies ç‰ˆ æœ¬ 1ï¼ˆRFC 2965ï¼‰ ã€‚ cookies ç‰ˆ æœ¬ 1 æ˜¯ å¯¹ cookies ç‰ˆ æœ¬ 0 çš„ æ‰© å±•ï¼Œåº”ç”¨ä¸å¦‚åè€…å¹¿æ³›ã€‚ cookieç‰ˆæœ¬0 Set-Cookie é¦–éƒ¨Set-Cookie é¦–éƒ¨æœ‰ä¸€ä¸ªå¼ºåˆ¶æ€§çš„cookieåå’Œcookieå€¼ã€‚åé¢è·Ÿç€å¯é€‰çš„cookie å±æ€§ï¼Œä¸­é—´ç”±åˆ†å·åˆ†éš”ã€‚ cookie 0é¦–éƒ¨: 1Cookie: session-id=002-1145265-8016838; session-id-time=1007884800 cookieç‰ˆæœ¬1 Set-Cookie2é¦–éƒ¨è¿™ä¸ªç‰ˆæœ¬ 1 æ ‡å‡†å¼•å…¥äº†Set-Cookie2é¦–éƒ¨å’ŒCookie2é¦–éƒ¨ï¼Œä½†å®ƒä¹Ÿèƒ½äºç‰ˆæœ¬0è¿›è¡Œäº¤äº’æ“ä½œã€‚ cookie 1é¦–éƒ¨: 12345Cookie: $Version=&quot;1&quot;;ID=&quot;29046&quot;; $Domain=&quot;.joes-hardware.com&quot;;color=&quot;blue&quot;;Coupon=&quot;hammer027&quot;; $Path=&quot;/tools&quot;;Coupon=&quot;handvac103&quot;; $Path=&quot;/tools/cordless&quot; NSHTTPCookieStorage NSHTTPCookieStorage implements a singleton object (shared instance) that manages storage of cookies. Each cookie is represented by an instance of the NSHTTPCookie class. As a rule, cookies are shared among all applications and are kept in sync across process boundaries. Session cookies (where the cookie objectâ€™s sessionOnly method returns YES) are local to a single process and are not shared. NSHTTPCookieStorageçš„å®ç°æ˜¯ä¸€ä¸ªå•ä¾‹å¯¹è±¡ï¼Œç®¡ç†ç€NSHTTPCookieå¯¹è±¡ï¼Œä¼šè¯cookieçš„ sessionOnlyæ–¹æ³•è¿”å›YESå°±ä¸å¯åœ¨è¿›ç¨‹é—´å…±äº«ã€‚ ç„¶è€Œè‹¹æœåœ¨è¿™ä¸ªç±»çš„API Referenceä¸­å†™äº†ä¸€ä¸ªiOS Noteï¼š Cookies are not shared among applications in iOS. iOSä¸­cookieä¸èƒ½è·¨åº”ç”¨å…±äº« MacOSä¸­sessionOnlyä¸ä¸ºYESæ˜¯å¯ä»¥è¢«å…±äº«çš„ NSHTTPCookieStorageå¯ä»¥ç®¡ç†cookieçš„æ¥å—ç­–ç•¥ï¼Œåœ¨ä¸€ä¸ªappä¸­æ”¹å˜cookieçš„æ¥å—ç­–ç•¥å°†ä¼šå½±å“å…¶ä»–æ­£åœ¨è¿è¡Œçš„appçš„cookieæ¥å—ç­–ç•¥ã€‚ å½“å…¶ä»–çš„appä¿®æ”¹äº†cookieå­˜å‚¨ æˆ–è€… cookieæ¥å—ç­–ç•¥ï¼ŒNSHTTPCookieStorageå°†ä¼šç»™appå‘é€NSHTTPCookieManagerCookiesChangedNotificationæˆ–è€…NSHTTPCookieStorageAcceptPolicyChangedNotificationé€šçŸ¥ Cookieæ¥å—ç­–ç•¥ï¼šNSHTTPCookieAcceptPolicy 12345typedef NS_ENUM(NSUInteger, NSHTTPCookieAcceptPolicy) &#123; NSHTTPCookieAcceptPolicyAlways,//é»˜è®¤ç­–ç•¥ï¼Œæ¥å—æ‰€æœ‰çš„cookies NSHTTPCookieAcceptPolicyNever,//æ‹’ç»æ‰€æœ‰çš„cookies NSHTTPCookieAcceptPolicyOnlyFromMainDocumentDomain//åªä»ä¸»æ–‡æ¡£åŸŸåæ¥å—cookies&#125;; NSHTTPCookie An NSHTTPCookie object represents an HTTP cookie. It is an immutable object, initialized from a dictionary containing the cookie attributes. NSHTTPCookieå¯¹è±¡ä¸­åŒ…å«äº†HTTP çš„cookieå¯¹è±¡ï¼Œä»åŒ…å«cookieå­—æ®µçš„å­—å…¸åˆå§‹åŒ–åˆ›å»ºã€‚ The NSHTTPCookie class encapsulates a cookie, providing accessors for many of the common cookie attributes. This class also provides methods to convert HTTP cookie headers to NSHTTPCookie instances and convert an NSHTTPCookie instance to headers suitable for use with an NSURLRequest object. The URL loading system automatically sends any stored cookies appropriate for an NSURLRequest object unless the request specifies not to send cookies. Likewise, cookies returned in an NSURLResponse object are accepted in accordance with the current cookie acceptance policy. NSHTTPCookieç±»å°è£…äº†ä¸€ä¸ªHTTP Cookieï¼Œå¹¶æä¾›å¸¸è§çš„Cookieå±æ€§è®¿é—®æ¥å£ã€‚NSHTTPCookieå¯ä»¥è½¬æ¢HTTP CookieæˆNSHTTPCookieså¯¹è±¡ï¼Œå¹¶å¯ä»¥å°†NSHTTPCookieå¯¹è±¡è½¬åŒ–ä¸ºNSURLRequestå¯¹è±¡çš„è¯·æ±‚å¤´éƒ¨åˆ†ã€‚URL loading system ä¼šè‡ªåŠ¨åœ°ç»™NSURLRequestå¯¹è±¡å‘é€å­˜å‚¨çš„cookieï¼Œé™¤éNSURLRequestå¯¹è±¡æŒ‡å®šä¸éœ€è¦ä¼ cookieï¼ŒåŒæ ·cookieåœ¨NSURLRequestä¸­è¿”å›ä¹ŸæŒ‰ç…§å½“å‰çš„cookieæ¥å—ç­–ç•¥æ¥æ”¶ã€‚ Cookieä½¿ç”¨ğŸ’ªä¸ªğŸŒ°Cookieç”Ÿæˆçš„æœ‰ä¸¤ä¸ªé€”å¾„ï¼Œä¸€ä¸ªæ˜¯è®¿é—®ä¸€ä¸ªç½‘é¡µï¼Œè¿™ä¸ªç½‘é¡µè¿”å›çš„HTTP Headerä¸­æœ‰Set-CookieæŒ‡ä»¤è¿›è¡ŒCookieçš„è®¾ç½®ï¼Œè¿™é‡ŒCookieçš„æœ¬åœ°å¤„ç†å…¶å®æ˜¯ç”±WebKitè¿›è¡Œçš„ï¼›è¿˜æœ‰ä¸€ç§é€”å¾„å°±æ˜¯å®¢æˆ·ç«¯é€šè¿‡ä»£ç æ‰‹åŠ¨è®¾ç½®Cookieã€‚ å€¼å¾—æ³¨æ„iOS Cookieä½¿ç”¨æåˆ°ï¼šNSHTTPCookieStorageå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼ŒsetCookieæˆ–è€…deleteCookieåå¹¶ä¸ä¼šç«‹å³è¿›è¡ŒæŒä¹…åŒ–ï¼Œè€Œæ˜¯æœ‰å‡ ç§’çš„å»¶è¿Ÿã€‚ä¸ºäº†å¯é æ€§ï¼Œæˆ‘ä»¬ä¼šå°†cookieä¿¡æ¯ä¿å­˜ä¸€ä»½åˆ°User Defaultsï¼Œéœ€è¦ç”¨çš„æ—¶å€™loadè¿›æ¥ã€‚ å®¢æˆ·ç«¯æ‰‹åŠ¨è®¾ç½®Cookie 12345678910NSMutableDictionary *cookieProperties = [NSMutableDictionary dictionary];[cookieProperties setObject:@\"name\" forKey:NSHTTPCookieName];[cookieProperties setObject:@\"value\" forKey:NSHTTPCookieValue];[cookieProperties setObject:@\"www.taobao.com\" forKey:NSHTTPCookieDomain];[cookieProperties setObject:@\"/\" forKey:NSHTTPCookiePath];[cookieProperties setObject:@\"0\" forKey:NSHTTPCookieVersion];[cookieProperties setObject:@\"30000\" forKey:NSHTTPCookieMaximumAge];NSHTTPCookie *cookie = [NSHTTPCookie cookieWithProperties:cookieProperties];[[NSHTTPCookieStorage sharedHTTPCookieStorage] setCookie:cookie];//åˆ é™¤cookieçš„æ–¹æ³•ä¸ºdeleteCookie: åœ¨é€šè¿‡setCookie:è¿›è¡Œè®¾ç½®cookieçš„æ—¶å€™ï¼Œä¼šè¦†ç›–name,domain,pathéƒ½ç›¸åŒçš„cookieçš„ã€‚è‡³äºcookieä¼šä¸ä¼šæŒä¹…åŒ–åˆ°cookieæ–‡ä»¶ä¸­ä¸»è¦çœ‹è¿™ä¸ªcookieçš„ç”Ÿå‘½å‘¨æœŸï¼Œå’ŒMax-Ageæˆ–è€…Expiresæœ‰å…³ã€‚ é€šè¿‡HTTP Headerçš„Set-Cookieåè€…Set-Cookie2è®¾ç½®Cookie 123456789101112131415161718192021222324252627282930313233343536373839404142 //è¯·æ±‚ä¸€ä¸ªç½‘å€ï¼Œå³å¯åˆ†é…åˆ°cookie AFHTTPRequestOperationManager *manager = [AFHTTPRequestOperationManager manager]; manager.responseSerializer = [AFJSONResponseSerializer new]; [manager GET:urlString parameters:nil success:^(AFHTTPRequestOperation *operation, id responseObject) &#123; //è·å–cookie NSArray *cookies = [[NSHTTPCookieStorage sharedHTTPCookieStorage] cookies]; /* * æŠŠcookieè¿›è¡Œå½’æ¡£å¹¶è½¬æ¢ä¸ºNSDataç±»å‹ * æ³¨æ„ï¼šcookieä¸èƒ½ç›´æ¥è½¬æ¢ä¸ºNSDataç±»å‹ï¼Œå¦åˆ™ä¼šå¼•èµ·å´©æºƒã€‚ * æ‰€ä»¥å…ˆè¿›è¡Œå½’æ¡£å¤„ç†ï¼Œå†è½¬æ¢ä¸ºData */ NSData *cookiesData = [NSKeyedArchiver archivedDataWithRootObject: [[NSHTTPCookieStorage sharedHTTPCookieStorage] cookies]]; //å­˜å‚¨å½’æ¡£åçš„cookie NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults]; [userDefaults setObject: cookiesData forKey: @\"cookie\"]; [self setCookie]; &#125; failure:^(AFHTTPRequestOperation *operation, NSError *error) &#123; &#125;]; - (void)setCookie&#123; //å–å‡ºä¿å­˜çš„cookie NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults]; //å¯¹å–å‡ºçš„cookieè¿›è¡Œåå½’æ¡£å¤„ç† NSArray *cookies = [NSKeyedUnarchiver unarchiveObjectWithData:[userDefaults objectForKey:@\"cookie\"]]; if (cookies) &#123; //è®¾ç½®cookie NSHTTPCookieStorage *cookieStorage = [NSHTTPCookieStorage sharedHTTPCookieStorage]; for (id cookie in cookies) &#123; [cookieStorage setCookie:(NSHTTPCookie *)cookie]; &#125; &#125;else&#123; NSLog(@\"æ— cookie\"); &#125; &#125; å‚è€ƒNSHTTPCookieStorage Cookies and Custom Protocols http://geeklu.com/2013/04/ios-cookie/ http://blog.it985.com/11248.html ã€ŠHTTP æƒå¨æŒ‡å—ã€‹ç¬¬11ç«  å®¢æˆ·ç«¯è¯†åˆ«ä¸cookieæœºåˆ¶ ç›¸å…³å¯¼å¼•è§£å†³UIWebViewå’ŒWKWebViewä¹‹é—´çš„cookieå…±äº«é—®é¢˜ï¼š iOSå¼€å‘-æ‰“é€šUIWebViewå’ŒWKWebViewçš„Cookie","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"Objective-Cä¸­çš„è£…é¥°æ¨¡å¼","date":"2017-01-10T06:34:56.000Z","path":"2017/01/10/Objective-Cä¸­çš„è£…é¥°æ¨¡å¼/","text":"èƒŒæ™¯å‰æ®µæ—¶é—´æ¥è§¦åˆ°äº†è£…é¥°æ¨¡å¼ï¼Œä¹Ÿåšäº†åŸºæœ¬çš„äº†è§£ï¼Œä½†æ˜¯è¿˜ä¸æ˜¯å¾ˆæ¸…æ¥šå®ƒåœ¨iOSå¼€å‘ä¸­çš„å®é™…è¿ç”¨ï¼Œå’Œåˆç†çš„å­˜åœ¨æ–¹å¼ã€‚è¿™ä¸¤å¤©çœ‹äº†ã€ŠObjective-Cç¼–ç¨‹ä¹‹é“ï¼šiOSè®¾è®¡æ¨¡å¼è§£æã€‹ ä¸­çš„ç¬¬16ç« ï¼Œæœ‰äº†æ›´åŠ æ·±çš„ç†è§£ï¼Œç»“åˆè‡ªå·±çš„ç†è§£åœ¨è¿™é‡Œåšä¸€ä¸‹è®°å½•ã€‚ ä»€ä¹ˆæ˜¯è£…é¥°æ¨¡å¼å°±æè¿°æ¦‚å¿µè€Œè¨€ï¼Œæˆ‘è§‰å¾—ã€ŠHead First è®¾è®¡æ¨¡å¼ã€‹è¿™æœ¬ä¹¦é€šè¿‡å„ç§ä¾‹å­é˜è¿°å¾—è¦æ›´åŠ è¯¦ç»†æ˜“æ‡‚ã€‚ã€ŠObjective-Cç¼–ç¨‹ä¹‹é“ï¼šiOSè®¾è®¡æ¨¡å¼è§£æã€‹è®²å¾—æ›´å¤šæ˜¯iOSå¼€å‘ä¸­çš„ä½¿ç”¨å’Œä¸åŒå®ç°æ–¹å¼çš„å¯¹æ¯”ã€‚æ ‡å‡†çš„è£…é¥°æ¨¡å¼æœ‰åŒ…æ‹¬ä¸€ä¸ªæŠ½è±¡çš„Componentçˆ¶ç±»ï¼Œå®ƒå£°æ˜äº†ä¸€äº›æ“ä½œï¼Œå®ƒå…·ä½“çš„ç±»è®²è¿›è¡Œé‡è½½ä»¥å®ç°è‡ªå·±ç‰¹å®šçš„æ“ä½œã€‚è¿™ä¸ªComponentå…·ä½“ç±»æ˜¯æ¨¡å¼ä¸­çš„è¢«è£…é¥°è€…ï¼ŒComponentçˆ¶ç±»å¯ä»¥è¢«ç»†åŒ–ä¸ºå¦ä¸€ä¸ªå«åšDecoratorçš„æŠ½è±¡ç±»ï¼Œå³è£…é¥°è€…æŠ½è±¡ç±»ã€‚Decoratorç±»ä¸­åŒ…å«äº†ä¸€ä¸ªComponentçš„å¼•ç”¨ã€‚Decoratorçš„å…·ä½“ç±»ä¸ºComponentæˆ–è€…Decoratorå®šä¹‰äº†å‡ ä¸ªæ‰©å±•è¡Œä¸ºï¼Œå¹¶ä¸”ä¼šåœ¨è‡ªå·±çš„æ“ä½œä¸­å†…åµŒComponentæ“ä½œã€‚å…³ç³»å›¾è§ è£…é¥°æ¨¡å¼ç±»å›¾ Componentå®šä¹‰äº†ä¸€äº›æŠ½è±¡æ“ä½œï¼Œå…·ä½“ç±»å°†è¿›è¡Œé‡è½½å®ç°è‡ªå·±ç‰¹å®šçš„æ“ä½œã€‚DecoratoræŠ½è±¡ç±»é€šè¿‡å°†ä¸€ä¸ªComponentï¼ˆæˆ–Decoratorï¼‰å†…åµŒåˆ°Decoratorå¯¹è±¡ï¼Œå®šä¹‰äº†æ‰©å±•è¿™ä¸ªComponentçš„å®ä¾‹çš„â€œè£…é¥°æ€§â€çš„è¡Œä¸ºã€‚ é»˜è®¤çš„operationæ–¹æ³•åªæ˜¯æƒ³å†…åµŒçš„Componentå‘é€ä¸€ä¸ªæ¶ˆæ¯ï¼ŒDecoratorçš„å…·ä½“å®ç°ç±»é‡è½½çˆ¶ç±»çš„operationï¼Œé€šè¿‡superæŠŠè‡ªå·±å¢åŠ çš„è¡Œä¸ºæ‰©å±•ç»™Componentçš„operationã€‚å¦‚æœåªéœ€è¦å‘Componentæ·»åŠ ä¸€ç§èŒè´£ï¼Œé‚£å¯ä»¥çœæ‰æŠ½è±¡çš„Decoratorç±»ï¼Œè®©å…·ä½“çš„Decoratorç›´æ¥æŠŠè¯·æ±‚è½¬å‘ç»™Componentã€‚é‚£ä¹ˆè¿™ç§æ–¹å¼å°±å¥½åƒå½¢æˆä¸€ç§æ“ä½œé“¾ï¼ŒæŠŠä¸€ç§è¡Œä¸ºåŠ åˆ°å¦ä¸€ç§è¡Œä¸ºä¹‹ä¸Šï¼Œå¦‚å¯¹è±¡å›¾ è£…é¥°æ¨¡å¼ç±»å›¾ ä½•æ—¶ä½¿ç”¨è£…é¥°æ¨¡å¼ æƒ³è¦åœ¨ä¸å½±å“å…¶ä»–å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œä»¥åŠ¨æ€ã€é€æ˜çš„æ–¹å¼ç»™å•ä¸ªå¯¹è±¡æ·»åŠ èŒè´£ã€‚ æƒ³è¦æ‰©å±•ä¸€ä¸ªç±»çš„è¡Œä¸ºï¼Œå´åšä¸åˆ°ã€‚ç±»å®šä¹‰å¯èƒ½è¢«éšè—ï¼Œæ— æ³•è¿›è¡Œå­ç±»åŒ–ï¼›æˆ–è€…å¯¹ç±»çš„æ¯ä¸ªè¡Œä¸ºçš„æ‰©å±•ï¼Œä¸ºæ”¯æŒæ¯ç§åŠŸèƒ½ç»„åˆï¼Œå°†äº§ç”Ÿå¤§é‡çš„å­ç±» å¯¹ç±»çš„èŒè´£çš„æ‰©å±•æ˜¯å¯é€‰çš„ã€‚ è£…é¥°æ¨¡å¼åœ¨iOSä¸­çš„å®ç°æ ¹æ®Objective-Cçš„ç‰¹æ€§ï¼Œæœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼š é€šè¿‡çœŸæ­£çš„å­ç±»å®ç°è£…é¥° é€šè¿‡åˆ†ç±»å®ç°è£…é¥° ç¬¬äºŒç§æ–¹å¼æ˜¯ä½¿ç”¨äº†Objective-Cçš„è¯­è¨€åŠŸèƒ½ï¼Œé€šè¿‡åˆ†ç±»å‘ç±»æ·»åŠ è¡Œä¸ºï¼Œä¸å¿…è¿›è¡Œå­ç±»åŒ–ï¼Œè¿™å¹¶éæ ‡å‡†çš„è£…é¥°æ¨¡å¼ç»“æ„ï¼Œä½†æ˜¯å®ç°äº†è£…é¥°æ¨¡å¼åŒæ ·çš„éœ€æ±‚ã€‚å°½ç®¡ä½¿ç”¨åˆ†ç±»æ¥å®ç°è£…é¥°æ¨¡å¼è·ŸåŸå§‹é£æ ¼æœ‰åç¦»ï¼Œä½†æ˜¯å®ç°å°‘é‡çš„è£…é¥°å™¨çš„æ—¶å€™ï¼Œå®ƒæ¯”çœŸæ­£å­ç±»æ–¹å¼æ›´åŠ è½»é‡ã€æ›´åŠ å®¹æ˜“ã€‚ ä¾‹å­æ˜¯ä½¿ç”¨è£…é¥°å®ç°UIImageçš„æ»¤é•œåŠŸèƒ½ ç»ˆäºè¦è§ä»£ç äº†~ çœŸå­ç±»å®ç°è£…é¥°å…ˆçœ‹ç›®å½•ç»“æ„ï¼š ComponentæŠ½è±¡ç±»æ˜¯ä¸€ä¸ªProtocolæ–‡ä»¶ï¼Œ 123456789@protocol ImageComponent &lt;NSObject&gt;@optional- (void)drawAsPatternInRect:(CGRect)rect;- (void)drawAtPoint:(CGPoint)point;- (void)drawAtPoint:(CGPoint)ponit blendMode:(CGBlendMode)blendMode alpha:(CGFloat)alpha;- (void)drawInRect:(CGRect)rect;- (void)drawInRect:(CGRect)rect blendMode:(CGBlendMode)blendMode alpha:(CGFloat)alpha;@end UIImage_ImageComponent.hæ˜¯UIImageçš„ä¸€ä¸ªExtensionï¼Œè®©UIImageéµå¾ªImageComponentåè®®ã€‚å¦‚æ­¤åœ¨è£…é¥°æ¨¡å¼ä¸­UIImageç±»æ˜¯ImageComponentæŠ½è±¡ç±»çš„å…·ä½“ç±»ï¼Œå³UIImageæ˜¯æ¨¡å¼ä¸­çš„è¢«è£…é¥°è€…ã€‚ DecoratoræŠ½è±¡ç±»ImageFilteréµå®ˆImageComponentåè®®ï¼Œå¹¶å®šä¹‰äº†ä¸‰ä¸ªæ–¹æ³•å’Œä¸€ä¸ªImageComponentåè®®çš„ä»£ç†å¯¹è±¡å±æ€§ã€‚ 1234567@interface ImageFilter : NSObject &lt;ImageComponent&gt;- (void)apply;- (id)initWithImageComponent:(id &lt;ImageComponent&gt;) component;- (id)forwardingTargetForSelector:(SEL)aSelector;- @end 123456789101112131415161718192021222324@interface ImageFilter ()@property (nonatomic, strong) id &lt;ImageComponent&gt; component;@end@implementation ImageFilter- (instancetype)initWithImageComponent:(id&lt;ImageComponent&gt;)component &#123; if (self = [super init]) &#123; [self setComponent:component]; &#125; return self;&#125;- (void)apply &#123; //ç”±å­ç±»é‡è½½&#125;- (id)forwardingTargetForSelector:(SEL)aSelector &#123; NSString *selectorName = NSStringFromSelector(aSelector); if ([selectorName hasPrefix:@\"draw\"]) &#123; [self apply]; &#125; return self.component;&#125;@end åœ¨DecoratoræŠ½è±¡ç±»çš„å…·ä½“å®ç°ç±»ä¸­å»é‡è½½applyæ–¹æ³•ï¼Œå½“å‘é€ä»¥â€drawâ€å¼€å¤´çš„æ¶ˆæ¯æ—¶ï¼Œå…ˆæ‰§è¡ŒDecoratorå…·ä½“ç±»ä¸­çš„applyæ–¹æ³•ï¼Œç„¶åå†æ‰§è¡ŒComponentå…·ä½“ç±»å³UIImageç±»ï¼ˆè¢«è£…é¥°è€…ï¼‰ä¸­çš„â€drawâ€å¼€å¤´çš„é‚£ä¸ªæ–¹æ³•ã€‚å¦‚æ­¤å®ç°äº†å¯¹UIImageå¯¹åº”çš„â€drawâ€å¼€å¤´æ–¹æ³•åŠ¨æ€æ·»åŠ è¡Œä¸ºã€‚ å…·ä½“çš„ä½¿ç”¨ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415- (void)viewDidLoad &#123; [super viewDidLoad]; UIImage *image = [UIImage imageNamed:@\"avatar.jpg\"]; CGAffineTransform rorateTransform = CGAffineTransformMakeRotation(-M_PI / 4); CGAffineTransform translateTransform = CGAffineTransformMakeTranslation(-image.size.width / 2.0, image.size.height / 8.0); CGAffineTransform finalTransform = CGAffineTransformConcat(rorateTransform, translateTransform); id&lt;ImageComponent&gt;transformdImage = [[ImageTransformFilter alloc] initWithImageComponent:image transform:finalTransform]; id&lt;ImageComponent&gt;finalImage = [[ImageShadowFliter alloc] initWithImageComponent:transformdImage]; DecoratorView *decoratorView = [[DecoratorView alloc] initWithFrame:self.view.frame]; [decoratorView setImage:finalImage]; [self.view addSubview:decoratorView];&#125; ç”±DecoratorViewä¸­çš„drawRectï¼šè°ƒèµ·UIImageçš„è£…é¥° 123456@implementation DecoratorViewduring animation.- (void)drawRect:(CGRect)rect &#123; [self.image drawInRect:rect];&#125;@end ç±»å›¾å¦‚ä¸‹: å„ç§ImageComponentå¯¹è±¡å¯åœ¨è¿è¡Œæ—¶è¿›è¡Œè¿æ¥ï¼Œå¦‚ä¸‹å›¾ï¼š åˆ†ç±»å®ç°è£…é¥°åˆ†ç±»æ–¹å¼å®ç°å°±æ˜¯å¹³å¸¸å¼€å‘ä¸­å¸¸è§çš„ä½¿ç”¨ï¼Œä»£ç å°±ä¸å†ä¸€ä¸€åˆ—å‡º ç±»å›¾å¦‚ä¸‹ï¼š BaseFilteråˆ†ç±»ä¸­å®šä¹‰äº†ç»˜å›¾çš„æ–¹æ³•ï¼ŒTransformå’Œshadowåˆ†ç±»ä¸­å¯ä»¥è°ƒç”¨BaseFilteråˆ†ç±»ä¸­å®šä¹‰çš„æ–¹æ³•æ¥è¿›è¡Œè‡ªå·±çš„ç»˜åˆ¶ã€‚ä»–ä»¬ä¹Ÿå¯ä»¥åƒçœŸæ­£å­ç±»åŒ–æ–¹å¼é‚£æ ·é“¾æ¥èµ·æ¥ï¼Œæ¥çœ‹å¯¹è±¡å›¾: æ€»ç»“è£…é¥°æ¨¡å¼åœ¨Objective-Cä¸­æœ‰ä¸¤ç§ä¸åŒçš„å®ç°æ–¹å¼ï¼ŒçœŸæ­£å­ç±»æ–¹å¼çš„å®ç°ä½¿ç”¨ä¸€ç§è¾ƒä¸ºç»“æ„åŒ–çš„æ–¹å¼é“¾æ¥å„ç§è£…é¥°å™¨ï¼Œåˆ†ç±»çš„æ–¹å¼æ›´åŠ ç®€å•å’Œè½»é‡ï¼Œä½¿ç”¨äºç°æœ‰ç±»åªéœ€è¦å°‘é‡è£…é¥°å™¨çš„åº”ç”¨ã€‚ å‚è€ƒï¼šã€ŠObjective-Cç¼–ç¨‹ä¹‹é“ï¼šiOSè®¾è®¡æ¨¡å¼è§£æã€‹ç¬¬16ç« ï¼Œï¼ˆ190-206ï¼‰demoåœ°å€ï¼šGitHub","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"ç»§æ‰¿ä¸ä»£ç†--Decorate Pattern","date":"2017-01-04T09:51:11.000Z","path":"2017/01/04/ç»§æ‰¿ä¸ä»£ç†-Decorate-Pattern/","text":"åœºæ™¯å†™è¿™ç¯‡æ–‡ç« çš„èƒŒæ™¯æ˜¯åœ¨çœ‹casatwyçš„ç½‘ç»œå±‚æ¶æ„ä»£ç æ—¶å¯¹å­ç±»ç»§æ‰¿å’Œåè®®ä»£ç†æ–¹çš„å®ç°äº§ç”Ÿäº†ç–‘æƒ‘ï¼Œè¿›è¡Œäº†æ¢ç´¢ã€‚ é—®é¢˜é—®é¢˜æƒ…æ™¯ï¼šçˆ¶ç±»çš„æ–¹æ³•åˆ—è¡¨ä¸­å’Œåè®®ä¸­æœ‰åŒæ ·çš„æ–¹æ³•ï¼ˆä»£ç å¦‚ä¸‹ï¼‰ï¼Œå­ç±»ç»§æ‰¿æ–¹æ³•åŒæ—¶ä»£ç†æ–¹ä¹Ÿå®ç°åè®®æ–¹æ³•ï¼Œé‚£ä¹ˆå½“çˆ¶ç±»è°ƒç”¨decoratePatternTestè¿™ä¸ªæ–¹æ³•æ—¶å…·ä½“çš„æ‰§è¡Œæ–¹æ˜¯è°ï¼Ÿå­ç±»åŒæ—¶æ˜¯ä»£ç†æ–¹å’Œä¸æ˜¯ä»£ç†æ–¹åˆ†åˆ«æœ‰ä»€ä¹ˆæ ·çš„æƒ…å†µå‘¢ï¼Ÿ 12345678910#import &lt;Foundation/Foundation.h&gt;@protocol BaseDecorateDelegate &lt;NSObject&gt;- (NSString *)decoratePatternTest;@end@interface BaseProtocolTest : NSObject@property (nonatomic, weak) id&lt;BaseDecorateDelegate&gt; decorate;- (NSString *)decoratePatternTest;- (void)startTest;@end casatwyæ³¨é‡Šåœ¨casatwyçš„ä»£ç ä¸­é‡åˆ°ä¸Šè¿°é—®é¢˜çš„æœ‰BaseAPIManageræ‹¦æˆªå™¨ä»£ç éƒ¨åˆ†ï¼Œä½œè€…çš„æ³¨é‡Šå¦‚ä¸‹ï¼š 1234567891011/* æ‹¦æˆªå™¨çš„åŠŸèƒ½å¯ä»¥ç”±å­ç±»é€šè¿‡ç»§æ‰¿å®ç°ï¼Œä¹Ÿå¯ä»¥ç”±å…¶å®ƒå¯¹è±¡å®ç°,ä¸¤ç§åšæ³•å¯ä»¥å…±å­˜ å½“ä¸¤ç§æƒ…å†µå…±å­˜çš„æ—¶å€™ï¼Œå­ç±»é‡è½½çš„æ–¹æ³•ä¸€å®šè¦è°ƒç”¨ä¸€ä¸‹super ç„¶åå®ƒä»¬çš„è°ƒç”¨é¡ºåºæ˜¯BaseManagerä¼šå…ˆè°ƒç”¨å­ç±»é‡è½½çš„å®ç°ï¼Œå†è°ƒç”¨å¤–éƒ¨interceptorçš„å®ç° notes: æ­£å¸¸æƒ…å†µä¸‹ï¼Œæ‹¦æˆªå™¨æ˜¯é€šè¿‡ä»£ç†çš„æ–¹å¼å®ç°çš„ï¼Œå› æ­¤å¯ä»¥ä¸éœ€è¦ä»¥ä¸‹è¿™äº›ä»£ç  ä½†æ˜¯ä¸ºäº†å°†æ¥æ‹“å±•æ–¹ä¾¿ï¼Œå¦‚æœåœ¨è°ƒç”¨æ‹¦æˆªå™¨ä¹‹å‰manageråˆå¸Œæœ›è‡ªå·±èƒ½å¤Ÿå…ˆåšä¸€äº›äº‹æƒ…ï¼Œæ‰€ä»¥è¿™äº›æ–¹æ³•è¿˜æ˜¯éœ€è¦èƒ½å¤Ÿè¢«ç»§æ‰¿é‡è½½çš„ æ‰€æœ‰é‡è½½çš„æ–¹æ³•ï¼Œéƒ½è¦è°ƒç”¨ä¸€ä¸‹super,è¿™æ ·æ‰èƒ½ä¿è¯å¤–éƒ¨interceptorèƒ½å¤Ÿè¢«è°ƒåˆ° è¿™å°±æ˜¯decorate pattern */ æ³¨é‡Šä¸­æåˆ°ï¼š å­ç±»ç»§æ‰¿å’Œä»£ç†æ–¹å®ç°åè®®å¯ä»¥å…±å­˜ ä¸¤ç§å…±å­˜æ—¶å­ç±»é‡è½½çš„æ–¹æ³•å¿…é¡»è¦è°ƒç”¨çˆ¶ç±»æ–¹æ³• ä¸¤è€…è°ƒç”¨é¡ºåºæ˜¯å…ˆå®ç°å­ç±»é‡è½½çš„æ–¹æ³•å†è°ƒç”¨ä»£ç†æ–¹å®ç°çš„æ–¹æ³• æœ€åæåˆ°çš„æ˜¯ Decorate Pattern è£…é¥°è€…æ¨¡å¼ åˆ†æƒ…å†µå®ç°éªŒè¯ å­ç±»ç»§æ‰¿çˆ¶ç±»æ–¹æ³• &amp; å­ç±»æ²¡æœ‰éµå®ˆçˆ¶ç±»åè®® &amp; å…¶ä»–ç±»éµå®ˆåè®®å®ç°ä»£ç†æ–¹æ³• å­ç±»ç»§æ‰¿çˆ¶ç±»æ–¹æ³• &amp; éµå®ˆçˆ¶ç±»åè®® çˆ¶ç±»æ–¹æ³•ï¼š 123456789- (NSString *)decoratePatternTest &#123; NSLog(@\"æ‰§è¡Œçˆ¶ç±»decoratePatternTest\"); NSString *string = @\"åŸºç±»ä¸­å®ç°decoratePatternTest\"; if (self != self.decorate &amp;&amp; [self.decorate respondsToSelector:@selector(decoratePatternTest)]) &#123; string = [self.decorate decoratePatternTest]; &#125; return string;&#125; å­ç±»æ–¹æ³•ï¼š 123456- (NSString *)decoratePatternTest &#123; [super decoratePatternTest]; NSLog(@\"å­ç±»æ‰§è¡ŒdecoratePatternTest\"); return @\"å­ç±»ä¸­å®ç°decoratePatternTest\";&#125; éå­ç±»ä»£ç†è€…æ–¹æ³•ï¼š 12345- (NSString *)decoratePatternTest &#123; NSLog(@\"æ‰§è¡Œè¿‡ä»£ç†æ–¹å®ç°decoratePatternTest\"); return @\"ä»£ç†æ–¹å®ç°decoratePatternTest\";&#125; æµ‹è¯•ç»“æœï¼š çˆ¶ç±» å­ç±» Other çˆ¶ç±» å­ç±» Other éµå®ˆåè®®å®ç°æ–¹æ³• - N Y - Y N ç»§æ‰¿æ–¹æ³• - Y N - Y N æ–¹æ³•æ‰§è¡Œé¡ºåº 2 1 3 2 1 - å…³é”®å…¶å®é—®é¢˜çš„å…³é”®æ˜¯åœ¨ä»£ç†è€…çš„åè®®æ–¹æ³•è°ƒç”¨çš„æ—¶æœºã€‚ å½“å­ç±»ç»§æ‰¿äº†æ–¹æ³•åˆæ˜¯ä»£ç†è€…ï¼Œé‚£ä¹ˆåœ¨çˆ¶ç±»æ–¹æ³•ä¸­é€šè¿‡ï¼ˆself != self.decotateï¼‰æ¥åˆ¤æ–­ä¸ç”¨å†å»æ‰§è¡Œåè®®ä¸­çš„æ–¹æ³• å­ç±»ä¸æ˜¯ä»£ç†è€…æ²¡æœ‰ç»§æ‰¿æ–¹æ³•ï¼Œåˆ™åœ¨çˆ¶ç±»æ–¹æ³•ä¸­è°ƒç”¨ä»£ç†è€…æ‰§è¡Œåè®®æ–¹æ³• å­ç±»ä¸æ˜¯ä»£ç†è€…ä½†æ˜¯ç»§æ‰¿äº†æ–¹æ³•ï¼Œçˆ¶ç±»è°ƒç”¨ä»£ç†è€…åè®®æ–¹æ³• ä¸¤ä¸ªæ–¹æ³•çš„è°ƒå…¶é¡ºåºæ˜¯ å­ç±»ä¸­æ–¹æ³• -&gt; çˆ¶ç±»ä¸­æ–¹æ³• -&gt; ä»£ç†è€…æ–¹æ³• ä¸¤ä¸ªæ–¹æ³•ä¸­çš„æœ‰æ•ˆä»£ç æ‰§è¡Œé¡ºåºè¦çœ‹ å­ç±»æ–¹æ³•ä¸­ superè°ƒç”¨çš„ä½ç½® (superè°ƒç”¨åœ¨å­ç±»æœ‰æ•ˆä»£ç å‰åˆ™ ä»£ç†è€…æ–¹æ³•çš„ä»£ç å…ˆæ‰§è¡Œ)â€”â€”-&gt;è§æœ€åä¸€èŠ‚Decorate Pattern è£…é¥°è€…æ¨¡å¼ ä»£ç ä¸­ä¸ç”¨è°ƒç”¨çˆ¶ç±»æ–¹æ³•çš„æƒ…å†µä½œè€…çš„ä»£ç BaseAPIManagerä¸­çš„reformerParamsæ–¹æ³•åœ¨çˆ¶ç±»å®ä¾‹æ–¹æ³•å’Œåè®®æ–¹æ³•ä¸­å­˜åœ¨ï¼Œä½†æ˜¯å­ç±»ç»§æ‰¿å®ç°æ—¶å¹¶ä¸éœ€è¦è°ƒç”¨çˆ¶ç±»çš„ reformerParamsï¼ŒåŸå› æ˜¯çˆ¶ç±»ä¸­ä½œäº†å¦‚ä¸‹å¤„ç†ï¼š 1234567891011121314151617181920212223242526272829303132333435- (instancetype)init&#123; self = [super init]; if (self) &#123; if ([self conformsToProtocol:@protocol(BaseProtocolDelegate)]) &#123; self.child = (id &lt;BaseProtocolDelegate&gt;)self; &#125; else &#123; NSException *exception = [[NSException alloc] init]; @throw exception; &#125; &#125; return self;&#125;- (NSString *)reformerParams &#123; NSLog(@\"æ‰§è¡Œçˆ¶ç±»reformerTest\"); IMP childIMP = [self.child methodForSelector:@selector(reformerTest)]; IMP selfIMP = [self methodForSelector:@selector(reformerTest)]; if (childIMP == selfIMP) &#123; return @\"å­ç±»æ²¡æœ‰ç»§æ‰¿æ­¤æ–¹æ³•\"; &#125; else &#123; // å¦‚æœchildæ˜¯ç»§æ‰¿å¾—æ¥çš„ï¼Œé‚£ä¹ˆè¿™é‡Œå°±ä¸ä¼šè·‘åˆ°ï¼Œä¼šç›´æ¥è·‘å­ç±»ä¸­çš„IMPã€‚ // å¦‚æœchildæ˜¯å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå°±ä¼šè·‘åˆ°è¿™é‡Œ NSString *result = nil; result = [self.child reformerParams]; if (result) &#123; return result; &#125; else &#123; return @\"default\"; &#125; &#125;&#125; åˆå§‹åŒ–æ–¹æ³•ä¸­é¦–å…ˆä¿è¯å­ç±»å¿…é¡»éµå®ˆäº†BaseProtocolDelegateåè®® å­ç±»å®ç°äº†reformerParamsæ–¹æ³•å¹¶æ²¡æœ‰è°ƒç”¨superå¹¶ä¸ä¼šå‡ºå‘çˆ¶ç±»çš„reformerParams æ ¹æ®æ¶ˆæ¯ä¼ é€’æœºåˆ¶çˆ¶ç±»reformerParams æ–¹æ³•ä¼šè¢«è°ƒç”¨è¯´æ˜å­ç±»æ²¡æœ‰å®ç°æ­¤æ–¹æ³•ï¼Œé‚£ä¹ˆæ‰§è¡Œéå­ç±»ä»£ç†è€…çš„åè®®æ–¹æ³• çˆ¶ç±»è¦æ±‚å­ç±»å¿…é¡»éµå®ˆåè®®ï¼Œé‚£ä¹ˆæ­¤åè®®BaseProtocolDelegateæ›´å¤šçš„ç”¨å¤„æ˜¯è·å–å­ç±»å¯¹è±¡ Decorate Pattern è£…é¥°è€…æ¨¡å¼ è£…é¥°è€…æ¨¡å¼åŠ¨æ€åœ°å°†è´£ä»»é™„ä»¶åˆ°å¯¹è±¡ä¸Šï¼Œè‹¥è¦æ‰©å±•åŠŸèƒ½ï¼Œè£…é¥°ç€æä¾›äº†æ¯”ç»§æ‰¿æ›´å…·æœ‰å¼¹æ€§çš„æ–¹æ¡ˆã€‚ è£…é¥°è€…æ¨¡å¼çš„è®¾è®¡åŸåˆ™ï¼šå¯ä»¥éšå¿ƒä¸ºä¸€ä¸ªç±»æ‰©å±•åŠŸèƒ½ï¼Œä½†ä¸å…è®¸å¯¹å·²ç»å­˜åœ¨çš„ä»£ç è¿›è¡Œä¿®æ”¹ã€‚ è£…é¥°è€…æ¨¡å¼çš„ä¸»è¦ç‰¹ç‚¹ï¼š è£…é¥°è€…æ¨¡å¼ç±»å›¾ï¼š å®é™…çš„ä¾‹å­ï¼šjavaä¸­å¸¸ç”¨çš„java.ioç±»å°±å­˜åœ¨ç€å¤§é‡è£…é¥°è€… ä»¥ä¸Šå†…å®¹æ‘˜è‡ªã€ŠHead Firstè®¾è®¡æ¨¡å¼ã€‹ ç¬¬ä¸‰ç«  è£…é¥°è€…æ¨¡å¼ ï¼ˆ79-107ï¼‰ å¯¹åº”åˆ°iOSä¸­æœ¬æ–‡çš„åœºæ™¯ï¼š è¢«è£…é¥°è€… åŠŸèƒ½ç»„ä»¶ è£…é¥°è€… å§”æ‰˜æ–¹çˆ¶ç±» ä»£ç†æ–¹OtherObjectï¼ˆéå­ç±»ï¼‰ å­ç±» å…¶å®åœ¨æ€è€ƒè£…é¥°è€…æ¨¡å¼å¯¹åº”æƒ…å†µä¸Šï¼Œæœ‰ç‚¹ç–‘æƒ‘ï¼š è£…é¥°è€…ç±»Decoratoræ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„ç±» ä½†è£…é¥°è€…æ¨¡å¼ä¸­çš„å…³é”®ç‚¹ï¼š è£…é¥°è€…å¯ä»¥åœ¨è¢«æ‰€å§”æ‰˜è¢«è£…é¥°è€…çš„è¡Œä¸ºä¹‹å‰æˆ–ä¹‹åï¼ŒåŠ ä¸Šè‡ªå·±çš„è¡Œä¸ºï¼Œä»¥è¾¾åˆ°ç‰¹å®šç›®æ ‡ã€‚ åœ¨æœ¬æ–‡çš„ä¾‹å­ä¸­æœ‰æ˜æ˜¾ä½“ç°ï¼šå­ç±»ç»§æ‰¿çš„æ–¹æ³•ä¸­è°ƒç”¨superæ–¹æ³•ï¼Œåœ¨è¿™ä¹‹å‰æˆ–è€…ä¹‹åå¯ä»¥åŠ ä¸Šè‡ªå·±çš„è¡Œä¸ºï¼Œè¾¾åˆ°ç‰¹å®šç›®æ ‡ã€‚ å¯¹è£…é¥°è€…æ¨¡å¼çš„ç†è§£è¿˜æ¯”è¾ƒåŸºç¡€æœ‰å¾…ç»§ç»­ç ”ç©¶â€¦â€¦æ¬¢è¿æŒ‡æ­£æŒ‡å¯¼ï¼Œè°¢è°¢ï¼ iOSä¸­è£…é¥°è€…æ¨¡å¼çš„å®ç°çš„åç»­ç ”ç©¶è¯·çœ‹Objective-Cä¸­çš„è£…é¥°æ¨¡å¼","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"çŸ¥è¯†ä¼ é€é—¨","date":"2016-12-29T01:11:11.000Z","path":"2016/12/29/çŸ¥è¯†ä¼ é€é—¨/","text":"å¤§ç¥åšå®¢ä¼ é€é—¨ onevcat å–µç¥ ç‹å· sunnyxx å­™æº bang æ²¡æ•…äº‹çš„å“åŒå­¦ Casa Taloyum å”å·§ å­¦ä¹ å¹³å°ä¼ é€é—¨ swifter.tips Objcä¸­å›½ æ³Šå­¦ swiftv objc.io Swiftå­¦ä¹ æŒ‡å¼• Google Interview University FreeCodeCamp iOSå¹²è´§ä¼ é€é—¨ iOS ä¸‹å…³äº MD5 çš„é‚£ä¸ªå‘ Xcodeä¸‹è°ƒè¯•ç¥å™¨â€”â€”Chisel Swiftå’ŒObjectiveæ··ç¼–æ”»ç•¥ Swiftä¸­ç¼–å†™å•ä¾‹çš„æ­£ç¡®æ–¹å¼ xibçš„å…¨æ–¹ä½ä½¿ç”¨æŠ€å·§ ä¹¦ç± ç¨‹åºå‘˜ä¹¦å•","tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://www.yangjie.hu//tags/éšç¬”/"}]},{"title":"JSPatchå­¦ä¹ åˆ†äº«","date":"2016-12-23T02:38:08.000Z","path":"2016/12/23/JSPatchå­¦ä¹ åˆ†äº«/","text":"Appçƒ­æ›´æ–°æŠ€æœ¯â€”â€”JSPatchå­¦ä¹ åˆ†äº« å¦‚æœä¸æ¸…æ¥šæœ¬æ–‡çš„ä¸»è§’ JSPatchæ˜¯ä»€ä¹ˆè¯·çœ‹æˆ‘åšå®¢ä¸­çš„JSPatchå­¦ä¹ ç¬”è®°ï¼š è¿™é‡Œ å’Œ è¿™é‡Œ èƒŒæ™¯iOS Developer Program License Agreementé‡Œ3.3.2æåˆ°ä¸å¯åŠ¨æ€ä¸‹å‘å¯æ‰§è¡Œä»£ç ï¼Œä½†é€šè¿‡è‹¹æœJavaScriptCore.frameworkæˆ–WebKitæ‰§è¡Œçš„ä»£ç é™¤å¤–ï¼ŒJSæ­£æ˜¯é€šè¿‡JavaScriptCore.frameworkæ‰§è¡Œçš„ã€‚ åŸºç¡€åŸç†JSPatch èƒ½åšåˆ°é€šè¿‡ JS è°ƒç”¨å’Œæ”¹å†™ OC æ–¹æ³•æœ€æ ¹æœ¬çš„åŸå› æ˜¯ Objective-C æ˜¯åŠ¨æ€è¯­è¨€ï¼ŒOC ä¸Šæ‰€æœ‰æ–¹æ³•çš„è°ƒç”¨/ç±»çš„ç”Ÿæˆéƒ½é€šè¿‡ Objective-C Runtime åœ¨è¿è¡Œæ—¶è¿›è¡Œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç±»å/æ–¹æ³•ååå°„å¾—åˆ°ç›¸åº”çš„ç±»å’Œæ–¹æ³•ï¼š 1234Class class = NSClassFromString(\"UIViewController\");id viewController = [[class alloc] init];SEL selector = NSSelectorFromString(\"viewDidLoad\");[viewController performSelector:selector]; ä¹Ÿå¯ä»¥æ›¿æ¢æŸä¸ªç±»çš„æ–¹æ³•ä¸ºæ–°çš„å®ç°ï¼š 12static void newViewDidLoad(id slf, SEL sel) &#123;&#125;class_replaceMethod(class, selector, newViewDidLoad, @\"\"); è¿˜å¯ä»¥æ–°æ³¨å†Œä¸€ä¸ªç±»ï¼Œä¸ºç±»æ·»åŠ æ–¹æ³•ï¼š 123Class cls = objc_allocateClassPair(superCls, \"JPObject\", 0);objc_registerClassPair(cls);class_addMethod(cls, selector, implement, typedesc); ç†è®ºä¸Šå¯ä»¥åœ¨è¿è¡Œæ—¶é€šè¿‡ç±»å/æ–¹æ³•åè°ƒç”¨åˆ°ä»»ä½• OC æ–¹æ³•ï¼Œæ›¿æ¢ä»»ä½•ç±»çš„å®ç°ä»¥åŠæ–°å¢ä»»æ„ç±»ã€‚JSPatch çš„åŸºæœ¬åŸç†å°±æ˜¯ï¼šJS ä¼ é€’å­—ç¬¦ä¸²ç»™ OCï¼ŒOC é€šè¿‡ Runtime æ¥å£è°ƒç”¨å’Œæ›¿æ¢ OC æ–¹æ³•ã€‚ JSPatchå®ç°åŸç†è¯¦è§£ Demoå±•ç¤ºdemoåœ°å€ ç–‘é—®ï¼šçƒ­ä¿®å¤éƒ½éœ€è¦é‡å¯Appåæ‰èƒ½ç”Ÿæ•ˆå—ï¼Ÿ demo ä¸­å¯¹ä»¥ä¸Šç–‘é—®æœ‰å®ç°ï¼Œå…·ä½“çš„åŸç†ç†è§£ä¸‹ä¸€èŠ‚ æ–¹æ³•æ›¿æ¢ å¯¹demoä»£ç çš„å…·ä½“è§£é‡Šè¯·çœ‹ è¿™é‡Œ æ–¹æ³•æ›¿æ¢OCä¸Šï¼Œæ¯ä¸ªç±»åº•å±‚éƒ½æ˜¯è¿™æ ·ä¸€ä¸ªç»“æ„ä½“ï¼š 123456789101112struct objc_class &#123; Class isa; Class super_class; const char *name; long version; long info; long instance_size; struct objc_ivar_list *ivars; struct objc_method_list **methodLists; /*æ–¹æ³•é“¾è¡¨*/ struct objc_cache *cache; struct objc_protocol_list *protocols; &#125; å…¶ä¸­ methodList æ–¹æ³•é“¾è¡¨é‡Œå­˜å‚¨çš„æ˜¯ Method ç±»å‹ï¼š 123456typedef struct objc_method *Method;typedef struct objc_ method &#123; SEL method_name; char *method_types; IMP method_imp;&#125;; Method ä¿å­˜äº†ä¸€ä¸ªæ–¹æ³•çš„å…¨éƒ¨ä¿¡æ¯ï¼ŒåŒ…æ‹¬ SEL æ–¹æ³•åï¼Œtype å„å‚æ•°å’Œè¿”å›å€¼ç±»å‹ï¼ŒIMP è¯¥æ–¹æ³•å…·ä½“å®ç°çš„å‡½æ•°æŒ‡é’ˆã€‚ é€šè¿‡ Selector è°ƒç”¨æ–¹æ³•æ—¶ï¼Œä¼šä» methodList é“¾è¡¨é‡Œæ‰¾åˆ°å¯¹åº”Methodè¿›è¡Œè°ƒç”¨ï¼Œè¿™ä¸ª methodList ä¸Šçš„çš„å…ƒç´ æ˜¯å¯ä»¥åŠ¨æ€æ›¿æ¢çš„ï¼Œå¯ä»¥æŠŠæŸä¸ª Selector å¯¹åº”çš„å‡½æ•°æŒ‡é’ˆIMPæ›¿æ¢æˆæ–°çš„ï¼Œä¹Ÿå¯ä»¥æ‹¿åˆ°å·²æœ‰çš„æŸä¸ª Selector å¯¹åº”çš„å‡½æ•°æŒ‡é’ˆIMPï¼Œè®©å¦ä¸€ä¸ª Selector è·Ÿå®ƒå¯¹åº”ï¼ŒRuntime æä¾›äº†ä¸€äº›æ¥å£åšè¿™äº›äº‹ JSPatchè„šæœ¬æ–‡ä»¶ä¸‹å‘åŠ å¯†æ¥å…¥ JSPatch æ—¶åš RSA éå¯¹ç§°åŠ å¯†ä¼ è¾“ å¼€å‘è€…è‡ªå·±åœ¨ APP æ¥å…¥ JSPatchï¼Œè‹¥å¼€å‘è€…æ²¡æœ‰é’ˆå¯¹ä¼ è¾“çš„ JSPatch è„šæœ¬åŠ å¯†ã€‚æ”»å‡»è€…å°±é€šè¿‡ç½‘ç»œä¼ è¾“çš„ä¸­é—´äººæ”»å‡»æ‰‹æ®µä¸‹å‘æ¶æ„è„šæœ¬åˆ°ç”¨æˆ·APP åŠ¨æ€æ›´æ–°æ–¹æ¡ˆå¯¹æ¯”ï¼šJSPatch vs React Native å­¦ä¹ æˆæœ¬ React Native æ˜¯ä» web å‰ç«¯å¼€å‘æ¡†æ¶ React å»¶ä¼¸å‡ºæ¥çš„è§£å†³æ–¹æ¡ˆï¼Œä¸»è¦è§£å†³çš„é—®é¢˜æ˜¯webé¡µé¢åœ¨ç§»åŠ¨ç«¯æ€§èƒ½ä½çš„é—®é¢˜ã€‚è‹¥ä½¿ç”¨React Nativeï¼Œå°±æ„å‘³ç€iOSå¼€å‘è€…éœ€è¦å­¦ä¹ webå‰ç«¯çš„ä¸€æ•´å¥—å¼€å‘æŠ€èƒ½ JSPatch æ˜¯ä»ç»ˆç«¯å¼€å‘å‡ºå‘çš„ä¸€ç§æ–¹æ¡ˆï¼ŒJSPatch å†™å‡ºæ¥çš„ä»£ç é£æ ¼ä¸ OC åŸç”Ÿå¼€å‘ä¸€è‡´ï¼ŒåŠ ä¸Šä¸€ç‚¹ JS è¯­æ³•çš„äº†è§£ï¼Œå°±å¯ä»¥ä½¿ç”¨ æ¥å…¥æˆæœ¬ React Native éœ€è¦æ­å»ºä¸€å¥—å¼€å‘ç¯å¢ƒï¼Œæœ‰å¾ˆå¤šä¾èµ–çš„åº“ã€‚React Native æ˜¯æ¯”è¾ƒå¤§çš„æ¡†æ¶ï¼Œæ®ç»Ÿè®¡ç›®å‰æ ¸å¿ƒä»£ç é‡Œ OC å’Œ JS ä»£ç åŠ èµ·æ¥æœ‰4wè¡Œï¼Œæ¥å…¥åå®‰è£…åŒ…ä½“ç§¯å¢å¤§ 1.8M å·¦å³ JSPatch æ˜¯å¾®å‹æ¡†æ¶ï¼Œåªæœ‰ 3 ä¸ªæ–‡ä»¶ 2k è¡Œä»£ç ï¼Œæ¥å…¥åå¢å¤§ 100K å·¦å³ å¼€å‘æ•ˆç‡ React Native ç”¨è¿‘ä¼¼ HTML+CSS å»ç»˜åˆ¶ UIï¼Œè¿™æ–¹é¢å¼€å‘æ•ˆç‡ç›¸å¯¹ JSPatch ä¼šé«˜äº›ï¼Œå¦å¤–React Native åœ¨å¼€å‘æ•ˆç‡ä¸Šçš„å¦ä¸€ä¸ªä¼˜åŠ¿æ˜¯æ”¯æŒè·¨å¹³å°ï¼ŒReact Native æœ¬æ„æ˜¯å¤ç”¨é€»è¾‘å±‚ä»£ç ï¼ŒUI å±‚æ ¹æ®ä¸åŒå¹³å°å†™ä¸åŒçš„ä»£ç  JSPatch ä¹Ÿå¯ä»¥å€ŸåŠ© iOS ä¸€äº›æˆç†Ÿçš„åº“å»æé«˜æ•ˆç‡ï¼Œä¾‹å¦‚ä½¿ç”¨ Massoryã€‚ï¼ˆå°è¯•äº†å…¶å®ä¹Ÿæ˜¯ç›¸å½“åƒåŠ›ï¼‰ çƒ­æ›´æ–°èƒ½åŠ› React Native åœ¨çƒ­æ›´æ–°æ—¶æ— æ³•ä½¿ç”¨äº‹å…ˆæ²¡æœ‰åšè¿‡æ¡¥æ¥çš„åŸç”Ÿç»„ä»¶ JSPatch å¯ä»¥è°ƒç”¨åˆ°ä»»æ„å·²åœ¨é¡¹ç›®é‡Œçš„ç»„ä»¶ï¼Œä»¥åŠä»»æ„åŸç”Ÿ framework æ¥å£ æ–¹æ¡ˆå¯¹æ¯”è¡¨æ ¼ï¼š å­¦ä¹ æˆæœ¬ æ¥å…¥æˆæœ¬ çƒ­æ›´æ–°èƒ½åŠ› å¼€å‘æ•ˆç‡ æ€§èƒ½ä½“éªŒ JSPatch ä½ ä½ é«˜ ä¸­ï¼Œä¸è·¨å¹³å° é«˜ React Native é«˜ é«˜ ä¸­ é«˜ï¼Œè·¨å¹³å° é«˜ JSPatch vs Wax å¯¹JSPatchçš„æ€è€ƒ è¿›è¡Œçƒ­æ›´æ–°åä¸‹ä¸€ä¸ªç‰ˆæœ¬éœ€è¦å°†JSä»£ç ä¿®æ”¹ä¸ºåŸç”Ÿä»£ç ï¼Œä¸èƒ½åœç•™è¶…è¿‡ä¸€ä¸ªç‰ˆæœ¬ã€‚ ç¼–å†™JSè„šæœ¬æ–‡ä»¶ï¼Œè°ƒç”¨OCåŸç”Ÿçš„æ–¹æ³•ï¼ˆæ–¹æ³•åé•¿å¾—å¯æ€•ï¼‰æ²¡æœ‰ä»£ç è¡¥å…¨æç¤ºå’Œé«˜äº®ï¼Œæ˜¾å¾—éå¸¸åƒåŠ›ã€‚ å½“è¦è¿›è¡Œçƒ­ä¿®å¤çš„æ–¹æ³•æ˜¯ä¸€ä¸ªä»£ç é‡å¾ˆå¤§çš„æ–¹æ³•ï¼Œéœ€è¦ç”¨JSé‡å†™è¿™ä¸ªæ–¹æ³•ï¼Œè¿™ä¼šå¾ˆç—›è‹¦ã€‚ æ–°æ–¹æ¡ˆ : DynamicCocoaä¼˜åŠ¿æ‰€åœ¨ï¼š ä½¿ç”¨åŸç”ŸæŠ€æœ¯æ ˆï¼šä½¿ç”¨è€…å®Œå…¨ä¸ç”¨æ¥è§¦åˆ° JS æˆ–ä»»ä½•ä¸­é—´ä»£ç ï¼Œä¿æŒåŸç”Ÿçš„ Objective-C å¼€å‘ã€è°ƒè¯•æ–¹å¼ä¸å˜ æ— éœ€é‡å†™å·²æœ‰ä»£ç ï¼šå·²æœ‰ native æ¨¡å—èƒ½å¾ˆæ–¹ä¾¿çš„å˜æˆåŠ¨æ€åŒ–æ’ä»¶ è¯­æ³•æ”¯æŒå®Œå¤‡æ€§é«˜ï¼šæ”¯æŒç»å¤§å¤šæ•°æ—¥å¸¸å¼€å‘ä¸­ç”¨åˆ°çš„è¯­æ³•ï¼Œä¸ç”¨æ‹…å¿ƒè¿™ä¸æ”¯æŒé‚£ä¸æ”¯æŒ æ”¯æŒ HotPatchï¼šæ”¹å®Œ bug åç›´æ¥ä»æºç æ‰“å‡º patchï¼Œä¸€ç«™å¼è§£å†³åŠ¨æ€åŒ–å’Œçƒ­ä¿®å¤éœ€æ±‚ èµ„æºçš„æ”¯æŒ,åŠ¨æ€ bundle æ”¯æŒï¼š xib å’Œ storyboard xcassets ä¸æ”¾åœ¨ xcassets é‡Œçš„å›¾ç‰‡èµ„æº å…¶ä»–èµ„æºæ–‡ä»¶ DynamicCocoaï¼šæ»´æ»´ iOS åŠ¨æ€åŒ–æ–¹æ¡ˆçš„è¯ç”Ÿä¸èµ·èˆª","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"Objective-C IsaæŒ‡é’ˆ","date":"2016-12-19T05:52:37.000Z","path":"2016/12/19/Objective-C-isaæŒ‡é’ˆ/","text":"1. ä»€ä¹ˆæ˜¯isaæŒ‡é’ˆé¦–å…ˆæ¥çœ‹ä¸€ä¸‹ï¼ŒNSObjectçš„å®šä¹‰ï¼ˆä¸å«æ–¹æ³•å®šä¹‰ï¼‰ï¼š 123@interface NSObject &lt;NSObject&gt; &#123; Class isa;&#125; åœ¨Objective-Cä¸­ï¼Œ@interfaceå…³é”®å­—å¯ä»¥çœ‹ç€æ˜¯Cè¯­è¨€ä¸­çš„structå…³é”®å­—çš„åˆ«åï¼Œå½“ç„¶ä»–è¿˜ä¼šæœ‰ä¸€äº›å…¶å®ƒåŠŸèƒ½ï¼Œæ¯”å¦‚è¯´è®©ç¼–è¯‘å™¨çŸ¥é“@interfaceååé¢çš„æ˜¯ä¸€ä¸ªObjective-Cçš„ç±»çš„åå­—ç­‰ã€‚ä½†å°±æˆ‘ä»¬ç ”ç©¶å…¶å†…å­˜å¸ƒå±€æ¥è¯´ï¼Œæˆ‘ä»¬ç®€å•åœ°å°†å…¶æ›¿æ¢ä¸ºstructï¼Œå¹¶å°†protocalå®šä¹‰å»æ‰ã€‚å› æ­¤ï¼ŒNSObjectçš„å®šä¹‰å°±æ˜¯æ ·ï¼š 123struct NSObject&#123; Class isa;&#125; é‚£ä¸ªè¿™ä¸ªClassåˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿåœ¨objc.hä¸­æˆ‘ä»¬å‘ç°å…¶ä»…ä»…æ˜¯ä¸€ä¸ªç»“æ„(struct)æŒ‡é’ˆçš„typedefå®šä¹‰: typedefstruct objc_class *Class; å› æ­¤ï¼ŒNSObjectçš„å®šä¹‰å°±åƒè¿™ä¸ªæ ·å­ï¼š 123struct NSObject&#123; objc_class *isa&#125; isaå°±æ˜¯â€œis aâ€ï¼Œå¯¹äºæ‰€æœ‰ç»§æ‰¿äº†NSObjectçš„ç±»å…¶å¯¹è±¡ä¹Ÿéƒ½æœ‰ä¸€ä¸ªisaæŒ‡é’ˆã€‚è¿™ä¸ªisaæŒ‡é’ˆæŒ‡å‘çš„ä¸œè¥¿(å…ˆè¿™æ ·ç§°å‘¼å®ƒå§)å°±æ˜¯å…³äºè¿™ä¸ªå¯¹è±¡æ‰€å±çš„ç±»çš„å®šä¹‰ã€‚ æ¯ä¸€ä¸ªObjective-Cå¯¹è±¡çš„åº•å±‚éƒ½æ˜¯è¿™æ ·çš„ä¸€ä¸ªCç»“æ„ä½“ï¼š 123456struct objc_class &#123; struct objc_class * isa; const char *name; â€¦. struct objc_method_list **methodLists; /*æ–¹æ³•é“¾è¡¨*/&#125;; è¿™ä¸ªç»“æ„ä½“ä¸­çš„ç¬¬ä¸€ä¸ªæˆå‘˜å˜é‡ï¼Œå°±æ˜¯isaæŒ‡é’ˆã€‚ 2. isaæŒ‡é’ˆçš„æŒ‡å‘å®ä¾‹å¯¹è±¡çš„isaæŒ‡é’ˆæŒ‡å‘æ˜¯å…¶æ‰€å±çš„ç±»å¯¹è±¡ï¼Œè¿™ä¸ªç±»å¯¹è±¡åŒ…å«äº†è¯¥å®ä¾‹å¯¹è±¡çš„ä¸€äº›ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼šå®ä¾‹åˆ—è¡¨ã€æ–¹æ³•åˆ—è¡¨ç­‰ï¼‰ã€‚isaæŒ‡é’ˆçš„ç±»å‹æ˜¯è¿˜æ˜¯ä¸€ä¸ªç»“æ„ä½“ objc_class å…¶å®ä¹Ÿå°±æ˜¯æŒ‡å‘åœ°å€çš„ç±»å¯¹è±¡çš„ç»“æ„ï¼Œæ¥ä¸‹æ¥çœ‹ä¸‹ è¯¥objc_classçš„å…·ä½“ç»“æ„ï¼š 1234567891011121314151617struct objc_class &#123; Class isa; Class super_class; const char *name; long version; long info; long instance_size; struct objc_ivar_list *ivars; struct objc_method_list **methodLists; struct objc_cache *cache; struct objc_protocol_list *protocols; &#125; ä¸€ä¸ªobjc_classå¯¹è±¡åŒ…æ‹¬ä¸€ä¸ªç±»çš„ï¼šçˆ¶ç±»å®šä¹‰(super_class), å˜é‡åˆ—è¡¨ï¼Œæ–¹æ³•åˆ—è¡¨ï¼Œè¿˜æœ‰å®ç°äº†å“ªäº›åè®®(Protocal) è¿™ä¸ªç»“æ„ä¸­è¿˜æœ‰ä¸€ä¸ªisaæŒ‡é’ˆï¼Œå®ƒåœ¨è¿™é‡Œï¼ˆç±»å¯¹è±¡ä¸­ï¼‰æŒ‡å‘çš„æ˜¯å…ƒç±»å¯¹è±¡(metaclass object)ã€‚åœ¨Objective-Cä¸­ä»»ä½•çš„ç±»å®šä¹‰éƒ½æ˜¯å¯¹è±¡ã€‚å³åœ¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™ä»»ä½•ç±»å®šä¹‰éƒ½å¯¹åº”äºä¸€å—å†…å­˜ã€‚åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼Œç¼–è¯‘å™¨ä¼šç»™æ¯ä¸€ä¸ªç±»ç”Ÿæˆä¸€ä¸ªä¸”åªç”Ÿæˆä¸€ä¸ªâ€æè¿°å…¶å®šä¹‰çš„å¯¹è±¡â€,ä¹Ÿå°±æ˜¯æ°´æœå…¬å¸è¯´çš„ç±»å¯¹è±¡(class object),ä»–æ˜¯ä¸€ä¸ªå•ä¾‹(singleton), è€Œæˆ‘ä»¬åœ¨C++ç­‰è¯­è¨€ä¸­æ‰€è°“çš„å¯¹è±¡ï¼Œå«åšå®ä¾‹å¯¹è±¡(instance object)ã€‚å¯¹äºå®ä¾‹å¯¹è±¡æˆ‘ä»¬ä¸éš¾ç†è§£ï¼Œä½†ç±»å¯¹è±¡(class object)æ˜¯å¹²ä»€ä¹ˆåƒçš„å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“Objective-Cæ˜¯é—¨å¾ˆåŠ¨æ€çš„è¯­è¨€ï¼Œå› æ­¤ç¨‹åºé‡Œçš„æ‰€æœ‰å®ä¾‹å¯¹è±¡(instace objec)éƒ½æ˜¯åœ¨è¿è¡Œæ—¶ç”±Objective-Cçš„è¿è¡Œæ—¶åº“ç”Ÿæˆçš„ï¼Œè€Œè¿™ä¸ªç±»å¯¹è±¡(class object)å°±æ˜¯è¿è¡Œæ—¶åº“ç”¨æ¥åˆ›å»ºå®ä¾‹å¯¹è±¡(instance object)çš„ä¾æ®ã€‚ ä»»ä½•ç›´æ¥æˆ–é—´æ¥ç»§æ‰¿äº†NSObjectçš„ç±»ï¼Œå®ƒçš„å®ä¾‹å¯¹è±¡(instacne objec)ä¸­éƒ½æœ‰ä¸€ä¸ªisaæŒ‡é’ˆï¼ŒæŒ‡å‘å®ƒçš„ç±»å¯¹è±¡(class object)ã€‚è¿™ä¸ªç±»å¯¹è±¡(class object)ä¸­å­˜å‚¨äº†å…³äºè¿™ä¸ªå®ä¾‹å¯¹è±¡(instace object)æ‰€å±çš„ç±»çš„å®šä¹‰çš„ä¸€åˆ‡ï¼šåŒ…æ‹¬å˜é‡ï¼Œæ–¹æ³•ï¼Œéµå®ˆçš„åè®®ç­‰ç­‰ã€‚ è¿™ä¸ªå®ä¾‹å¯¹è±¡(instance object)çš„isaæŒ‡é’ˆæŒ‡å‘çš„ç±»å¯¹è±¡(class object)é‡Œé¢è¿˜æœ‰ä¸€ä¸ªisaå‘¢ï¼Ÿ è¿™ä¸ªç±»å¯¹è±¡(class objec)çš„isaæŒ‡å‘çš„ä¾ç„¶æ˜¯ä¸€ä¸ªobjc-classï¼Œå®ƒå°±æ˜¯â€œå…ƒç±»å¯¹è±¡â€(metaclass object)ï¼Œå®ƒå’Œç±»å¯¹è±¡(class object)çš„å…³ç³»æ˜¯è¿™æ ·çš„: ç±»å¯¹è±¡(class object)ä¸­åŒ…å«äº†ç±»çš„å®ä¾‹å˜é‡ï¼Œå®ä¾‹æ–¹æ³•çš„å®šä¹‰ï¼Œè€Œå…ƒç±»å¯¹è±¡(metaclass object)ä¸­åŒ…æ‹¬äº†ç±»çš„ç±»æ–¹æ³•(ä¹Ÿå°±æ˜¯C++ä¸­çš„é™æ€æ–¹æ³•)çš„å®šä¹‰ã€‚ç±»å¯¹è±¡å’Œå…ƒç±»å¯¹è±¡ä¸­æ°´æœå…¬å¸å½“ç„¶è¿˜ä¼šåŒ…å«ä¸€äº›å…¶å®ƒçš„ä¸œè¥¿ï¼Œä»¥åä¹Ÿå¯èƒ½æ·»åŠ å…¶å®ƒçš„å†…å®¹ï¼Œä½†å¯¹äºæˆ‘ä»¬äº†è§£å…¶å†…å­˜å¸ƒå±€æ¥è¯´ï¼Œåªéœ€è¦è®°ä½ï¼šç±»å¯¹è±¡å­˜çš„æ˜¯å…³äºå®ä¾‹å¯¹è±¡çš„ä¿¡æ¯(å˜é‡ï¼Œå®ä¾‹æ–¹æ³•ç­‰)ï¼Œè€Œå…ƒç±»å¯¹è±¡(metaclass object)ä¸­å­˜å‚¨çš„æ˜¯å…³äºç±»çš„ä¿¡æ¯(ç±»çš„ç‰ˆæœ¬ï¼Œåå­—ï¼Œç±»æ–¹æ³•ç­‰)ã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œç±»å¯¹è±¡(class object)å’Œå…ƒç±»å¯¹è±¡(metaclass object)çš„å®šä¹‰éƒ½æ˜¯objc_classç»“æ„ï¼Œå…¶ä¸åŒä»…ä»…æ˜¯åœ¨ç”¨é€”ä¸Šï¼Œæ¯”å¦‚å…¶ä¸­çš„æ–¹æ³•åˆ—è¡¨åœ¨ç±»å¯¹è±¡(instance object)ä¸­ä¿å­˜çš„æ˜¯å®ä¾‹æ–¹æ³•(instance method)ï¼Œè€Œåœ¨å…ƒç±»å¯¹è±¡(metaclass object)ä¸­åˆ™ä¿å­˜çš„æ˜¯ç±»æ–¹æ³•(class method)ã€‚ 3. å›¾ä¾‹è¯´æ˜å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼ŒD3ç»§æ‰¿D2,D2ç»§æ‰¿D1,D1æœ€ç»ˆç»§æ‰¿NSObjectã€‚ä¸‹å›¾ä»D3çš„ä¸€ä¸ªå¯¹è±¡å¼€å§‹ï¼Œæ’åˆ—å‡ºD3 D2 D1 NSObject ç±»å¯¹è±¡ï¼Œå…ƒç±»å¯¹è±¡ç­‰å…³ç³»ã€‚ å›¾ä¸­çš„ç®­å¤´éƒ½æ˜¯æŒ‡é’ˆçš„æŒ‡å‘ã€‚ å‚è€ƒï¼š Objective-Cå†…å­˜å¸ƒå±€ Objective-C Runtime","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"JSPatchå­¦ä¹ ç¬”è®°(äºŒ)","date":"2016-12-19T01:14:01.000Z","path":"2016/12/19/JSPatchå­¦ä¹ ç¬”è®°-äºŒ/","text":"è¿™æ¬¡ç¬”è®°ä¸­ä¸»è¦æè¿°çš„æœ‰ï¼š JSPathåŸç†ç†è§£ï¼ˆå­¦ä¹ ä½œè€…å¤§ç‰›åšå®¢ï¼‰ JSPatchä½¿ç”¨çš„æ—¶æœº AppDelegateä¸­æ›´æ–°JSæ–‡ä»¶åä½•æ—¶ç”Ÿæ•ˆ å…¶ä»–æ—¶æœºæ‰‹åŠ¨æ›´æ–°JSæ–‡ä»¶çš„æ•ˆæœ JSè°ƒç”¨OCæ–¹æ³•ä¸­çš„å‡ ä¸ªå‘ JSè„šæœ¬æ–‡ä»¶çš„ç‰ˆæœ¬æ§åˆ¶ç®¡ç† æ›´å¤šæ€è€ƒ 1. JSPatchåŸç†æµ…è°ˆJSPatchç”¨iOSå†…ç½®çš„JavaScriptCore.frameworkä½œä¸ºJSå¼•æ“ï¼Œä½†æ²¡æœ‰ç”¨å®ƒJSExportçš„ç‰¹æ€§è¿›è¡ŒJS-OCå‡½ æ•°äº’è°ƒï¼Œè€Œæ˜¯é€šè¿‡Objective-C Runtimeï¼Œä»JSä¼ é€’è¦è°ƒç”¨çš„ç±»åå‡½æ•°ååˆ°Objective-Cï¼Œå†ä½¿ç”¨NSInvocationåŠ¨æ€è°ƒç”¨å¯¹åº”çš„OCæ–¹æ³•ã€‚ è¯¦ç»†åŸç†ä»‹ç»å¯è§ä½œè€…åšå®¢:JSPatch å®ç°åŸç†è¯¦è§£ å¦å¤–JSPatchå·²ç»æœ‰å•†ä¸šåŒ–çš„å¹³å°jspatch.comï¼Œå¯ä»¥ä½¿ç”¨é‡Œé¢çš„SDKï¼Œé€šè¿‡è¿™ä¸ªå¹³å°ä¸Šä¼ çš„jsè„šæœ¬éƒ½å­˜å‚¨åœ¨ä¸ƒç‰›äº‘ã€‚ 2. JSPatchä½¿ç”¨çš„æ—¶æœºç¡®åˆ‡åœ°è¯´åº”è¯¥æ˜¯åœ¨ç»è¿‡æ€æ ·çš„æµç¨‹ä¹‹åå¼€å§‹è½½å…¥è°ƒç”¨JSè„šæœ¬ã€‚åœ¨è‘£é“‚ç„¶çš„åšå®¢:JSPatchä½¿ç”¨å°è®°ä¸­æœ‰è¿™æ ·çš„ä¸€å¥—æ–¹æ¡ˆï¼š è¿™ä¸ªæ–¹æ¡ˆçš„ç‰¹ç‚¹ï¼š æ·»åŠ äº†ä¸Šæ¬¡è¯·æ±‚çš„æ—¶é—´ï¼Œé¿å…å¤šä½™çš„ç½‘ç»œè¯·æ±‚ æŠŠæ›´æ–°jsè„šæœ¬çš„ä»£ç æ”¾åœ¨äº†applicationDidBecomeActive:æ–¹æ³•ä¸­ï¼Œé¿å…ç¨‹åºåœ¨åå°çš„æ—¶å€™ä¹Ÿè¿›è¡Œä¸å¿…è¦çš„è„šæœ¬æ›´æ–°æ£€æŸ¥ã€‚ å¯¹jsæ–‡ä»¶è¿›è¡Œcodeæ ¡éªŒï¼Œé¿å…ä¼ è¾“è¿‡ç¨‹ä¸­è¢«ä¿®æ”¹ã€‚å®é™…ä½¿ç”¨ä¸­åº”å¯¹jsè„šæœ¬æ–‡ä»¶è¿›è¡ŒåŠ å¯†ã€‚ï¼ˆä½œè€…çš„åšå®¢ä¸­ä¹Ÿå»ºè®®ç”¨RSAç­‰éå¯¹ç§°åŠ å¯†å¯¹æ–‡ä»¶è¿›è¡ŒåŠ å¯†ä¼ è¾“ï¼‰ è¿ç»­å´©æºƒæ¬¡æ•°çš„åˆ¤æ–­ï¼Œèƒ½å¤Ÿåšåˆ°ç¨‹åºè‡ªæˆ‘é€‰æ‹©æ€§ä¿®å¤ 3. AppDelegateä¸­æ›´æ–°JSæ–‡ä»¶åä½•æ—¶ç”Ÿæ•ˆå½“ç»è¿‡æœ¬æ–‡ç¬¬äºŒç‚¹ä¸­æµç¨‹ä¹‹åï¼Œæœ¬åœ°è½½å…¥äº†æœ€æ–°çš„jsè„šæœ¬æ–‡ä»¶ï¼Œé‚£ä¹ˆç¨‹åºä»€ä¹ˆæ—¶å€™ä¼šä½¿ç”¨è¿™ä¸ªè„šæœ¬ä¸­çš„ä»£ç å‘¢ï¼Ÿä¸ºæ­¤æˆ‘å†™äº†demoæµ‹è¯•ï¼š AppDelegateä¸­çš„ä»£ç  åˆ¤æ–­æœ¬åœ°æ˜¯å¦å­˜åœ¨hotfix.jsæ–‡ä»¶ï¼š 123456789101112- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123; NSString *docuPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) firstObject]; NSString *hotfixPath = [docuPath stringByAppendingPathComponent:@\"hotfix.js\"]; if ([[NSFileManager defaultManager] fileExistsAtPath:hotfixPath]) &#123; [JPEngine startEngine]; NSString *script = [NSString stringWithContentsOfFile:hotfixPath encoding:NSUTF8StringEncoding error:nil]; [JPEngine evaluateScript:script]; &#125; return YES;&#125; æ£€æµ‹æ˜¯å¦éœ€è¦æ›´æ–°ï¼š 12345678910111213141516171819202122- (void)applicationDidBecomeActive:(UIApplication *)application &#123; // Restart any tasks that were paused (or not yet started) while the application was inactive. If the application was previously in the background, optionally refresh the user interface. [HotFixManager checkUpdateCompleteHandle:^(BOOL status, NSString *response, NSError *error) &#123; dispatch_async(dispatch_get_main_queue(), ^&#123; if (!status)&#123; if (!error) &#123; NSLog(@\"æ²¡æœ‰æ›´æ–°\"); &#125; else &#123; NSLog(@\"%@\", error.userInfo); &#125; return ; &#125; NSLog(@\"Hotfixæ–‡ä»¶æ›´æ–°æˆåŠŸ\"); [JPEngine startEngine]; NSString *script = [NSString stringWithContentsOfFile:response encoding:NSUTF8StringEncoding error:nil]; [JPEngine evaluateScript:script]; &#125;); &#125;]; &#125; é¦–å…ˆç¬¬ä¸€ç‚¹å¯ä»¥ç¡®å®šçš„æ˜¯ï¼šåˆ¤æ–­æœ¬åœ°æ˜¯å¦å­˜åœ¨jsæ–‡ä»¶éœ€è¦åŠ è½½çš„ä»£ç ä¸èƒ½å¤Ÿå†™åœ¨ç½‘ç»œè¯·æ±‚æ˜¯å¦éœ€è¦æ›´æ–°çš„å›è°ƒä¸­åŸå› ï¼šé¦–å…ˆçœ‹ä¸‹æˆ‘çš„hotfix.jsæ–‡ä»¶ä¸­çš„ä»£ç  1234567891011121314151617181920212223defineClass('JSPatchController', [/*æ–°å¢çš„å±æ€§*/'updateLabel'], &#123;//å®ä¾‹æ–¹æ³• viewDidLoad: function() &#123;// self.ORIGviewDidLoad() self.setTitle(\"æµ‹è¯•JS1\") self.view().addSubview(self.getUpdateLabel()) &#125;, //å®ç°Labelçš„getteræ–¹æ³• getUpdateLabel: function() &#123; var _updateLabel = self.updateLabel() if (!_updateLabel) &#123; _updateLabel = require('UILabel').alloc().init() _updateLabel.setFrame(&#123;x:50, y:100, width:100, height:30&#125;) _updateLabel.setText(\"ç‚¹å‡»æŒ‰é’®æ›´æ–°JSä»£ç ---&gt;\") _updateLabel.setFont(require('UIFont').systemFontOfSize(15)) _updateLabel.setTextColor(require('UIColor').redColor()) _updateLabel.sizeToFit() self.setUpdateLabel(_updateLabel) &#125; return _updateLabel &#125;,&#125;) ä»£ç ä¸­æ˜¯æœ‰æ·»åŠ äº†updateLabelè¿™æ ·ä¸€ä¸ªå±æ€§ï¼Œå¹¶æ·»åŠ åˆ°JSPatchControllerçš„è§†å›¾ä¸­ï¼Œå…¶ä¸­JSPatchControllerä¸ºwindowä¸‹navigationControllerçš„rootViewControllerã€‚ å½“æˆ‘å°è¯•åœ¨æ£€æŸ¥æ›´æ–°çš„blockæ²¡æœ‰æ›´æ–°çš„åŒºå—ä¸­æ‰§è¡Œ 123[JPEngine startEngine]; NSString *script = [NSString stringWithContentsOfFile:hotfixPath encoding:NSUTF8StringEncoding error:nil]; [JPEngine evaluateScript:script] å‘ç°JSPatchControllerå¹¶æ²¡æœ‰æ·»åŠ ä¸ŠupdateLabelï¼Œèµ·åˆä»¥ä¸ºæ˜¯æ²¡æœ‰å›åˆ°ä¸»çº¿ç¨‹ä¸­æ›´æ–°è§†å›¾ï¼Œç»è¿‡å°è¯•å¹¶ä¸æ˜¯ã€‚å½“æ‰§è¡ŒNSURLSessionDataTaskçš„ç½‘ç»œè¯·æ±‚åï¼Œä¼šæ–°å¼€å¯ä¸€ä¸ªçº¿ç¨‹ã€‚è€Œä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œç¼–è¯‘JSPatchControllerï¼Œå½“æ–°çš„çº¿ç¨‹ä¸­çš„ç½‘ç»œè¯·æ±‚å®Œæˆäº†ï¼Œç„¶ååŠ è½½äº†jsè„šæœ¬æ–‡ä»¶ï¼Œæ­¤æ—¶å·²ç»ä¸èƒ½å†å¯¹JSPatchControlleråŠ¨æ€æ·»åŠ updateLabeläº†ã€‚ ç¬¬äºŒç‚¹ï¼šdidFinishLaunchingWithOptions: çš„æ‰§è¡Œä¼˜å…ˆçº§æ˜¯é«˜äºapplicationDidBecomeActive:æ–¹æ³•çš„ï¼Œæ£€æŸ¥æœ¬åœ°çš„jsæ–‡ä»¶åº”å‘åœ¨å‰è€…ä¸­ã€‚ ç¬¬ä¸‰ç‚¹ï¼š applicationDidBecomeActive: æ–¹æ³•ä¸­æ£€æµ‹éœ€è¦æ›´æ–°å¹¶ä¸‹è½½äº†jsè„šæœ¬æ–‡ä»¶ï¼Œä½†æ˜¯åªæœ‰ä¸‹ä¸€æ¬¡å¯åŠ¨Appçš„æ—¶å€™æ‰èƒ½ç”Ÿæ•ˆ åœ¨æ ¹æ§åˆ¶å™¨ä¸­çš„åŠ¨æ€ä¿®æ”¹ä»£ç åªèƒ½ä¸‹ä¸€æ¬¡å¯åŠ¨Appçš„æ—¶å€™æ‰èƒ½ç”Ÿæ•ˆã€‚ 4. å…¶ä»–æ—¶æœºæ‰‹åŠ¨æ›´æ–°JSæ–‡ä»¶çš„æ•ˆæœå…¶ä»–æ—¶æœºè¿™é‡ŒæŒ‡çš„æ˜¯ä¾‹å¦‚UIControläº‹ä»¶ï¼Œç‚¹å‡»æŒ‰é’®åæ›´æ–°jsè„šæœ¬ï¼Œé‚£ä¹ˆè¿™ä¸ªè„šæœ¬æ–‡ä»¶ä¸­çš„ä»£ç ä½•æ—¶ç”Ÿæ•ˆå‘¢ï¼Ÿåœ¨demoä¸­çš„JSPatchControllerä¸­ â€œæ›´æ–°JSâ€ è¿™ä¸ªæŒ‰é’®ï¼Œç‚¹å‡»æ‰§è¡Œçš„ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718- (IBAction)updateJS:(UIButton *)sender &#123; sender.selected = !sender.isSelected; NSString *url = sender.isSelected ? jsfile1 : jsfile2; [sender setTitle:@\"å½“å‰JS1\" forState:UIControlStateSelected]; [sender setTitle:@\"å½“å‰JS2\" forState:UIControlStateNormal]; NSLog(@\"ä¸‹è½½çš„æ˜¯%@\",url); [HotFixManager downLoadHotFixJSfileWithURL:url completeHandle:^(BOOL status, id response, NSError *error) &#123; if (!status)&#123; NSLog(@\"ä¸‹è½½å‡ºé”™\\n%@\", error.userInfo); return ; &#125; NSLog(@\"Hotfixæ–‡ä»¶æ›´æ–°æˆåŠŸ\"); [JPEngine startEngine]; NSString *script = [NSString stringWithContentsOfFile:response encoding:NSUTF8StringEncoding error:nil]; [JPEngine evaluateScript:script]; &#125;];&#125; ç‚¹æŒ‰æŒ‰é’®æœ‰ä¸¤ä¸ªjsè„šæœ¬æ–‡ä»¶å¯ä»¥è¿›è¡Œåˆ‡æ¢ï¼Œä¸¤ä¸ªjsæ–‡ä»¶ä¸­çš„åŒºåˆ«éƒ¨åˆ†ä¸ºå¯¹ä¸‹ä¸€ä¸ªæ§åˆ¶å™¨ä¸­çš„lableæ–‡å­—å’Œnavigation titleçš„æ§åˆ¶ jsfile1ï¼š 12345678defineClass('SecondViewController', &#123; viewDidLoad: function() &#123; self.ORIGviewDidLoad() var label = self.myLabel() label.setText(\"è¿™æ˜¯åœ¨JS1ä¸­ä¿®æ”¹çš„æ–‡å­—\") self.setTitle(\"JS1æ¨å‡ºçš„é¡µé¢\") &#125; &#125;) jsfile2: 12345678defineClass('SecondViewController', &#123; viewDidLoad: function() &#123; self.ORIGviewDidLoad() var label = self.myLabel() label.setText(\"è¿™æ˜¯åœ¨JS2ä¸­ä¿®æ”¹çš„æ–‡å­—\") self.setTitle(\"JS2æ¨å‡ºçš„é¡µé¢\") &#125; &#125;) æµ‹è¯•ç»“æœæ˜¯ï¼šæ›´æ–°çš„jsè„šæœ¬ä¸­å¯¹ä¹‹åçš„é¡µé¢çš„jsä¿®å¤ä»£ç æ˜¯å¯ä»¥ç”Ÿæ•ˆçš„ï¼Œä½†æ˜¯å¯¹ä¹‹å‰çš„é¡µé¢è·ŸåŒçº§çš„é¡µé¢æ˜¯æ²¡æœ‰æ•ˆæœçš„ã€‚ å…¶å®è¿™äº›ï¼Œåªè¦ææ¸…æ¥šåŸç†å°±éƒ½èƒ½çŸ¥é“ç¼˜ç”±å’Œè§„å¾‹ã€‚ 5. JSè°ƒç”¨OCæ–¹æ³•ä¸­çš„å‡ ä¸ªå‘ åœ¨jsä¸­ NSNumberä¸éœ€è¦åœ¨å¤„ç†ï¼Œå¯ç›´æ¥å½“æ•°å€¼ä½¿ç”¨ã€‚ NSRang åˆå§‹åŒ–ï¼švar range = {location: 0, length: senderName.length()}; æ— è®ºå˜é‡è¿˜æ˜¯æ–¹æ³•ï¼Œå•ä¸‹åˆ’çº¿å…¨éƒ¨æ”¹ä¸ºåŒä¸‹åˆ’çº¿ CGRect å–å®½é«˜ï¼Œ ç›´æ¥rect.width, ä¸ç”¨rect.size.widthã€‚å…¶ä»–ç»“æ„ä½“ç±»ä¼¼ js ä¸­ YES ä¸º tureï¼ŒNO ä¸ºfalse ocå¯¹è±¡è½¬jså¯¹è±¡å¯æ“ä½œtoJS()ï¼Œjså¯¹è±¡è½¬ocå¯¹è±¡æš‚æ—¶æ²¡æ‰¾åˆ°æ–¹æ³•ã€‚jså†…åˆ›å»ºçš„å­—å…¸ä¸ºjså¯¹è±¡ï¼Œä¼ å…¥ocæ–¹æ³•æ— æ•ˆ jspatch ä¸æ”¯æŒå˜å‚æ–¹æ³•ï¼Œå¦‚stringWithFormat:ï¼Œå¯ç”¨jså­—ç¬¦ä¸²æ–¹æ³•æˆ–NSMutableStringä»£æ›¿ã€‚ 6. JSè„šæœ¬æ–‡ä»¶çš„ç‰ˆæœ¬æ§åˆ¶ç®¡ç†ä¸€èˆ¬ä½¿ç”¨çš„jsè„šæœ¬æ–‡ä»¶éƒ½æ˜¯ä»æœåŠ¡å™¨ä¸‹å‘è¿‡æ¥ï¼ŒæœåŠ¡å™¨çš„æ¥å£éœ€è¦è¿”å›æ—¶å€™éœ€è¦æ›´æ–°çš„å‚æ•°ï¼Œéœ€è¦åˆ™ä¸‹è½½äºå½“å‰ç¨‹åºç‰ˆæœ¬å·å¯¹åº”ç‰ˆæœ¬çš„jsè„šæœ¬æ–‡ä»¶ã€‚å¯¹äºå¤šä¸ªç‰ˆæœ¬çš„é¡¹ç›®æ¥è¯´ï¼Œjsè„šæœ¬æ–‡ä»¶æœ€å¥½ä¹Ÿè¿›è¡Œç‰ˆæœ¬æ§åˆ¶é¿å…å‡ºé”™ï¼Œå¯ä»¥åœ¨æœåŠ¡å™¨å•ç‹¬å»ºç«‹jsè„šæœ¬æ–‡ä»¶çš„Gitä»“åº“æ¥è¿›è¡Œç®¡ç†ã€‚ 7. æ›´å¤šæ€è€ƒ JSçƒ­ä¿®å¤çš„ä»£ç åœ¨ä¸‹ä¸€æ¬¡æ›´æ–°ä¸­åº”å½“ä½¿ç”¨åŸç”Ÿçš„ä»£ç æ›¿æ¢ï¼Œä¸èƒ½è¶…è¿‡ä¸€ä¸ªç‰ˆæœ¬ã€‚é¿å…å¯¹JSPatchæœ‰è¿‡å¤šçš„ä¾èµ– ä½¿ç”¨JSè¯­æ³•æ¥è°ƒç”¨OCçš„æ–¹æ³•ï¼Œæ²¡æœ‰ä»£ç è‡ªåŠ¨è¡¥å…¨æ˜¾å¾—éå¸¸åƒåŠ›ã€‚ä½œè€…bangå¼€å‘äº†Xcodeæ’ä»¶ï¼šJSPatchXï¼Œç„¶è€ŒXcode8ä¸æ”¯æŒæ’ä»¶äº†ã€‚ã€‚ã€‚ åœ¨ä¸€ä¸ªå¾ˆå¤æ‚çš„æ–¹æ³•ä¸­,ä»…ä¸­é—´æŸä¸€è¡Œä»£ç éœ€è¦ä¿®æ”¹,å°±è¦å°†æ•´ä¸ªæ–¹æ³•ç”¨JSé‡å†™ä¸€é,æ¨ä»‹ä½œè€…å¼€å‘çš„Objective-Cè½¬JavaScriptä»£ç å·¥å…·JSPatch Convertor,ä½†ä¸€äº›å¤æ‚çš„è¯­æ³•è¿˜æ˜¯è¦äººå·¥ä¿®æ­£","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"JSPatchå­¦ä¹ ç¬”è®°(ä¸€)","date":"2016-12-19T01:09:29.000Z","path":"2016/12/19/JSPatchå­¦ä¹ ç¬”è®°-ä¸€/","text":"ä»€ä¹ˆæ˜¯JSPatchJSPatch æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®(Githubé“¾æ¥)ï¼Œåªéœ€è¦åœ¨é¡¹ç›®é‡Œå¼•å…¥æå°çš„å¼•æ“æ–‡ä»¶ï¼Œå°±å¯ä»¥ä½¿ç”¨ JavaScript è°ƒç”¨ä»»ä½• Objective-C çš„åŸç”Ÿæ¥å£ï¼Œæ›¿æ¢ä»»æ„ Objective-C åŸç”Ÿæ–¹æ³•ã€‚ç›®å‰ä¸»è¦ç”¨äºä¸‹å‘ JS è„šæœ¬æ›¿æ¢åŸç”Ÿ Objective-C ä»£ç ï¼Œå®æ—¶ä¿®å¤çº¿ä¸Š bugã€‚ ç†è§£ä¸‹æ¥ç±»ä¼¼äºè¿è¡Œæ—¶çš„Method Swizzlingï¼ŒåŠ¨æ€åœ°å°†éœ€è¦ä¿®å¤çš„bugä»£ç æ›¿æ¢æˆæ›´æ–°çš„ä»£ç ã€‚ä¸åŒçš„æ˜¯JSPatchä½¿ç”¨JavaScriptæ¥è¿›è¡Œçƒ­ä¿®å¤ï¼Œå¯ä»¥åœ¨Appä¸Šçº¿çš„çŠ¶æ€ä¸‹æ›¿æ¢Appå†…çš„JSæ–‡ä»¶ä»è€Œå¯ä»¥éšå¿ƒæ‰€æ¬²ä¿®æ”¹å’Œæ›¿æ¢åŸæœ‰çš„æ–¹æ³•ï¼Œè¾¾åˆ°çƒ­ä¿®å¤çš„æ•ˆæœã€‚ JSPatchçš„ä½¿ç”¨Githubé¡¹ç›®ä¸»é¡µä¸Šä»‹ç»å¯ä»¥é€šè¿‡podå¯¼å…¥çš„æ–¹å¼åŠ å…¥é¡¹ç›®ï¼Œæ‰‹åŠ¨ç®¡ç†ä¹Ÿä»…ä»…æ˜¯éœ€è¦æ·»åŠ ä¸‰ä¸ªæ–‡ä»¶åˆ°é¡¹ç›®æ—¢å¯ä½¿ç”¨ã€‚ InstallationCocoaPodsCocoaPods is a dependency manager for Objective-C, which automates and simplifies the process of using 3rd-party libraries like JSPatch in your projects. See the â€œGetting Startedâ€ guide for more information. 123# Your Podfileplatform :ios, &apos;6.0&apos;pod &apos;JSPatch&apos; ManuallyCopy JSEngine.m JSEngine.h JSPatch.js in JSPatch/ to your project. ä½¿ç”¨JSè°ƒç”¨åŸç”ŸAPIçš„çš„JSè¯­æ³•åœ¨é¡¹ç›®ä¸»é¡µä¸Šä¹Ÿæœ‰æ–‡æ¡£ã€‚ å…¶ä¸­æœ€å…³é”®çš„å°±æ˜¯è¿™ä¸ªAPIï¼š 12345defineClass(classDeclaration, [properties,] instanceMethods, classMethods) @param classDeclaration: å­—ç¬¦ä¸²ï¼Œç±»å/çˆ¶ç±»åå’ŒProtocol @param properties: æ–°å¢propertyï¼Œå­—ç¬¦ä¸²æ•°ç»„ï¼Œå¯çœç•¥ @param instanceMethods: è¦æ·»åŠ æˆ–è¦†ç›–çš„å®ä¾‹æ–¹æ³• @param classMethods: è¦æ·»åŠ æˆ–è¦†ç›–çš„ç±»æ–¹æ³• ä¾‹å­ï¼š 1234567defineClass('JPViewController', &#123; handleBtn: function(sender) &#123; //self.ORIGhandleBtn() var tableViewCtrl = JPTableViewController.alloc().init() self.navigationController().pushViewController_animated(tableViewCtrl, YES) &#125;&#125;) ä»£ç ä½œç”¨æ˜¯ï¼šæ›¿æ¢JPViewController ç±»ä¸­çš„ handleBtn: æ–¹æ³•ï¼Œå¹¶å¯ä»¥self.ORIGhandleBtn()é€‰æ‹©æ‰§è¡ŒåŸOCä¸­çš„æ­¤æ–¹æ³•ï¼Œè¿™å°±æ˜¯ä¿®å¤ï¼ˆæ›¿æ¢ï¼‰bugä»£ç ã€‚ åœ¨ç†Ÿæ‚‰è¯­æ³•ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ä¸»è¦ï¼ˆæš‚æ—¶ï¼‰é‡åˆ°äº†å¦‚ä¸‹å‡ ä¸ªé—®é¢˜ï¼ˆæ¯”è¾ƒå®¹æ˜“çŠ¯é”™ï¼‰ï¼š OCä¸­çš„ self.view å’Œ self.navigationController ä¹‹ç±»åœ¨è¿™é‡Œéƒ½éœ€è¦è°ƒç”¨å®ƒä»¬çš„getteræ–¹æ³•æ¥è¾¾åˆ°ç›¸åŒæ•ˆæœå¦‚self.view() åœ¨OCä¸­å†™æƒ¯äº†çš„ label.text = @&quot;text&quot;ä¹‹ç±»éƒ½è¦ä½¿ç”¨setteræ–¹æ³•label.setText(&quot;text&quot;) æ€»ç»“ä¸Šé¢ä¸¤æ¡å°±æ˜¯è®¿é—®å’Œèµ‹å€¼å±æ€§éƒ½è¦é€šè¿‡è°ƒç”¨æ–¹æ³•æ¥å®ç° åœ¨JSä»£ç ä¸­æ·»åŠ å±æ€§ï¼Œé‡å†™getteræ–¹æ³•æ—¶ï¼Œéœ€è¦è‡ªå·±åˆ›å»ºå±€éƒ¨å˜é‡ï¼Œä¸åœ¨æœ‰è‡ªåŠ¨ç”Ÿæˆçš„_ivarå¯ä»¥ä½¿ç”¨ åè¯ï¼šæ–¹æ³•åä¸å†æœ‰è¡¥å…¨æç¤ºåƒä¸‡ä¸è¦å†™é”™äº† æ­£åœ¨ç»§ç»­å­¦ä¹ â€¦â€¦","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]},{"title":"iOS10æ–°ç‰¹æ€§é€‚é…æ€»ç»“","date":"2016-12-16T00:45:51.000Z","path":"2016/12/16/iOS10æ–°ç‰¹æ€§é€‚é…æ€»ç»“/","text":"1. Notification(é€šçŸ¥)è‡ªä»Notificationè¢«å¼•å…¥ä¹‹åï¼Œè‹¹æœå°±ä¸æ–­çš„æ›´æ–°ä¼˜åŒ–ï¼Œä½†è¿™äº›æ›´æ–°ä¼˜åŒ–åªæ˜¯å°æ‰“å°é—¹ï¼Œç›´è‡³ç°åœ¨iOS 10å¼€å§‹çœŸæ­£çš„è¿›è¡Œå¤§æ”¹é‡æ„ï¼Œè¿™è®©å¼€å‘è€…ä¹Ÿä½“ä¼šåˆ°UserNotificationsçš„æ˜“ç”¨ï¼ŒåŠŸèƒ½ä¹Ÿå˜å¾—éå¸¸å¼ºå¤§ã€‚ iOS 9 ä»¥å‰çš„é€šçŸ¥ åœ¨è°ƒç”¨æ–¹æ³•æ—¶ï¼Œæœ‰äº›æ–¹æ³•è®©äººå¾ˆéš¾åŒºåˆ†ï¼Œå®¹æ˜“å†™é”™æ–¹æ³•ï¼Œè¿™è®©å¼€å‘è€…æœ‰æ—¶å€™å¾ˆè‹¦æ¼ã€‚ åº”ç”¨åœ¨è¿è¡Œæ—¶å’Œéè¿è¡Œæ—¶æ•è·é€šçŸ¥çš„è·¯å¾„è¿˜ä¸ä¸€è‡´ã€‚ åº”ç”¨åœ¨å‰å°æ—¶ï¼Œæ˜¯æ— æ³•ç›´æ¥æ˜¾ç¤ºè¿œç¨‹é€šçŸ¥ï¼Œè¿˜éœ€è¦è¿›ä¸€æ­¥å¤„ç†ã€‚ å·²ç»å‘å‡ºçš„é€šçŸ¥æ˜¯ä¸èƒ½æ›´æ–°çš„ï¼Œå†…å®¹å‘å‡ºæ—¶æ˜¯ä¸èƒ½æ”¹å˜çš„ï¼Œå¹¶ä¸”åªæœ‰ç®€å•æ–‡æœ¬å±•ç¤ºæ–¹å¼ï¼Œæ‰©å±•æ€§æ ¹æœ¬ä¸æ˜¯å¾ˆå¥½ã€‚ iOS 10 å¼€å§‹çš„é€šçŸ¥ æ‰€æœ‰ç›¸å…³é€šçŸ¥è¢«ç»Ÿä¸€åˆ°äº†UserNotifications.frameworkæ¡†æ¶ä¸­ã€‚ å¢åŠ äº†æ’¤é”€ã€æ›´æ–°ã€ä¸­é€”è¿˜å¯ä»¥ä¿®æ”¹é€šçŸ¥çš„å†…å®¹ã€‚ é€šçŸ¥ä¸åœ¨æ˜¯ç®€å•çš„æ–‡æœ¬äº†ï¼Œå¯ä»¥åŠ å…¥è§†é¢‘ã€å›¾ç‰‡ï¼Œè‡ªå®šä¹‰é€šçŸ¥çš„å±•ç¤ºç­‰ç­‰ã€‚ iOS 10ç›¸å¯¹ä¹‹å‰çš„é€šçŸ¥æ¥è¯´æ›´åŠ å¥½ç”¨æ˜“äºç®¡ç†ï¼Œå¹¶ä¸”è¿›è¡Œäº†å¤§è§„æ¨¡ä¼˜åŒ–ï¼Œå¯¹äºå¼€å‘è€…æ¥è¯´æ˜¯ä¸€ä»¶å¥½äº‹ã€‚ iOS 10å¼€å§‹å¯¹äºæƒé™é—®é¢˜è¿›è¡Œäº†ä¼˜åŒ–ï¼Œç”³è¯·æƒé™å°±æ¯”è¾ƒç®€å•äº†(æœ¬åœ°ä¸è¿œç¨‹é€šçŸ¥é›†æˆåœ¨ä¸€ä¸ªæ–¹æ³•ä¸­)ã€‚ å¦‚æœä½¿ç”¨äº†æ¨é€ï¼Œä¿®æ”¹å¦‚å›¾ï¼š 2. ATSçš„é—®é¢˜iOS 9ä¸­é»˜è®¤éHTTSçš„ç½‘ç»œæ˜¯è¢«ç¦æ­¢çš„ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠNSAllowsArbitraryLoadsè®¾ç½®ä¸ºYESç¦ç”¨ATSã€‚ä¸è¿‡iOS 10ä»2017å¹´1æœˆ1æ—¥èµ·è‹¹æœä¸å…è®¸æˆ‘ä»¬é€šè¿‡è¿™ä¸ªæ–¹æ³•è·³è¿‡ATSï¼Œä¹Ÿå°±æ˜¯è¯´å¼ºåˆ¶æˆ‘ä»¬ç”¨HTTPSï¼Œå¦‚æœä¸è¿™æ ·çš„è¯æäº¤Appå¯èƒ½ä¼šè¢«æ‹’ç»ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡NSExceptionDomainsæ¥é’ˆå¯¹ç‰¹å®šçš„åŸŸåå¼€æ”¾HTTPå¯ä»¥å®¹æ˜“é€šè¿‡å®¡æ ¸ã€‚ NSExceptionDomainsæ–¹å¼ è®¾ç½®åŸŸã€‚å¯ä»¥ç®€å•ç†è§£æˆï¼ŒæŠŠä¸æ”¯æŒhttpsåè®®çš„æ¥å£è®¾ç½®æˆhttpçš„æ¥å£ã€‚ å…·ä½“æ–¹æ³•ï¼š åœ¨é¡¹ç›®çš„info.plistä¸­æ·»åŠ ä¸€ä¸ªKeyï¼šApp Transport Security Settingsï¼Œç±»å‹ä¸ºå­—å…¸ç±»å‹ã€‚ ç„¶åç»™å®ƒæ·»åŠ ä¸€ä¸ªException Domainsï¼Œç±»å‹ä¸ºå­—å…¸ç±»å‹ï¼› æŠŠéœ€è¦çš„æ”¯æŒçš„åŸŸæ·»åŠ çµ¦Exception Domainsã€‚å…¶ä¸­åŸŸä½œä¸ºKeyï¼Œç±»å‹ä¸ºå­—å…¸ç±»å‹ã€‚ æ¯ä¸ªåŸŸä¸‹é¢éœ€è¦è®¾ç½®3ä¸ªå±æ€§ï¼šNSIncludesSubdomainsã€NSExceptionRequiresForwardSecrecyã€NSExceptionAllowsInsecureHTTPLoadsã€‚ å¦‚å›¾ï¼šç»†èŠ‚æç¤º:åœ¨iOS9ä»¥åçš„ç³»ç»Ÿä¸­å¦‚æœä½¿ç”¨åˆ°ç½‘ç»œå›¾ç‰‡ï¼Œä¹Ÿè¦æ³¨æ„ç½‘ç»œå›¾ç‰‡æ˜¯å¦æ˜¯HTTPçš„å“¦ï¼Œå¦‚æœæ˜¯ï¼Œä¹Ÿè¦æŠŠå›¾ç‰‡çš„åŸŸè®¾ç½®å“¦ï¼ 3. iOS 10 éšç§æƒé™è®¾ç½®iOS 10 å¼€å§‹å¯¹éšç§æƒé™æ›´åŠ ä¸¥æ ¼ï¼Œå¦‚æœä½ ä¸è®¾ç½®å°±ä¼šç›´æ¥å´©æºƒï¼Œç°åœ¨å¾ˆå¤šé‡åˆ°å´©æºƒé—®é¢˜äº†ï¼Œä¸€èˆ¬è§£å†³åŠæ³•éƒ½æ˜¯åœ¨info.plistæ–‡ä»¶æ·»åŠ å¯¹åº”çš„Key-Valueå°±å¯ä»¥äº†ã€‚ä»¥ä¸ŠValueå€¼ï¼Œåœˆå‡ºçš„çº¢çº¿éƒ¨åˆ†çš„æ–‡å­—æ˜¯å±•ç¤ºç»™ç”¨æˆ·çœ‹çš„ï¼Œå¿…é¡»æ·»åŠ ã€‚ 4. Xcode 8 è¿è¡Œä¸€å †æ²¡ç”¨çš„logsè§£å†³åŠæ³• ä¸Šå›¾æˆ‘ä»¬çœ‹åˆ°ï¼Œè‡ªå·±æ–°å»ºçš„ä¸€ä¸ªå·¥ç¨‹å•¥ä¹Ÿæ²¡å¹²å°±æ‰“å°ä¸€å †çƒ‚ä¸ƒå…«ç³Ÿçš„ä¸œè¥¿ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªåº”è¯¥æ˜¯Xcode 8çš„é—®é¢˜ï¼Œ å…·ä½“ä¹Ÿæ²¡ç»†ç ”ç©¶ï¼Œè§£å†³åŠæ³•æ˜¯è®¾ç½®OS_ACTIVITY_MODE : disableå¦‚ä¸‹å›¾:ç¬¬ä¸€æ­¥ï¼šç¬¬äºŒæ­¥ï¼šç¬¬ä¸‰æ­¥ï¼šæ·»åŠ å‚æ•°ï¼šName ï¼šOS_ACTIVITY_MODEValue : disable 5. iOS 10 UIStatusBaræ–¹æ³•è¿‡æœŸ:åœ¨æˆ‘ä»¬å¼€å‘ä¸­æœ‰å¯èƒ½ç”¨åˆ°UIStatusBarä¸€äº›å±æ€§ï¼Œåœ¨iOS 10 ä¸­è¿™äº›æ–¹æ³•å·²ç»è¿‡æœŸäº†ï¼Œå¦‚æœä½ çš„é¡¹ç›®ä¸­æœ‰ç”¨çš„è¯å°±å¾—éœ€è¦é€‚é…ã€‚ ä¸Šé¢çš„å›¾ç‰‡ä¹Ÿèƒ½å‘ç°ï¼Œå¦‚æœåœ¨iOS 10ä¸­ä½ éœ€è¦ä½¿ç”¨preferredStatusBaræ¯”å¦‚è¿™æ ·ï¼š //iOS 10 - (UIStatusBarStyle)preferredStatusBarStyle { return UIStatusBarStyleDefault; } 6. iOS 10 UICollectionView æ€§èƒ½ä¼˜åŒ–éšç€å¼€å‘è€…å¯¹UICollectionViewçš„ä¿¡èµ–ï¼Œé¡¹ç›®ä¸­ç”¨çš„åœ°æ–¹ä¹Ÿæ¯”è¾ƒå¤šï¼Œä½†æ˜¯è¿˜æ˜¯å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚æœ‰æ—¶ä¼šå¡é¡¿ã€åŠ è½½æ…¢ç­‰ã€‚æ‰€ä»¥iOS 10 å¯¹UICollectionViewè¿›ä¸€æ­¥çš„ä¼˜åŒ–ã€‚ UICollectionView cell pre-fetchingé¢„åŠ è½½æœºåˆ¶ UICollectionView and UITableView prefetchDataSource æ–°å¢çš„API é’ˆå¯¹self-sizing cells çš„æ”¹è¿› Interactive reordering åœ¨iOS 10 ä¹‹å‰,UICollectionViewä¸Šé¢å¦‚æœæœ‰å¤§é‡cell,å½“ç”¨æˆ·æ´»åŠ¨å¾ˆå¿«çš„æ—¶å€™,æ•´ä¸ªUICollectionViewçš„å¡é¡¿ä¼šå¾ˆæ˜æ˜¾,ä¸ºä»€ä¹ˆä¼šé€ æˆè¿™æ ·çš„é—®é¢˜,è¿™é‡Œæ¶‰åŠåˆ°äº†iOS ç³»ç»Ÿçš„é‡ç”¨æœºåˆ¶,å½“cellå‡†å¤‡åŠ è½½è¿›å±å¹•çš„æ—¶å€™,æ•´ä¸ªcelléƒ½å·²ç»åŠ è½½å®Œæˆ,ç­‰å¾…åœ¨å±å¹•å¤–é¢äº†,ä¹Ÿå°±æ˜¯æ•´æ•´ä¸€è¡Œcelléƒ½å·²ç»åŠ è½½å®Œæ¯•,è¿™å°±æ˜¯é€ æˆå¡é¡¿çš„ä¸»è¦åŸå› ,ä¸“ä¸šæœ¯è¯­å«åš:æ‰å¸§.è¦æƒ³è®©ç”¨æˆ·æ„Ÿè§‰ä¸åˆ°å¡é¡¿,æˆ‘ä»¬çš„appå¿…é¡»å¸§ç‡è¾¾åˆ°60å¸§/ç§’,ä¹Ÿå°±æ˜¯è¯´æ¯å¸§16æ¯«ç§’è¦åˆ·æ–°ä¸€æ¬¡. iOS 10 ä¹‹å‰UICollectionViewCellçš„ç”Ÿå‘½å‘¨æœŸæ˜¯è¿™æ ·çš„: ç”¨æˆ·æ»‘åŠ¨å±å¹•,å±å¹•å¤–æœ‰ä¸€ä¸ªcellå‡†å¤‡åŠ è½½è¿›æ¥,æŠŠcellä»reusré˜Ÿåˆ—æ‹¿å‡ºæ¥,ç„¶åè°ƒç”¨prepareForReuseæ–¹æ³•,åœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢,å¯ä»¥é‡ç½®cellçš„çŠ¶æ€,åŠ è½½æ–°çš„æ•°æ®; ç»§ç»­æ»‘åŠ¨,å°±ä¼šè°ƒç”¨cellForItemAtIndexPathæ–¹æ³•,åœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢ç»™cellèµ‹å€¼æ¨¡å‹,ç„¶åè¿”å›ç»™ç³»ç»Ÿ; å½“cellé©¬ä¸Šè¿›å»å±å¹•çš„æ—¶å€™,å°±ä¼šè°ƒç”¨willDisplayCellæ–¹æ³•,åœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢æˆ‘ä»¬è¿˜å¯ä»¥ä¿®æ”¹cell,ä¸ºè¿›å…¥å±å¹•åšæœ€åçš„å‡†å¤‡å·¥ä½œ; æ‰§è¡Œå®ŒwillDisplayCellæ–¹æ³•å,cellå°±è¿›å»å±å¹•äº†.å½“cellå®Œå…¨ç¦»å¼€å±å¹•ä»¥å,ä¼šè°ƒç”¨didEndDisplayingCellæ–¹æ³•.iOS 10 UICollectionViewCellçš„ç”Ÿå‘½å‘¨æœŸæ˜¯è¿™æ ·çš„: ç”¨æˆ·æ»‘åŠ¨å±å¹•,å±å¹•å¤–æœ‰ä¸€ä¸ªcellå‡†å¤‡åŠ è½½è¿›æ¥,æŠŠcellä»reusré˜Ÿåˆ—æ‹¿å‡ºæ¥,ç„¶åè°ƒç”¨prepareForReuseæ–¹æ³•,åœ¨è¿™é‡Œå½“cellè¿˜æ²¡æœ‰è¿›å»å±å¹•çš„æ—¶å€™,å°±å·²ç»æå‰è°ƒç”¨è¿™ä¸ªæ–¹æ³•äº†,å¯¹æ¯”ä¹‹å‰çš„åŒºåˆ«æ˜¯ä¹‹å‰æ˜¯cellçš„ä¸Šè¾¹ç¼˜é©¬ä¸Šè¿›å»å±å¹•çš„æ—¶å€™å°±ä¼šè°ƒç”¨è¯¥æ–¹æ³•,è€ŒiOS 10 æå‰åˆ°cellè¿˜åœ¨å±å¹•å¤–é¢çš„æ—¶å€™å°±è°ƒç”¨; åœ¨cellForItemAtIndexPathä¸­åˆ›å»ºcellï¼Œå¡«å……æ•°æ®ï¼Œåˆ·æ–°çŠ¶æ€ç­‰æ“ä½œ,ç›¸æ¯”äºä¹‹å‰ä¹Ÿæå‰äº†; ç”¨æˆ·ç»§ç»­æ»‘åŠ¨çš„è¯,å½“cellé©¬ä¸Šå°±éœ€è¦æ˜¾ç¤ºçš„æ—¶å€™æˆ‘ä»¬å†è°ƒç”¨willDisplayCellæ–¹æ³•,åŸåˆ™å°±æ˜¯:ä½•æ—¶éœ€è¦æ˜¾ç¤º,ä½•æ—¶å†å»è°ƒç”¨willDisplayCellæ–¹æ³•; å½“cellå®Œå…¨ç¦»å¼€å±å¹•ä»¥å,ä¼šè°ƒç”¨didEndDisplayingCellæ–¹æ³•,è·Ÿä¹‹å‰ä¸€æ ·,cellä¼šè¿›å…¥é‡ç”¨é˜Ÿåˆ—.åœ¨iOS 10 ä¹‹å‰,cellåªèƒ½ä»é‡ç”¨é˜Ÿåˆ—é‡Œé¢å–å‡º,å†èµ°ä¸€éç”Ÿå‘½å‘¨æœŸ,å¹¶è°ƒç”¨cellForItemAtIndexPathåˆ›å»ºæˆ–è€…ç”Ÿæˆä¸€ä¸ªcell.åœ¨iOS 10 ä¸­,ç³»ç»Ÿä¼šcellä¿å­˜ä¸€æ®µæ—¶é—´,ä¹Ÿå°±æ˜¯è¯´å½“ç”¨æˆ·æŠŠcellæ»‘å‡ºå±å¹•ä»¥å,å¦‚æœåˆæ»‘åŠ¨å›æ¥,cellä¸ç”¨å†èµ°ä¸€éç”Ÿå‘½å‘¨æœŸäº†,åªéœ€è¦è°ƒç”¨willDisplayCellæ–¹æ³•å°±å¯ä»¥é‡æ–°å‡ºç°åœ¨å±å¹•ä¸­äº†.iOS 10 ä¸­,ç³»ç»Ÿæ˜¯ä¸€ä¸ªä¸€ä¸ªåŠ è½½cellçš„,äºŒä»¥å‰æ˜¯ä¸€è¡Œä¸€è¡ŒåŠ è½½çš„,è¿™æ ·å°±å¯ä»¥æå‡å¾ˆå¤šæ€§èƒ½;iOS 10 æ–°å¢åŠ çš„Pre-Fetchingé¢„åŠ è½½è¿™ä¸ªæ˜¯ä¸ºäº†é™ä½UICollectionViewCellåœ¨åŠ è½½çš„æ—¶å€™æ‰€èŠ±è´¹çš„æ—¶é—´,åœ¨ iOS 10 ä¸­,é™¤äº†æ•°æ®æºåè®®å’Œä»£ç†åè®®å¤–,æ–°å¢åŠ äº†ä¸€ä¸ªUICollectionViewDataSourcePrefetchingåè®®,è¿™ä¸ªåè®®é‡Œé¢å®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³•: 1 - (void)collectionView:(UICollectionView *)collectionView prefetchItemsAtIndexPaths:(NSArray&lt;NSIndexPath *&gt; *)indexPaths NS_AVAILABLE_IOS(10_0; 1 - (void)collectionView:(UICollectionView *)collectionView cancelPrefetchingForItemsAtIndexPaths:(NSArray&lt;NSIndexPath *&gt; *)indexPaths NS_AVAILABLE_IOS(10_0; åœ¨ColletionView prefetchItemsAt indexPathsè¿™ä¸ªæ–¹æ³•æ˜¯å¼‚æ­¥é¢„åŠ è½½æ•°æ®çš„,å½“ä¸­çš„indexPathsæ•°ç»„æ˜¯æœ‰åºçš„,å°±æ˜¯itemæ¥æ”¶æ•°æ®çš„é¡ºåº; CollectionView cancelPrefetcingForItemsAt indexPathsè¿™ä¸ªæ–¹æ³•æ˜¯å¯é€‰çš„,å¯ä»¥ç”¨æ¥å¤„ç†åœ¨æ»‘åŠ¨ä¸­å–æ¶ˆæˆ–è€…é™ä½æå‰åŠ è½½æ•°æ®çš„ä¼˜å…ˆçº§. æ³¨æ„:è¿™ä¸ªåè®®å¹¶ä¸èƒ½ä»£æ›¿ä¹‹å‰è¯»å–æ•°æ®çš„æ–¹æ³•,ä»…ä»…æ˜¯è¾…åŠ©åŠ è½½æ•°æ®. Pre-Fetchingé¢„åŠ è½½å¯¹UITableViewCellåŒæ ·é€‚ç”¨. 7. iOS 10 UIColor æ–°å¢æ–¹æ³•ä»¥ä¸‹æ˜¯å®˜æ–¹æ–‡æ¡£çš„è¯´æ˜ï¼š Most graphics frameworks throughout the system, including Core Graphics, Core Image, Metal, and AVFoundation, have substantially improved support for extended-range pixel formats and wide-gamut color spaces. By extending this behavior throughout the entire graphics stack, it is easier than ever to support devices with a wide color display. In addition, UIKit standardizes on working in a new extended sRGB color space, making it easy to mix sRGB colors with colors in other, wider color gamuts without a significant performance penalty. Here are some best practices to adopt as you start working with Wide Color. In iOS 10, the UIColor class uses the extended sRGB color space and its initializers no longer clamp raw component values to between 0.0 and 1.0. If your app relies on UIKit to clamp component values (whether youâ€™re creating a color or asking a color for its component values), you need to change your appâ€™s behavior when you link against iOS 10. When performing custom drawing in a UIView on an iPad Pro (9.7 inch), the underlying drawing environment is configured with an extended sRGB color space. If your app renders custom image objects, use the new UIGraphicsImageRenderer class to control whether the destination bitmap is created using an extended-range or standard-range format. If you are performing your own image processing on wide-gamut devices using a lower level API, such as Core Graphics or Metal, you should use an extended range color space and a pixel format that supports 16-bit floating-point component values. When clamping of color values is necessary, you should do so explicitly. Core Graphics, Core Image, and Metal Performance Shaders provide new options for easily converting colors and images between color spaces. å› ä¸ºä¹‹å‰æˆ‘ä»¬éƒ½æ˜¯ç”¨RGBæ¥è®¾ç½®é¢œè‰²ï¼Œåæ­£ç”¨èµ·æ¥ä¹Ÿä¸æ˜¯ç‰¹åˆ«å¤šæ ·åŒ–ï¼Œè¿™æ¬¡æ–°å¢çš„æ–¹æ³•åº”è¯¥å°±æ˜¯ä¸€ä¸ªå¼¥è¡¥å§ã€‚æ‰€ä»¥åœ¨iOS 10 è‹¹æœå®˜æ–¹å»ºè®®æˆ‘ä»¬ä½¿ç”¨sRGBï¼Œå› ä¸ºå®ƒæ€§èƒ½æ›´å¥½ï¼Œè‰²å½©æ›´ä¸°å¯Œã€‚å¦‚æœä½ è‡ªå·±ä¸ºUIColorå†™äº†ä¸€å¥—åˆ†ç±»çš„è¯ä¹Ÿå¯å°è¯•æ›¿æ¢ä¸ºsRGBï¼ŒUIColorç±»ä¸­æ–°å¢äº†ä¸¤ä¸ªApiå¦‚ä¸‹: 123+ (UIColor *)colorWithDisplayP3Red:(CGFloat)displayP3Red green:(CGFloat)green blue:(CGFloat)blue alpha:(CGFloat)alpha NS_AVAILABLE_IOS(10_0);- (UIColor *)initWithDisplayP3Red:(CGFloat)displayP3Red green:(CGFloat)green blue:(CGFloat)blue alpha:(CGFloat)alpha NS_AVAILABLE_IOS(10_0); 8. iOS 10 UITextContentType// The textContentType property is to provide the keyboard with extra information about the semantic intent of the text document.@property(nonatomic,copy) UITextContentType textContentType NS_AVAILABLE_IOS(10_0); // default is nil åœ¨iOS 10 UITextFieldæ·»åŠ äº†textContentTypeæšä¸¾ï¼ŒæŒ‡ç¤ºæ–‡æœ¬è¾“å…¥åŒºåŸŸæ‰€æœŸæœ›çš„è¯­ä¹‰æ„ä¹‰ã€‚ ä½¿ç”¨æ­¤å±æ€§å¯ä»¥ç»™é”®ç›˜å’Œç³»ç»Ÿä¿¡æ¯ï¼Œå…³äºç”¨æˆ·è¾“å…¥çš„å†…å®¹çš„é¢„æœŸçš„è¯­ä¹‰æ„ä¹‰ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥æŒ‡å®šä¸€ä¸ªæ–‡æœ¬å­—æ®µï¼Œç”¨æˆ·å¡«å†™æ”¶åˆ°ä¸€å°ç”µå­é‚®ä»¶ç¡®è®¤uitextcontenttypeemailaddressã€‚å½“æ‚¨æä¾›æœ‰å…³æ‚¨æœŸæœ›ç”¨æˆ·åœ¨æ–‡æœ¬è¾“å…¥åŒºåŸŸä¸­è¾“å…¥çš„å†…å®¹çš„ä¿¡æ¯æ—¶ï¼Œç³»ç»Ÿå¯ä»¥åœ¨æŸäº›æƒ…å†µä¸‹è‡ªåŠ¨é€‰æ‹©é€‚å½“çš„é”®ç›˜ï¼Œå¹¶æé«˜é”®ç›˜ä¿®æ­£å’Œä¸»åŠ¨ä¸å…¶ä»–æ–‡æœ¬è¾“å…¥æœºä¼šçš„æ•´åˆã€‚ 9. iOS 10 å­—ä½“éšç€æ‰‹æœºç³»ç»Ÿå­—ä½“è€Œæ”¹å˜å½“æˆ‘ä»¬æ‰‹æœºç³»ç»Ÿå­—ä½“æ”¹å˜äº†ä¹‹åï¼Œé‚£æˆ‘ä»¬Appçš„labelä¹Ÿä¼šè·Ÿç€ä¸€èµ·å˜åŒ–ï¼Œè¿™éœ€è¦æˆ‘ä»¬å†™å¾ˆå¤šä»£ç æ¥è¿›ä¸€æ­¥å¤„ç†æ‰èƒ½å®ç°ï¼Œä½†æ˜¯iOS 10 æä¾›äº†è¿™æ ·çš„å±æ€§adjustsFontForContentSizeCategoryæ¥è®¾ç½®ã€‚å› ä¸ºæ²¡æœ‰çœŸæœºï¼Œå…·ä½“å®é™…æ“ä½œè¿˜æ²¡å»å®ç°ï¼Œå¦‚æœç†è§£é”™è¯¯å¸®å¿™æŒ‡æ­£ã€‚ UILabel *myLabel = [UILabel new]; /* UIFont çš„preferredFontForTextStyle: æ„æ€æ˜¯æŒ‡å®šä¸€ä¸ªæ ·å¼ï¼Œå¹¶è®©å­—ä½“å¤§å°ç¬¦åˆç”¨æˆ·è®¾å®šçš„å­—ä½“å¤§å°ã€‚ 12345myLabel.font =[UIFont preferredFontForTextStyle: UIFontTextStyleHeadline];/*Indicates whether the corresponding element should automatically update its font when the deviceâ€™s UIContentSizeCategory is changed.For this property to take effect, the elementâ€™s font must be a font vended using +preferredFontForTextStyle: or +preferredFontForTextStyle:compatibleWithTraitCollection: with a valid UIFontTextStyle.*/ //æ˜¯å¦æ›´æ–°å­—ä½“çš„å˜åŒ– myLabel.adjustsFontForContentSizeCategory = YES; 10. iOS 10 UIScrollViewæ–°å¢refreshControliOS 10 ä»¥ååªè¦æ˜¯ç»§æ‰¿UIScrollViewé‚£ä¹ˆå°±æ”¯æŒåˆ·æ–°åŠŸèƒ½ï¼š @property (nonatomic, strong, nullable) UIRefreshControl *refreshControl NS_AVAILABLE_IOS(10_0) __TVOS_PROHIBITED; 11. iOS 10 åˆ¤æ–­ç³»ç»Ÿç‰ˆæœ¬æ­£ç¡®å§¿åŠ¿åˆ¤æ–­ç³»ç»Ÿç‰ˆæœ¬æ˜¯æˆ‘ä»¬ç»å¸¸ç”¨åˆ°çš„ï¼Œå°¤å…¶æ˜¯ç°åœ¨å¤§å®¶éƒ½æœ‰å¯èƒ½éœ€è¦é€‚é…iOS 10ï¼Œé‚£ä¹ˆé—®é¢˜å°±å‡ºç°äº†ï¼Œå¦‚ä¸‹å›¾ï¼šæˆ‘ä»¬å¾—åˆ°äº†ç­”æ¡ˆæ˜¯ï¼š //å€¼ä¸º 1 [[[[UIDevice currentDevice] systemVersion] substringToIndex:1] integerValue] //å€¼ä¸º10.000000 [[UIDevice currentDevice] systemVersion].floatValue, //å€¼ä¸º10.0[[UIDevice currentDevice] systemVersion] æ‰€ä»¥è¯´åˆ¤æ–­ç³»ç»Ÿæ–¹æ³•æœ€å¥½è¿˜æ˜¯ç”¨åé¢çš„ä¸¤ç§æ–¹æ³•ï¼Œå“¦~æˆ‘å¿˜è®°è¯´äº†[[UIDevice currentDevice] systemVersion].floatValueè¿™ä¸ªæ–¹æ³•ä¹Ÿæ˜¯ä¸é è°±çš„ï¼Œå¥½åƒåœ¨8.3ç‰ˆæœ¬è¾“å‡ºçš„å€¼æ˜¯8.2ï¼Œè®°ä¸æ¸…æ¥šäº†åæ­£æ˜¯ä¸é è°±çš„ï¼Œæ‰€ä»¥å»ºè®®å¤§å®¶ç”¨[[UIDevice currentDevice] systemVersion]è¿™ä¸ªæ–¹æ³•ï¼ Swiftåˆ¤æ–­å¦‚ä¸‹ï¼š1234if #available(iOS 10.0, *) &#123; // iOS 10.0 print(\"iOS 10.0\"); &#125; else &#123; &#125; 12. Xcode 8 æ’ä»¶ä¸èƒ½ç”¨çš„é—®é¢˜å¤§å®¶éƒ½å‡çº§äº†Xcode 8ï¼Œä½†æ˜¯å¯¹äºæ’ä»¶ä¾èµ–çš„å¼€å‘è€…ä»¬ï¼Œä¸€è¾¹å“­ç€ä¸€è¾¹å»ç½‘ä¸Šå¯»æ‰¾è§£å†³åŠæ³•ã€‚é‚£ä¹ˆä¸‹é¢æ˜¯è§£å†³åŠæ³•ï¼šè®©ä½ çš„ Xcode8 ç»§ç»­ä½¿ç”¨æ’ä»¶(http://vongloo.me/2016/09/10/Make-Your-Xcode8-Great-Again/?utm_source=tuicool&amp;utm_medium=referral ) ä½†æ˜¯çœ‹åˆ°æ–‡ç« æœ€åçš„è§£é‡Šï¼Œæˆ‘ä»¬çŸ¥é“å¦‚æœç”¨æ’ä»¶çš„è¯ï¼Œå¯èƒ½å®‰å…¨ä¸Šä¼šæœ‰é—®é¢˜ã€å¹¶ä¸”æäº¤å®¡æ ¸ä¼šè¢«æ‹’ç»ï¼Œæ‰€ä»¥å»ºè®®å¤§å®¶è¿˜æ˜¯ä¸è¦ç”¨äº†ï¼Œè§£å†³åŠæ³•æ€»æ˜¯æœ‰çš„ï¼Œæ¯”å¦‚åœ¨Xcodeä¸­æ·»åŠ æ³¨é‡Šçš„ä»£ç å—ä¹Ÿæ˜¯å¾ˆæ–¹ä¾¿çš„ã€‚ 13. iOS 10å¼€å§‹é¡¹ç›®ä¸­æœ‰çš„æ–‡å­—æ˜¾ç¤ºä¸å…¨é—®é¢˜æˆ‘ç”¨Xcode 8 å’ŒXcode 7.3åˆ†åˆ«æµ‹è¯•äº†ä¸‹ï¼Œå¦‚ä¸‹å›¾ï¼š Xcode 8 Xcode7 åˆ›å»ºä¸€ä¸ªLabelç„¶åè®©å®ƒè‡ªé€‚åº”å¤§å°ï¼Œå­—ä½“å¤§å°éƒ½æ˜¯17æœ€åè¾“å‡ºçš„å®½åº¦æ˜¯ä¸ä¸€æ ·çš„ï¼Œæˆ‘ä»¬å†çœ‹ä¸€ä¸‹ï¼Œä¸‹é¢çš„æ•°æ®å°±çŸ¥é“ä¸ºä»€ä¹ˆå‡çº§iOS 10 ä¹‹åAppä¸­æœ‰çš„æ–‡å­—æ˜¾ç¤ºä¸å…¨äº†ï¼š è‹±æ–‡å­—æ¯ä¼šä¸ä¼šä¹Ÿæœ‰è¿™ç§é—®é¢˜ï¼Œæˆ‘åˆé€šè¿‡æµ‹è¯•ï¼Œåæ¥å‘ç°è‹±æ–‡å­—æ¯æ²¡æœ‰é—®é¢˜ï¼Œåªæœ‰æ±‰å­—æœ‰é—®é¢˜ã€‚ç›®å‰åªæœ‰ä¸€ä¸ªä¸€ä¸ªä¿®æ”¹æ§ä»¶è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæš‚æ—¶æ²¡æœ‰å…¶ä»–å¥½åŠæ³•æ¥è§£å†³ã€‚ 14. Xcode 8ä½¿ç”¨Xib awakeFromNibçš„è­¦å‘Šé—®é¢˜åœ¨Xcode 8ä¹‹å‰æˆ‘ä»¬ä½¿ç”¨Xibåˆå§‹åŒ–- (void)awakeFromNib {}éƒ½æ˜¯è¿™ä¹ˆå†™ä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯åœ¨Xcode 8ä¼šæœ‰å¦‚ä¸‹è­¦å‘Šï¼š å®˜æ–¹è§£é‡Šï¼š You must call the super implementation of awakeFromNib to give parent classes the opportunity to perform any additional initialization they require.Although the default implementation of this method does nothing, many UIKit classes provide non-empty implementations.You may call the super implementation at any point during your own awakeFromNib method. ä½ å¿…é¡»è°ƒç”¨çˆ¶ç±»å®ç°awakeFromNibæ¥ç»™çˆ¶ç±»æ¥æ‰§è¡Œå®ƒä»¬éœ€è¦çš„ä»»ä½•é¢å¤–çš„åˆå§‹åŒ–çš„æœºä¼šã€‚è™½ç„¶è¿™ç§æ–¹æ³•çš„é»˜è®¤å®ç°ä¸åšä»»ä½•äº‹æƒ…ï¼Œè®¸å¤šUIKitç±»æä¾›éç©ºçš„å®ç°ã€‚ä½ å¯ä»¥è°ƒç”¨è‡ªå·±çš„awakeFromNibæ–¹æ³•ä¸­çš„ä»»ä½•æ—¶å€™è¶…çº§å®ç°ã€‚ 15. æ¨é€çš„æ—¶å€™ï¼Œå¼€å¯Remote notificationsYou&apos;ve implemented -[&lt;UIApplicationDelegate&gt; application:didReceiveRemoteNotification:fetchCompletionHandler:], but you still need to add &quot;remote-notification&quot; to the list of your supported UIBackgroundModes in your Info.plist.* è§£å†³æ–¹æ¡ˆï¼šéœ€è¦åœ¨Xcode ä¸­ä¿®æ”¹åº”ç”¨çš„ Capabilities å¼€å¯Remote notificationsï¼Œè¯·å‚è€ƒä¸‹å›¾ï¼š 16. One of the two will be used. Which one is undefined.objc[5114]: Class PLBuildVersion is implemented in both /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator.sdk/System/Library/PrivateFrameworks/AssetsLibraryServices.framework/AssetsLibraryServices (0x1109a5910) and /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator.sdk/System/Library/PrivateFrameworks/PhotoLibraryServices.framework/PhotoLibraryServices (0x110738210). One of the two will be used. Which one is undefined. åœ¨æ¨¡æ‹Ÿå™¨ä¸­ã€å‘ç°â€œOne of the two will be used. Which one is undefined.â€æ—¥å¿— æŸ¥æ‰¾èµ„æ–™å‘ç°åŸå› ï¼šobjc runtime å¯¹æ‰€ç”¨appä½¿ç”¨åŒä¸€ä¸ªå‘½åç©ºé—´(flat namespace)ï¼Œè¿è¡Œæœºåˆ¶å¦‚ä¸‹ï¼š é¦–å…ˆäºŒè¿›åˆ¶æ˜ åƒè¢«åŠ è½½ï¼Œæ£€æŸ¥ç¨‹åºä¾èµ–å…³ç³» æ¯ä¸€ä¸ªäºŒè¿›åˆ¶æ˜ åƒè¢«åŠ è½½çš„åŒæ—¶ï¼Œç¨‹åºçš„objc classesåœ¨objc runtimeå‘½åç©ºé—´ä¸­æ³¨å†Œ å¦‚æœå…·æœ‰ç›¸åŒåç§°çš„ç±»è¢«å†æ¬¡åŠ è½½ï¼Œobjc runtimeçš„è¡Œä¸ºæ˜¯ä¸å¯é¢„çŸ¥çš„ã€‚ä¸€ç§å¯èƒ½çš„æƒ…å†µæ˜¯ä»»æ„ä¸€ä¸ªç¨‹åºçš„è¯¥ç±»ä¼šè¢«åŠ è½½(è¿™åº”è¯¥ä¹Ÿæ˜¯é»˜è®¤åŠ¨ä½œ) 17. Invalid Bundle - The asset catalog at &#39;Payload/XXXXX/Assets.car&#39; can&#39;t contain 16-bit or P3 assets if the app supports iOS 9.3 or earlier åœ¨ Xcode 8 ä¸­ï¼Œå½“ä½ èµ„æºæ–‡ä»¶ä¸­[å«æœ‰16ä½å›¾]æˆ–è€…[å›¾ç‰‡æ˜¾ç¤ºæ¨¡å¼Î³å€¼ä¸ºâ€™P3â€™]ä¸”iOS targetsè®¾å®šä¸ºiOS 9.3ä»¥ä¸‹å°±ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜. å¦‚æœä½ çš„appéœ€è¦æ”¯æŒå¹¿è‰²åŸŸæ˜¾ç¤ºçš„è¯ï¼Œé‚£ä½ å¿…é¡»å¾—æŠŠtargetè®¾ç½®æˆiOS 9.3+ï¼Œç›¸åï¼Œå¦‚æœä½ çš„appä¸éœ€è¦æ”¯æŒå¹¿è‰²åŸŸä¸”ä½ æƒ³å…¼å®¹ iOS 9.3 ä¹‹å‰çš„é¡¹ç›®ï¼Œä½ å°±å¾—æŠŠæ‰€æœ‰çš„16ä½çš„æˆ–è€…æ˜¾ç¤ºæ¨¡å¼ä¸ºâ€™P3â€™å›¾ç‰‡å…¨éƒ½æ›¿æ¢æˆ8ä½æ¨¡å¼çš„SRGBé¢œè‰²çš„å›¾ç‰‡ã€‚ ä½ å¯ä»¥é€šè¿‡è¿è¡Œâ€œassetutilâ€åœ¨iTunes Connectçš„é”™è¯¯ä¿¡æ¯ä¸­æ‰¾åˆ°16-bit æˆ– P3 èµ„æºæ–‡ä»¶ã€‚ç¦»çº¿çš„è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š å¯¼å‡ºé¡¹ç›®çš„ ipa æ–‡ä»¶ å®šä½åˆ°è¯¥ipaæ–‡ä»¶ä¿®æ”¹åç¼€å.ipa ä¸º .zip. è§£å‹è¯¥ .zip æ–‡ä»¶. è§£å‹åçš„ç›®å½•é‡Œé¢ä¼šæœ‰ä¸€ä¸ªåŒ…å«ç€ä½ çš„ app bundle æ–‡ä»¶çš„ Payload æ–‡ä»¶å¤¹. æ‰“å¼€ç»ˆç«¯ç—…åˆ‡æ¢åˆ°ä½ çš„appçš„Payloadæ–‡ä»¶å¤¹ä¸‹çš„ .app bundle æ–‡ä»¶å¤¹å†…ï¼Œå½¢å¼å¦‚ä¸‹ï¼š cd path/to/Payload/your.app ç”¨ find å‘½ä»¤å®šä½åˆ° Assets.car æ–‡ä»¶ .app bundle , å½¢å¼å¦‚ä¸‹: find . -name &#39;Assets.car&#39; ä½¿ç”¨ assetutil å‘½ä»¤æ‰¾åˆ°ä»»ä½•åŒ…å«ç€ 16-bit or P3 çš„èµ„æºæ–‡ä»¶, å¯¹æ¯ä¸ª Assets.car ä¹‹è¡Œä»¥ä¸‹å‘½ä»¤ : sudo xcrun --sdk iphoneos assetutil --info /path/to/a/Assets.car &gt; /tmp/Assets.json æ‰“å¼€ä¸Šä¸€æ­¥ç”Ÿæˆçš„ /tmp/Assets.json æ–‡ä»¶å¹¶æŸ¥æ‰¾åŒ…å«æœ‰ â€œDisplayGamutâ€: â€œP3â€ æˆ–è€…ç›¸å…³çš„å†…å®¹. è¿™æ®µjsonçš„â€Nameâ€å­—æ®µå¯¹åº”çš„å€¼å°±æ˜¯16ä½æˆ–æ˜¾ç¤ºçš„Î³å€¼ä¸ºP3çš„èµ„æºæ–‡ä»¶å. æ‰¾åˆ°è¿™ä¸ªèµ„æºæ–‡ä»¶ä¿®æ”¹ä¸º 8ä½çš„sRGBå½¢å¼,é‡æ–°ç¼–è¯‘ä¸Šä¼ ä½ çš„appå³å¯. 18. This version does not support documents saved in the Xcode 8 format. Open this document with Xcode 8 or later ç¼–è¾‘é¡¹ç›®æ—¶é»˜è®¤ä½¿ç”¨Xcode8æ‰“å¼€ï¼Œå¯¼è‡´æˆ‘ç”¨Xcode7æ‰“å¼€Xibæ˜¯æŠ¥é”™ï¼š This version does not support documents saved in the Xcode 8 format. Open this document with Xcode 8.0 or later å¯¼è‡´ç”¨Xcode8æ‰“å¼€çš„Xibå…¨éƒ¨æ‰“ä¸å¼€ï¼Œåªèƒ½ç”¨ç¼–è¾‘å™¨å°†Xibé‡Œé¢çš„ä¸‹é¢ä¸€å¥è¯åˆ é™¤æ‰æ‰èƒ½æ‰“å¼€ï¼š &lt;capability name=&quot;documents saved in the Xcode 8 format&quot; minToolsVersion=&quot;8.0&quot;/&gt;","tags":[{"name":"iOS","slug":"iOS","permalink":"http://www.yangjie.hu//tags/iOS/"}]}]