<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="iOS," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="NSDistionary是非常熟悉常用的一个Foundation中的类，最显著的几个特点是：  以键值对存储数据 存储的数据具有唯一性 数据无序  我们这次不是讲NSDictionary或NSMutableDictionary的方法，这些在Apple API Reference中查询即可了解啦~我们来探索下NSDictionary的内部">
<meta name="keywords" content="iOS">
<meta property="og:type" content="article">
<meta property="og:title" content="解读Objective-C的NSDictionary">
<meta property="og:url" content="http://jake.gift/2017/04/20/解读Objective-C的NSDictionary/index.html">
<meta property="og:site_name" content="ColdCode">
<meta property="og:description" content="NSDistionary是非常熟悉常用的一个Foundation中的类，最显著的几个特点是：  以键值对存储数据 存储的数据具有唯一性 数据无序  我们这次不是讲NSDictionary或NSMutableDictionary的方法，这些在Apple API Reference中查询即可了解啦~我们来探索下NSDictionary的内部">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://jpkc.nwu.edu.cn/sjjg/study_online/book/8/4_2.files/image001.gif">
<meta property="og:updated_time" content="2017-10-06T07:12:34.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="解读Objective-C的NSDictionary">
<meta name="twitter:description" content="NSDistionary是非常熟悉常用的一个Foundation中的类，最显著的几个特点是：  以键值对存储数据 存储的数据具有唯一性 数据无序  我们这次不是讲NSDictionary或NSMutableDictionary的方法，这些在Apple API Reference中查询即可了解啦~我们来探索下NSDictionary的内部">
<meta name="twitter:image" content="http://jpkc.nwu.edu.cn/sjjg/study_online/book/8/4_2.files/image001.gif">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://jake.gift/2017/04/20/解读Objective-C的NSDictionary/"/>





  <title>解读Objective-C的NSDictionary | ColdCode</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ColdCode</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">托起一片绿叶，走向更远的远方</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/2016/12/29/知识传送门/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jake.gift/2017/04/20/解读Objective-C的NSDictionary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jakey_yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ColdCode">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">解读Objective-C的NSDictionary</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-20T11:27:20+08:00">
                2017-04-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/猿猿养成记/" itemprop="url" rel="index">
                    <span itemprop="name">猿猿养成记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>NSDistionary是非常熟悉常用的一个Foundation中的类，最显著的几个特点是：</p>
<ul>
<li>以键值对存储数据</li>
<li>存储的数据具有唯一性</li>
<li>数据无序</li>
</ul>
<p>我们这次不是讲NSDictionary或NSMutableDictionary的方法，这些在<a href="https://developer.apple.com/reference/foundation/nsdictionary?language=objc" target="_blank" rel="external">Apple API Reference</a>中查询即可了解啦~<br>我们来探索下NSDictionary的内部</p>
<a id="more"></a>
<h3 id="Apple文档的启示"><a href="#Apple文档的启示" class="headerlink" title="Apple文档的启示"></a>Apple文档的启示</h3><p>苹果貌似并不推荐我们去继承<code>NSDictionary</code>来使用其子类（苹果已经实现的子类：<code>NSMutableDictionary</code>除外）</p>
<blockquote>
<p>Before making a custom class of NSDictionary, investigate <strong>NSMapTable</strong> and the corresponding Core Foundation type, <strong>CFDictionary</strong>. Because NSDictionary and CFDictionary are “toll-free bridged,” you can substitute a CFDictionary object for a NSDictionary object in your code (with appropriate casting). Although they are corresponding types, CFDictionary and NSDictionary do not have identical interfaces or implementations, and you can sometimes do things with CFDictionary that you cannot easily do with NSDictionary.</p>
<p>If the behavior you want to add supplements that of the existing class, you could write a category on NSDictionary. Keep in mind, however, that this category will be in effect for all instances of NSDictionary that you use, and this might have unintended consequences. Alternatively, you could use composition to achieve the desired behavior.</p>
</blockquote>
<p><em>大致意思是让我们想要给<code>NSDictionary</code>添加新功能就使用分类，不要继承子类。如果打算要继承<code>NSDictionary</code>，则需要好好研究下<code>NSMapTable</code>和相对应的Core Foundation类型：<code>CFDictionary</code></em></p>
<p><code>CFDictionary</code>是Core Foundation中的字典，和<code>NSDictionary</code>可以无代价转换，两者可以互相调用对方的方法创建和释放。可以使用<code>CFDictionary</code>来实现<code>NSDictionary</code>不容易实现的功能。·</p>
<p>另外苹果推荐让我们研究的<a href="https://developer.apple.com/reference/foundation/nsmaptable?language=objc" target="_blank" rel="external"><code>NSMapTable</code></a>具体是什么呢?</p>
<blockquote>
<p>The NSMapTable class is a mutable collection modeled after NSDictionary</p>
</blockquote>
<p>看到这句话刚开始我有点不解，NSMapTable竟是模仿NSDictionary的一个可变得集合，那跟NSMutableDictionary有什么不同啊？</p>
<p>NSMapTable与NSDictionary的几个不同点是：</p>
<ul>
<li>可以weak的方式持有对象，当持有的对象的引用计数为0的时候，该对象会自动从集合中移除</li>
<li>key 和 value在输入的时候都可以copy，使用指针对做isEqual或者hashing对比</li>
<li>可以包含任何指针，不再仅仅局限于Objective-C的对象</li>
</ul>
<p>NSMapTable的初始化就可以指定 key 和 value 的持有方式</p>
<p>苹果提供了几个便捷的工厂方法<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//key strong， value strong</span></div><div class="line">+ (<span class="built_in">NSMapTable</span>&lt;KeyType, ObjectType&gt; *)strongToStrongObjectsMapTable <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_8, <span class="number">6</span>_0);</div><div class="line"><span class="comment">//key weak， value strong</span></div><div class="line">+ (<span class="built_in">NSMapTable</span>&lt;KeyType, ObjectType&gt; *)weakToStrongObjectsMapTable <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_8, <span class="number">6</span>_0); <span class="comment">// entries are not necessarily purged right away when the weak key is reclaimed</span></div><div class="line"><span class="comment">//key strong， value weak</span></div><div class="line">+ (<span class="built_in">NSMapTable</span>&lt;KeyType, ObjectType&gt; *)strongToWeakObjectsMapTable <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_8, <span class="number">6</span>_0);</div><div class="line"><span class="comment">//key weak， value weak</span></div><div class="line">+ (<span class="built_in">NSMapTable</span>&lt;KeyType, ObjectType&gt; *)weakToWeakObjectsMapTable <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_8, <span class="number">6</span>_0); <span class="comment">// entries are not necessarily purged right away when the weak key or object is reclaimed</span></div></pre></td></tr></table></figure></p>
<p>或者像这样指定：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//还可以指定NSMapTableCopyIn(添加前进行copy) ， 或者NSMapTableObjectPointerPersonality（使用指针去hashing）</span></div><div class="line"> <span class="built_in">NSMapTable</span> *mapTable = [<span class="built_in">NSMapTable</span> mapTableWithKeyOptions:<span class="built_in">NSMapTableStrongMemory</span> valueOptions:<span class="built_in">NSMapTableWeakMemory</span>];</div><div class="line"> </div><div class="line"> <span class="comment">//需要一个对象到对象的映射集合，可以使用如下的mapTable</span></div><div class="line"> </div><div class="line"> <span class="built_in">NSMapTable</span> *objectToObjectMapping = [<span class="built_in">NSMapTable</span> mapTableWithStrongToStrongObjects];</div></pre></td></tr></table></figure>
<p>同样类推，<a href="https://developer.apple.com/reference/foundation/nshashtable?language=objc" target="_blank" rel="external">NSHashTable</a>是对NSSet的模仿和衍生，扩展的功能与NSMapTable相同</p>
<h3 id="抛两个问题🙈"><a href="#抛两个问题🙈" class="headerlink" title="抛两个问题🙈"></a>抛两个问题🙈</h3><h5 id="Q：上千的对象存储到NSDictionary时，出现效率低下的问题是什么原因？"><a href="#Q：上千的对象存储到NSDictionary时，出现效率低下的问题是什么原因？" class="headerlink" title="Q：上千的对象存储到NSDictionary时，出现效率低下的问题是什么原因？"></a>Q：上千的对象存储到NSDictionary时，出现效率低下的问题是什么原因？</h5><p>直接先回答问题：因为存储的数量很多后hash表会出现比较多的冲突，解决大量冲突会占用大量CPU资源，造成效率低下。</p>
<p><a href="https://zh.wikipedia.org/wiki/%E5%93%88%E5%B8%8C%E8%A1%A8" target="_blank" rel="external">hash表</a>是什么？跟NSDictionary又有什么关系？</p>
<p>NSDictionary是使用hash表来实现key和value之间的映射和存储的。</p>
<p>hash表的基本思想是：将key作为关键字，放到hash函数ƒ(k)中计算得到结果为hash地址，然后将value值的地址存储到hash表中的ƒ(key)的hash地址中。</p>
<p>当关键字集合很大的时候，不同的关键字可能会通过hash函数映射到hash表的同一地址上。key1 ≠ key2, ƒ(key1) = ƒ(key2),这种情况称为冲突。冲突是不可避免的，只能通过改善哈希函数来减少冲突。（构造哈希函数方法请参考<a href="https://zh.wikipedia.org/wiki/%E5%93%88%E5%B8%8C%E8%A1%A8" target="_blank" rel="external">这里</a>或查找其他资料）</p>
<p>然而有冲突必定是要解决的，不然新的值怎么存储到哈希表中呢。<br>处理冲突主要有（查看原文请移步底部参考链接：哈希表）：</p>
<ul>
<li><strong>开放定址法</strong><ul>
<li>线性探测</li>
<li>平方探测</li>
<li>伪随机探测</li>
</ul>
</li>
<li><p><strong>单独链表法</strong></p>
<p>  将散列到同一个存储位置的所有元素保存在一个链表中。实现时，一种策略是散列表同一位置的所有冲突结果都是用栈存放的，新元素被插入到表的前端还是后端完全取决于怎样方便。<br>  <img src="http://jpkc.nwu.edu.cn/sjjg/study_online/book/8/4_2.files/image001.gif" alt=""></p>
</li>
<li><p><strong>再哈希</strong></p>
<p>  上一次哈希计算发生冲突后，使用另外的哈希函数进行哈希计算知道冲突不再发生</p>
</li>
<li><p><strong>建立公共溢出区</strong></p>
<p>  为冲突的哈希地址单独建立一块区域，所有冲突的哈希地址都存放在此区域中</p>
</li>
</ul>
<p>到这里也就可以推断出，如果在NSDictionary存取时出现效率低下的情况，那么很可能是： 1.频繁的扩容 2.冲突过多</p>
<h5 id="Q：NSMapTable是怎样的结构呢？"><a href="#Q：NSMapTable是怎样的结构呢？" class="headerlink" title="Q：NSMapTable是怎样的结构呢？"></a>Q：NSMapTable是怎样的结构呢？</h5><p><strong>先来看看NSMapTable的结构</strong>(代码来自于cocotron)<br>NSMapTable是一个key－value的容器，下面是NSMapTable的部分代码：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;</div><div class="line">   <span class="built_in">NSMapTable</span>        *table;</div><div class="line">   <span class="built_in">NSInteger</span>                i;</div><div class="line">   <span class="keyword">struct</span> _NSMapNode *j;</div><div class="line">&#125; <span class="built_in">NSMapEnumerator</span>;</div></pre></td></tr></table></figure>
<p>上述结构体描述了遍历一个NSMapTable时的一个指针对象，其中包含table对象自身的指针，计数值，和节点指针。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;</div><div class="line">   <span class="built_in">NSUInteger</span> (*hash)(<span class="built_in">NSMapTable</span> *table,<span class="keyword">const</span> <span class="keyword">void</span> *);</div><div class="line">   <span class="built_in">BOOL</span> (*isEqual)(<span class="built_in">NSMapTable</span> *table,<span class="keyword">const</span> <span class="keyword">void</span> *,<span class="keyword">const</span> <span class="keyword">void</span> *);</div><div class="line">   <span class="keyword">void</span> (*<span class="keyword">retain</span>)(<span class="built_in">NSMapTable</span> *table,<span class="keyword">const</span> <span class="keyword">void</span> *);</div><div class="line">   <span class="keyword">void</span> (*release)(<span class="built_in">NSMapTable</span> *table,<span class="keyword">void</span> *);</div><div class="line">   <span class="built_in">NSString</span>  *(*describe)(<span class="built_in">NSMapTable</span> *table,<span class="keyword">const</span> <span class="keyword">void</span> *);</div><div class="line">   <span class="keyword">const</span> <span class="keyword">void</span> *notAKeyMarker;</div><div class="line">&#125; <span class="built_in">NSMapTableKeyCallBacks</span>;</div></pre></td></tr></table></figure>
<p>上述结构体中存放的是几个函数指针，用于计算key的hash值，判断key是否相等，retain，release操作。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;</div><div class="line">   <span class="keyword">void</span>       (*<span class="keyword">retain</span>)(<span class="built_in">NSMapTable</span> *table,<span class="keyword">const</span> <span class="keyword">void</span> *);</div><div class="line">   <span class="keyword">void</span>       (*release)(<span class="built_in">NSMapTable</span> *table,<span class="keyword">void</span> *);</div><div class="line">   <span class="built_in">NSString</span>  *(*describe)(<span class="built_in">NSMapTable</span> *table, <span class="keyword">const</span> <span class="keyword">void</span> *);</div><div class="line">&#125; <span class="built_in">NSMapTableValueCallBacks</span>;</div></pre></td></tr></table></figure>
<p>上述存放的三个函数指针，定义在对nsmaptable插入一对key－value时，对value对象的操作。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSMapTable</span> : <span class="title">NSObject</span> </span>&#123;</div><div class="line">   <span class="built_in">NSMapTableKeyCallBacks</span>   *keyCallBacks;</div><div class="line">   <span class="built_in">NSMapTableValueCallBacks</span> *valueCallBacks;</div><div class="line">   <span class="built_in">NSUInteger</span>             count;</div><div class="line">   <span class="built_in">NSUInteger</span>             nBuckets;</div><div class="line">   <span class="keyword">struct</span> _NSMapNode  **buckets;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>上面是NSMtabtable真正的描述，可以看出来NSMapTable是一个哈希＋链表的数据结构(也就是使用Hash表中的单链表法解决冲突)，因此在NSMapTable中插入或者删除一对对象时</p>
<p>寻找的时间是O（1）＋O（m），m最坏时可能为n。</p>
<p> O（1）：为对key进行hash得到bucket的位置<br> O（m）：遍历该bucket后面冲突的value，通过链表连接起来。</p>
<p>因此：NSDictionary中的key Value遍历时是无序的，至如按照什么样的顺序，跟hash函数相关。NSMapTable使用NSObject的哈希函数。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">-(<span class="built_in">NSUInteger</span>)hash &#123;</div><div class="line">   <span class="keyword">return</span> (<span class="built_in">NSUInteger</span>)<span class="keyword">self</span>&gt;&gt;<span class="number">4</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>上述是NSObject的哈希值的计算方式，简单通过移位实现。右移4位，左边补0.<br>因为对象大多存于堆中，地址相差4位应该很正常。</p>
<p>参考：</p>
<p><a href="http://www.isaced.com/post-235.html" target="_blank" rel="external">NSMapTable: more than an NSDictionary for weak pointers</a></p>
<p><a href="https://developer.apple.com/reference/foundation/nsmaptable?language=objc" target="_blank" rel="external">Apple API Reference - NSMapTable</a></p>
<p><a href="https://developer.apple.com/reference/foundation/nshashtable?language=objc" target="_blank" rel="external">Apple API Reference - NSHashTable</a></p>
<p><a href="https://zh.wikipedia.org/wiki/%E5%93%88%E5%B8%8C%E8%A1%A8" target="_blank" rel="external">维基百科 - 哈希表</a>(需要翻下墙，也可以问下度娘)</p>
<p><a href="http://ibloodline.com/articles/2016/07/11/NSDictionary.html" target="_blank" rel="external">关于NSDictionary</a></p>
<p><a href="http://www.cnblogs.com/doudouyoutang/p/4379068.html" target="_blank" rel="external">NSDictionary 的内部实现</a></p>
<p><em>《Objective-C高级编程：iOS与OS X多线程和内存管理》 ARC的实现</em></p>

      
    </div>
    
    
    

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    Jakey_yang
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://jake.gift/2017/04/20/解读Objective-C的NSDictionary/" title="解读Objective-C的NSDictionary">http://jake.gift/2017/04/20/解读Objective-C的NSDictionary/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/03/29/removeFromSuperView浅谈/" rel="next" title="removeFromSuperView浅谈">
                <i class="fa fa-chevron-left"></i> removeFromSuperView浅谈
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/04/28/多睡觉多读书/" rel="prev" title="多睡觉多读书">
                多睡觉多读书 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        
  <script>
    window._bd_share_config = {
      "common": {
        "bdText": "",
        "bdMini": "1",
        "bdMiniList": false,
        "bdPic": ""
      },
      "image": {
        "viewList": ["tsina", "douban", "sqq", "qzone", "weixin", "twi", "fbook"],
        "viewText": "分享到：",
        "viewSize": "16"
      },
      "slide": {
        "bdImg": "5",
        "bdPos": "left",
        "bdTop": "100"
      }
    }
  </script>

<script>
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="Jakey_yang" />
          <p class="site-author-name" itemprop="name">Jakey_yang</p>
           
              <p class="site-description motion-element" itemprop="description">记录生活工作</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">38</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Apple文档的启示"><span class="nav-number">1.</span> <span class="nav-text">Apple文档的启示</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#抛两个问题🙈"><span class="nav-number">2.</span> <span class="nav-text">抛两个问题🙈</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Q：上千的对象存储到NSDictionary时，出现效率低下的问题是什么原因？"><span class="nav-number">2.0.1.</span> <span class="nav-text">Q：上千的对象存储到NSDictionary时，出现效率低下的问题是什么原因？</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Q：NSMapTable是怎样的结构呢？"><span class="nav-number">2.0.2.</span> <span class="nav-text">Q：NSMapTable是怎样的结构呢？</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jakey_yang</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
