<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Cookie in iOS | ColdCode</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="背景项目中用到了本地登录存储cookie，再进行webView请求时间带上cookie的功能。不是很清晰逻辑，于是学习了解了下iOS中cookie的使用，做个小结。跳过概念直接看使用🌰">
<meta name="keywords" content="iOS">
<meta property="og:type" content="article">
<meta property="og:title" content="Cookie in iOS">
<meta property="og:url" content="http://jake.gift/2017/01/12/cookie-in-iOS/index.html">
<meta property="og:site_name" content="ColdCode">
<meta property="og:description" content="背景项目中用到了本地登录存储cookie，再进行webView请求时间带上cookie的功能。不是很清晰逻辑，于是学习了解了下iOS中cookie的使用，做个小结。跳过概念直接看使用🌰">
<meta property="og:locale" content="zh-cn">
<meta property="og:image" content="http://ojam5z7vg.bkt.clouddn.com/coldreading/jpg/cookie%E5%B7%A5%E4%BD%9C.png-blog">
<meta property="og:image" content="http://ojam5z7vg.bkt.clouddn.com/coldreading/jpg/setcookie%E9%A6%96%E9%83%A81.png-blog">
<meta property="og:image" content="http://ojam5z7vg.bkt.clouddn.com/coldreading/jpg/setcookie%E9%A6%96%E9%83%A82.png-blog">
<meta property="og:image" content="http://ojam5z7vg.bkt.clouddn.com/coldreading/jpg/setcookie2%E9%A6%96%E9%83%A8.png-blog">
<meta property="og:updated_time" content="2017-09-13T14:31:10.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Cookie in iOS">
<meta name="twitter:description" content="背景项目中用到了本地登录存储cookie，再进行webView请求时间带上cookie的功能。不是很清晰逻辑，于是学习了解了下iOS中cookie的使用，做个小结。跳过概念直接看使用🌰">
<meta name="twitter:image" content="http://ojam5z7vg.bkt.clouddn.com/coldreading/jpg/cookie%E5%B7%A5%E4%BD%9C.png-blog">
  
    <link rel="alternative" href="/atom.xml" title="ColdCode" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          rootUrl: '/',
          fancybox: true,
          animate: false,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img src="/img/head.jpg" class="js-avatar" style="width: 100%;height: 100%;opacity: 1;">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/" title="Hi Mate">Jakey_yang</a></h1>
        </hgroup>

        
        <p class="header-subtitle">托起一片绿叶，走向更远的远方</p>
        
        
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/tags/iOS/">iOS</a></li>
                        
                            <li><a href="/tags/随笔/">随笔</a></li>
                        
                            <li><a href="/tags/学习笔记/">学习笔记</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=PAkNDgsKBQ4MCnxNTRJfU1E" title="mail">mail</a>
                            
                                <a class="fl github" target="_blank" href="https://github.com/huyangjake" title="github">github</a>
                            
                                <a class="fl weibo" target="_blank" href="#" title="weibo">weibo</a>
                            
                                <a class="fl twitter" target="_blank" href="#" title="twitter">twitter</a>
                            
                                <a class="fl jianshu" target="_blank" href="http://www.jianshu.com/u/b64617df987a" title="jianshu">jianshu</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://onevcat.com/#blog">onevcat</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.sunnyxx.com/">sunnyxx</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.cnbang.net/">bang</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.devtang.com/">唐巧</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.jianshu.com/users/88a056103c02/latest_articles">没故事的卓同学</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://casatwy.com/">Casa Taloyum</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://nianxi.net/">念茜</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://lucida.me/blog/developer-reading-list/">程序员读书清单</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">2年小猿人，沉浸于Objective-C，Swift       感冒JavaScript，python   坐标：杭州   邮箱：huyangjake@163.com</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me">Jakey_yang</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img src="/img/head.jpg" class="js-avatar" style="width: 100%; height: 100%; opacity: 1;">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me">Jakey_yang</a></h1>
            </hgroup>
            
            <p class="header-subtitle">托起一片绿叶，走向更远的远方</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/tags/iOS/">iOS</a></li>
                
                    <li><a href="/tags/随笔/">随笔</a></li>
                
                    <li><a href="/tags/学习笔记/">学习笔记</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=PAkNDgsKBQ4MCnxNTRJfU1E" title="mail">mail</a>
                    
                        <a class="github" target="_blank" href="https://github.com/huyangjake" title="github">github</a>
                    
                        <a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
                    
                        <a class="twitter" target="_blank" href="#" title="twitter">twitter</a>
                    
                        <a class="jianshu" target="_blank" href="http://www.jianshu.com/u/b64617df987a" title="jianshu">jianshu</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-cookie-in-iOS" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/01/12/cookie-in-iOS/" class="article-date">
      <time datetime="2017-01-12T08:37:13.000Z" itemprop="datePublished">2017-01-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Cookie in iOS
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        

        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>项目中用到了本地登录存储cookie，再进行webView请求时间带上cookie的功能。不是很清晰逻辑，于是学习了解了下iOS中cookie的使用，做个小结。跳过概念直接看<a href="#example">使用🌰</a></p>
<a id="more"></a>
<h3 id="Cookie介绍"><a href="#Cookie介绍" class="headerlink" title="Cookie介绍"></a>Cookie介绍</h3><p>Cookie分类两类：</p>
<ul>
<li>会话cookie</li>
<li>持久cookie</li>
</ul>
<p>会话 cookie 和持久 cookie 之间唯一的区别就是它们的过期时间。</p>
<p><strong>cookie如何工作</strong></p>
<p>cookie 中包含了一个由 名字 = 值 （name=value） 这样的信息构成的任意列表，并通过 Set-Cookie 或 Set-Cookie2 HTTP 响应（扩 展）首部将其贴到用户身上去。<br><img src="http://ojam5z7vg.bkt.clouddn.com/coldreading/jpg/cookie%E5%B7%A5%E4%BD%9C.png-blog" alt="cookie工作"></p>
<p><strong>cookie组成</strong><br>现在使用的 cookie 规范有两个不同的版本：cookies 版本 0（有时被称为 Netscape cookies） 和 cookies 版 本 1（RFC 2965） 。 cookies 版 本 1 是 对 cookies 版 本 0 的 扩 展，应用不如后者广泛。</p>
<ul>
<li><p><strong>cookie版本0</strong></p>
<ul>
<li><p>Set-Cookie 首部<br>Set-Cookie 首部有一个强制性的cookie名和cookie值。后面跟着可选的cookie 属性，中间由分号分隔。<br><img src="http://ojam5z7vg.bkt.clouddn.com/coldreading/jpg/setcookie%E9%A6%96%E9%83%A81.png-blog" alt=""><br><img src="http://ojam5z7vg.bkt.clouddn.com/coldreading/jpg/setcookie%E9%A6%96%E9%83%A82.png-blog" alt=""></p>
</li>
<li><p>cookie 0首部:</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Cookie: session-id=002-1145265-8016838; session-id-time=1007884800</div></pre></td></tr></table></figure>
<ul>
<li><p><strong>cookie版本1</strong> </p>
<ul>
<li><p>Set-Cookie2首部<br>这个版本 1 标准引入了Set-Cookie2首部和Cookie2首部，但它也能于版本0进行交互操作。<br><img src="http://ojam5z7vg.bkt.clouddn.com/coldreading/jpg/setcookie2%E9%A6%96%E9%83%A8.png-blog" alt=""></p>
</li>
<li><p>cookie 1首部:</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Cookie: $Version=&quot;1&quot;;</div><div class="line">ID=&quot;29046&quot;; $Domain=&quot;.joes-hardware.com&quot;;</div><div class="line">color=&quot;blue&quot;;</div><div class="line">Coupon=&quot;hammer027&quot;; $Path=&quot;/tools&quot;;</div><div class="line">Coupon=&quot;handvac103&quot;; $Path=&quot;/tools/cordless&quot;</div></pre></td></tr></table></figure>
<h3 id="NSHTTPCookieStorage"><a href="#NSHTTPCookieStorage" class="headerlink" title="NSHTTPCookieStorage"></a>NSHTTPCookieStorage</h3><blockquote>
<p>NSHTTPCookieStorage implements a singleton object (shared instance) that manages storage of cookies. Each cookie is represented by an instance of the NSHTTPCookie class. As a rule, cookies are shared among all applications and are kept in sync across process boundaries. Session cookies (where the cookie object’s sessionOnly method returns YES) are local to a single process and are not shared.</p>
</blockquote>
<p><code>NSHTTPCookieStorage</code>的实现是一个单例对象，管理着<code>NSHTTPCookie</code>对象，会话cookie的 <code>sessionOnly</code>方法返回<code>YES</code>就不可在进程间共享。</p>
<p>然而苹果在这个类的API Reference中写了一个<code>iOS Note</code>：</p>
<blockquote>
<p>Cookies are not shared among applications in iOS.</p>
</blockquote>
<ul>
<li><p><strong>iOS</strong>中cookie不能跨应用共享</p>
</li>
<li><p><strong>MacOS</strong>中<code>sessionOnly</code>不为<code>YES</code>是可以被共享的</p>
</li>
</ul>
<p><code>NSHTTPCookieStorage</code>可以管理cookie的接受策略，在一个app中改变cookie的接受策略将会影响其他正在运行的app的cookie接受策略。</p>
<p>当其他的app修改了cookie存储 或者 cookie接受策略，NSHTTPCookieStorage将会给app发送<code>NSHTTPCookieManagerCookiesChangedNotification</code>或者<code>NSHTTPCookieStorageAcceptPolicyChangedNotification</code>通知</p>
<p><strong>Cookie接受策略：</strong><br><code>NSHTTPCookieAcceptPolicy</code></p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSUInteger</span>, <span class="built_in">NSHTTPCookieAcceptPolicy</span>) &#123;</div><div class="line">    <span class="built_in">NSHTTPCookieAcceptPolicyAlways</span>,<span class="comment">//默认策略，接受所有的cookies</span></div><div class="line">    <span class="built_in">NSHTTPCookieAcceptPolicyNever</span>,<span class="comment">//拒绝所有的cookies</span></div><div class="line">    <span class="built_in">NSHTTPCookieAcceptPolicyOnlyFromMainDocumentDomain</span><span class="comment">//只从主文档域名接受cookies</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="NSHTTPCookie"><a href="#NSHTTPCookie" class="headerlink" title="NSHTTPCookie"></a>NSHTTPCookie</h3><blockquote>
<p>An NSHTTPCookie object represents an HTTP cookie. It is an immutable object, initialized from a dictionary containing the cookie attributes.</p>
</blockquote>
<p><code>NSHTTPCookie</code>对象中包含了HTTP 的cookie对象，从包含cookie字段的字典初始化创建。</p>
<blockquote>
<p>The NSHTTPCookie class encapsulates a cookie, providing accessors for many of the common cookie attributes. This class also provides methods to convert HTTP cookie headers to NSHTTPCookie instances and convert an NSHTTPCookie instance to headers suitable for use with an NSURLRequest object. The URL loading system automatically sends any stored cookies appropriate for an NSURLRequest object unless the request specifies not to send cookies. Likewise, cookies returned in an NSURLResponse object are accepted in accordance with the current cookie acceptance policy.</p>
</blockquote>
<p><code>NSHTTPCookie</code>类封装了一个HTTP Cookie，并提供常见的Cookie属性访问接口。<code>NSHTTPCookie</code>可以转换HTTP Cookie成NSHTTPCookies对象，并可以将NSHTTPCookie对象转化为NSURLRequest对象的请求头部分。URL loading system 会自动地给NSURLRequest对象发送存储的cookie，除非NSURLRequest对象指定不需要传cookie，同样cookie在NSURLRequest中返回也按照当前的cookie接受策略接收。</p>
<h3 id="Cookie使用💪个🌰"><a href="#Cookie使用💪个🌰" class="headerlink" title="Cookie使用💪个🌰"></a><span id="example">Cookie使用💪个🌰</span></h3><p>Cookie生成的有两个途径，一个是访问一个网页，这个网页返回的HTTP Header中有Set-Cookie指令进行Cookie的设置，这里Cookie的本地处理其实是由WebKit进行的；还有一种途径就是客户端通过代码手动设置Cookie。</p>
<p>值得注意<a href="http://geeklu.com/2013/04/ios-cookie/" target="_blank" rel="external">iOS Cookie使用</a>提到：<br>NSHTTPCookieStorage存在一个问题，setCookie或者deleteCookie后并不会立即进行持久化，而是有几秒的延迟。为了可靠性，我们会将cookie信息保存一份到User Defaults，需要用的时候load进来。</p>
<ul>
<li>客户端手动设置Cookie</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSMutableDictionary</span> *cookieProperties = [<span class="built_in">NSMutableDictionary</span> dictionary];</div><div class="line">[cookieProperties setObject:<span class="string">@"name"</span> forKey:<span class="built_in">NSHTTPCookieName</span>];</div><div class="line">[cookieProperties setObject:<span class="string">@"value"</span> forKey:<span class="built_in">NSHTTPCookieValue</span>];</div><div class="line">[cookieProperties setObject:<span class="string">@"www.taobao.com"</span> forKey:<span class="built_in">NSHTTPCookieDomain</span>];</div><div class="line">[cookieProperties setObject:<span class="string">@"/"</span> forKey:<span class="built_in">NSHTTPCookiePath</span>];</div><div class="line">[cookieProperties setObject:<span class="string">@"0"</span> forKey:<span class="built_in">NSHTTPCookieVersion</span>];</div><div class="line">[cookieProperties setObject:<span class="string">@"30000"</span> forKey:<span class="built_in">NSHTTPCookieMaximumAge</span>];</div><div class="line"><span class="built_in">NSHTTPCookie</span> *cookie = [<span class="built_in">NSHTTPCookie</span> cookieWithProperties:cookieProperties];</div><div class="line">[[<span class="built_in">NSHTTPCookieStorage</span> sharedHTTPCookieStorage] setCookie:cookie];</div><div class="line"><span class="comment">//删除cookie的方法为deleteCookie:</span></div></pre></td></tr></table></figure>
<p>在通过setCookie:进行设置cookie的时候，会覆盖name,domain,path都相同的cookie的。<br>至于cookie会不会持久化到cookie文件中主要看这个cookie的生命周期，和Max-Age或者Expires有关。</p>
<ul>
<li>通过HTTP Header的Set-Cookie后者Set-Cookie2设置Cookie</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">//请求一个网址，即可分配到cookie</span></div><div class="line">    AFHTTPRequestOperationManager *manager = [AFHTTPRequestOperationManager manager];</div><div class="line">    manager.responseSerializer = [AFJSONResponseSerializer new];</div><div class="line">    [manager GET:urlString parameters:<span class="literal">nil</span> success:^(AFHTTPRequestOperation *operation, <span class="keyword">id</span> responseObject) &#123;</div><div class="line"> </div><div class="line">        <span class="comment">//获取cookie</span></div><div class="line">        <span class="built_in">NSArray</span> *cookies = [[<span class="built_in">NSHTTPCookieStorage</span> sharedHTTPCookieStorage] cookies];</div><div class="line">        </div><div class="line">        <span class="comment">/*</span></div><div class="line"><span class="comment">         * 把cookie进行归档并转换为NSData类型</span></div><div class="line"><span class="comment">         * 注意：cookie不能直接转换为NSData类型，否则会引起崩溃。</span></div><div class="line"><span class="comment">         * 所以先进行归档处理，再转换为Data</span></div><div class="line"><span class="comment">         */</span></div><div class="line">        <span class="built_in">NSData</span> *cookiesData = [<span class="built_in">NSKeyedArchiver</span> archivedDataWithRootObject: [[<span class="built_in">NSHTTPCookieStorage</span> sharedHTTPCookieStorage] cookies]];</div><div class="line"> </div><div class="line">        <span class="comment">//存储归档后的cookie</span></div><div class="line">        <span class="built_in">NSUserDefaults</span> *userDefaults = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</div><div class="line">        [userDefaults setObject: cookiesData forKey: <span class="string">@"cookie"</span>];</div><div class="line">        [<span class="keyword">self</span> setCookie];</div><div class="line">        </div><div class="line">    &#125; failure:^(AFHTTPRequestOperation *operation, <span class="built_in">NSError</span> *error) &#123;</div><div class="line"> </div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    - (<span class="keyword">void</span>)setCookie</div><div class="line">&#123;</div><div class="line">    <span class="comment">//取出保存的cookie</span></div><div class="line">    <span class="built_in">NSUserDefaults</span> *userDefaults = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</div><div class="line"> </div><div class="line">    <span class="comment">//对取出的cookie进行反归档处理</span></div><div class="line">    <span class="built_in">NSArray</span> *cookies = [<span class="built_in">NSKeyedUnarchiver</span> unarchiveObjectWithData:[userDefaults objectForKey:<span class="string">@"cookie"</span>]];</div><div class="line"> </div><div class="line">    <span class="keyword">if</span> (cookies) &#123;</div><div class="line">        <span class="comment">//设置cookie</span></div><div class="line">        <span class="built_in">NSHTTPCookieStorage</span> *cookieStorage = [<span class="built_in">NSHTTPCookieStorage</span> sharedHTTPCookieStorage];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">id</span> cookie <span class="keyword">in</span> cookies) &#123;</div><div class="line">            [cookieStorage setCookie:(<span class="built_in">NSHTTPCookie</span> *)cookie];</div><div class="line">        &#125;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"无cookie"</span>);</div><div class="line">   &#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="https://developer.apple.com/reference/foundation/nshttpcookiestorage" target="_blank" rel="external">NSHTTPCookieStorage</a></p>
<p><a href="https://developer.apple.com/library/prerelease/content/documentation/Cocoa/Conceptual/URLLoadingSystem/CookiesandCustomProtocols/CookiesandCustomProtocols.html" target="_blank" rel="external">Cookies and Custom Protocols</a></p>
<p><a href="http://geeklu.com/2013/04/ios-cookie/" target="_blank" rel="external">http://geeklu.com/2013/04/ios-cookie/</a></p>
<p><a href="http://blog.it985.com/11248.html" target="_blank" rel="external">http://blog.it985.com/11248.html</a></p>
<p><em>《HTTP 权威指南》第11章 客户端识别与cookie机制</em></p>
<h3 id="相关导引"><a href="#相关导引" class="headerlink" title="相关导引"></a>相关导引</h3><p>解决UIWebView和WKWebView之间的cookie共享问题：</p>
<p><a href="https://fengqiangboy.com/14611518603473.html" target="_blank" rel="external">iOS开发-打通UIWebView和WKWebView的Cookie</a></p>

      
      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2017/01/12/cookie-in-iOS/">Cookie in iOS</a></p>
        <p><span>文章作者:</span><a href="/" title="访问 Jakey_yang 的个人博客">Jakey_yang</a></p>
        <p><span>发布时间:</span>2017年01月12日 - 16时37分</p>
        <p><span>最后更新:</span>2017年09月13日 - 22时31分</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2017/01/12/cookie-in-iOS/" title="Cookie in iOS">http://jake.gift/2017/01/12/cookie-in-iOS/</a>
            <span class="copy-path" data-clipboard-text="原文: http://jake.gift/2017/01/12/cookie-in-iOS/　　作者: Jakey_yang" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script src="/js/clipboard.min.js"></script>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



<nav id="article-nav">
  
    <a href="/2017/01/19/Swift的weak-unowned-unowned-unsafe/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          Swift的weak Unowned Unowned(unsafe)
        
      </div>
    </a>
  
  
    <a href="/2017/01/10/Objective-C中的装饰模式/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Objective-C中的装饰模式</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#背景"><span class="toc-number">1.</span> <span class="toc-text">背景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie介绍"><span class="toc-number">2.</span> <span class="toc-text">Cookie介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NSHTTPCookieStorage"><span class="toc-number">3.</span> <span class="toc-text">NSHTTPCookieStorage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NSHTTPCookie"><span class="toc-number">4.</span> <span class="toc-text">NSHTTPCookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie使用💪个🌰"><span class="toc-number">5.</span> <span class="toc-text">Cookie使用💪个🌰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#参考"><span class="toc-number">6.</span> <span class="toc-text">参考</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#相关导引"><span class="toc-number">7.</span> <span class="toc-text">相关导引</span></a></li></ol>
</div>
<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
    }
</script>





<div class="bdsharebuttonbox">
	<a href="#" class="fx fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
	<a href="#" class="fx fa-weixin bds_weixin" data-cmd="weixin" title="分享到微信"></a>
	<a href="#" class="fx fa-qq bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a>
	<a href="#" class="fx fa-facebook-official bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
	<a href="#" class="fx fa-twitter bds_twi" data-cmd="twi" title="分享到Twitter"></a>
	<a href="#" class="fx fa-linkedin bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
	<a href="#" class="fx fa-files-o bds_copy" data-cmd="copy" title="分享到复制网址"></a>
</div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>




    
        <div id="gitments"></div>
<script src="/js/gitment.browser.js"></script>
<script>
    var gitment = new Gitment({
      id: window.location.pathname,
      owner: 'huyangjake',
      repo: 'BlogComments',
      oauth: {
        client_id: '465fc53423145e17a447',
        client_secret: '4c8103f9a678b2e4546912bd02111ddf33c49f24',
      },
    })
    gitment.render('gitments')
</script>
    



    <div class="scroll" id="post-nav-button">
        
            <a href="/2017/01/19/Swift的weak-unowned-unowned-unsafe/" title="上一篇: Swift的weak Unowned Unowned(unsafe)">
                <i class="fa fa-angle-left"></i>
            </a>
        
        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a href="/2017/01/10/Objective-C中的装饰模式/" title="下一篇: Objective-C中的装饰模式">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/07/19/iOS隐式动画/">iOS隐式动画</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/17/Hi！CALayer我们聊聊/">Hi！CALayer我们聊聊</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/14/自定义NSURLProtocol实现UIWebView缓存机制/">自定义NSURLProtocol实现UIWebView缓存机制</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/03/小程序视图层/">小程序视图层</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/03/小程序逻辑层/">小程序逻辑层</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/03/微信小程序初识/">微信小程序初识</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/25/Apple-debugging-使用LLDB替换方法为自定义的block/">Apple Debugging---使用LLDB替换方法为自定义的block</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/23/Apple-Debugging-开始使用LLDB/">Apple Debugging---开始使用LLDB</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/11/方向/">方向</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/03/一次版本发布的启示/">一次版本发布的启示</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/28/多睡觉多读书/">多睡觉多读书</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/20/解读Objective-C的NSDictionary/">解读Objective-C的NSDictionary</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/29/removeFromSuperView浅谈/">removeFromSuperView浅谈</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/24/H5跳转Native路由机制的探索/">H5跳转Native路由机制的探索</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/08/JSPatch遇上Swift/">JSPatch遇上Swift</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/20/Swift和Objective-C的数组转换/">Swift和Objective-C的数组转换</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/19/Using-Swift-with-Cocoa-and-Objective-C笔记-ONE/">Using Swift With Cocoa and Objective-C笔记_ONE</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/19/Swift的weak-unowned-unowned-unsafe/">Swift的weak Unowned Unowned(unsafe)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/12/cookie-in-iOS/">Cookie in iOS</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/10/Objective-C中的装饰模式/">Objective-C中的装饰模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/04/继承与代理-Decorate-Pattern/">继承与代理--Decorate Pattern</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/29/知识传送门/">知识传送门</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/23/JSPatch学习分享/">JSPatch学习分享</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/19/Objective-C-isa指针/">Objective-C Isa指针</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/19/JSPatch学习笔记-二/">JSPatch学习笔记(二)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/19/JSPatch学习笔记-一/">JSPatch学习笔记(一)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/16/iOS10新特性适配总结/">iOS10新特性适配总结</a></li></ul>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
    <script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
            }
        })
    </script>



    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2017 Jakey_yang
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/luuman/hexo-theme-spfk" target="_blank">spfk</a> by luuman
            </div>
        </div>
        
    </div>
</footer>

    </div>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 109;
            var backgroundimg = "url(/background/bg-" + backgroundnum +".jpg)";
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>




	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?3fdf633934fb9f62ceee0538975b8820";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>


<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>